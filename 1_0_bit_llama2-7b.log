/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.24it/s]
Model loaded. LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 4096)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=4096, out_features=32000, bias=False)
)
Loading tokenizer for meta-llama/Llama-2-7b-hf
Starting...
Ready.
0 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 14.408017873764038 s
stopped after 9 iterations
16.919 s H_error tensor(11.5031, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.9262, device='cuda:7', grad_fn=<DivBackward0>)
43349 MiB free out of 48676 MiB total
0 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.059651851654053 s
stopped after 9 iterations
15.962 s H_error tensor(8.4666, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.8537, device='cuda:7', grad_fn=<DivBackward0>)
43349 MiB free out of 48676 MiB total
0 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.024038791656494 s
stopped after 9 iterations
15.122 s H_error tensor(0.3027, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.8033, device='cuda:7', grad_fn=<DivBackward0>)
43413 MiB free out of 48676 MiB total
0 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.947808027267456 s
stopped after 9 iterations
14.781 s H_error tensor(0.0351, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.7392, device='cuda:7', grad_fn=<DivBackward0>)
43445 MiB free out of 48676 MiB total
0 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.191498041152954 s
stopped after 9 iterations
38.727 s H_error tensor(10.7036, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6143, device='cuda:7', grad_fn=<DivBackward0>)
43477 MiB free out of 48676 MiB total
0 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.97370433807373 s
stopped after 9 iterations
38.907 s H_error tensor(8.1850, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6012, device='cuda:7', grad_fn=<DivBackward0>)
43509 MiB free out of 48676 MiB total
0 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.89263653755188 s
stopped after 9 iterations
38.849 s H_error tensor(0.0386, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6511, device='cuda:7', grad_fn=<DivBackward0>)
43655 MiB free out of 48676 MiB total
1 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.642089128494263 s
stopped after 9 iterations
16.563 s H_error tensor(178.8454, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.8395, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
1 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.979830741882324 s
stopped after 9 iterations
16.057 s H_error tensor(186.1064, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.8124, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
1 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.94314169883728 s
stopped after 9 iterations
14.698 s H_error tensor(2.5928, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.7448, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
1 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.113439321517944 s
stopped after 9 iterations
14.486 s H_error tensor(0.1181, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6566, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
1 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.27585244178772 s
stopped after 9 iterations
38.87 s H_error tensor(45.7234, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5930, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
1 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.894317626953125 s
stopped after 9 iterations
38.515 s H_error tensor(29.1250, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5927, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
1 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 32.327669620513916 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
37.785 s H_error tensor(-0.6274, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.7069, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
2 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.608227968215942 s
stopped after 9 iterations
15.777 s H_error tensor(235.3234, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.7235, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
2 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.957112312316895 s
stopped after 9 iterations
16.423 s H_error tensor(385.8059, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.8230, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
2 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.957677125930786 s
stopped after 9 iterations
14.413 s H_error tensor(27.3775, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6381, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
2 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.11819314956665 s
stopped after 9 iterations
14.393 s H_error tensor(1.0281, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6235, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
2 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.85485768318176 s
stopped after 9 iterations
38.5 s H_error tensor(67.4709, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5974, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
2 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.641239404678345 s
stopped after 9 iterations
38.291 s H_error tensor(52.0440, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5964, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
2 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.986504793167114 s
stopped after 9 iterations
39.068 s H_error tensor(0.3121, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6195, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
3 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.69660210609436 s
stopped after 9 iterations
15.934 s H_error tensor(602.6429, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.7094, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
3 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.12600302696228 s
stopped after 9 iterations
15.445 s H_error tensor(622.3376, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.7438, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
3 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.039518117904663 s
stopped after 9 iterations
14.328 s H_error tensor(63.5450, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6306, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
3 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.025612115859985 s
stopped after 9 iterations
14.353 s H_error tensor(1.2988, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6079, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
3 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.8085150718689 s
stopped after 9 iterations
37.595 s H_error tensor(102.6497, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6029, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
3 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.84714365005493 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
37.677 s H_error tensor(83.0765, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6000, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
3 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.98663568496704 s
stopped after 9 iterations
38.742 s H_error tensor(0.3509, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6274, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
4 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.62561559677124 s
stopped after 9 iterations
15.599 s H_error tensor(527.8063, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6917, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
4 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.917180061340332 s
stopped after 9 iterations
14.825 s H_error tensor(533.8099, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.7026, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
4 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.16905665397644 s
stopped after 9 iterations
14.547 s H_error tensor(65.8463, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6251, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
4 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.951951026916504 s
stopped after 9 iterations
14.245 s H_error tensor(5.6902, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6188, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
4 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.06087803840637 s
stopped after 9 iterations
38.639 s H_error tensor(164.7103, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6093, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
4 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.834983825683594 s
stopped after 9 iterations
38.478 s H_error tensor(117.6356, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6076, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
4 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.35164403915405 s
stopped after 9 iterations
39.325 s H_error tensor(1.1634, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6541, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
5 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.786856889724731 s
stopped after 9 iterations
15.058 s H_error tensor(546.8501, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6444, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
5 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.010373830795288 s
stopped after 9 iterations
14.356 s H_error tensor(703.4148, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6411, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
5 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.038644790649414 s
stopped after 9 iterations
14.343 s H_error tensor(72.7613, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6169, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
5 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.05177116394043 s
stopped after 9 iterations
14.108 s H_error tensor(18.0240, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6183, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
5 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.670273542404175 s
stopped after 9 iterations
38.267 s H_error tensor(206.2026, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6137, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
5 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.76302766799927 s
stopped after 9 iterations
38.377 s H_error tensor(142.6582, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6135, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
5 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.64362406730652 s
stopped after 9 iterations
38.266 s H_error tensor(1.6840, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6525, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
6 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.767215490341187 s
stopped after 9 iterations
14.854 s H_error tensor(729.5014, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6306, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
6 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.021562099456787 s
stopped after 9 iterations
14.388 s H_error tensor(702.9423, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6300, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
6 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.046963453292847 s
stopped after 9 iterations
14.107 s H_error tensor(98.0742, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6211, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
6 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.916907548904419 s
stopped after 9 iterations
14.251 s H_error tensor(32.7501, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6086, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
6 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.849326372146606 s
stopped after 9 iterations
38.452 s H_error tensor(287.5352, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6129, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
6 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.88149333000183 s
stopped after 9 iterations
38.456 s H_error tensor(188.0636, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6131, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
6 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.8501501083374 s
stopped after 9 iterations
38.625 s H_error tensor(2.8452, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6530, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
7 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 14.003675937652588 s
stopped after 9 iterations
15.357 s H_error tensor(660.6571, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6224, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
7 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.9301917552948 s
stopped after 9 iterations
14.13 s H_error tensor(654.3108, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6244, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
7 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.060777187347412 s
stopped after 9 iterations
14.154 s H_error tensor(112.2553, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6181, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
7 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.960811614990234 s
stopped after 9 iterations
14.261 s H_error tensor(53.4691, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6026, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
7 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.68790888786316 s
stopped after 9 iterations
37.628 s H_error tensor(315.2610, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6161, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
7 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.98850464820862 s
stopped after 9 iterations
38.597 s H_error tensor(213.0778, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6132, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
7 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.23534393310547 s
stopped after 9 iterations
39.433 s H_error tensor(3.3059, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6485, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
8 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.623769998550415 s
stopped after 9 iterations
14.659 s H_error tensor(649.5559, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6203, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
8 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.875420093536377 s
stopped after 9 iterations
14.214 s H_error tensor(665.6499, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6184, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
8 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.019961833953857 s
stopped after 9 iterations
14.347 s H_error tensor(114.5064, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6084, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
8 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.964161157608032 s
stopped after 9 iterations
14.313 s H_error tensor(58.7757, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5993, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
8 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.89878964424133 s
stopped after 9 iterations
38.443 s H_error tensor(322.7015, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6122, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
8 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.676311016082764 s
stopped after 9 iterations
38.442 s H_error tensor(237.0809, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6103, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
8 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.59127449989319 s
stopped after 9 iterations
38.39 s H_error tensor(4.0508, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6504, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
9 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.688407182693481 s
stopped after 9 iterations
15.007 s H_error tensor(683.1111, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6166, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
9 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.04866623878479 s
stopped after 9 iterations
14.395 s H_error tensor(754.7891, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6147, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
9 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.037482976913452 s
stopped after 9 iterations
14.056 s H_error tensor(123.0536, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6094, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
9 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.00477910041809 s
stopped after 9 iterations
14.333 s H_error tensor(61.9435, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5981, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
9 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.25348687171936 s
stopped after 9 iterations
38.07 s H_error tensor(335.0794, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6124, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
9 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.9014630317688 s
stopped after 9 iterations
38.544 s H_error tensor(252.6600, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6103, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
9 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.01274919509888 s
stopped after 9 iterations
39.135 s H_error tensor(4.5166, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6507, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
10 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.805880546569824 s
stopped after 9 iterations
14.884 s H_error tensor(706.3190, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6176, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
10 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.975409746170044 s
stopped after 9 iterations
14.297 s H_error tensor(729.5958, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6143, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
10 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.949196577072144 s
stopped after 9 iterations
13.964 s H_error tensor(126.5898, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6116, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
10 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.947691917419434 s
stopped after 9 iterations
14.285 s H_error tensor(62.8340, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5961, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
10 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.813056230545044 s
stopped after 9 iterations
38.419 s H_error tensor(357.0645, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6088, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
10 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.75837588310242 s
stopped after 9 iterations
39.374 s H_error tensor(276.1940, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6081, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
10 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.6990270614624 s
stopped after 9 iterations
39.484 s H_error tensor(4.9426, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6494, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
11 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 14.03159499168396 s
stopped after 9 iterations
15.35 s H_error tensor(720.5916, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6122, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
11 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.237157344818115 s
stopped after 9 iterations
14.313 s H_error tensor(742.7693, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6165, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
11 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.007313966751099 s
stopped after 9 iterations
14.332 s H_error tensor(167.0444, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6038, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
11 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.002724409103394 s
stopped after 9 iterations
14.316 s H_error tensor(84.6581, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5954, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
11 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.30586004257202 s
stopped after 9 iterations
38.952 s H_error tensor(373.9186, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6071, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
11 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.92353415489197 s
stopped after 9 iterations
37.845 s H_error tensor(296.0723, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6100, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
11 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.85952186584473 s
stopped after 9 iterations
38.405 s H_error tensor(5.4567, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6436, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
12 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.667192935943604 s
stopped after 9 iterations
14.727 s H_error tensor(760.5219, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6141, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
12 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.896904468536377 s
stopped after 9 iterations
14.22 s H_error tensor(824.7252, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6107, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
12 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.087050437927246 s
stopped after 9 iterations
14.392 s H_error tensor(165.5310, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6031, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
12 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.05237340927124 s
stopped after 9 iterations
14.415 s H_error tensor(92.6505, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5947, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
12 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.95850110054016 s
stopped after 9 iterations
38.598 s H_error tensor(378.4443, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6060, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
12 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.765604972839355 s
stopped after 9 iterations
38.406 s H_error tensor(311.3555, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6045, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
12 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.04442262649536 s
stopped after 9 iterations
39.199 s H_error tensor(5.3390, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6364, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
13 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.64474081993103 s
stopped after 9 iterations
14.654 s H_error tensor(787.9465, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6113, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
13 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.915148973464966 s
stopped after 9 iterations
14.185 s H_error tensor(832.1263, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6114, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
13 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.101667404174805 s
stopped after 9 iterations
14.095 s H_error tensor(186.4642, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6036, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
13 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.979849100112915 s
stopped after 9 iterations
13.978 s H_error tensor(83.7583, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5961, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
13 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.75797462463379 s
stopped after 9 iterations
38.361 s H_error tensor(389.8685, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6030, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
13 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.14152669906616 s
stopped after 9 iterations
38.817 s H_error tensor(341.0021, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6030, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
13 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.00800824165344 s
stopped after 9 iterations
39.176 s H_error tensor(5.7376, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6337, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
14 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.739396095275879 s
stopped after 9 iterations
15.064 s H_error tensor(791.1528, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6076, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
14 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.094732761383057 s
stopped after 9 iterations
14.175 s H_error tensor(834.2688, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6123, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
14 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.048580408096313 s
stopped after 9 iterations
14.333 s H_error tensor(183.8141, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5994, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
14 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.912148237228394 s
stopped after 9 iterations
14.221 s H_error tensor(98.2605, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5938, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
14 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.85447549819946 s
stopped after 9 iterations
38.484 s H_error tensor(432.9359, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6026, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
14 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.933595418930054 s
stopped after 9 iterations
37.813 s H_error tensor(373.4513, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6053, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
14 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.925758361816406 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
38.272 s H_error tensor(6.1521, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6342, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
15 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.73877477645874 s
stopped after 9 iterations
14.815 s H_error tensor(737.1368, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6125, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
15 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.991192102432251 s
stopped after 9 iterations
14.078 s H_error tensor(782.6498, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6120, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
15 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.951700925827026 s
stopped after 9 iterations
13.988 s H_error tensor(194.1863, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6018, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
15 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.949634790420532 s
stopped after 9 iterations
14.275 s H_error tensor(98.4518, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5924, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
15 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.76080656051636 s
stopped after 9 iterations
38.401 s H_error tensor(465.6799, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6027, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
15 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.59977149963379 s
stopped after 9 iterations
38.223 s H_error tensor(406.2923, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6019, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
15 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.83289861679077 s
stopped after 9 iterations
38.516 s H_error tensor(7.1694, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6356, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
16 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.571226596832275 s
stopped after 9 iterations
14.912 s H_error tensor(759.0089, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6070, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
16 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.915714025497437 s
stopped after 9 iterations
14.243 s H_error tensor(796.8878, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6054, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
16 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.861442804336548 s
stopped after 9 iterations
14.168 s H_error tensor(219.2237, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5964, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
16 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.829623699188232 s
stopped after 9 iterations
14.13 s H_error tensor(106.5956, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5910, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
16 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.6165132522583 s
stopped after 9 iterations
38.254 s H_error tensor(529.3757, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5995, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
16 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.55761218070984 s
stopped after 9 iterations
38.178 s H_error tensor(456.3967, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5992, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
16 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.53616261482239 s
stopped after 9 iterations
38.006 s H_error tensor(8.3387, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6282, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
17 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.749638795852661 s
stopped after 9 iterations
15.072 s H_error tensor(782.1143, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6047, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
17 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.998744010925293 s
stopped after 9 iterations
14.3 s H_error tensor(808.5372, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6049, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
17 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.978581190109253 s
stopped after 9 iterations
14.293 s H_error tensor(234.2107, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5966, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
17 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.06244158744812 s
stopped after 9 iterations
14.353 s H_error tensor(115.3937, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5920, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
17 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.61846303939819 s
stopped after 9 iterations
38.176 s H_error tensor(586.8663, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5995, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
17 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.36369466781616 s
stopped after 9 iterations
37.987 s H_error tensor(501.7432, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5982, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
17 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.862287282943726 s
stopped after 9 iterations
39.025 s H_error tensor(9.0053, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6210, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
18 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.5859215259552 s
stopped after 9 iterations
14.917 s H_error tensor(864.3996, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6039, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
18 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.82402753829956 s
stopped after 9 iterations
14.139 s H_error tensor(886.5043, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6039, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
18 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.814073085784912 s
stopped after 9 iterations
13.788 s H_error tensor(286.0166, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5982, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
18 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.782689571380615 s
stopped after 9 iterations
14.095 s H_error tensor(117.4345, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5901, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
18 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.695746421813965 s
stopped after 9 iterations
38.323 s H_error tensor(667.9293, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5984, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
18 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.67840814590454 s
stopped after 9 iterations
37.434 s H_error tensor(560.8398, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6018, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
18 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.83465790748596 s
stopped after 9 iterations
38.938 s H_error tensor(11.8366, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6245, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
19 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.654901504516602 s
stopped after 9 iterations
14.946 s H_error tensor(836.1735, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6064, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
19 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.824191093444824 s
stopped after 9 iterations
14.148 s H_error tensor(840.7586, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6044, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
19 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.800512552261353 s
stopped after 9 iterations
13.805 s H_error tensor(287.9876, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5973, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
19 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.849600791931152 s
stopped after 9 iterations
14.162 s H_error tensor(115.1367, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5914, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
19 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.502676248550415 s
stopped after 9 iterations
37.284 s H_error tensor(712.4282, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6021, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
19 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.515583992004395 s
stopped after 9 iterations
38.151 s H_error tensor(598.9666, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5959, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
19 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.87972021102905 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
39.038 s H_error tensor(11.8421, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6156, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
20 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.846733570098877 s
stopped after 9 iterations
15.189 s H_error tensor(873.2039, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6031, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
20 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.936682224273682 s
stopped after 9 iterations
13.982 s H_error tensor(860.4749, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6075, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
20 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.871290445327759 s
stopped after 9 iterations
13.87 s H_error tensor(302.4698, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5968, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
20 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 12.883121728897095 s
stopped after 9 iterations
13.9 s H_error tensor(107.1787, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5972, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
20 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 34.95530128479004 s
stopped after 9 iterations
37.712 s H_error tensor(762.8953, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5999, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
20 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.86561155319214 s
stopped after 9 iterations
39.474 s H_error tensor(634.1756, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5961, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
20 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.744967222213745 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
39.168 s H_error tensor(13.5718, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6165, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
21 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.989262342453003 s
stopped after 9 iterations
15.076 s H_error tensor(991.7961, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6068, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
21 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.289018630981445 s
stopped after 9 iterations
14.625 s H_error tensor(932.5825, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6025, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
21 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.240752458572388 s
stopped after 9 iterations
14.541 s H_error tensor(363.0499, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5931, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
21 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.260453462600708 s
stopped after 9 iterations
14.571 s H_error tensor(146.5517, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5910, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
21 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.49612474441528 s
stopped after 9 iterations
39.073 s H_error tensor(823.8051, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5969, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
21 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.738861083984375 s
stopped after 9 iterations
39.454 s H_error tensor(675.5654, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5956, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
21 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.49670076370239 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
39.086 s H_error tensor(15.3291, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6140, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
22 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 14.053686141967773 s
stopped after 9 iterations
15.376 s H_error tensor(1056.5782, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6028, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
22 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.42650032043457 s
stopped after 9 iterations
14.749 s H_error tensor(987.2208, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6028, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
22 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.354952573776245 s
stopped after 9 iterations
14.666 s H_error tensor(369.3836, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5925, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
22 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.30488920211792 s
stopped after 9 iterations
14.321 s H_error tensor(188.6170, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5964, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
22 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.668681383132935 s
stopped after 9 iterations
38.396 s H_error tensor(853.3253, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5986, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
22 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.45651626586914 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
39.094 s H_error tensor(702.5567, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5935, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
22 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.69852066040039 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
39.784 s H_error tensor(16.7641, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6103, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
23 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 14.078237533569336 s
stopped after 9 iterations
15.306 s H_error tensor(1172.5298, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6050, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
23 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.326707363128662 s
stopped after 9 iterations
14.641 s H_error tensor(1075.1514, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6013, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
23 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.301172971725464 s
stopped after 9 iterations
14.316 s H_error tensor(468.5199, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5949, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
23 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.250842571258545 s
stopped after 9 iterations
14.541 s H_error tensor(244.8098, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5904, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
23 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.70010757446289 s
stopped after 9 iterations
39.317 s H_error tensor(899.2888, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5949, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
23 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.55243921279907 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
39.143 s H_error tensor(758.4653, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5922, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
23 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.68763089179993 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
39.835 s H_error tensor(18.7454, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6090, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
24 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.988545656204224 s
stopped after 9 iterations
15.287 s H_error tensor(1059.8774, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6013, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
24 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.273216724395752 s
stopped after 9 iterations
14.624 s H_error tensor(968.1931, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6012, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
24 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.325717687606812 s
stopped after 9 iterations
14.633 s H_error tensor(448.4532, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5917, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
24 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.367245435714722 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
14.349 s H_error tensor(255.5384, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5938, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
24 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.60226821899414 s
stopped after 9 iterations
39.312 s H_error tensor(961.6129, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5931, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
24 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.61670207977295 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
39.224 s H_error tensor(821.6872, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5915, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
24 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.5057647228241 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
39.612 s H_error tensor(21.7983, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6089, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
25 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 14.1881685256958 s
stopped after 9 iterations
15.489 s H_error tensor(1206.5861, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5994, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
25 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.57552456855774 s
stopped after 9 iterations
14.885 s H_error tensor(1132.8381, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6000, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
25 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.506230592727661 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
14.805 s H_error tensor(574.4167, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5909, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
25 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.454076051712036 s
stopped after 9 iterations
14.729 s H_error tensor(375.2902, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5887, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
25 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 36.34956455230713 s
stopped after 9 iterations
39.234 s H_error tensor(1056.0049, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5968, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
25 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 36.00127100944519 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
38.737 s H_error tensor(889.5135, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5942, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
25 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.525885581970215 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
38.907 s H_error tensor(26.4635, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6117, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
26 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.921681642532349 s
stopped after 9 iterations
14.964 s H_error tensor(1062.2360, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6037, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
26 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.312423944473267 s
stopped after 9 iterations
14.63 s H_error tensor(1001.5120, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5998, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
26 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.247791528701782 s
stopped after 9 iterations
14.242 s H_error tensor(560.9892, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5930, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
26 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.208214521408081 s
stopped after 9 iterations
14.524 s H_error tensor(440.3141, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5892, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
26 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.679444551467896 s
stopped after 9 iterations
39.323 s H_error tensor(1151.1063, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5932, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
26 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 36.17662239074707 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
39.767 s H_error tensor(970.4449, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5909, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
26 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 36.420501947402954 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
39.952 s H_error tensor(32.8101, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6161, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
27 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 14.197000980377197 s
stopped after 9 iterations
15.516 s H_error tensor(1108.2771, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5984, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
27 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.552673816680908 s
stopped after 9 iterations
14.541 s H_error tensor(1099.8638, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6021, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
27 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.26621127128601 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
14.574 s H_error tensor(612.1823, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5905, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
27 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.346888780593872 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
14.634 s H_error tensor(608.7962, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5891, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
27 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.5132532119751 s
stopped after 9 iterations
39.171 s H_error tensor(1259.3069, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5944, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
27 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.58041501045227 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
38.314 s H_error tensor(1073.3059, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5957, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
27 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.56391143798828 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
39.819 s H_error tensor(38.1449, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6150, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
28 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 14.167342901229858 s
stopped after 9 iterations
15.479 s H_error tensor(1042.4077, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5976, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
28 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.33338189125061 s
stopped after 9 iterations
14.635 s H_error tensor(1040.2223, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5978, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
28 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.344335556030273 s
stopped after 9 iterations
14.688 s H_error tensor(668.6283, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5903, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
28 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.572981595993042 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
14.868 s H_error tensor(742.0319, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5896, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
28 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.67920231819153 s
stopped after 9 iterations
39.312 s H_error tensor(1325.0292, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5945, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
28 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.56736731529236 s
stopped after 9 iterations
39.178 s H_error tensor(1172.4675, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5947, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
28 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.54766488075256 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
39.224 s H_error tensor(50.8251, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6250, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
29 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.976183891296387 s
stopped after 9 iterations
15.288 s H_error tensor(982.7379, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5981, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
29 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.340770721435547 s
stopped after 9 iterations
14.403 s H_error tensor(1012.9138, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6028, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
29 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.358891725540161 s
stopped after 9 iterations
14.705 s H_error tensor(640.1404, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5897, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
29 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.314661026000977 s
stopped after 9 iterations
14.616 s H_error tensor(684.5775, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5890, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
29 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.77169227600098 s
stopped after 9 iterations
39.374 s H_error tensor(1441.9113, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5954, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
29 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.52220344543457 s
stopped after 9 iterations
39.183 s H_error tensor(1330.4387, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5958, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
29 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.57818031311035 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
39.63 s H_error tensor(75.7129, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6454, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
30 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.964925765991211 s
stopped after 9 iterations
15.275 s H_error tensor(1043.3276, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5975, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
30 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.303025484085083 s
stopped after 9 iterations
14.625 s H_error tensor(1085.0675, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5975, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
30 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.311450719833374 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
14.292 s H_error tensor(744.3776, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5937, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
30 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.321675300598145 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
14.616 s H_error tensor(887.3142, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5903, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
30 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.69800901412964 s
stopped after 9 iterations
39.34 s H_error tensor(1703.9187, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5961, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
30 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.67449331283569 s
stopped after 9 iterations
39.287 s H_error tensor(1609.2816, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5967, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
30 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.74089741706848 s
stopped after 9 iterations
40.445 s H_error tensor(-0.7688, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6906, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
31 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.927804708480835 s
stopped after 9 iterations
14.926 s H_error tensor(742.4594, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6033, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
31 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.337051630020142 s
stopped after 9 iterations
14.657 s H_error tensor(762.9703, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5988, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
31 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.299959659576416 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
14.601 s H_error tensor(430.7515, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.5929, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
31 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 13.30787444114685 s
stopped after 9 iterations
14.71 s H_error tensor(4199.5708, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6017, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
31 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.66751217842102 s
stopped after 9 iterations
39.224 s H_error tensor(1392.5349, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6101, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
31 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.78261852264404 s
stopped after 9 iterations
39.08 s H_error tensor(1345.3699, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.6219, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
31 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 35.63186073303223 s
stopped after 9 iterations
41.172 s H_error tensor(351.5828, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.7799, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
Total bits: 6516211712.0 Total params: 6476005376
average bits per value: 1.0062085087435233
5894.157421350479
Loading tokenizer for meta-llama/Llama-2-7b-hf
/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Dataset: wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
Perplexity: 28818.644531
