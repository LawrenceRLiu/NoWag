/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.13s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.38it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.27it/s]
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. If you see this, DO NOT PANIC! This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=True`. This should only be set if you understand what it means, and thouroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Token indices sequence length is longer than the specified maximum sequence length for this model (2824491 > 2048). Running this sequence through the model will result in indexing errors
Starting...
Ready.
0 self_attn.q_proj
Pruning ...
0.01
torch.Size([4151338])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.92it/s] 20%|██        | 200/1000 [00:01<00:07, 107.09it/s] 30%|███       | 300/1000 [00:02<00:06, 107.22it/s] 40%|████      | 400/1000 [00:03<00:05, 107.23it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.22it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.24it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.23it/s] 73%|███████▎  | 734/1000 [00:06<00:02, 107.06it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.52it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.79it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.19it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.01it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.82it/s] 50%|█████     | 8/16 [00:00<00:00,  9.55it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.82it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.70it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.48it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.41it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.98it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.14it/s] 20%|██        | 20/100 [00:02<00:08,  9.30it/s] 30%|███       | 30/100 [00:03<00:07,  9.37it/s] 40%|████      | 40/100 [00:04<00:06,  9.42it/s] 50%|█████     | 50/100 [00:05<00:05,  9.44it/s] 60%|██████    | 60/100 [00:06<00:04,  9.43it/s] 70%|███████   | 70/100 [00:07<00:03,  9.44it/s] 80%|████████  | 80/100 [00:08<00:02,  9.45it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.44it/s]100%|██████████| 100/100 [00:10<00:00,  9.44it/s]100%|██████████| 100/100 [00:10<00:00,  9.42it/s]
H_error tensor(5.6986, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5507, device='cuda:6', grad_fn=<DivBackward0>)
6356 MiB free out of 48676 MiB total
0 self_attn.k_proj
Pruning ...
0.01
torch.Size([4151344])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 107.26it/s] 20%|██        | 200/1000 [00:01<00:07, 107.45it/s] 30%|███       | 300/1000 [00:02<00:06, 107.49it/s] 40%|████      | 400/1000 [00:03<00:05, 107.49it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.52it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.58it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.58it/s] 80%|████████  | 800/1000 [00:07<00:01, 107.59it/s] 90%|█████████ | 900/1000 [00:08<00:00, 107.58it/s]100%|██████████| 1000/1000 [00:09<00:00, 107.29it/s]100%|██████████| 1000/1000 [00:09<00:00, 107.45it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.89it/s] 25%|██▌       | 4/16 [00:00<00:01, 11.28it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.27it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.99it/s] 50%|█████     | 8/16 [00:00<00:00,  9.63it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.59it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.40it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.53it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.79it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.46it/s]100%|██████████| 16/16 [00:01<00:00,  9.57it/s]100%|██████████| 16/16 [00:01<00:00,  9.79it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.63it/s] 20%|██        | 20/100 [00:02<00:08,  9.59it/s] 30%|███       | 30/100 [00:03<00:07,  9.59it/s] 40%|████      | 40/100 [00:04<00:06,  9.57it/s] 50%|█████     | 50/100 [00:05<00:05,  9.57it/s] 60%|██████    | 60/100 [00:06<00:04,  9.57it/s] 70%|███████   | 70/100 [00:07<00:03,  9.58it/s] 80%|████████  | 80/100 [00:08<00:02,  9.59it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.57it/s]100%|██████████| 100/100 [00:10<00:00,  9.60it/s]100%|██████████| 100/100 [00:10<00:00,  9.59it/s]
H_error tensor(5.4976, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5527, device='cuda:6', grad_fn=<DivBackward0>)
6388 MiB free out of 48676 MiB total
0 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148797])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.84it/s] 20%|██        | 200/1000 [00:01<00:07, 107.17it/s] 30%|███       | 300/1000 [00:02<00:06, 107.33it/s] 40%|████      | 400/1000 [00:03<00:05, 107.38it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.34it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.25it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.26it/s] 80%|████████  | 800/1000 [00:07<00:01, 107.28it/s] 90%|█████████ | 900/1000 [00:08<00:00, 107.27it/s] 90%|█████████ | 902/1000 [00:08<00:00, 107.15it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.12it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.84it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.46it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.33it/s] 50%|█████     | 8/16 [00:00<00:00, 10.62it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.22it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.26it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.12it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.08it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.77it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.53it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.63it/s] 20%|██        | 20/100 [00:02<00:08,  9.60it/s] 30%|███       | 30/100 [00:03<00:07,  9.59it/s] 40%|████      | 40/100 [00:04<00:06,  9.58it/s] 50%|█████     | 50/100 [00:05<00:05,  9.58it/s] 60%|██████    | 60/100 [00:06<00:04,  9.58it/s] 70%|███████   | 70/100 [00:07<00:03,  9.58it/s] 80%|████████  | 80/100 [00:08<00:02,  9.57it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.57it/s]100%|██████████| 100/100 [00:10<00:00,  9.57it/s]100%|██████████| 100/100 [00:10<00:00,  9.58it/s]
H_error tensor(0.6100, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5291, device='cuda:6', grad_fn=<DivBackward0>)
6420 MiB free out of 48676 MiB total
0 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148892])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 107.23it/s] 20%|██        | 200/1000 [00:01<00:07, 107.40it/s] 30%|███       | 300/1000 [00:02<00:06, 107.37it/s] 40%|████      | 400/1000 [00:03<00:05, 107.39it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.28it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.29it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.29it/s] 73%|███████▎  | 730/1000 [00:06<00:02, 107.16it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.04it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.00it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.02it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.50it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.45it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.53it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.57it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.88it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.33it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.80it/s]100%|██████████| 16/16 [00:01<00:00, 10.43it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.53it/s] 20%|██        | 20/100 [00:02<00:08,  9.49it/s] 30%|███       | 30/100 [00:03<00:07,  9.48it/s] 40%|████      | 40/100 [00:04<00:06,  9.47it/s] 50%|█████     | 50/100 [00:05<00:05,  9.47it/s] 60%|██████    | 60/100 [00:06<00:04,  9.47it/s] 70%|███████   | 70/100 [00:07<00:03,  9.46it/s] 80%|████████  | 80/100 [00:08<00:02,  9.46it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.46it/s]100%|██████████| 100/100 [00:10<00:00,  9.47it/s]100%|██████████| 100/100 [00:10<00:00,  9.47it/s]
H_error tensor(0.0466, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5264, device='cuda:6', grad_fn=<DivBackward0>)
6484 MiB free out of 48676 MiB total
0 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150319])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 44.39it/s] 20%|██        | 200/1000 [00:04<00:18, 44.39it/s] 30%|███       | 300/1000 [00:06<00:15, 44.39it/s] 40%|████      | 400/1000 [00:09<00:13, 44.39it/s] 50%|█████     | 500/1000 [00:11<00:11, 44.40it/s] 60%|██████    | 600/1000 [00:13<00:09, 44.40it/s] 70%|███████   | 700/1000 [00:15<00:06, 44.40it/s] 80%|████████  | 800/1000 [00:18<00:04, 44.39it/s] 88%|████████▊ | 881/1000 [00:19<00:02, 44.35it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.34it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.28it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.65it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.50it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.93it/s] 50%|█████     | 8/16 [00:01<00:01,  6.91it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.65it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.89it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.38it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.65it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.03it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.08it/s]100%|██████████| 16/16 [00:02<00:00,  6.38it/s]100%|██████████| 16/16 [00:02<00:00,  6.92it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.19it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.19it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(7.2345, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5095, device='cuda:6', grad_fn=<DivBackward0>)
6514 MiB free out of 48676 MiB total
0 mlp.up_proj
Pruning ...
0.01
torch.Size([11150109])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 44.34it/s] 20%|██        | 200/1000 [00:04<00:18, 44.35it/s] 30%|███       | 300/1000 [00:06<00:15, 44.36it/s] 40%|████      | 400/1000 [00:09<00:13, 44.37it/s] 50%|█████     | 500/1000 [00:11<00:11, 44.35it/s] 60%|██████    | 600/1000 [00:13<00:09, 44.33it/s] 70%|███████   | 700/1000 [00:15<00:06, 44.32it/s] 80%|████████  | 800/1000 [00:18<00:04, 44.32it/s] 90%|█████████ | 900/1000 [00:20<00:02, 44.31it/s] 96%|█████████▌| 956/1000 [00:21<00:00, 44.28it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.45it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.84it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.62it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.81it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.55it/s] 50%|█████     | 8/16 [00:01<00:01,  6.81it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.53it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.34it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.72it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.33it/s] 88%|████████▊ | 14/16 [00:02<00:00,  5.97it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.62it/s]100%|██████████| 16/16 [00:02<00:00,  6.61it/s]100%|██████████| 16/16 [00:02<00:00,  6.90it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.17it/s] 20%|██        | 20/100 [00:06<00:25,  3.17it/s] 30%|███       | 30/100 [00:09<00:22,  3.17it/s] 40%|████      | 40/100 [00:12<00:18,  3.17it/s] 50%|█████     | 50/100 [00:15<00:15,  3.17it/s] 60%|██████    | 60/100 [00:18<00:12,  3.17it/s] 70%|███████   | 70/100 [00:22<00:09,  3.17it/s] 80%|████████  | 80/100 [00:25<00:06,  3.17it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]
H_error tensor(6.7568, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5136, device='cuda:6', grad_fn=<DivBackward0>)
6546 MiB free out of 48676 MiB total
0 mlp.down_proj
Pruning ...
0.01
torch.Size([11158770])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 44.12it/s] 20%|██        | 200/1000 [00:04<00:18, 44.07it/s] 30%|███       | 300/1000 [00:06<00:15, 44.05it/s] 40%|████      | 400/1000 [00:09<00:13, 44.00it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.99it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.99it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.99it/s] 72%|███████▏  | 716/1000 [00:16<00:06, 43.95it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.41it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.23it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.34it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.03it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.53it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.35it/s] 50%|█████     | 8/16 [00:01<00:01,  6.57it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.22it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.55it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.04it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.31it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.61it/s]100%|██████████| 16/16 [00:02<00:00,  6.41it/s]100%|██████████| 16/16 [00:02<00:00,  6.89it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.72it/s] 20%|██        | 20/100 [00:07<00:29,  2.73it/s] 30%|███       | 30/100 [00:11<00:25,  2.73it/s] 40%|████      | 40/100 [00:14<00:21,  2.73it/s] 50%|█████     | 50/100 [00:18<00:18,  2.73it/s] 60%|██████    | 60/100 [00:21<00:14,  2.73it/s] 70%|███████   | 70/100 [00:25<00:10,  2.73it/s] 80%|████████  | 80/100 [00:29<00:07,  2.73it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(0.0692, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5197, device='cuda:6', grad_fn=<DivBackward0>)
6400 MiB free out of 48676 MiB total
1 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149142])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.81it/s] 20%|██        | 200/1000 [00:01<00:07, 106.96it/s] 30%|███       | 300/1000 [00:02<00:06, 107.06it/s] 40%|████      | 400/1000 [00:03<00:05, 107.07it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.07it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.06it/s] 62%|██████▏   | 622/1000 [00:05<00:03, 106.86it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.11it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.30it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.52it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.31it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.20it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.62it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.45it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.35it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.05it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.86it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.63it/s]100%|██████████| 16/16 [00:01<00:00,  9.67it/s]100%|██████████| 16/16 [00:01<00:00,  9.90it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.74it/s] 30%|███       | 30/100 [00:03<00:07,  9.74it/s] 40%|████      | 40/100 [00:04<00:06,  9.75it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(26.4501, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5437, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
1 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149351])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 107.02it/s] 20%|██        | 200/1000 [00:01<00:07, 107.08it/s] 30%|███       | 300/1000 [00:02<00:06, 107.11it/s] 40%|████      | 400/1000 [00:03<00:05, 107.12it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.09it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.10it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.10it/s] 80%|████████  | 800/1000 [00:07<00:01, 107.11it/s] 90%|█████████ | 900/1000 [00:08<00:00, 107.09it/s]100%|██████████| 1000/1000 [00:09<00:00, 107.12it/s]100%|██████████| 1000/1000 [00:09<00:00, 107.10it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 12.43it/s] 25%|██▌       | 4/16 [00:00<00:01, 11.25it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.51it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.02it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.83it/s] 50%|█████     | 8/16 [00:00<00:00,  9.65it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.72it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.69it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.54it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.33it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.95it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.96it/s]100%|██████████| 16/16 [00:01<00:00,  9.68it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.76it/s] 30%|███       | 30/100 [00:03<00:07,  9.74it/s] 40%|████      | 40/100 [00:04<00:06,  9.74it/s] 50%|█████     | 50/100 [00:05<00:05,  9.74it/s] 60%|██████    | 60/100 [00:06<00:04,  9.73it/s] 70%|███████   | 70/100 [00:07<00:03,  9.74it/s] 80%|████████  | 80/100 [00:08<00:02,  9.75it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]
H_error tensor(27.6640, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5425, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
1 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148854])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.98it/s] 20%|██        | 200/1000 [00:01<00:07, 107.02it/s] 30%|███       | 300/1000 [00:02<00:06, 107.00it/s] 40%|████      | 400/1000 [00:03<00:05, 106.97it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.96it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.97it/s] 61%|██████    | 612/1000 [00:05<00:03, 106.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.34it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.01it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.78it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.53it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.30it/s] 50%|█████     | 8/16 [00:00<00:00,  9.76it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.73it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.82it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.11it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.75it/s]100%|██████████| 16/16 [00:01<00:00, 10.41it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(2.5886, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5250, device='cuda:6', grad_fn=<DivBackward0>)
43275 MiB free out of 48676 MiB total
1 self_attn.o_proj
Pruning ...
0.01
torch.Size([4149013])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.92it/s] 20%|██        | 200/1000 [00:01<00:07, 106.96it/s] 30%|███       | 300/1000 [00:02<00:06, 106.96it/s] 40%|████      | 400/1000 [00:03<00:05, 107.00it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.02it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.06it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.01it/s] 77%|███████▋  | 766/1000 [00:07<00:02, 106.87it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.13it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.20it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.02it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.77it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.70it/s] 50%|█████     | 8/16 [00:00<00:00, 10.48it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.07it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.99it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.97it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.38it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.03it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.01it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.62it/s] 20%|██        | 20/100 [00:02<00:08,  9.57it/s] 30%|███       | 30/100 [00:03<00:07,  9.55it/s] 40%|████      | 40/100 [00:04<00:06,  9.55it/s] 50%|█████     | 50/100 [00:05<00:05,  9.54it/s] 60%|██████    | 60/100 [00:06<00:04,  9.55it/s] 70%|███████   | 70/100 [00:07<00:03,  9.55it/s] 80%|████████  | 80/100 [00:08<00:02,  9.55it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.55it/s]100%|██████████| 100/100 [00:10<00:00,  9.55it/s]100%|██████████| 100/100 [00:10<00:00,  9.55it/s]
H_error tensor(0.2401, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5123, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
1 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150380])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 44.13it/s] 20%|██        | 200/1000 [00:04<00:18, 44.13it/s] 30%|███       | 300/1000 [00:06<00:15, 44.12it/s] 40%|████      | 400/1000 [00:09<00:13, 44.13it/s] 50%|█████     | 500/1000 [00:11<00:11, 44.15it/s] 60%|██████    | 600/1000 [00:13<00:09, 44.16it/s] 70%|███████   | 700/1000 [00:15<00:06, 44.16it/s] 80%|████████  | 800/1000 [00:18<00:04, 44.13it/s] 90%|█████████ | 900/1000 [00:20<00:02, 44.11it/s]100%|██████████| 1000/1000 [00:22<00:00, 44.11it/s]100%|██████████| 1000/1000 [00:22<00:00, 44.13it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.36it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.25it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.31it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.96it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.00it/s] 50%|█████     | 8/16 [00:01<00:01,  7.12it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.58it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.69it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.65it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.15it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.09it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.61it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.13it/s]100%|██████████| 16/16 [00:02<00:00,  6.91it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.20it/s] 40%|████      | 40/100 [00:12<00:18,  3.20it/s] 50%|█████     | 50/100 [00:15<00:15,  3.21it/s] 60%|██████    | 60/100 [00:18<00:12,  3.21it/s] 70%|███████   | 70/100 [00:21<00:09,  3.21it/s] 80%|████████  | 80/100 [00:24<00:06,  3.21it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]
H_error tensor(28.0652, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5070, device='cuda:6', grad_fn=<DivBackward0>)
43175 MiB free out of 48676 MiB total
1 mlp.up_proj
Pruning ...
0.01
torch.Size([11150240])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 44.14it/s] 20%|██        | 200/1000 [00:04<00:18, 44.15it/s] 30%|███       | 300/1000 [00:06<00:15, 44.17it/s] 40%|████      | 400/1000 [00:09<00:13, 44.19it/s] 50%|█████     | 500/1000 [00:11<00:11, 44.20it/s] 60%|██████    | 600/1000 [00:13<00:09, 44.20it/s] 70%|███████   | 700/1000 [00:15<00:06, 44.18it/s] 80%|████████  | 800/1000 [00:18<00:04, 44.17it/s] 90%|█████████ | 900/1000 [00:20<00:02, 44.15it/s]100%|██████████| 1000/1000 [00:22<00:00, 44.13it/s]100%|██████████| 1000/1000 [00:22<00:00, 44.16it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.84it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.41it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.28it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.38it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.80it/s] 50%|█████     | 8/16 [00:01<00:01,  7.73it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.53it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.13it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.61it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.77it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.31it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.67it/s]100%|██████████| 16/16 [00:02<00:00,  7.33it/s]100%|██████████| 16/16 [00:02<00:00,  6.90it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:24,  3.20it/s] 30%|███       | 30/100 [00:09<00:21,  3.20it/s] 40%|████      | 40/100 [00:12<00:18,  3.20it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.20it/s] 70%|███████   | 70/100 [00:21<00:09,  3.20it/s] 80%|████████  | 80/100 [00:24<00:06,  3.21it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]
H_error tensor(24.3829, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4959, device='cuda:6', grad_fn=<DivBackward0>)
43161 MiB free out of 48676 MiB total
1 mlp.down_proj
Pruning ...
0.01
torch.Size([11158745])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.85it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.88it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.28it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.84it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.96it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.60it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.60it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.92it/s] 50%|█████     | 8/16 [00:01<00:01,  6.92it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.49it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.71it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.32it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.81it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.54it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.14it/s]100%|██████████| 16/16 [00:02<00:00,  7.07it/s]100%|██████████| 16/16 [00:02<00:00,  6.91it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.71it/s] 20%|██        | 20/100 [00:07<00:29,  2.71it/s] 30%|███       | 30/100 [00:11<00:25,  2.72it/s] 40%|████      | 40/100 [00:14<00:22,  2.72it/s] 50%|█████     | 50/100 [00:18<00:18,  2.72it/s] 60%|██████    | 60/100 [00:22<00:14,  2.71it/s] 70%|███████   | 70/100 [00:25<00:11,  2.71it/s] 80%|████████  | 80/100 [00:29<00:07,  2.71it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.71it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]
H_error tensor(0.2403, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5005, device='cuda:6', grad_fn=<DivBackward0>)
42797 MiB free out of 48676 MiB total
2 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149148])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.64it/s] 20%|██        | 200/1000 [00:01<00:07, 106.87it/s] 30%|███       | 300/1000 [00:02<00:06, 106.94it/s] 40%|████      | 400/1000 [00:03<00:05, 106.94it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.96it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.97it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.95it/s] 75%|███████▌  | 751/1000 [00:07<00:02, 106.78it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.33it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.15it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.11it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.74it/s] 50%|█████     | 8/16 [00:00<00:00,  9.98it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.75it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.70it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.86it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.65it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.47it/s]100%|██████████| 16/16 [00:01<00:00, 10.33it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.73it/s] 40%|████      | 40/100 [00:04<00:06,  9.73it/s] 50%|█████     | 50/100 [00:05<00:05,  9.72it/s] 60%|██████    | 60/100 [00:06<00:04,  9.73it/s] 70%|███████   | 70/100 [00:07<00:03,  9.72it/s] 80%|████████  | 80/100 [00:08<00:02,  9.73it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.73it/s]100%|██████████| 100/100 [00:10<00:00,  9.73it/s]
H_error tensor(57.0331, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5228, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
2 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149532])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.45it/s] 20%|██        | 200/1000 [00:01<00:07, 106.57it/s] 30%|███       | 300/1000 [00:02<00:06, 106.57it/s] 34%|███▍      | 338/1000 [00:03<00:06, 106.25it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.74it/s] 19%|█▉        | 3/16 [00:00<00:01, 11.52it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.69it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.55it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.24it/s] 50%|█████     | 8/16 [00:00<00:00,  9.85it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.64it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.12it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.84it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.56it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.67it/s]100%|██████████| 16/16 [00:01<00:00,  9.48it/s]100%|██████████| 16/16 [00:01<00:00,  9.90it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(60.5282, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5225, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
2 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148820])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.34it/s] 20%|██        | 200/1000 [00:01<00:07, 106.51it/s] 30%|███       | 300/1000 [00:02<00:06, 106.54it/s] 40%|████      | 400/1000 [00:03<00:05, 106.52it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.55it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.55it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.57it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.58it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.61it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.62it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.57it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.44it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.89it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.45it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.23it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.47it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.16it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.56it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.28it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.77it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.73it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.50it/s]100%|██████████| 16/16 [00:01<00:00,  9.92it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.68it/s] 20%|██        | 20/100 [00:02<00:08,  9.65it/s] 30%|███       | 30/100 [00:03<00:07,  9.64it/s] 40%|████      | 40/100 [00:04<00:06,  9.64it/s] 50%|█████     | 50/100 [00:05<00:05,  9.64it/s] 60%|██████    | 60/100 [00:06<00:04,  9.64it/s] 70%|███████   | 70/100 [00:07<00:03,  9.64it/s] 80%|████████  | 80/100 [00:08<00:02,  9.64it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.63it/s]100%|██████████| 100/100 [00:10<00:00,  9.64it/s]
H_error tensor(7.0389, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5003, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
2 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148895])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.24it/s] 20%|██        | 200/1000 [00:01<00:07, 106.39it/s] 30%|███       | 300/1000 [00:02<00:06, 106.46it/s] 40%|████      | 400/1000 [00:03<00:05, 106.51it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.58it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.59it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.62it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.62it/s] 89%|████████▉ | 892/1000 [00:08<00:01, 106.45it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.77it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.82it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.64it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.26it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.55it/s] 50%|█████     | 8/16 [00:00<00:00,  9.29it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.16it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.53it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.01it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.32it/s]100%|██████████| 16/16 [00:01<00:00,  9.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(0.6206, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4998, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
2 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150240])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.82it/s] 20%|██        | 200/1000 [00:04<00:18, 43.83it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.83it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.83it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.47it/s] 89%|████████▊ | 886/1000 [00:20<00:02, 43.64it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.82it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.62it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.38it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.31it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.88it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.88it/s] 50%|█████     | 8/16 [00:01<00:01,  7.27it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.52it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.68it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.19it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.21it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.77it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.69it/s]100%|██████████| 16/16 [00:02<00:00,  6.85it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:22,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:22<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(58.0039, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4980, device='cuda:6', grad_fn=<DivBackward0>)
43093 MiB free out of 48676 MiB total
2 mlp.up_proj
Pruning ...
0.01
torch.Size([11150094])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.77it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.83it/s] 40%|████      | 400/1000 [00:09<00:13, 43.84it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.84it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.84it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.82it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.81it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.80it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.80it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.51it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.22it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.65it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.19it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.99it/s] 50%|█████     | 8/16 [00:01<00:01,  7.11it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.46it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.40it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.60it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.08it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.95it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.38it/s]100%|██████████| 16/16 [00:02<00:00,  6.26it/s]100%|██████████| 16/16 [00:02<00:00,  6.88it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:22,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:22<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(46.5094, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4923, device='cuda:6', grad_fn=<DivBackward0>)
43079 MiB free out of 48676 MiB total
2 mlp.down_proj
Pruning ...
0.01
torch.Size([11158762])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.84it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.89it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.86it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.84it/s] 97%|█████████▋| 969/1000 [00:22<00:00, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.31it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.14it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.63it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.94it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.44it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.17it/s] 50%|█████     | 8/16 [00:01<00:01,  5.89it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.62it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.42it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.00it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.91it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.25it/s]100%|██████████| 16/16 [00:02<00:00,  8.34it/s]100%|██████████| 16/16 [00:02<00:00,  6.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.73it/s] 20%|██        | 20/100 [00:07<00:29,  2.74it/s] 30%|███       | 30/100 [00:10<00:25,  2.74it/s] 40%|████      | 40/100 [00:14<00:21,  2.74it/s] 50%|█████     | 50/100 [00:18<00:18,  2.73it/s] 60%|██████    | 60/100 [00:21<00:14,  2.74it/s] 70%|███████   | 70/100 [00:25<00:10,  2.74it/s] 80%|████████  | 80/100 [00:29<00:07,  2.73it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(0.5410, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4937, device='cuda:6', grad_fn=<DivBackward0>)
42715 MiB free out of 48676 MiB total
3 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149218])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.83it/s] 20%|██        | 200/1000 [00:01<00:07, 107.01it/s] 30%|███       | 300/1000 [00:02<00:06, 107.05it/s] 40%|████      | 400/1000 [00:03<00:05, 107.09it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.07it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.10it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.06it/s] 72%|███████▎  | 725/1000 [00:06<00:02, 106.90it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.47it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.17it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.87it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.62it/s] 50%|█████     | 8/16 [00:00<00:00, 10.22it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.72it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.33it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.15it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.97it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.62it/s]100%|██████████| 16/16 [00:01<00:00,  9.90it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.66it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.65it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(107.3826, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5189, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
3 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149238])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.77it/s] 20%|██        | 200/1000 [00:01<00:07, 106.88it/s] 30%|███       | 300/1000 [00:02<00:06, 106.87it/s] 40%|████      | 400/1000 [00:03<00:05, 106.99it/s] 44%|████▍     | 445/1000 [00:04<00:05, 106.50it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.01it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.72it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.36it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.23it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.90it/s] 50%|█████     | 8/16 [00:00<00:00,  9.72it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.33it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.20it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.16it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.86it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(120.0119, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5209, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
3 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148813])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 105.88it/s] 20%|██        | 200/1000 [00:01<00:07, 106.46it/s] 30%|███       | 300/1000 [00:02<00:06, 106.60it/s] 40%|████      | 400/1000 [00:03<00:05, 106.72it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.73it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.73it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.74it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.71it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.72it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.75it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.68it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.90it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.08it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.17it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.43it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.04it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.20it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.13it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.82it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.68it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.50it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.72it/s] 20%|██        | 20/100 [00:02<00:08,  9.67it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.66it/s] 60%|██████    | 60/100 [00:06<00:04,  9.65it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.65it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]
H_error tensor(29.0426, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4960, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
3 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148862])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.53it/s] 20%|██        | 200/1000 [00:01<00:07, 106.70it/s] 30%|███       | 300/1000 [00:02<00:06, 106.72it/s] 40%|████      | 400/1000 [00:03<00:05, 106.79it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.81it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.80it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.79it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.75it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.71it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.70it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.73it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.59it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.64it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.72it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.61it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.76it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.29it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.05it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.49it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.70it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.17it/s]100%|██████████| 16/16 [00:01<00:00, 10.07it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(0.3107, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5010, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
3 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150327])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.82it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.87it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.84it/s] 92%|█████████▏| 921/1000 [00:21<00:01, 43.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.50it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.85it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.87it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.07it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.38it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.99it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.36it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.74it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.53it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.13it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.51it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.76it/s]100%|██████████| 16/16 [00:02<00:00,  6.91it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.22it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.21it/s] 50%|█████     | 50/100 [00:15<00:15,  3.21it/s] 60%|██████    | 60/100 [00:18<00:12,  3.21it/s] 70%|███████   | 70/100 [00:21<00:09,  3.21it/s] 80%|████████  | 80/100 [00:24<00:06,  3.21it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]
H_error tensor(81.2510, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4915, device='cuda:6', grad_fn=<DivBackward0>)
43093 MiB free out of 48676 MiB total
3 mlp.up_proj
Pruning ...
0.01
torch.Size([11150149])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.79it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:16, 43.72it/s] 40%|████      | 400/1000 [00:09<00:13, 43.77it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.79it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.80it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.80it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.79it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.79it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.79it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.95it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.71it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.94it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.92it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.39it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.85it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.70it/s] 50%|█████     | 8/16 [00:01<00:01,  6.67it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.67it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.91it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.34it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.21it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.55it/s]100%|██████████| 16/16 [00:02<00:00,  6.91it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.19it/s] 40%|████      | 40/100 [00:12<00:18,  3.19it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.20it/s] 70%|███████   | 70/100 [00:21<00:09,  3.20it/s] 80%|████████  | 80/100 [00:25<00:06,  3.20it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]
H_error tensor(66.8443, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4896, device='cuda:6', grad_fn=<DivBackward0>)
42529 MiB free out of 48676 MiB total
3 mlp.down_proj
Pruning ...
0.01
torch.Size([11158787])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.78it/s] 20%|██        | 200/1000 [00:04<00:18, 43.84it/s] 30%|███       | 300/1000 [00:06<00:15, 43.85it/s] 40%|████      | 400/1000 [00:09<00:13, 43.89it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.88it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.87it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.86it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.84it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.83it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.11it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.35it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.94it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.59it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.73it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.61it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.14it/s] 50%|█████     | 8/16 [00:01<00:01,  6.81it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.23it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.35it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.62it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.26it/s] 88%|████████▊ | 14/16 [00:02<00:00,  8.32it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.50it/s]100%|██████████| 16/16 [00:02<00:00,  6.91it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.76it/s] 20%|██        | 20/100 [00:07<00:28,  2.77it/s] 30%|███       | 30/100 [00:10<00:25,  2.77it/s] 40%|████      | 40/100 [00:14<00:21,  2.77it/s] 50%|█████     | 50/100 [00:18<00:18,  2.77it/s] 60%|██████    | 60/100 [00:21<00:14,  2.77it/s] 70%|███████   | 70/100 [00:25<00:10,  2.76it/s] 80%|████████  | 80/100 [00:28<00:07,  2.76it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.76it/s]100%|██████████| 100/100 [00:36<00:00,  2.76it/s]100%|██████████| 100/100 [00:36<00:00,  2.76it/s]
H_error tensor(0.7137, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4950, device='cuda:6', grad_fn=<DivBackward0>)
42847 MiB free out of 48676 MiB total
4 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149043])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.45it/s] 20%|██        | 200/1000 [00:01<00:07, 106.62it/s] 30%|███       | 300/1000 [00:02<00:06, 106.69it/s] 40%|████      | 400/1000 [00:03<00:05, 106.69it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.74it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.72it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.75it/s] 72%|███████▎  | 725/1000 [00:06<00:02, 106.56it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.47it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.36it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.19it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.79it/s] 50%|█████     | 8/16 [00:00<00:00, 10.33it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.07it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.67it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.79it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.52it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.53it/s]100%|██████████| 16/16 [00:01<00:00,  9.60it/s]100%|██████████| 16/16 [00:01<00:00,  9.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.74it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(163.9918, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5204, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
4 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149176])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.60it/s] 20%|██        | 200/1000 [00:01<00:07, 106.69it/s] 30%|███       | 300/1000 [00:02<00:06, 106.72it/s] 40%|████      | 400/1000 [00:03<00:05, 106.77it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.81it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.74it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.72it/s] 77%|███████▋  | 766/1000 [00:07<00:02, 106.59it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.33it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.77it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.72it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.15it/s] 50%|█████     | 8/16 [00:00<00:00,  9.75it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.58it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.86it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.62it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.21it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.83it/s]100%|██████████| 16/16 [00:01<00:00,  9.59it/s]100%|██████████| 16/16 [00:01<00:00,  9.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(171.3395, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5231, device='cuda:6', grad_fn=<DivBackward0>)
43051 MiB free out of 48676 MiB total
4 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148812])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.45it/s] 20%|██        | 200/1000 [00:01<00:07, 106.60it/s] 30%|███       | 300/1000 [00:02<00:06, 106.62it/s] 40%|████      | 400/1000 [00:03<00:05, 106.71it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.71it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.73it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.74it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.72it/s] 89%|████████▉ | 892/1000 [00:08<00:01, 106.58it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.64it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.68it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.07it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.34it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.81it/s] 50%|█████     | 8/16 [00:00<00:00,  9.43it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.15it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.07it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.05it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.23it/s]100%|██████████| 16/16 [00:01<00:00, 10.12it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.79it/s] 20%|██        | 20/100 [00:02<00:08,  9.74it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(42.9010, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4964, device='cuda:6', grad_fn=<DivBackward0>)
43051 MiB free out of 48676 MiB total
4 self_attn.o_proj
Pruning ...
0.01
torch.Size([4149166])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.67it/s] 20%|██        | 200/1000 [00:01<00:07, 106.79it/s] 30%|███       | 300/1000 [00:02<00:06, 106.88it/s] 40%|████      | 400/1000 [00:03<00:05, 106.94it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.96it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.99it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.00it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.99it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.99it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.96it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.95it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.75it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.85it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.22it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.69it/s] 50%|█████     | 8/16 [00:00<00:00,  9.91it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.58it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.43it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.55it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.38it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.93it/s]100%|██████████| 16/16 [00:01<00:00, 10.52it/s]100%|██████████| 16/16 [00:01<00:00, 10.06it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(0.7999, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5032, device='cuda:6', grad_fn=<DivBackward0>)
43051 MiB free out of 48676 MiB total
4 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150382])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.70it/s] 20%|██        | 200/1000 [00:04<00:18, 43.76it/s] 30%|███       | 300/1000 [00:06<00:15, 43.77it/s] 40%|████      | 400/1000 [00:09<00:13, 43.79it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.79it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.78it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.76it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.76it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.75it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.74it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.76it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.47it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.33it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.21it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.94it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.01it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.30it/s] 50%|█████     | 8/16 [00:01<00:01,  6.00it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.50it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.02it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.71it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.65it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.06it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.69it/s]100%|██████████| 16/16 [00:02<00:00,  6.91it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.22it/s] 20%|██        | 20/100 [00:06<00:24,  3.22it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(116.8631, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4942, device='cuda:6', grad_fn=<DivBackward0>)
42965 MiB free out of 48676 MiB total
4 mlp.up_proj
Pruning ...
0.01
torch.Size([11150166])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.76it/s] 20%|██        | 200/1000 [00:04<00:18, 43.79it/s] 30%|███       | 300/1000 [00:06<00:15, 43.81it/s] 40%|████      | 400/1000 [00:09<00:13, 43.81it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.81it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.81it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.79it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.78it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.77it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.77it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.79it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.45it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.44it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.44it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.68it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.41it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.03it/s] 50%|█████     | 8/16 [00:01<00:01,  6.37it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.21it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.76it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.80it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.52it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.51it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.25it/s]100%|██████████| 16/16 [00:02<00:00,  6.61it/s]100%|██████████| 16/16 [00:02<00:00,  6.90it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:22,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(93.7713, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4914, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
4 mlp.down_proj
Pruning ...
0.01
torch.Size([11158746])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.79it/s] 20%|██        | 200/1000 [00:04<00:18, 43.84it/s] 30%|███       | 300/1000 [00:06<00:15, 43.85it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.84it/s] 76%|███████▋  | 763/1000 [00:17<00:05, 43.79it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.32it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.46it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.79it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.52it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.40it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.20it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.47it/s] 50%|█████     | 8/16 [00:01<00:01,  6.99it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.47it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.04it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.21it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.10it/s] 81%|████████▏ | 13/16 [00:02<00:00,  6.31it/s] 94%|█████████▍| 15/16 [00:02<00:00,  8.12it/s]100%|██████████| 16/16 [00:02<00:00,  6.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.72it/s] 20%|██        | 20/100 [00:07<00:29,  2.71it/s] 30%|███       | 30/100 [00:11<00:25,  2.71it/s] 40%|████      | 40/100 [00:14<00:22,  2.71it/s] 50%|█████     | 50/100 [00:18<00:18,  2.71it/s] 60%|██████    | 60/100 [00:22<00:14,  2.71it/s] 70%|███████   | 70/100 [00:25<00:11,  2.71it/s] 80%|████████  | 80/100 [00:29<00:07,  2.70it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.70it/s]100%|██████████| 100/100 [00:36<00:00,  2.70it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]
H_error tensor(1.3504, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4995, device='cuda:6', grad_fn=<DivBackward0>)
43401 MiB free out of 48676 MiB total
5 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149006])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.22it/s] 20%|██        | 200/1000 [00:01<00:07, 106.58it/s] 30%|███       | 300/1000 [00:02<00:06, 106.70it/s] 40%|████      | 400/1000 [00:03<00:05, 106.79it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.87it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.92it/s] 68%|██████▊   | 682/1000 [00:06<00:02, 106.68it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.20it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.97it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.22it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.89it/s] 50%|█████     | 8/16 [00:00<00:00, 10.00it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.67it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.72it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.40it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.61it/s]100%|██████████| 16/16 [00:01<00:00, 10.09it/s]100%|██████████| 16/16 [00:01<00:00,  9.90it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(238.6475, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5220, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
5 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149155])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.71it/s] 20%|██        | 200/1000 [00:01<00:07, 106.77it/s] 30%|███       | 300/1000 [00:02<00:06, 106.78it/s] 40%|████      | 400/1000 [00:03<00:05, 106.82it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.82it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.84it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.87it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.85it/s] 88%|████████▊ | 876/1000 [00:08<00:01, 106.71it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.22it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.92it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.35it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.92it/s] 50%|█████     | 8/16 [00:00<00:00,  9.90it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.62it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.42it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.67it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.59it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.27it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.70it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(246.5688, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5246, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
5 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148813])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.48it/s] 20%|██        | 200/1000 [00:01<00:07, 106.64it/s] 30%|███       | 300/1000 [00:02<00:06, 106.73it/s] 40%|████      | 400/1000 [00:03<00:05, 106.70it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.72it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.75it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.76it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.75it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.75it/s] 93%|█████████▎| 933/1000 [00:08<00:00, 106.61it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.61it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.93it/s] 38%|███▊      | 6/16 [00:00<00:00, 11.38it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.92it/s] 50%|█████     | 8/16 [00:00<00:00, 10.24it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.90it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.64it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.53it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.64it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.39it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(72.1173, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4973, device='cuda:6', grad_fn=<DivBackward0>)
43275 MiB free out of 48676 MiB total
5 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148889])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.29it/s] 20%|██        | 200/1000 [00:01<00:07, 106.49it/s] 30%|███       | 300/1000 [00:02<00:06, 106.55it/s] 40%|████      | 400/1000 [00:03<00:05, 106.62it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.64it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.68it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.68it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.71it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.69it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.69it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.65it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.25it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.84it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.00it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.77it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.38it/s] 50%|█████     | 8/16 [00:00<00:00,  9.61it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.79it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.84it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.80it/s]100%|██████████| 16/16 [00:01<00:00, 10.59it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(1.8161, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5156, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
5 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150403])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.76it/s] 20%|██        | 200/1000 [00:04<00:18, 43.80it/s] 30%|███       | 300/1000 [00:06<00:15, 43.84it/s] 40%|████      | 400/1000 [00:09<00:13, 43.84it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.84it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.82it/s] 78%|███████▊  | 780/1000 [00:17<00:05, 43.76it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.43it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.08it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.80it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.52it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.96it/s] 50%|█████     | 8/16 [00:01<00:01,  7.16it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.62it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.77it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.22it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.46it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.05it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.88it/s]100%|██████████| 16/16 [00:02<00:00,  7.38it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.22it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.23it/s] 70%|███████   | 70/100 [00:21<00:09,  3.23it/s] 80%|████████  | 80/100 [00:24<00:06,  3.23it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.23it/s]100%|██████████| 100/100 [00:30<00:00,  3.23it/s]100%|██████████| 100/100 [00:30<00:00,  3.23it/s]
H_error tensor(160.1275, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4969, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
5 mlp.up_proj
Pruning ...
0.01
torch.Size([11150147])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.75it/s] 20%|██        | 200/1000 [00:04<00:18, 43.79it/s] 30%|███       | 300/1000 [00:06<00:15, 43.81it/s] 40%|████      | 400/1000 [00:09<00:13, 43.81it/s] 44%|████▍     | 443/1000 [00:10<00:12, 43.71it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.96it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.29it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.42it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.80it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.17it/s] 38%|███▊      | 6/16 [00:00<00:01,  5.80it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.47it/s] 50%|█████     | 8/16 [00:01<00:01,  5.99it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.70it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.94it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.51it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.35it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.61it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.16it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.22it/s] 20%|██        | 20/100 [00:06<00:24,  3.22it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(123.1615, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4948, device='cuda:6', grad_fn=<DivBackward0>)
43253 MiB free out of 48676 MiB total
5 mlp.down_proj
Pruning ...
0.01
torch.Size([11158786])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.89it/s] 30%|███       | 300/1000 [00:06<00:15, 43.93it/s] 40%|████      | 400/1000 [00:09<00:13, 43.94it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.94it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.95it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.95it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.94it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.93it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.92it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.93it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.28it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.62it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.65it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.96it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.81it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.91it/s] 50%|█████     | 8/16 [00:01<00:01,  7.61it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.32it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.15it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.20it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.84it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.37it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.93it/s]100%|██████████| 16/16 [00:02<00:00,  7.52it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.74it/s] 20%|██        | 20/100 [00:07<00:29,  2.74it/s] 30%|███       | 30/100 [00:10<00:25,  2.74it/s] 40%|████      | 40/100 [00:14<00:21,  2.74it/s] 50%|█████     | 50/100 [00:18<00:18,  2.74it/s] 60%|██████    | 60/100 [00:21<00:14,  2.74it/s] 70%|███████   | 70/100 [00:25<00:10,  2.73it/s] 80%|████████  | 80/100 [00:29<00:07,  2.73it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(2.1355, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5089, device='cuda:6', grad_fn=<DivBackward0>)
43107 MiB free out of 48676 MiB total
6 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149028])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.53it/s] 20%|██        | 200/1000 [00:01<00:07, 106.75it/s] 30%|███       | 300/1000 [00:02<00:06, 106.71it/s] 40%|████      | 400/1000 [00:03<00:05, 106.78it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.83it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.83it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.83it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.84it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.83it/s] 96%|█████████▌| 959/1000 [00:08<00:00, 106.69it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.76it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.83it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.99it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.17it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.02it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.66it/s] 50%|█████     | 8/16 [00:00<00:00,  9.61it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.15it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.19it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.32it/s]100%|██████████| 16/16 [00:01<00:00, 10.33it/s]100%|██████████| 16/16 [00:01<00:00,  9.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(276.3510, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5336, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
6 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149102])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.48it/s] 20%|██        | 200/1000 [00:01<00:07, 106.67it/s] 30%|███       | 300/1000 [00:02<00:06, 106.79it/s] 40%|████      | 400/1000 [00:03<00:05, 106.81it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.82it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.81it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.81it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.79it/s] 82%|████████▏ | 817/1000 [00:07<00:01, 106.65it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01, 10.00it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.55it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.29it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.63it/s] 50%|█████     | 8/16 [00:00<00:00,  9.85it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.55it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.13it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.84it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.77it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.15it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(290.7189, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5330, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
6 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148815])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.63it/s] 20%|██        | 200/1000 [00:01<00:07, 106.87it/s] 30%|███       | 300/1000 [00:02<00:06, 106.96it/s] 40%|████      | 400/1000 [00:03<00:05, 106.95it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.99it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.04it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.09it/s] 80%|████████  | 800/1000 [00:07<00:01, 107.11it/s] 83%|████████▎ | 829/1000 [00:07<00:01, 106.90it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.91it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.66it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.37it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.42it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.44it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.05it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.96it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.69it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.52it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.30it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.71it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.72it/s] 50%|█████     | 50/100 [00:05<00:05,  9.71it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(81.6135, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5007, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
6 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148796])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.95it/s] 20%|██        | 200/1000 [00:01<00:07, 107.08it/s] 30%|███       | 300/1000 [00:02<00:06, 107.09it/s] 40%|████      | 400/1000 [00:03<00:05, 107.12it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.14it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.12it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.10it/s] 78%|███████▊  | 785/1000 [00:07<00:02, 106.97it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.58it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.79it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.06it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.54it/s] 50%|█████     | 8/16 [00:00<00:00, 10.33it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.07it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.77it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.43it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.99it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.76it/s]100%|██████████| 16/16 [00:01<00:00,  9.53it/s]100%|██████████| 16/16 [00:01<00:00, 10.10it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(2.6219, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5180, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
6 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150416])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.78it/s] 20%|██        | 200/1000 [00:04<00:18, 43.80it/s] 30%|███       | 300/1000 [00:06<00:15, 43.81it/s] 40%|████      | 400/1000 [00:09<00:13, 43.81it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.81it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.81it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.80it/s] 80%|███████▉  | 796/1000 [00:18<00:04, 43.74it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.04it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.24it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.17it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.30it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.86it/s] 38%|███▊      | 6/16 [00:01<00:01,  5.59it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.44it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.51it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.55it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.49it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.90it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.09it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.56it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.21it/s] 50%|█████     | 50/100 [00:15<00:15,  3.21it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(180.3563, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4971, device='cuda:6', grad_fn=<DivBackward0>)
42497 MiB free out of 48676 MiB total
6 mlp.up_proj
Pruning ...
0.01
torch.Size([11150187])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.75it/s] 20%|██        | 200/1000 [00:04<00:18, 43.80it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.83it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.82it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.80it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.79it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.79it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.24it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.13it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.23it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.23it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.14it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.96it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.32it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.27it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.09it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.40it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.76it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.90it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.45it/s]100%|██████████| 16/16 [00:02<00:00,  6.27it/s]100%|██████████| 16/16 [00:02<00:00,  6.92it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.22it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.21it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(146.6901, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4952, device='cuda:6', grad_fn=<DivBackward0>)
42615 MiB free out of 48676 MiB total
6 mlp.down_proj
Pruning ...
0.01
torch.Size([11158718])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.71it/s] 20%|██        | 200/1000 [00:04<00:18, 43.79it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.84it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.85it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.84it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.83it/s] 92%|█████████▏| 918/1000 [00:20<00:01, 43.78it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.26it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.66it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.94it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.09it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.13it/s] 50%|█████     | 8/16 [00:01<00:00,  8.90it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.93it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.64it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.34it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.56it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.16it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.46it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.16it/s]100%|██████████| 16/16 [00:02<00:00,  6.70it/s]100%|██████████| 16/16 [00:02<00:00,  6.92it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.73it/s] 20%|██        | 20/100 [00:07<00:29,  2.73it/s] 30%|███       | 30/100 [00:10<00:25,  2.73it/s] 40%|████      | 40/100 [00:14<00:21,  2.73it/s] 50%|█████     | 50/100 [00:18<00:18,  2.73it/s] 60%|██████    | 60/100 [00:21<00:14,  2.73it/s] 70%|███████   | 70/100 [00:25<00:10,  2.73it/s] 80%|████████  | 80/100 [00:29<00:07,  2.73it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(2.6457, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5120, device='cuda:6', grad_fn=<DivBackward0>)
42933 MiB free out of 48676 MiB total
7 self_attn.q_proj
Pruning ...
0.01
torch.Size([4148984])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.94it/s] 20%|██        | 200/1000 [00:01<00:07, 106.95it/s] 30%|███       | 300/1000 [00:02<00:06, 107.14it/s] 40%|████      | 400/1000 [00:03<00:05, 107.21it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.25it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.26it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.31it/s] 75%|███████▍  | 746/1000 [00:06<00:02, 107.09it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.84it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.97it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.80it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.95it/s] 50%|█████     | 8/16 [00:00<00:00, 10.13it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.02it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.79it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.51it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.30it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.46it/s]100%|██████████| 16/16 [00:01<00:00, 10.15it/s]100%|██████████| 16/16 [00:01<00:00, 10.09it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(267.3149, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5236, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
7 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149101])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.67it/s] 20%|██        | 200/1000 [00:01<00:07, 106.75it/s] 30%|███       | 300/1000 [00:02<00:06, 106.89it/s] 40%|████      | 400/1000 [00:03<00:05, 106.99it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.00it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.96it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.83it/s] 78%|███████▊  | 781/1000 [00:07<00:02, 106.73it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.54it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.76it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.55it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.34it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.98it/s] 50%|█████     | 8/16 [00:00<00:00,  9.99it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.63it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.95it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.35it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.96it/s]100%|██████████| 16/16 [00:01<00:00, 10.19it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.75it/s] 30%|███       | 30/100 [00:03<00:07,  9.74it/s] 40%|████      | 40/100 [00:04<00:06,  9.73it/s] 50%|█████     | 50/100 [00:05<00:05,  9.74it/s] 60%|██████    | 60/100 [00:06<00:04,  9.73it/s] 70%|███████   | 70/100 [00:07<00:03,  9.74it/s] 80%|████████  | 80/100 [00:08<00:02,  9.73it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.73it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]
H_error tensor(275.4691, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5254, device='cuda:6', grad_fn=<DivBackward0>)
43371 MiB free out of 48676 MiB total
7 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148820])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.51it/s] 20%|██        | 200/1000 [00:01<00:07, 106.65it/s] 30%|███       | 300/1000 [00:02<00:06, 106.77it/s] 40%|████      | 400/1000 [00:03<00:05, 106.76it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.73it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.76it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.76it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.77it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.75it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.75it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.74it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.31it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.99it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.70it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.40it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.36it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.93it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.60it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.36it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.92it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.87it/s]100%|██████████| 16/16 [00:01<00:00, 10.63it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.78it/s] 30%|███       | 30/100 [00:03<00:07,  9.79it/s] 40%|████      | 40/100 [00:04<00:06,  9.79it/s] 50%|█████     | 50/100 [00:05<00:05,  9.79it/s] 60%|██████    | 60/100 [00:06<00:04,  9.76it/s] 70%|███████   | 70/100 [00:07<00:03,  9.76it/s] 80%|████████  | 80/100 [00:08<00:02,  9.74it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.76it/s]
H_error tensor(89.3149, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5011, device='cuda:6', grad_fn=<DivBackward0>)
43403 MiB free out of 48676 MiB total
7 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148805])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.44it/s] 20%|██        | 200/1000 [00:01<00:07, 106.59it/s] 30%|███       | 300/1000 [00:02<00:06, 106.60it/s] 40%|████      | 400/1000 [00:03<00:05, 106.60it/s] 44%|████▍     | 443/1000 [00:04<00:05, 106.34it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.87it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.45it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.54it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.97it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.62it/s] 50%|█████     | 8/16 [00:00<00:00,  9.30it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.95it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.13it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.92it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.47it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]100%|██████████| 16/16 [00:01<00:00,  9.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.80it/s] 20%|██        | 20/100 [00:02<00:08,  9.75it/s] 30%|███       | 30/100 [00:03<00:07,  9.72it/s] 40%|████      | 40/100 [00:04<00:06,  9.72it/s] 50%|█████     | 50/100 [00:05<00:05,  9.72it/s] 60%|██████    | 60/100 [00:06<00:04,  9.72it/s] 70%|███████   | 70/100 [00:07<00:03,  9.71it/s] 80%|████████  | 80/100 [00:08<00:02,  9.72it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(7.4299, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5193, device='cuda:6', grad_fn=<DivBackward0>)
43371 MiB free out of 48676 MiB total
7 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150335])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.79it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.84it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 88%|████████▊ | 882/1000 [00:20<00:02, 43.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.07it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.30it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.91it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.32it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.08it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.70it/s] 50%|█████     | 8/16 [00:01<00:01,  6.70it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.42it/s] 62%|██████▎   | 10/16 [00:01<00:01,  6.00it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.04it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.97it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.04it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.87it/s]100%|██████████| 16/16 [00:02<00:00,  6.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.19it/s] 40%|████      | 40/100 [00:12<00:18,  3.19it/s] 50%|█████     | 50/100 [00:15<00:15,  3.19it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(184.4221, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4995, device='cuda:6', grad_fn=<DivBackward0>)
43239 MiB free out of 48676 MiB total
7 mlp.up_proj
Pruning ...
0.01
torch.Size([11150142])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.79it/s] 20%|██        | 200/1000 [00:04<00:18, 43.84it/s] 30%|███       | 300/1000 [00:06<00:15, 43.83it/s] 40%|████      | 400/1000 [00:09<00:13, 43.83it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.84it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.84it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.83it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.82it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.81it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.81it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.30it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.42it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.55it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.31it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.38it/s] 44%|████▍     | 7/16 [00:00<00:01,  6.95it/s] 50%|█████     | 8/16 [00:01<00:01,  6.49it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.54it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.06it/s] 69%|██████▉   | 11/16 [00:01<00:00,  5.85it/s] 75%|███████▌  | 12/16 [00:01<00:00,  5.63it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.98it/s]100%|██████████| 16/16 [00:02<00:00,  7.88it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.19it/s] 50%|█████     | 50/100 [00:15<00:15,  3.19it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(152.9224, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4959, device='cuda:6', grad_fn=<DivBackward0>)
43271 MiB free out of 48676 MiB total
7 mlp.down_proj
Pruning ...
0.01
torch.Size([11158711])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.72it/s] 20%|██        | 200/1000 [00:04<00:18, 43.79it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.84it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.85it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.84it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.83it/s] 86%|████████▌ | 859/1000 [00:19<00:03, 43.77it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.53it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.57it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.69it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.94it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.33it/s] 44%|████▍     | 7/16 [00:00<00:01,  6.88it/s] 50%|█████     | 8/16 [00:01<00:01,  6.24it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.82it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.94it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.41it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.20it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.54it/s]100%|██████████| 16/16 [00:02<00:00,  6.75it/s]100%|██████████| 16/16 [00:02<00:00,  6.92it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.72it/s] 20%|██        | 20/100 [00:07<00:29,  2.72it/s] 30%|███       | 30/100 [00:11<00:25,  2.71it/s] 40%|████      | 40/100 [00:14<00:22,  2.72it/s] 50%|█████     | 50/100 [00:18<00:18,  2.71it/s] 60%|██████    | 60/100 [00:22<00:14,  2.72it/s] 70%|███████   | 70/100 [00:25<00:11,  2.72it/s] 80%|████████  | 80/100 [00:29<00:07,  2.72it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.71it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]
H_error tensor(3.0117, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5178, device='cuda:6', grad_fn=<DivBackward0>)
42907 MiB free out of 48676 MiB total
8 self_attn.q_proj
Pruning ...
0.01
torch.Size([4148959])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.70it/s] 20%|██        | 200/1000 [00:01<00:07, 106.89it/s] 30%|███       | 300/1000 [00:02<00:06, 106.95it/s] 40%|████      | 400/1000 [00:03<00:05, 106.98it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.87it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.80it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.79it/s] 76%|███████▋  | 765/1000 [00:07<00:02, 106.69it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.42it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.72it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.17it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.75it/s] 50%|█████     | 8/16 [00:00<00:00,  9.93it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.64it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.15it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.03it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.72it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.70it/s]100%|██████████| 16/16 [00:01<00:00,  9.62it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.79it/s] 20%|██        | 20/100 [00:02<00:08,  9.81it/s] 30%|███       | 30/100 [00:03<00:07,  9.81it/s] 40%|████      | 40/100 [00:04<00:06,  9.78it/s] 50%|█████     | 50/100 [00:05<00:05,  9.75it/s] 60%|██████    | 60/100 [00:06<00:04,  9.74it/s] 70%|███████   | 70/100 [00:07<00:03,  9.72it/s] 80%|████████  | 80/100 [00:08<00:02,  9.73it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]
H_error tensor(322.7885, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5221, device='cuda:6', grad_fn=<DivBackward0>)
42827 MiB free out of 48676 MiB total
8 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149116])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.71it/s] 20%|██        | 200/1000 [00:01<00:07, 106.86it/s] 30%|███       | 300/1000 [00:02<00:06, 106.92it/s] 40%|████      | 400/1000 [00:03<00:05, 106.94it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.95it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.90it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.92it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.94it/s] 88%|████████▊ | 884/1000 [00:08<00:01, 106.77it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.87it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.40it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.73it/s] 50%|█████     | 8/16 [00:00<00:00, 10.63it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.19it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.00it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.78it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.56it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.39it/s]100%|██████████| 16/16 [00:01<00:00,  9.97it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.71it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(320.6748, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5231, device='cuda:6', grad_fn=<DivBackward0>)
42859 MiB free out of 48676 MiB total
8 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148806])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.52it/s] 20%|██        | 200/1000 [00:01<00:07, 106.78it/s] 30%|███       | 300/1000 [00:02<00:06, 106.93it/s] 40%|████      | 400/1000 [00:03<00:05, 106.99it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.06it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.06it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.06it/s] 80%|████████  | 800/1000 [00:07<00:01, 107.03it/s] 90%|█████████ | 900/1000 [00:08<00:00, 107.02it/s]100%|██████████| 1000/1000 [00:09<00:00, 107.00it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.99it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.43it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.89it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.28it/s] 50%|█████     | 8/16 [00:00<00:00, 10.82it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.56it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.11it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.15it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.78it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.07it/s]100%|██████████| 16/16 [00:01<00:00,  9.79it/s]100%|██████████| 16/16 [00:01<00:00, 10.06it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(105.6980, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5046, device='cuda:6', grad_fn=<DivBackward0>)
42637 MiB free out of 48676 MiB total
8 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148806])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.53it/s] 20%|██        | 200/1000 [00:01<00:07, 106.70it/s] 30%|███       | 300/1000 [00:02<00:06, 106.80it/s] 40%|████      | 400/1000 [00:03<00:05, 106.87it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.95it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.97it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.94it/s] 73%|███████▎  | 732/1000 [00:06<00:02, 106.74it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.61it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.77it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.86it/s] 50%|█████     | 8/16 [00:00<00:00, 10.01it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.78it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.68it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.53it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.30it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.29it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.68it/s] 20%|██        | 20/100 [00:02<00:08,  9.65it/s] 30%|███       | 30/100 [00:03<00:07,  9.65it/s] 40%|████      | 40/100 [00:04<00:06,  9.65it/s] 50%|█████     | 50/100 [00:05<00:05,  9.65it/s] 60%|██████    | 60/100 [00:06<00:04,  9.65it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.65it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]
H_error tensor(14.1381, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5323, device='cuda:6', grad_fn=<DivBackward0>)
42415 MiB free out of 48676 MiB total
8 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150379])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.78it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.84it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.83it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.83it/s] 80%|███████▉  | 798/1000 [00:18<00:04, 43.77it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.13it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.26it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.05it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.79it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.35it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.29it/s] 50%|█████     | 8/16 [00:01<00:01,  7.81it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.99it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.75it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.34it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.03it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.39it/s] 94%|█████████▍| 15/16 [00:02<00:00,  8.03it/s]100%|██████████| 16/16 [00:02<00:00,  7.09it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:22,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(195.4979, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5092, device='cuda:6', grad_fn=<DivBackward0>)
42415 MiB free out of 48676 MiB total
8 mlp.up_proj
Pruning ...
0.01
torch.Size([11150079])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.84it/s] 20%|██        | 200/1000 [00:04<00:18, 43.85it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.83it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.83it/s] 95%|█████████▌| 950/1000 [00:21<00:01, 43.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.15it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.60it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.62it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.97it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.29it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.01it/s] 50%|█████     | 8/16 [00:01<00:01,  7.07it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.73it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.87it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.80it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.29it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.62it/s]100%|██████████| 16/16 [00:02<00:00,  7.63it/s]100%|██████████| 16/16 [00:02<00:00,  6.92it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.17it/s] 20%|██        | 20/100 [00:06<00:25,  3.17it/s] 30%|███       | 30/100 [00:09<00:22,  3.17it/s] 40%|████      | 40/100 [00:12<00:18,  3.17it/s] 50%|█████     | 50/100 [00:15<00:15,  3.17it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:22<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(160.2014, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5026, device='cuda:6', grad_fn=<DivBackward0>)
41851 MiB free out of 48676 MiB total
8 mlp.down_proj
Pruning ...
0.01
torch.Size([11158751])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.73it/s] 20%|██        | 200/1000 [00:04<00:18, 43.81it/s] 30%|███       | 300/1000 [00:06<00:15, 43.84it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 55%|█████▍    | 546/1000 [00:12<00:10, 43.77it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.97it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.90it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.99it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.44it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.16it/s] 44%|████▍     | 7/16 [00:00<00:01,  6.74it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.33it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.39it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.64it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.71it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.23it/s] 88%|████████▊ | 14/16 [00:02<00:00,  5.90it/s] 94%|█████████▍| 15/16 [00:02<00:00,  5.93it/s]100%|██████████| 16/16 [00:02<00:00,  6.66it/s]100%|██████████| 16/16 [00:02<00:00,  6.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.72it/s] 20%|██        | 20/100 [00:07<00:29,  2.72it/s] 30%|███       | 30/100 [00:11<00:25,  2.71it/s] 40%|████      | 40/100 [00:14<00:22,  2.72it/s] 50%|█████     | 50/100 [00:18<00:18,  2.72it/s] 60%|██████    | 60/100 [00:22<00:14,  2.72it/s] 70%|███████   | 70/100 [00:25<00:11,  2.72it/s] 80%|████████  | 80/100 [00:29<00:07,  2.72it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.72it/s]100%|██████████| 100/100 [00:36<00:00,  2.72it/s]100%|██████████| 100/100 [00:36<00:00,  2.72it/s]
H_error tensor(3.5863, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5237, device='cuda:6', grad_fn=<DivBackward0>)
41487 MiB free out of 48676 MiB total
9 self_attn.q_proj
Pruning ...
0.01
torch.Size([4148961])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.76it/s] 20%|██        | 200/1000 [00:01<00:07, 106.80it/s] 30%|███       | 300/1000 [00:02<00:06, 106.47it/s] 40%|████      | 400/1000 [00:03<00:05, 106.62it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.80it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.88it/s] 70%|██████▉   | 698/1000 [00:06<00:02, 106.67it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.82it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.15it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.70it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.51it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.56it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.42it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.89it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.60it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.51it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.08it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.66it/s]100%|██████████| 16/16 [00:01<00:00, 10.35it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(337.1023, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5320, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
9 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149099])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.69it/s] 20%|██        | 200/1000 [00:01<00:07, 106.80it/s] 30%|███       | 300/1000 [00:02<00:06, 106.82it/s] 40%|████      | 400/1000 [00:03<00:05, 106.61it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.73it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.82it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.87it/s] 71%|███████▏  | 714/1000 [00:06<00:02, 106.64it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.99it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.83it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.43it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.44it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.59it/s] 50%|█████     | 8/16 [00:00<00:00,  9.72it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.64it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.83it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.27it/s]100%|██████████| 16/16 [00:01<00:00, 10.44it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(332.4205, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5273, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
9 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148809])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.30it/s] 20%|██        | 200/1000 [00:01<00:07, 106.53it/s] 30%|███       | 300/1000 [00:02<00:06, 106.65it/s] 40%|████      | 400/1000 [00:03<00:05, 106.75it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.80it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.79it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.79it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.75it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.74it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.71it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.72it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.71it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.08it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.74it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.62it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.99it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.67it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.45it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.84it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.98it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.66it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.80it/s] 20%|██        | 20/100 [00:02<00:08,  9.79it/s] 30%|███       | 30/100 [00:03<00:07,  9.79it/s] 40%|████      | 40/100 [00:04<00:06,  9.78it/s] 50%|█████     | 50/100 [00:05<00:05,  9.78it/s] 60%|██████    | 60/100 [00:06<00:04,  9.79it/s] 70%|███████   | 70/100 [00:07<00:03,  9.78it/s] 80%|████████  | 80/100 [00:08<00:02,  9.79it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.79it/s]100%|██████████| 100/100 [00:10<00:00,  9.79it/s]100%|██████████| 100/100 [00:10<00:00,  9.79it/s]
H_error tensor(116.7630, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5049, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
9 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148889])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.62it/s] 20%|██        | 200/1000 [00:01<00:07, 106.62it/s] 30%|███       | 300/1000 [00:02<00:06, 106.65it/s] 40%|████      | 400/1000 [00:03<00:05, 106.70it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.65it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.67it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.63it/s] 78%|███████▊  | 777/1000 [00:07<00:02, 106.51it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.09it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.91it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.36it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.32it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.95it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.80it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.20it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.08it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.77it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.61it/s]100%|██████████| 16/16 [00:01<00:00,  9.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.70it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(20.8487, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5394, device='cuda:6', grad_fn=<DivBackward0>)
43275 MiB free out of 48676 MiB total
9 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150367])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.83it/s] 40%|████      | 400/1000 [00:09<00:13, 43.83it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.83it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.81it/s] 63%|██████▎   | 631/1000 [00:14<00:08, 43.75it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.86it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.61it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.16it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.46it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.75it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.18it/s] 50%|█████     | 8/16 [00:01<00:01,  5.83it/s] 56%|█████▋    | 9/16 [00:01<00:01,  5.82it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.39it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.05it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.08it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.58it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.19it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.17it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:22,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:22<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(201.9667, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5042, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
9 mlp.up_proj
Pruning ...
0.01
torch.Size([11150105])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.80it/s] 20%|██        | 200/1000 [00:04<00:18, 43.81it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.82it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.83it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.82it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.81it/s] 82%|████████▏ | 816/1000 [00:18<00:04, 43.76it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.28it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.20it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.71it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.00it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.71it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.42it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.59it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.34it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.09it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.11it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.22it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.05it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.73it/s]100%|██████████| 16/16 [00:02<00:00,  6.20it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.21it/s] 50%|█████     | 50/100 [00:15<00:15,  3.21it/s] 60%|██████    | 60/100 [00:18<00:12,  3.21it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(179.0860, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5023, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
9 mlp.down_proj
Pruning ...
0.01
torch.Size([11158688])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.82it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.88it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.87it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.88it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.87it/s] 86%|████████▌ | 860/1000 [00:19<00:03, 43.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.94it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.82it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.77it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.41it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.37it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.08it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.53it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.48it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.67it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.49it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.77it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.24it/s]100%|██████████| 16/16 [00:02<00:00,  6.15it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.73it/s] 20%|██        | 20/100 [00:07<00:29,  2.74it/s] 30%|███       | 30/100 [00:10<00:25,  2.73it/s] 40%|████      | 40/100 [00:14<00:21,  2.73it/s] 50%|█████     | 50/100 [00:18<00:18,  2.73it/s] 60%|██████    | 60/100 [00:21<00:14,  2.74it/s] 70%|███████   | 70/100 [00:25<00:10,  2.74it/s] 80%|████████  | 80/100 [00:29<00:07,  2.74it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.74it/s]100%|██████████| 100/100 [00:36<00:00,  2.74it/s]100%|██████████| 100/100 [00:36<00:00,  2.74it/s]
H_error tensor(3.9594, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5277, device='cuda:6', grad_fn=<DivBackward0>)
43075 MiB free out of 48676 MiB total
10 self_attn.q_proj
Pruning ...
0.01
torch.Size([4148984])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.50it/s] 20%|██        | 200/1000 [00:01<00:07, 106.60it/s] 30%|███       | 300/1000 [00:02<00:06, 106.62it/s] 40%|████      | 400/1000 [00:03<00:05, 106.69it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.72it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.70it/s] 60%|██████    | 602/1000 [00:05<00:03, 106.50it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.96it/s] 25%|██▌       | 4/16 [00:00<00:01, 11.23it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.39it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.04it/s] 50%|█████     | 8/16 [00:00<00:00,  9.66it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.34it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.02it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.96it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.84it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.75it/s]100%|██████████| 16/16 [00:01<00:00,  9.51it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.71it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.71it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(349.6580, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5274, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
10 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149208])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.63it/s] 20%|██        | 200/1000 [00:01<00:07, 106.79it/s] 30%|███       | 300/1000 [00:02<00:06, 106.76it/s] 40%|████      | 400/1000 [00:03<00:05, 106.81it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.81it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.78it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.79it/s] 74%|███████▍  | 743/1000 [00:06<00:02, 106.64it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.63it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.40it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.60it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.93it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.34it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.24it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.93it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.81it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.75it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.49it/s]100%|██████████| 16/16 [00:01<00:00,  9.34it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.73it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.72it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.72it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]
H_error tensor(369.0411, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5304, device='cuda:6', grad_fn=<DivBackward0>)
43321 MiB free out of 48676 MiB total
10 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148826])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.62it/s] 20%|██        | 200/1000 [00:01<00:07, 106.74it/s] 30%|███       | 300/1000 [00:02<00:06, 106.74it/s] 40%|████      | 400/1000 [00:03<00:05, 106.77it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.74it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.77it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.77it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.73it/s] 81%|████████  | 808/1000 [00:07<00:01, 106.61it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.33it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.17it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.36it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.17it/s] 50%|█████     | 8/16 [00:00<00:00,  9.72it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.42it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.11it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.75it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.65it/s]100%|██████████| 16/16 [00:01<00:00, 10.08it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.75it/s] 40%|████      | 40/100 [00:04<00:06,  9.75it/s] 50%|█████     | 50/100 [00:05<00:05,  9.73it/s] 60%|██████    | 60/100 [00:06<00:04,  9.73it/s] 70%|███████   | 70/100 [00:07<00:03,  9.73it/s] 80%|████████  | 80/100 [00:08<00:02,  9.73it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.75it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]
H_error tensor(132.4953, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5047, device='cuda:6', grad_fn=<DivBackward0>)
43289 MiB free out of 48676 MiB total
10 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148882])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.56it/s] 20%|██        | 200/1000 [00:01<00:07, 106.73it/s] 30%|███       | 300/1000 [00:02<00:06, 106.78it/s] 40%|████      | 400/1000 [00:03<00:05, 106.80it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.74it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.76it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.77it/s] 74%|███████▍  | 741/1000 [00:06<00:02, 106.61it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.32it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.13it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.32it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.15it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.01it/s] 50%|█████     | 8/16 [00:00<00:00,  9.59it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.52it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.56it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.36it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.18it/s]100%|██████████| 16/16 [00:01<00:00,  9.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.80it/s] 20%|██        | 20/100 [00:02<00:08,  9.80it/s] 30%|███       | 30/100 [00:03<00:07,  9.79it/s] 40%|████      | 40/100 [00:04<00:06,  9.76it/s] 50%|█████     | 50/100 [00:05<00:05,  9.74it/s] 60%|██████    | 60/100 [00:06<00:04,  9.73it/s] 70%|███████   | 70/100 [00:07<00:03,  9.72it/s] 80%|████████  | 80/100 [00:08<00:02,  9.72it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.73it/s]
H_error tensor(28.2773, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5419, device='cuda:6', grad_fn=<DivBackward0>)
43321 MiB free out of 48676 MiB total
10 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150387])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.83it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.89it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 77%|███████▋  | 770/1000 [00:17<00:05, 43.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.24it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.28it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.22it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.76it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.98it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.56it/s] 50%|█████     | 8/16 [00:01<00:01,  7.12it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.45it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.10it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.16it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.31it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.26it/s]100%|██████████| 16/16 [00:02<00:00,  7.35it/s]100%|██████████| 16/16 [00:02<00:00,  6.92it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.16it/s] 20%|██        | 20/100 [00:06<00:25,  3.15it/s] 30%|███       | 30/100 [00:09<00:22,  3.15it/s] 40%|████      | 40/100 [00:12<00:19,  3.15it/s] 50%|█████     | 50/100 [00:15<00:15,  3.15it/s] 60%|██████    | 60/100 [00:19<00:12,  3.15it/s] 70%|███████   | 70/100 [00:22<00:09,  3.15it/s] 80%|████████  | 80/100 [00:25<00:06,  3.15it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.15it/s]100%|██████████| 100/100 [00:31<00:00,  3.16it/s]100%|██████████| 100/100 [00:31<00:00,  3.15it/s]
H_error tensor(218.9995, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5062, device='cuda:6', grad_fn=<DivBackward0>)
43235 MiB free out of 48676 MiB total
10 mlp.up_proj
Pruning ...
0.01
torch.Size([11150051])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.84it/s] 20%|██        | 200/1000 [00:04<00:18, 43.88it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.85it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.84it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.54it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.61it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.67it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.54it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.68it/s] 50%|█████     | 8/16 [00:01<00:01,  6.81it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.29it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.19it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.46it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.49it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.18it/s] 88%|████████▊ | 14/16 [00:02<00:00,  5.92it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.50it/s]100%|██████████| 16/16 [00:02<00:00,  6.33it/s]100%|██████████| 16/16 [00:02<00:00,  6.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.23it/s] 20%|██        | 20/100 [00:06<00:24,  3.23it/s] 30%|███       | 30/100 [00:09<00:21,  3.23it/s] 40%|████      | 40/100 [00:12<00:18,  3.23it/s] 50%|█████     | 50/100 [00:15<00:15,  3.23it/s] 60%|██████    | 60/100 [00:18<00:12,  3.23it/s] 70%|███████   | 70/100 [00:21<00:09,  3.23it/s] 80%|████████  | 80/100 [00:24<00:06,  3.23it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.23it/s]100%|██████████| 100/100 [00:30<00:00,  3.23it/s]100%|██████████| 100/100 [00:30<00:00,  3.23it/s]
H_error tensor(197.2587, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5040, device='cuda:6', grad_fn=<DivBackward0>)
43267 MiB free out of 48676 MiB total
10 mlp.down_proj
Pruning ...
0.01
torch.Size([11158774])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.73it/s] 20%|██        | 200/1000 [00:04<00:18, 43.81it/s] 30%|███       | 300/1000 [00:06<00:15, 43.84it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 90%|████████▉ | 899/1000 [00:20<00:02, 43.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.93it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.37it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.42it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.54it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.21it/s] 44%|████▍     | 7/16 [00:01<00:01,  5.93it/s] 50%|█████     | 8/16 [00:01<00:01,  6.62it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.90it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.98it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.67it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.92it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.41it/s]100%|██████████| 16/16 [00:02<00:00,  7.41it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.70it/s] 20%|██        | 20/100 [00:07<00:29,  2.71it/s] 30%|███       | 30/100 [00:11<00:25,  2.72it/s] 40%|████      | 40/100 [00:14<00:22,  2.72it/s] 50%|█████     | 50/100 [00:18<00:18,  2.72it/s] 60%|██████    | 60/100 [00:22<00:14,  2.72it/s] 70%|███████   | 70/100 [00:25<00:11,  2.72it/s] 80%|████████  | 80/100 [00:29<00:07,  2.72it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.72it/s]100%|██████████| 100/100 [00:36<00:00,  2.72it/s]100%|██████████| 100/100 [00:36<00:00,  2.72it/s]
H_error tensor(4.1937, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5317, device='cuda:6', grad_fn=<DivBackward0>)
42903 MiB free out of 48676 MiB total
11 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149007])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.51it/s] 20%|██        | 200/1000 [00:01<00:07, 106.66it/s] 30%|███       | 300/1000 [00:02<00:06, 106.63it/s] 40%|████      | 400/1000 [00:03<00:05, 106.69it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.66it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.67it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.69it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.68it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.69it/s] 98%|█████████▊| 978/1000 [00:09<00:00, 106.57it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.07it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.30it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.02it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.36it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.19it/s] 50%|█████     | 8/16 [00:00<00:00, 10.84it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.29it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.84it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.35it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.23it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.05it/s]100%|██████████| 16/16 [00:01<00:00,  9.71it/s]100%|██████████| 16/16 [00:01<00:00,  9.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(293.1872, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5297, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
11 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149284])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.81it/s] 20%|██        | 200/1000 [00:01<00:07, 106.97it/s] 30%|███       | 300/1000 [00:02<00:06, 107.00it/s] 40%|████      | 400/1000 [00:03<00:05, 107.07it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.04it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.08it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.10it/s] 80%|████████  | 800/1000 [00:07<00:01, 107.13it/s] 90%|█████████ | 900/1000 [00:08<00:00, 107.11it/s]100%|██████████| 1000/1000 [00:09<00:00, 107.09it/s]100%|██████████| 1000/1000 [00:09<00:00, 107.07it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.79it/s] 25%|██▌       | 4/16 [00:00<00:00, 12.09it/s] 38%|███▊      | 6/16 [00:00<00:00, 11.28it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.61it/s] 50%|█████     | 8/16 [00:00<00:00, 10.20it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.01it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.65it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.86it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.59it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.58it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.38it/s]100%|██████████| 16/16 [00:01<00:00, 10.06it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.74it/s] 30%|███       | 30/100 [00:03<00:07,  9.74it/s] 40%|████      | 40/100 [00:04<00:06,  9.73it/s] 50%|█████     | 50/100 [00:05<00:05,  9.74it/s] 60%|██████    | 60/100 [00:06<00:04,  9.74it/s] 70%|███████   | 70/100 [00:07<00:03,  9.73it/s] 80%|████████  | 80/100 [00:08<00:02,  9.74it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.73it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]
H_error tensor(309.6537, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5280, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
11 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148811])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.73it/s] 20%|██        | 200/1000 [00:01<00:07, 106.89it/s] 30%|███       | 300/1000 [00:02<00:06, 106.92it/s] 40%|████      | 400/1000 [00:03<00:05, 106.99it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.02it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.04it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.01it/s] 71%|███████   | 708/1000 [00:06<00:02, 106.83it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.27it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.57it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.94it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.65it/s] 50%|█████     | 8/16 [00:00<00:00,  9.64it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.55it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.33it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.36it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.36it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.62it/s]100%|██████████| 16/16 [00:01<00:00, 10.09it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.71it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.65it/s] 60%|██████    | 60/100 [00:06<00:04,  9.65it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.65it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]
H_error tensor(116.7383, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5086, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
11 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148789])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.82it/s] 20%|██        | 200/1000 [00:01<00:07, 106.93it/s] 30%|███       | 300/1000 [00:02<00:06, 106.99it/s] 40%|████      | 400/1000 [00:03<00:05, 106.97it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.02it/s] 59%|█████▊    | 586/1000 [00:05<00:03, 106.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.91it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.34it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.36it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.87it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.41it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.59it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.29it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.10it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.77it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.36it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]100%|██████████| 16/16 [00:01<00:00, 10.06it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(20.1891, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5335, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
11 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150352])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.85it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.82it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.81it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.80it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.80it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.56it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.29it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.30it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.11it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.45it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.02it/s] 50%|█████     | 8/16 [00:01<00:01,  6.11it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.67it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.63it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.24it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.69it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.88it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.93it/s]100%|██████████| 16/16 [00:02<00:00,  7.56it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.19it/s] 40%|████      | 40/100 [00:12<00:18,  3.19it/s] 50%|█████     | 50/100 [00:15<00:15,  3.19it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(225.2220, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5028, device='cuda:6', grad_fn=<DivBackward0>)
43029 MiB free out of 48676 MiB total
11 mlp.up_proj
Pruning ...
0.01
torch.Size([11150140])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.78it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.83it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.82it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.79it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.79it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.79it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.78it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.78it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.79it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.93it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.77it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.45it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.26it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.07it/s] 50%|█████     | 8/16 [00:01<00:01,  7.70it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.84it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.97it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.46it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.97it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.47it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.03it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.29it/s]100%|██████████| 16/16 [00:02<00:00,  6.80it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.16it/s] 20%|██        | 20/100 [00:06<00:25,  3.16it/s] 30%|███       | 30/100 [00:09<00:22,  3.16it/s] 40%|████      | 40/100 [00:12<00:18,  3.16it/s] 50%|█████     | 50/100 [00:15<00:15,  3.16it/s] 60%|██████    | 60/100 [00:18<00:12,  3.16it/s] 70%|███████   | 70/100 [00:22<00:09,  3.16it/s] 80%|████████  | 80/100 [00:25<00:06,  3.16it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.16it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.16it/s]
H_error tensor(213.1450, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5019, device='cuda:6', grad_fn=<DivBackward0>)
43061 MiB free out of 48676 MiB total
11 mlp.down_proj
Pruning ...
0.01
torch.Size([11158749])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.76it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.88it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.87it/s] 74%|███████▎  | 736/1000 [00:16<00:06, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.38it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.32it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.58it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.58it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.37it/s] 38%|███▊      | 6/16 [00:01<00:01,  5.91it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.76it/s] 50%|█████     | 8/16 [00:01<00:01,  7.35it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.11it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.73it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.80it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.98it/s] 88%|████████▊ | 14/16 [00:02<00:00,  8.48it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.30it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.73it/s] 20%|██        | 20/100 [00:07<00:29,  2.73it/s] 30%|███       | 30/100 [00:10<00:25,  2.73it/s] 40%|████      | 40/100 [00:14<00:21,  2.73it/s] 50%|█████     | 50/100 [00:18<00:18,  2.74it/s] 60%|██████    | 60/100 [00:21<00:14,  2.74it/s] 70%|███████   | 70/100 [00:25<00:10,  2.74it/s] 80%|████████  | 80/100 [00:29<00:07,  2.74it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.74it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(5.0069, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5267, device='cuda:6', grad_fn=<DivBackward0>)
42915 MiB free out of 48676 MiB total
12 self_attn.q_proj
Pruning ...
0.01
torch.Size([4148963])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.76it/s] 20%|██        | 200/1000 [00:01<00:07, 106.93it/s] 30%|███       | 300/1000 [00:02<00:06, 106.91it/s] 40%|████      | 400/1000 [00:03<00:05, 107.01it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.04it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.08it/s] 68%|██████▊   | 684/1000 [00:06<00:02, 106.87it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.98it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.92it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.70it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.69it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.12it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.53it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.08it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.69it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.33it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.01it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.89it/s]100%|██████████| 16/16 [00:01<00:00,  9.82it/s]100%|██████████| 16/16 [00:01<00:00, 10.07it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.72it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.71it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(369.0954, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5237, device='cuda:6', grad_fn=<DivBackward0>)
42827 MiB free out of 48676 MiB total
12 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149282])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.68it/s] 20%|██        | 200/1000 [00:01<00:07, 106.87it/s] 30%|███       | 300/1000 [00:02<00:06, 106.92it/s] 40%|████      | 400/1000 [00:03<00:05, 106.95it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.87it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.90it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.87it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.84it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.78it/s] 94%|█████████▍| 939/1000 [00:08<00:00, 106.72it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.81it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.85it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.48it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.61it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.12it/s] 50%|█████     | 8/16 [00:00<00:00,  9.84it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.20it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.53it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.17it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.27it/s]100%|██████████| 16/16 [00:01<00:00,  9.93it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.82it/s] 20%|██        | 20/100 [00:02<00:08,  9.78it/s] 30%|███       | 30/100 [00:03<00:07,  9.75it/s] 40%|████      | 40/100 [00:04<00:06,  9.74it/s] 50%|█████     | 50/100 [00:05<00:05,  9.73it/s] 60%|██████    | 60/100 [00:06<00:04,  9.73it/s] 70%|███████   | 70/100 [00:07<00:03,  9.73it/s] 80%|████████  | 80/100 [00:08<00:02,  9.72it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.73it/s]
H_error tensor(387.3144, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5274, device='cuda:6', grad_fn=<DivBackward0>)
42859 MiB free out of 48676 MiB total
12 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148814])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.71it/s] 20%|██        | 200/1000 [00:01<00:07, 106.95it/s] 30%|███       | 300/1000 [00:02<00:06, 107.04it/s] 40%|████      | 400/1000 [00:03<00:05, 107.07it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.14it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.17it/s] 65%|██████▌   | 654/1000 [00:06<00:03, 106.94it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.18it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.32it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.45it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.91it/s] 50%|█████     | 8/16 [00:00<00:00, 10.17it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.85it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.05it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.68it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.04it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.90it/s]100%|██████████| 16/16 [00:01<00:00, 10.11it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(148.7561, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5091, device='cuda:6', grad_fn=<DivBackward0>)
42891 MiB free out of 48676 MiB total
12 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148876])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.64it/s] 20%|██        | 200/1000 [00:01<00:07, 106.85it/s] 30%|███       | 300/1000 [00:02<00:06, 106.92it/s] 40%|████      | 400/1000 [00:03<00:05, 107.00it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.99it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.05it/s] 68%|██████▊   | 681/1000 [00:06<00:02, 106.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.82it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.95it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.87it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.12it/s] 50%|█████     | 8/16 [00:00<00:00,  9.80it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.48it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.56it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.43it/s] 88%|████████▊ | 14/16 [00:01<00:00, 11.09it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.47it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]100%|██████████| 16/16 [00:01<00:00, 10.10it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(20.8492, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5380, device='cuda:6', grad_fn=<DivBackward0>)
42891 MiB free out of 48676 MiB total
12 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150389])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.83it/s] 20%|██        | 200/1000 [00:04<00:18, 43.87it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.89it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.88it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.87it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.87it/s] 82%|████████▏ | 818/1000 [00:18<00:04, 43.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.22it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.84it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.37it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.17it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.92it/s] 44%|████▍     | 7/16 [00:00<00:01,  6.98it/s] 50%|█████     | 8/16 [00:01<00:01,  6.51it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.46it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.11it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.38it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.12it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.51it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.46it/s]100%|██████████| 16/16 [00:02<00:00,  6.72it/s]100%|██████████| 16/16 [00:02<00:00,  6.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.19it/s] 40%|████      | 40/100 [00:12<00:18,  3.19it/s] 50%|█████     | 50/100 [00:15<00:15,  3.19it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(268.7659, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5065, device='cuda:6', grad_fn=<DivBackward0>)
42805 MiB free out of 48676 MiB total
12 mlp.up_proj
Pruning ...
0.01
torch.Size([11150069])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.82it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.87it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 76%|███████▌  | 755/1000 [00:17<00:05, 43.79it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.28it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.98it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.99it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.02it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.61it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.04it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.33it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.11it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.33it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.04it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.09it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.10it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.15it/s]100%|██████████| 16/16 [00:02<00:00,  6.65it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:24,  3.20it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.21it/s] 50%|█████     | 50/100 [00:15<00:15,  3.21it/s] 60%|██████    | 60/100 [00:18<00:12,  3.21it/s] 70%|███████   | 70/100 [00:21<00:09,  3.21it/s] 80%|████████  | 80/100 [00:24<00:06,  3.21it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]
H_error tensor(245.5535, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5037, device='cuda:6', grad_fn=<DivBackward0>)
42837 MiB free out of 48676 MiB total
12 mlp.down_proj
Pruning ...
0.01
torch.Size([11158717])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.73it/s] 20%|██        | 200/1000 [00:04<00:18, 43.12it/s] 30%|███       | 300/1000 [00:06<00:16, 43.46it/s] 40%|████      | 400/1000 [00:09<00:13, 43.63it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.70it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.66it/s] 70%|███████   | 700/1000 [00:16<00:06, 43.73it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.77it/s] 81%|████████  | 808/1000 [00:18<00:04, 43.61it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.55it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.48it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.86it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.47it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.89it/s] 50%|█████     | 8/16 [00:01<00:01,  7.98it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.70it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.91it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.33it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.82it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.76it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.20it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.50it/s]100%|██████████| 16/16 [00:02<00:00,  6.35it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.73it/s] 20%|██        | 20/100 [00:07<00:29,  2.73it/s] 30%|███       | 30/100 [00:10<00:25,  2.73it/s] 40%|████      | 40/100 [00:14<00:21,  2.73it/s] 50%|█████     | 50/100 [00:18<00:18,  2.73it/s] 60%|██████    | 60/100 [00:21<00:14,  2.73it/s] 70%|███████   | 70/100 [00:25<00:10,  2.73it/s] 80%|████████  | 80/100 [00:29<00:07,  2.73it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(5.8541, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5269, device='cuda:6', grad_fn=<DivBackward0>)
42983 MiB free out of 48676 MiB total
13 self_attn.q_proj
Pruning ...
0.01
torch.Size([4148975])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.39it/s] 20%|██        | 200/1000 [00:01<00:07, 106.58it/s] 30%|███       | 300/1000 [00:02<00:06, 106.65it/s] 40%|████      | 400/1000 [00:03<00:05, 106.63it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.65it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.70it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.71it/s] 73%|███████▎  | 734/1000 [00:06<00:02, 106.52it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.83it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.34it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.20it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.93it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.71it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.15it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.90it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.18it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.88it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.58it/s]100%|██████████| 16/16 [00:01<00:00,  9.79it/s]100%|██████████| 16/16 [00:01<00:00,  9.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.69it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.72it/s] 40%|████      | 40/100 [00:04<00:06,  9.72it/s] 50%|█████     | 50/100 [00:05<00:05,  9.73it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.72it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]
H_error tensor(486.5986, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5281, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
13 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149314])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.92it/s] 20%|██        | 200/1000 [00:01<00:07, 107.14it/s] 30%|███       | 300/1000 [00:02<00:06, 107.14it/s] 40%|████      | 400/1000 [00:03<00:05, 107.12it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.14it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.13it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.11it/s] 76%|███████▌  | 758/1000 [00:07<00:02, 106.98it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.01it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.21it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.70it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.01it/s] 50%|█████     | 8/16 [00:00<00:00, 10.35it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.07it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.08it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.34it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.00it/s]100%|██████████| 16/16 [00:01<00:00, 10.12it/s]100%|██████████| 16/16 [00:01<00:00, 10.09it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.79it/s] 20%|██        | 20/100 [00:02<00:08,  9.79it/s] 30%|███       | 30/100 [00:03<00:07,  9.79it/s] 40%|████      | 40/100 [00:04<00:06,  9.79it/s] 50%|█████     | 50/100 [00:05<00:05,  9.80it/s] 60%|██████    | 60/100 [00:06<00:04,  9.80it/s] 70%|███████   | 70/100 [00:07<00:03,  9.80it/s] 80%|████████  | 80/100 [00:08<00:02,  9.80it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.80it/s]100%|██████████| 100/100 [00:10<00:00,  9.80it/s]100%|██████████| 100/100 [00:10<00:00,  9.80it/s]
H_error tensor(502.7752, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5310, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
13 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148818])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.61it/s] 20%|██        | 200/1000 [00:01<00:07, 106.71it/s] 30%|███       | 300/1000 [00:02<00:06, 106.73it/s] 40%|████      | 400/1000 [00:03<00:05, 106.79it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.89it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.90it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.92it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.92it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.92it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.90it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.86it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.63it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.97it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.47it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.90it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.21it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.62it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.75it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.24it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.91it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.67it/s]100%|██████████| 16/16 [00:01<00:00,  9.59it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.79it/s] 30%|███       | 30/100 [00:03<00:07,  9.80it/s] 40%|████      | 40/100 [00:04<00:06,  9.77it/s] 50%|█████     | 50/100 [00:05<00:05,  9.73it/s] 60%|██████    | 60/100 [00:06<00:04,  9.72it/s] 70%|███████   | 70/100 [00:07<00:03,  9.71it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]
H_error tensor(216.5451, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5217, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
13 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148795])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.78it/s] 20%|██        | 200/1000 [00:01<00:07, 106.78it/s] 30%|███       | 300/1000 [00:02<00:06, 106.79it/s] 40%|████      | 400/1000 [00:03<00:05, 106.84it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.90it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.94it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.92it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.91it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.92it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.89it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.88it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.63it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.75it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.58it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.33it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.12it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.18it/s] 50%|█████     | 8/16 [00:00<00:00,  8.99it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.31it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.49it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.87it/s]100%|██████████| 16/16 [00:01<00:00, 10.36it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.78it/s] 30%|███       | 30/100 [00:03<00:07,  9.75it/s] 40%|████      | 40/100 [00:04<00:06,  9.73it/s] 50%|█████     | 50/100 [00:05<00:05,  9.75it/s] 60%|██████    | 60/100 [00:06<00:04,  9.77it/s] 70%|███████   | 70/100 [00:07<00:03,  9.77it/s] 80%|████████  | 80/100 [00:08<00:02,  9.77it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.76it/s]100%|██████████| 100/100 [00:10<00:00,  9.76it/s]
H_error tensor(23.2021, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5350, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
13 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150416])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.76it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.85it/s] 40%|████      | 400/1000 [00:09<00:13, 43.85it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.82it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.82it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.81it/s] 98%|█████████▊| 979/1000 [00:22<00:00, 43.78it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.58it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.40it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.84it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.31it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.93it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.07it/s] 50%|█████     | 8/16 [00:01<00:01,  7.37it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.28it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.26it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.61it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.99it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.67it/s]100%|██████████| 16/16 [00:02<00:00,  6.24it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.17it/s] 20%|██        | 20/100 [00:06<00:25,  3.16it/s] 30%|███       | 30/100 [00:09<00:22,  3.17it/s] 40%|████      | 40/100 [00:12<00:18,  3.17it/s] 50%|█████     | 50/100 [00:15<00:15,  3.17it/s] 60%|██████    | 60/100 [00:18<00:12,  3.17it/s] 70%|███████   | 70/100 [00:22<00:09,  3.17it/s] 80%|████████  | 80/100 [00:25<00:06,  3.16it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]
H_error tensor(360.4695, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5230, device='cuda:6', grad_fn=<DivBackward0>)
43093 MiB free out of 48676 MiB total
13 mlp.up_proj
Pruning ...
0.01
torch.Size([11150081])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.67it/s] 20%|██        | 200/1000 [00:04<00:18, 43.76it/s] 30%|███       | 300/1000 [00:06<00:15, 43.79it/s] 40%|████      | 400/1000 [00:09<00:13, 43.80it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.78it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.77it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.76it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.76it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.76it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.76it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.76it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.19it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.94it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.56it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.71it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.58it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.00it/s] 50%|█████     | 8/16 [00:01<00:01,  7.56it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.93it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.05it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.22it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.16it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.59it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.77it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.24it/s] 20%|██        | 20/100 [00:06<00:24,  3.25it/s] 30%|███       | 30/100 [00:09<00:21,  3.25it/s] 40%|████      | 40/100 [00:12<00:18,  3.25it/s] 50%|█████     | 50/100 [00:15<00:15,  3.25it/s] 60%|██████    | 60/100 [00:18<00:12,  3.25it/s] 70%|███████   | 70/100 [00:21<00:09,  3.25it/s] 80%|████████  | 80/100 [00:24<00:06,  3.25it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.25it/s]100%|██████████| 100/100 [00:30<00:00,  3.26it/s]100%|██████████| 100/100 [00:30<00:00,  3.25it/s]
H_error tensor(321.7069, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5211, device='cuda:6', grad_fn=<DivBackward0>)
43079 MiB free out of 48676 MiB total
13 mlp.down_proj
Pruning ...
0.01
torch.Size([11158794])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.80it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.83it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.83it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.25it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.05it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.35it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.04it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.67it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.40it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.63it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.02it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.99it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.36it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.33it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.49it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.96it/s]100%|██████████| 16/16 [00:02<00:00,  6.47it/s]100%|██████████| 16/16 [00:02<00:00,  6.90it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.73it/s] 20%|██        | 20/100 [00:07<00:29,  2.73it/s] 30%|███       | 30/100 [00:10<00:25,  2.73it/s] 40%|████      | 40/100 [00:14<00:21,  2.73it/s] 50%|█████     | 50/100 [00:18<00:18,  2.74it/s] 60%|██████    | 60/100 [00:21<00:14,  2.73it/s] 70%|███████   | 70/100 [00:25<00:10,  2.73it/s] 80%|████████  | 80/100 [00:29<00:07,  2.73it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(6.3637, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5295, device='cuda:6', grad_fn=<DivBackward0>)
42933 MiB free out of 48676 MiB total
14 self_attn.q_proj
Pruning ...
0.01
torch.Size([4148982])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.77it/s] 20%|██        | 200/1000 [00:01<00:07, 106.96it/s] 30%|███       | 300/1000 [00:02<00:06, 107.06it/s] 40%|████      | 400/1000 [00:03<00:05, 107.07it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.09it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.14it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.13it/s] 80%|████████  | 800/1000 [00:07<00:01, 107.14it/s] 88%|████████▊ | 881/1000 [00:08<00:01, 106.97it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.76it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.79it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.16it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.03it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.01it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.01it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.06it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.83it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.50it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.28it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.75it/s]100%|██████████| 16/16 [00:01<00:00, 10.09it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.72it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(435.3894, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5287, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
14 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149278])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.73it/s] 20%|██        | 200/1000 [00:01<00:07, 106.81it/s] 30%|███       | 300/1000 [00:02<00:06, 106.81it/s] 40%|████      | 400/1000 [00:03<00:05, 106.87it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.88it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.90it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.87it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.89it/s] 84%|████████▍ | 842/1000 [00:07<00:01, 106.75it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.17it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.52it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.34it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.25it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.84it/s] 50%|█████     | 8/16 [00:00<00:00,  9.51it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.10it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.06it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.38it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.16it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.79it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.77it/s] 30%|███       | 30/100 [00:03<00:07,  9.76it/s] 40%|████      | 40/100 [00:04<00:06,  9.74it/s] 50%|█████     | 50/100 [00:05<00:05,  9.73it/s] 60%|██████    | 60/100 [00:06<00:04,  9.72it/s] 70%|███████   | 70/100 [00:07<00:03,  9.72it/s] 80%|████████  | 80/100 [00:08<00:02,  9.72it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.73it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.73it/s]
H_error tensor(436.9029, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5291, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
14 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148821])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.84it/s] 20%|██        | 200/1000 [00:01<00:07, 106.98it/s] 30%|███       | 300/1000 [00:02<00:06, 107.03it/s] 40%|████      | 400/1000 [00:03<00:05, 107.06it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.03it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.99it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.96it/s] 76%|███████▌  | 760/1000 [00:07<00:02, 106.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.77it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.69it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.11it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.85it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.87it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.01it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.62it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.11it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.73it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.50it/s]100%|██████████| 16/16 [00:01<00:00,  9.34it/s]100%|██████████| 16/16 [00:01<00:00, 10.07it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(323.4251, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5311, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
14 self_attn.o_proj
Pruning ...
0.01
torch.Size([4149294])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.71it/s] 20%|██        | 200/1000 [00:01<00:07, 106.72it/s] 30%|███       | 300/1000 [00:02<00:06, 106.78it/s] 40%|████      | 400/1000 [00:03<00:05, 106.83it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.87it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.84it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.81it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.81it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.79it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.81it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.66it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.43it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.99it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.87it/s] 50%|█████     | 8/16 [00:00<00:00, 10.59it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.08it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.88it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.34it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.92it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.76it/s]100%|██████████| 16/16 [00:01<00:00,  9.53it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(18.2243, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5289, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
14 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150377])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.78it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.83it/s] 40%|████      | 400/1000 [00:09<00:13, 43.82it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.80it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.80it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.79it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.80it/s] 84%|████████▍ | 838/1000 [00:19<00:03, 43.75it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.66it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.83it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.01it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.68it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.33it/s] 50%|█████     | 8/16 [00:00<00:01,  7.56it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.75it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.07it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.70it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.23it/s] 88%|████████▊ | 14/16 [00:01<00:00,  5.99it/s] 94%|█████████▍| 15/16 [00:02<00:00,  5.75it/s]100%|██████████| 16/16 [00:02<00:00,  6.15it/s]100%|██████████| 16/16 [00:02<00:00,  6.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.16it/s] 20%|██        | 20/100 [00:06<00:25,  3.16it/s] 30%|███       | 30/100 [00:09<00:22,  3.17it/s] 40%|████      | 40/100 [00:12<00:18,  3.17it/s] 50%|█████     | 50/100 [00:15<00:15,  3.17it/s] 60%|██████    | 60/100 [00:18<00:12,  3.17it/s] 70%|███████   | 70/100 [00:22<00:09,  3.17it/s] 80%|████████  | 80/100 [00:25<00:06,  3.17it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]
H_error tensor(1358.4373, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5411, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
14 mlp.up_proj
Pruning ...
0.01
torch.Size([11150089])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.75it/s] 20%|██        | 200/1000 [00:04<00:18, 43.79it/s] 30%|███       | 300/1000 [00:06<00:15, 43.81it/s] 40%|████      | 400/1000 [00:09<00:13, 43.81it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.81it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.80it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.79it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.79it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.78it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.74it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.40it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.28it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.58it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.40it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.59it/s] 38%|███▊      | 6/16 [00:01<00:01,  6.42it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.11it/s] 50%|█████     | 8/16 [00:01<00:01,  6.27it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.66it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.88it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.99it/s] 81%|████████▏ | 13/16 [00:02<00:00,  7.00it/s] 94%|█████████▍| 15/16 [00:02<00:00,  8.63it/s]100%|██████████| 16/16 [00:02<00:00,  8.60it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.25it/s] 20%|██        | 20/100 [00:06<00:24,  3.25it/s] 30%|███       | 30/100 [00:09<00:21,  3.24it/s] 40%|████      | 40/100 [00:12<00:18,  3.24it/s] 50%|█████     | 50/100 [00:15<00:15,  3.24it/s] 60%|██████    | 60/100 [00:18<00:12,  3.24it/s] 70%|███████   | 70/100 [00:21<00:09,  3.24it/s] 80%|████████  | 80/100 [00:24<00:06,  3.24it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.25it/s]100%|██████████| 100/100 [00:30<00:00,  3.25it/s]100%|██████████| 100/100 [00:30<00:00,  3.24it/s]
H_error tensor(666.1561, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5273, device='cuda:6', grad_fn=<DivBackward0>)
42657 MiB free out of 48676 MiB total
14 mlp.down_proj
Pruning ...
0.01
torch.Size([11158709])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.83it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.89it/s] 40%|████      | 400/1000 [00:09<00:13, 43.89it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.90it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.88it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.88it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.87it/s] 82%|████████▏ | 816/1000 [00:18<00:04, 43.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.33it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.05it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.25it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.93it/s] 38%|███▊      | 6/16 [00:00<00:01,  5.80it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.44it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.32it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.27it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.34it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.77it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.53it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.02it/s]100%|██████████| 16/16 [00:02<00:00,  6.71it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.76it/s] 20%|██        | 20/100 [00:07<00:29,  2.76it/s] 30%|███       | 30/100 [00:10<00:25,  2.76it/s] 40%|████      | 40/100 [00:14<00:21,  2.76it/s] 50%|█████     | 50/100 [00:18<00:18,  2.76it/s] 60%|██████    | 60/100 [00:21<00:14,  2.76it/s] 70%|███████   | 70/100 [00:25<00:10,  2.76it/s] 80%|████████  | 80/100 [00:28<00:07,  2.76it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.76it/s]100%|██████████| 100/100 [00:36<00:00,  2.76it/s]100%|██████████| 100/100 [00:36<00:00,  2.76it/s]
H_error tensor(7.7290, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5283, device='cuda:6', grad_fn=<DivBackward0>)
42511 MiB free out of 48676 MiB total
15 self_attn.q_proj
Pruning ...
0.01
torch.Size([4148967])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.74it/s] 20%|██        | 200/1000 [00:01<00:07, 106.84it/s] 30%|███       | 300/1000 [00:02<00:06, 106.80it/s] 40%|████      | 400/1000 [00:03<00:05, 106.88it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.97it/s] 58%|█████▊    | 581/1000 [00:05<00:03, 106.74it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.43it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.33it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.01it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.54it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.33it/s] 50%|█████     | 8/16 [00:00<00:00,  9.37it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.30it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.45it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.25it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.99it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.66it/s]100%|██████████| 16/16 [00:01<00:00, 10.05it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.72it/s] 20%|██        | 20/100 [00:02<00:08,  9.67it/s] 30%|███       | 30/100 [00:03<00:07,  9.65it/s] 40%|████      | 40/100 [00:04<00:06,  9.65it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(754.7622, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5379, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
15 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149406])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 105.93it/s] 20%|██        | 200/1000 [00:01<00:07, 106.55it/s] 30%|███       | 300/1000 [00:02<00:06, 106.77it/s] 40%|████      | 400/1000 [00:03<00:05, 106.88it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.78it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.85it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.90it/s] 75%|███████▌  | 753/1000 [00:07<00:02, 106.68it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.96it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.49it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.23it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.15it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.04it/s] 50%|█████     | 8/16 [00:00<00:00,  9.67it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.16it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.12it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.90it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.56it/s]100%|██████████| 16/16 [00:01<00:00, 10.43it/s]100%|██████████| 16/16 [00:01<00:00, 10.05it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.72it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(731.8877, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5403, device='cuda:6', grad_fn=<DivBackward0>)
43117 MiB free out of 48676 MiB total
15 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148812])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.51it/s] 20%|██        | 200/1000 [00:01<00:07, 106.73it/s] 30%|███       | 300/1000 [00:02<00:06, 106.82it/s] 40%|████      | 400/1000 [00:03<00:05, 106.84it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.86it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.86it/s] 66%|██████▋   | 663/1000 [00:06<00:03, 106.67it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.68it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.80it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.72it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.02it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.34it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.19it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.07it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.97it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.83it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.05it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(239.8982, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5450, device='cuda:6', grad_fn=<DivBackward0>)
43085 MiB free out of 48676 MiB total
15 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148780])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.66it/s] 20%|██        | 200/1000 [00:01<00:07, 106.82it/s] 30%|███       | 300/1000 [00:02<00:06, 106.84it/s] 40%|████      | 400/1000 [00:03<00:05, 106.82it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.81it/s] 55%|█████▌    | 553/1000 [00:05<00:04, 106.61it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.72it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.50it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.28it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.92it/s] 50%|█████     | 8/16 [00:00<00:00, 10.40it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.16it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.87it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.57it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.83it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]100%|██████████| 16/16 [00:01<00:00, 10.05it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(14.2777, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5221, device='cuda:6', grad_fn=<DivBackward0>)
43117 MiB free out of 48676 MiB total
15 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150305])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.83it/s] 86%|████████▋ | 863/1000 [00:19<00:03, 43.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.52it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.26it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.29it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.32it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.66it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.18it/s] 50%|█████     | 8/16 [00:01<00:01,  6.77it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.36it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.96it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.07it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.49it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.86it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.28it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.23it/s] 20%|██        | 20/100 [00:06<00:24,  3.23it/s] 30%|███       | 30/100 [00:09<00:21,  3.24it/s] 40%|████      | 40/100 [00:12<00:18,  3.24it/s] 50%|█████     | 50/100 [00:15<00:15,  3.23it/s] 60%|██████    | 60/100 [00:18<00:12,  3.24it/s] 70%|███████   | 70/100 [00:21<00:09,  3.24it/s] 80%|████████  | 80/100 [00:24<00:06,  3.24it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.24it/s]100%|██████████| 100/100 [00:30<00:00,  3.24it/s]100%|██████████| 100/100 [00:30<00:00,  3.24it/s]
H_error tensor(716.7391, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5402, device='cuda:6', grad_fn=<DivBackward0>)
43031 MiB free out of 48676 MiB total
15 mlp.up_proj
Pruning ...
0.01
torch.Size([11150079])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.84it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.89it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.85it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.84it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.84it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.93it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.32it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.89it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.78it/s] 44%|████▍     | 7/16 [00:00<00:01,  6.89it/s] 50%|█████     | 8/16 [00:01<00:01,  6.43it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.89it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.39it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.53it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.11it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.25it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.54it/s]100%|██████████| 16/16 [00:02<00:00,  6.13it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(718.0370, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5381, device='cuda:6', grad_fn=<DivBackward0>)
42977 MiB free out of 48676 MiB total
15 mlp.down_proj
Pruning ...
0.01
torch.Size([11158738])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.78it/s] 20%|██        | 200/1000 [00:04<00:18, 43.83it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.89it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.88it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.87it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.87it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.87it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.87it/s]100%|█████████▉| 997/1000 [00:22<00:00, 43.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.62it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.19it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.06it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.72it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.32it/s] 50%|█████     | 8/16 [00:01<00:01,  7.28it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.19it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.48it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.85it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.43it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.71it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.17it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.79it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.76it/s] 20%|██        | 20/100 [00:07<00:28,  2.76it/s] 30%|███       | 30/100 [00:10<00:25,  2.77it/s] 40%|████      | 40/100 [00:14<00:21,  2.77it/s] 50%|█████     | 50/100 [00:18<00:18,  2.77it/s] 60%|██████    | 60/100 [00:21<00:14,  2.77it/s] 70%|███████   | 70/100 [00:25<00:10,  2.77it/s] 80%|████████  | 80/100 [00:28<00:07,  2.77it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.77it/s]100%|██████████| 100/100 [00:36<00:00,  2.77it/s]100%|██████████| 100/100 [00:36<00:00,  2.77it/s]
H_error tensor(9.6760, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5295, device='cuda:6', grad_fn=<DivBackward0>)
42613 MiB free out of 48676 MiB total
16 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149014])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.57it/s] 20%|██        | 200/1000 [00:01<00:07, 106.70it/s] 30%|███       | 300/1000 [00:02<00:06, 106.79it/s] 40%|████      | 400/1000 [00:03<00:05, 106.80it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.75it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.74it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.70it/s] 71%|███████   | 706/1000 [00:06<00:02, 106.57it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.72it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.15it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.90it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.01it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.77it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.60it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.55it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.21it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.94it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.86it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.66it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(415.7780, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5372, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
16 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149290])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 105.96it/s] 20%|██        | 200/1000 [00:01<00:07, 106.20it/s] 30%|███       | 300/1000 [00:02<00:06, 106.45it/s] 40%|████      | 400/1000 [00:03<00:05, 106.42it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.56it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.62it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.61it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.63it/s] 85%|████████▌ | 853/1000 [00:08<00:01, 106.41it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.58it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.81it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.34it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.08it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.63it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.10it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.72it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.78it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.56it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.32it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.18it/s]100%|██████████| 16/16 [00:01<00:00, 10.40it/s]100%|██████████| 16/16 [00:01<00:00,  9.90it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.72it/s] 20%|██        | 20/100 [00:02<00:08,  9.67it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.65it/s] 50%|█████     | 50/100 [00:05<00:05,  9.65it/s] 60%|██████    | 60/100 [00:06<00:04,  9.65it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.64it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]
H_error tensor(435.5003, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5312, device='cuda:6', grad_fn=<DivBackward0>)
42861 MiB free out of 48676 MiB total
16 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148803])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.12it/s] 20%|██        | 200/1000 [00:01<00:07, 106.22it/s] 30%|███       | 300/1000 [00:02<00:06, 106.39it/s] 40%|████      | 400/1000 [00:03<00:05, 106.50it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.55it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.58it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.61it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.64it/s] 82%|████████▏ | 817/1000 [00:07<00:01, 106.41it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.23it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.63it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.80it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.06it/s] 50%|█████     | 8/16 [00:00<00:00, 10.19it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.47it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.43it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.02it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.74it/s]100%|██████████| 16/16 [00:01<00:00,  9.56it/s]100%|██████████| 16/16 [00:01<00:00,  9.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(228.0948, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5209, device='cuda:6', grad_fn=<DivBackward0>)
42861 MiB free out of 48676 MiB total
16 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148809])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.52it/s] 20%|██        | 200/1000 [00:01<00:07, 106.66it/s] 30%|███       | 300/1000 [00:02<00:06, 106.80it/s] 40%|████      | 400/1000 [00:03<00:05, 106.87it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.94it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.97it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.02it/s] 76%|███████▋  | 765/1000 [00:07<00:02, 106.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.67it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.97it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.92it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.16it/s] 50%|█████     | 8/16 [00:00<00:00, 10.05it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.68it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.42it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.14it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.39it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.04it/s]100%|██████████| 16/16 [00:01<00:00, 10.06it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.81it/s] 20%|██        | 20/100 [00:02<00:08,  9.81it/s] 30%|███       | 30/100 [00:03<00:07,  9.79it/s] 40%|████      | 40/100 [00:04<00:06,  9.75it/s] 50%|█████     | 50/100 [00:05<00:05,  9.74it/s] 60%|██████    | 60/100 [00:06<00:04,  9.72it/s] 70%|███████   | 70/100 [00:07<00:03,  9.72it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.72it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.73it/s]
H_error tensor(8.0305, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5191, device='cuda:6', grad_fn=<DivBackward0>)
42893 MiB free out of 48676 MiB total
16 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150321])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.86it/s] 20%|██        | 200/1000 [00:04<00:18, 43.87it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.84it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.83it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.82it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.42it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.25it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.05it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.19it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.50it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.71it/s] 50%|█████     | 8/16 [00:01<00:00,  8.21it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.54it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.97it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.06it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.09it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.70it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.63it/s]100%|██████████| 16/16 [00:02<00:00,  6.27it/s]100%|██████████| 16/16 [00:02<00:00,  6.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.14it/s] 20%|██        | 20/100 [00:06<00:25,  3.14it/s] 30%|███       | 30/100 [00:09<00:22,  3.15it/s] 40%|████      | 40/100 [00:12<00:19,  3.15it/s] 50%|█████     | 50/100 [00:15<00:15,  3.15it/s] 60%|██████    | 60/100 [00:19<00:12,  3.15it/s] 70%|███████   | 70/100 [00:22<00:09,  3.15it/s] 80%|████████  | 80/100 [00:25<00:06,  3.15it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.15it/s]100%|██████████| 100/100 [00:31<00:00,  3.15it/s]100%|██████████| 100/100 [00:31<00:00,  3.15it/s]
H_error tensor(453.6376, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5200, device='cuda:6', grad_fn=<DivBackward0>)
42807 MiB free out of 48676 MiB total
16 mlp.up_proj
Pruning ...
0.01
torch.Size([11150127])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.76it/s] 20%|██        | 200/1000 [00:04<00:18, 43.80it/s] 30%|███       | 300/1000 [00:06<00:15, 43.80it/s] 40%|████      | 400/1000 [00:09<00:13, 43.79it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.79it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.78it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.77it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.78it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.78it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.78it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.78it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.59it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.27it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.92it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.15it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.73it/s] 50%|█████     | 8/16 [00:01<00:01,  7.66it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.99it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.98it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.33it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.67it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.17it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.10it/s]100%|██████████| 16/16 [00:02<00:00,  6.56it/s]100%|██████████| 16/16 [00:02<00:00,  6.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.17it/s] 20%|██        | 20/100 [00:06<00:25,  3.17it/s] 30%|███       | 30/100 [00:09<00:22,  3.17it/s] 40%|████      | 40/100 [00:12<00:18,  3.17it/s] 50%|█████     | 50/100 [00:15<00:15,  3.17it/s] 60%|██████    | 60/100 [00:18<00:12,  3.17it/s] 70%|███████   | 70/100 [00:22<00:09,  3.17it/s] 80%|████████  | 80/100 [00:25<00:06,  3.17it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]
H_error tensor(451.2334, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5223, device='cuda:6', grad_fn=<DivBackward0>)
42793 MiB free out of 48676 MiB total
16 mlp.down_proj
Pruning ...
0.01
torch.Size([11158737])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.79it/s] 20%|██        | 200/1000 [00:04<00:18, 43.86it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.88it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.88it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.87it/s] 78%|███████▊  | 776/1000 [00:17<00:05, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.96it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.24it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.28it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.01it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.27it/s] 50%|█████     | 8/16 [00:01<00:01,  7.21it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.61it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.24it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.40it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.76it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.26it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.63it/s]100%|██████████| 16/16 [00:02<00:00,  6.77it/s]100%|██████████| 16/16 [00:02<00:00,  6.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.76it/s] 20%|██        | 20/100 [00:07<00:29,  2.76it/s] 30%|███       | 30/100 [00:10<00:25,  2.75it/s] 40%|████      | 40/100 [00:14<00:21,  2.75it/s] 50%|█████     | 50/100 [00:18<00:18,  2.75it/s] 60%|██████    | 60/100 [00:21<00:14,  2.75it/s] 70%|███████   | 70/100 [00:25<00:10,  2.76it/s] 80%|████████  | 80/100 [00:29<00:07,  2.76it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.76it/s]100%|██████████| 100/100 [00:36<00:00,  2.76it/s]100%|██████████| 100/100 [00:36<00:00,  2.76it/s]
H_error tensor(12.6033, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5297, device='cuda:6', grad_fn=<DivBackward0>)
42939 MiB free out of 48676 MiB total
17 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149008])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.82it/s] 20%|██        | 200/1000 [00:01<00:07, 107.01it/s] 30%|███       | 300/1000 [00:02<00:06, 107.07it/s] 40%|████      | 400/1000 [00:03<00:05, 107.08it/s] 47%|████▋     | 466/1000 [00:04<00:04, 106.83it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.38it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.89it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.41it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.97it/s] 50%|█████     | 8/16 [00:00<00:00,  9.62it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.44it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.10it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.82it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.79it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.99it/s]100%|██████████| 16/16 [00:01<00:00, 10.08it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.71it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.71it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(410.0487, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5306, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
17 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149410])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.90it/s] 20%|██        | 200/1000 [00:01<00:07, 107.04it/s] 30%|███       | 300/1000 [00:02<00:06, 107.06it/s] 40%|████      | 400/1000 [00:03<00:05, 107.08it/s] 42%|████▏     | 423/1000 [00:03<00:05, 106.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.01it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.96it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.84it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.56it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.62it/s] 50%|█████     | 8/16 [00:00<00:00, 10.25it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.83it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.59it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.92it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.22it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.06it/s]100%|██████████| 16/16 [00:01<00:00, 10.09it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.72it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.72it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.71it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(417.9925, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5320, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
17 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148813])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.70it/s] 20%|██        | 200/1000 [00:01<00:07, 106.84it/s] 30%|███       | 300/1000 [00:02<00:06, 106.93it/s] 40%|████      | 400/1000 [00:03<00:05, 106.97it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.96it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.97it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.98it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.94it/s] 88%|████████▊ | 885/1000 [00:08<00:01, 106.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.61it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.66it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.32it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.17it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.18it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.97it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.75it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.35it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.50it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.05it/s]100%|██████████| 16/16 [00:01<00:00, 10.38it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.80it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.74it/s] 40%|████      | 40/100 [00:04<00:06,  9.72it/s] 50%|█████     | 50/100 [00:05<00:05,  9.73it/s] 60%|██████    | 60/100 [00:06<00:04,  9.72it/s] 70%|███████   | 70/100 [00:07<00:03,  9.72it/s] 80%|████████  | 80/100 [00:08<00:02,  9.72it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]
H_error tensor(236.0695, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5086, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
17 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148781])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.55it/s] 20%|██        | 200/1000 [00:01<00:07, 106.80it/s] 30%|███       | 300/1000 [00:02<00:06, 106.88it/s] 40%|████      | 400/1000 [00:03<00:05, 106.94it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.96it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.97it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.96it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.93it/s] 82%|████████▎ | 825/1000 [00:07<00:01, 106.78it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.73it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.68it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.09it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.62it/s] 50%|█████     | 8/16 [00:00<00:00, 10.00it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.70it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.55it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.46it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.01it/s]100%|██████████| 16/16 [00:01<00:00,  9.75it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.72it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(23.7313, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5216, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
17 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150277])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.89it/s] 20%|██        | 200/1000 [00:04<00:18, 43.88it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.85it/s] 93%|█████████▎| 930/1000 [00:21<00:01, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.30it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.83it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.53it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.81it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.99it/s] 50%|█████     | 8/16 [00:01<00:01,  6.68it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.03it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.15it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.89it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.99it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.50it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.48it/s]100%|██████████| 16/16 [00:02<00:00,  7.11it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.22it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.23it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(468.4025, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5110, device='cuda:6', grad_fn=<DivBackward0>)
43061 MiB free out of 48676 MiB total
17 mlp.up_proj
Pruning ...
0.01
torch.Size([11150061])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.86it/s] 20%|██        | 200/1000 [00:04<00:18, 43.90it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.84it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.84it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.85it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.83it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.64it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.38it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.61it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.38it/s] 44%|████▍     | 7/16 [00:00<00:01,  6.66it/s] 50%|█████     | 8/16 [00:01<00:01,  6.10it/s] 56%|█████▋    | 9/16 [00:01<00:01,  5.82it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.11it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.97it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.43it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.32it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:24,  3.20it/s] 30%|███       | 30/100 [00:09<00:21,  3.20it/s] 40%|████      | 40/100 [00:12<00:18,  3.20it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.20it/s] 70%|███████   | 70/100 [00:21<00:09,  3.20it/s] 80%|████████  | 80/100 [00:24<00:06,  3.20it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]
H_error tensor(446.0524, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5116, device='cuda:6', grad_fn=<DivBackward0>)
43093 MiB free out of 48676 MiB total
17 mlp.down_proj
Pruning ...
0.01
torch.Size([11158719])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.95it/s] 20%|██        | 200/1000 [00:04<00:18, 43.95it/s] 30%|███       | 300/1000 [00:06<00:15, 43.92it/s] 40%|████      | 400/1000 [00:09<00:13, 43.91it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.88it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.88it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.87it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.87it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.89it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.14it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.15it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.28it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.17it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.32it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.66it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.25it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.88it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.00it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.54it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.61it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.88it/s]100%|██████████| 16/16 [00:02<00:00,  7.31it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.76it/s] 20%|██        | 20/100 [00:07<00:29,  2.76it/s] 30%|███       | 30/100 [00:10<00:25,  2.76it/s] 40%|████      | 40/100 [00:14<00:21,  2.76it/s] 50%|█████     | 50/100 [00:18<00:18,  2.76it/s] 60%|██████    | 60/100 [00:21<00:14,  2.76it/s] 70%|███████   | 70/100 [00:25<00:10,  2.76it/s] 80%|████████  | 80/100 [00:28<00:07,  2.76it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.76it/s]100%|██████████| 100/100 [00:36<00:00,  2.76it/s]100%|██████████| 100/100 [00:36<00:00,  2.76it/s]
H_error tensor(14.3864, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5236, device='cuda:6', grad_fn=<DivBackward0>)
43411 MiB free out of 48676 MiB total
18 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149044])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.74it/s] 20%|██        | 200/1000 [00:01<00:07, 106.77it/s] 30%|███       | 300/1000 [00:02<00:06, 106.85it/s] 40%|████      | 400/1000 [00:03<00:05, 106.87it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.88it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.89it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.94it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.93it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.92it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.91it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.89it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.28it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.02it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.11it/s] 50%|█████     | 8/16 [00:00<00:00, 10.02it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.31it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.94it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.75it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.04it/s]100%|██████████| 16/16 [00:01<00:00,  9.94it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(407.8760, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5318, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
18 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149466])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.59it/s] 20%|██        | 200/1000 [00:01<00:07, 106.76it/s] 30%|███       | 300/1000 [00:02<00:06, 106.85it/s] 40%|████      | 400/1000 [00:03<00:05, 106.87it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.84it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.85it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.84it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.89it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.90it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.92it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.86it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.91it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.48it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.98it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.56it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.32it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.24it/s] 50%|█████     | 8/16 [00:00<00:00,  9.33it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.14it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.85it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.75it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.42it/s]100%|██████████| 16/16 [00:01<00:00, 10.71it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(423.4688, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5319, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
18 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148814])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.60it/s] 20%|██        | 200/1000 [00:01<00:07, 106.71it/s] 30%|███       | 300/1000 [00:02<00:06, 106.75it/s] 40%|████      | 400/1000 [00:03<00:05, 106.75it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.73it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.75it/s] 60%|██████    | 601/1000 [00:05<00:03, 106.56it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.17it/s] 25%|██▌       | 4/16 [00:00<00:01, 11.47it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.48it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.53it/s] 50%|█████     | 8/16 [00:00<00:00, 10.10it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.98it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.99it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.66it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.56it/s]100%|██████████| 16/16 [00:01<00:00,  9.71it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.68it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(241.5051, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5064, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
18 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148887])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.48it/s] 20%|██        | 200/1000 [00:01<00:07, 106.60it/s] 30%|███       | 300/1000 [00:02<00:06, 106.68it/s] 40%|████      | 400/1000 [00:03<00:05, 106.74it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.73it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.76it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.76it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.74it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.68it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.70it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.70it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.55it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.11it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.94it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.81it/s] 50%|█████     | 8/16 [00:00<00:00,  9.56it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.39it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.44it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.52it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.35it/s]100%|██████████| 16/16 [00:01<00:00, 10.17it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(33.5344, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5197, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
18 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150217])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.78it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.83it/s] 40%|████      | 400/1000 [00:09<00:13, 43.84it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.84it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.84it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.83it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.83it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.83it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.83it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.83it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.25it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.82it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.14it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.13it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.98it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.31it/s] 50%|█████     | 8/16 [00:01<00:01,  7.08it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.54it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.40it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.12it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.49it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.66it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.27it/s]100%|██████████| 16/16 [00:02<00:00,  6.15it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.19it/s] 40%|████      | 40/100 [00:12<00:18,  3.19it/s] 50%|█████     | 50/100 [00:15<00:15,  3.19it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(468.7347, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5041, device='cuda:6', grad_fn=<DivBackward0>)
43015 MiB free out of 48676 MiB total
18 mlp.up_proj
Pruning ...
0.01
torch.Size([11150109])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.89it/s] 20%|██        | 200/1000 [00:04<00:18, 43.91it/s] 30%|███       | 300/1000 [00:06<00:15, 43.89it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.88it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.87it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.87it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.87it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.88it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.88it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.88it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.19it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.95it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.25it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.78it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.53it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.71it/s] 50%|█████     | 8/16 [00:01<00:01,  7.39it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.66it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.29it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.88it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.91it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.40it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.97it/s]100%|██████████| 16/16 [00:02<00:00,  7.36it/s]100%|██████████| 16/16 [00:02<00:00,  6.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.17it/s] 30%|███       | 30/100 [00:09<00:22,  3.17it/s] 40%|████      | 40/100 [00:12<00:18,  3.17it/s] 50%|█████     | 50/100 [00:15<00:15,  3.17it/s] 60%|██████    | 60/100 [00:18<00:12,  3.17it/s] 70%|███████   | 70/100 [00:22<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(427.1043, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5014, device='cuda:6', grad_fn=<DivBackward0>)
43001 MiB free out of 48676 MiB total
18 mlp.down_proj
Pruning ...
0.01
torch.Size([11158763])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.88it/s] 20%|██        | 200/1000 [00:04<00:18, 43.92it/s] 30%|███       | 300/1000 [00:06<00:15, 43.91it/s] 40%|████      | 400/1000 [00:09<00:13, 43.91it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.91it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.92it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.92it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.92it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.92it/s] 94%|█████████▍| 940/1000 [00:21<00:01, 43.87it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.12it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.37it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.59it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.71it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.45it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.36it/s] 50%|█████     | 8/16 [00:01<00:01,  7.28it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.23it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.80it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.92it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.40it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.05it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.15it/s]100%|██████████| 16/16 [00:02<00:00,  6.74it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.74it/s] 20%|██        | 20/100 [00:07<00:29,  2.74it/s] 30%|███       | 30/100 [00:10<00:25,  2.75it/s] 40%|████      | 40/100 [00:14<00:21,  2.75it/s] 50%|█████     | 50/100 [00:18<00:18,  2.75it/s] 60%|██████    | 60/100 [00:21<00:14,  2.75it/s] 70%|███████   | 70/100 [00:25<00:10,  2.75it/s] 80%|████████  | 80/100 [00:29<00:07,  2.75it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.75it/s]100%|██████████| 100/100 [00:36<00:00,  2.75it/s]100%|██████████| 100/100 [00:36<00:00,  2.75it/s]
H_error tensor(14.2892, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5179, device='cuda:6', grad_fn=<DivBackward0>)
42855 MiB free out of 48676 MiB total
19 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149061])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.47it/s] 20%|██        | 200/1000 [00:01<00:07, 106.68it/s] 30%|███       | 300/1000 [00:02<00:06, 106.70it/s] 40%|████      | 400/1000 [00:03<00:05, 106.70it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.73it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.76it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.79it/s] 73%|███████▎  | 731/1000 [00:06<00:02, 106.59it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.94it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.84it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.91it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.47it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.22it/s] 50%|█████     | 8/16 [00:00<00:00,  9.93it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.20it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.12it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.78it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.13it/s]100%|██████████| 16/16 [00:01<00:00,  9.85it/s]100%|██████████| 16/16 [00:01<00:00,  9.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.76it/s] 30%|███       | 30/100 [00:03<00:07,  9.76it/s] 40%|████      | 40/100 [00:04<00:06,  9.74it/s] 50%|█████     | 50/100 [00:05<00:05,  9.75it/s] 60%|██████    | 60/100 [00:06<00:04,  9.76it/s] 70%|███████   | 70/100 [00:07<00:03,  9.73it/s] 80%|████████  | 80/100 [00:08<00:02,  9.75it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]100%|██████████| 100/100 [00:10<00:00,  9.75it/s]
H_error tensor(369.0572, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5263, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
19 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149445])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.43it/s] 20%|██        | 200/1000 [00:01<00:07, 106.66it/s] 30%|███       | 300/1000 [00:02<00:06, 106.70it/s] 40%|████      | 400/1000 [00:03<00:05, 106.75it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.74it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.77it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.75it/s] 80%|███████▉  | 797/1000 [00:07<00:01, 106.59it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.24it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.80it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.54it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.08it/s] 50%|█████     | 8/16 [00:00<00:00, 11.04it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.62it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.31it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.95it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.67it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.61it/s]100%|██████████| 16/16 [00:01<00:00,  9.62it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(377.2250, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5264, device='cuda:6', grad_fn=<DivBackward0>)
43371 MiB free out of 48676 MiB total
19 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148807])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.45it/s] 20%|██        | 200/1000 [00:01<00:07, 106.76it/s] 30%|███       | 300/1000 [00:02<00:06, 106.88it/s] 40%|████      | 400/1000 [00:03<00:05, 106.96it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.99it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.02it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.04it/s] 72%|███████▏  | 715/1000 [00:06<00:02, 106.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.69it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.67it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.81it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.32it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.37it/s] 50%|█████     | 8/16 [00:00<00:00, 10.22it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.57it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.07it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.12it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.92it/s]100%|██████████| 16/16 [00:01<00:00, 10.43it/s]100%|██████████| 16/16 [00:01<00:00, 10.06it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.66it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(239.3505, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5047, device='cuda:6', grad_fn=<DivBackward0>)
43353 MiB free out of 48676 MiB total
19 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148839])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.52it/s] 20%|██        | 200/1000 [00:01<00:07, 103.36it/s] 30%|███       | 300/1000 [00:02<00:06, 104.95it/s] 40%|████      | 400/1000 [00:03<00:05, 105.76it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.15it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.37it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.52it/s] 78%|███████▊  | 780/1000 [00:07<00:02, 105.93it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.28it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.84it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.13it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.68it/s] 50%|█████     | 8/16 [00:00<00:00, 10.38it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.22it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.03it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.05it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.85it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.67it/s] 20%|██        | 20/100 [00:02<00:08,  9.64it/s] 30%|███       | 30/100 [00:03<00:07,  9.63it/s] 40%|████      | 40/100 [00:04<00:06,  9.62it/s] 50%|█████     | 50/100 [00:05<00:05,  9.62it/s] 60%|██████    | 60/100 [00:06<00:04,  9.62it/s] 70%|███████   | 70/100 [00:07<00:03,  9.62it/s] 80%|████████  | 80/100 [00:08<00:02,  9.61it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.61it/s]100%|██████████| 100/100 [00:10<00:00,  9.62it/s]100%|██████████| 100/100 [00:10<00:00,  9.62it/s]
H_error tensor(44.1713, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5256, device='cuda:6', grad_fn=<DivBackward0>)
43385 MiB free out of 48676 MiB total
19 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150299])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.95it/s] 20%|██        | 200/1000 [00:04<00:18, 43.93it/s] 30%|███       | 300/1000 [00:06<00:15, 43.90it/s] 40%|████      | 400/1000 [00:09<00:13, 43.90it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.89it/s] 74%|███████▍  | 740/1000 [00:16<00:05, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.46it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.26it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.15it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.49it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.00it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.22it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.22it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.03it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.07it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.10it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.44it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.82it/s]100%|██████████| 16/16 [00:02<00:00,  6.63it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.20it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.21it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.20it/s] 70%|███████   | 70/100 [00:21<00:09,  3.20it/s] 80%|████████  | 80/100 [00:24<00:06,  3.21it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]
H_error tensor(505.4669, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5065, device='cuda:6', grad_fn=<DivBackward0>)
43299 MiB free out of 48676 MiB total
19 mlp.up_proj
Pruning ...
0.01
torch.Size([11150111])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.90it/s] 20%|██        | 200/1000 [00:04<00:18, 43.92it/s] 30%|███       | 300/1000 [00:06<00:15, 43.92it/s] 40%|████      | 400/1000 [00:09<00:13, 43.91it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.91it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.90it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.91it/s] 79%|███████▉  | 793/1000 [00:18<00:04, 43.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.19it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.09it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.72it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.60it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.58it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.44it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.72it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.00it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.71it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.26it/s] 88%|████████▊ | 14/16 [00:02<00:00,  5.91it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.17it/s]100%|██████████| 16/16 [00:02<00:00,  6.78it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(450.2595, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5022, device='cuda:6', grad_fn=<DivBackward0>)
43245 MiB free out of 48676 MiB total
19 mlp.down_proj
Pruning ...
0.01
torch.Size([11158729])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.86it/s] 20%|██        | 200/1000 [00:04<00:18, 43.88it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.88it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.88it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.89it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.89it/s] 99%|█████████▉| 989/1000 [00:22<00:00, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.14it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.06it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.48it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.30it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.79it/s] 50%|█████     | 8/16 [00:01<00:00,  8.38it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.41it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.75it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.01it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.39it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.53it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.55it/s]100%|██████████| 16/16 [00:02<00:00,  6.78it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.67it/s] 20%|██        | 20/100 [00:07<00:29,  2.67it/s] 30%|███       | 30/100 [00:11<00:26,  2.67it/s] 40%|████      | 40/100 [00:14<00:22,  2.67it/s] 50%|█████     | 50/100 [00:18<00:18,  2.67it/s] 60%|██████    | 60/100 [00:22<00:14,  2.67it/s] 70%|███████   | 70/100 [00:26<00:11,  2.67it/s] 80%|████████  | 80/100 [00:29<00:07,  2.67it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.67it/s]100%|██████████| 100/100 [00:37<00:00,  2.67it/s]100%|██████████| 100/100 [00:37<00:00,  2.67it/s]
H_error tensor(15.2051, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5169, device='cuda:6', grad_fn=<DivBackward0>)
43099 MiB free out of 48676 MiB total
20 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149079])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.74it/s] 20%|██        | 200/1000 [00:01<00:07, 106.72it/s] 30%|███       | 300/1000 [00:02<00:06, 106.77it/s] 40%|████      | 400/1000 [00:03<00:05, 106.79it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.80it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.79it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.76it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.74it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.72it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.67it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.73it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.58it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.80it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.39it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.24it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.32it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.44it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.51it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.22it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.39it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.96it/s]100%|██████████| 16/16 [00:01<00:00,  9.63it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(392.2781, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5276, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
20 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149392])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.49it/s] 20%|██        | 200/1000 [00:01<00:07, 106.77it/s] 30%|███       | 300/1000 [00:02<00:06, 106.78it/s] 40%|████      | 400/1000 [00:03<00:05, 106.79it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.78it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.78it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.79it/s] 79%|███████▉  | 788/1000 [00:07<00:01, 106.64it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.69it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.21it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.59it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.38it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.34it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.14it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.54it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.95it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.36it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.61it/s]100%|██████████| 16/16 [00:01<00:00, 10.19it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(397.9473, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5245, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
20 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148825])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.53it/s] 20%|██        | 200/1000 [00:01<00:07, 106.59it/s] 30%|███       | 300/1000 [00:02<00:06, 106.58it/s] 40%|████      | 400/1000 [00:03<00:05, 106.59it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.59it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.60it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.60it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.62it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.64it/s]100%|█████████▉| 995/1000 [00:09<00:00, 106.51it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.68it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.25it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.92it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.62it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.11it/s] 50%|█████     | 8/16 [00:00<00:00,  9.76it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.44it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.24it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.00it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.04it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.74it/s] 30%|███       | 30/100 [00:03<00:07,  9.73it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.72it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.71it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(260.6714, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5046, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
20 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148831])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.63it/s] 20%|██        | 200/1000 [00:01<00:07, 106.70it/s] 30%|███       | 300/1000 [00:02<00:06, 106.75it/s] 40%|████      | 400/1000 [00:03<00:05, 106.80it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.82it/s] 59%|█████▊    | 586/1000 [00:05<00:03, 106.62it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.63it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.00it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.47it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.42it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.82it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.04it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.28it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.79it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.29it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.04it/s]100%|██████████| 16/16 [00:01<00:00,  9.96it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.79it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.72it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(34.9501, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5201, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
20 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150326])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.84it/s] 30%|███       | 300/1000 [00:06<00:15, 43.85it/s] 40%|████      | 400/1000 [00:09<00:13, 43.85it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.86it/s] 85%|████████▌ | 850/1000 [00:19<00:03, 43.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.06it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.95it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.56it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.06it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.19it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.91it/s] 50%|█████     | 8/16 [00:01<00:01,  6.40it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.35it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.76it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.11it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.13it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.20it/s]100%|██████████| 16/16 [00:02<00:00,  7.62it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.16it/s] 20%|██        | 20/100 [00:06<00:25,  3.16it/s] 30%|███       | 30/100 [00:09<00:22,  3.16it/s] 40%|████      | 40/100 [00:12<00:18,  3.16it/s] 50%|█████     | 50/100 [00:15<00:15,  3.16it/s] 60%|██████    | 60/100 [00:18<00:12,  3.16it/s] 70%|███████   | 70/100 [00:22<00:09,  3.16it/s] 80%|████████  | 80/100 [00:25<00:06,  3.16it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.16it/s]100%|██████████| 100/100 [00:31<00:00,  3.16it/s]100%|██████████| 100/100 [00:31<00:00,  3.16it/s]
H_error tensor(522.9908, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5058, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
20 mlp.up_proj
Pruning ...
0.01
torch.Size([11150113])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.84it/s] 20%|██        | 200/1000 [00:04<00:18, 43.87it/s] 30%|███       | 300/1000 [00:06<00:15, 43.85it/s] 40%|████      | 400/1000 [00:09<00:13, 43.84it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.84it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.83it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.83it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.83it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.83it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.53it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.30it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.33it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.87it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.22it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.05it/s] 50%|█████     | 8/16 [00:01<00:01,  6.72it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.24it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.16it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.48it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.85it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.98it/s]100%|██████████| 16/16 [00:02<00:00,  7.30it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.21it/s] 50%|█████     | 50/100 [00:15<00:15,  3.21it/s] 60%|██████    | 60/100 [00:18<00:12,  3.21it/s] 70%|███████   | 70/100 [00:21<00:09,  3.21it/s] 80%|████████  | 80/100 [00:24<00:06,  3.21it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]
H_error tensor(473.2226, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5030, device='cuda:6', grad_fn=<DivBackward0>)
43211 MiB free out of 48676 MiB total
20 mlp.down_proj
Pruning ...
0.01
torch.Size([11158760])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.88it/s] 20%|██        | 200/1000 [00:04<00:18, 43.93it/s] 30%|███       | 300/1000 [00:06<00:15, 43.90it/s] 40%|████      | 400/1000 [00:09<00:13, 43.89it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.89it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.88it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.89it/s] 91%|█████████▏| 913/1000 [00:20<00:01, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.36it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.37it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.96it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.62it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.84it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.85it/s] 50%|█████     | 8/16 [00:01<00:01,  6.55it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.08it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.40it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.73it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.20it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.56it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.99it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.73it/s] 20%|██        | 20/100 [00:07<00:29,  2.73it/s] 30%|███       | 30/100 [00:10<00:25,  2.73it/s] 40%|████      | 40/100 [00:14<00:21,  2.73it/s] 50%|█████     | 50/100 [00:18<00:18,  2.73it/s] 60%|██████    | 60/100 [00:21<00:14,  2.73it/s] 70%|███████   | 70/100 [00:25<00:10,  2.74it/s] 80%|████████  | 80/100 [00:29<00:07,  2.74it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.74it/s]100%|██████████| 100/100 [00:36<00:00,  2.74it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(15.6731, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5133, device='cuda:6', grad_fn=<DivBackward0>)
42847 MiB free out of 48676 MiB total
21 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149121])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.45it/s] 20%|██        | 200/1000 [00:01<00:07, 106.55it/s] 30%|███       | 300/1000 [00:02<00:06, 106.66it/s] 40%|████      | 400/1000 [00:03<00:05, 106.67it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.68it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.70it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.74it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.75it/s] 88%|████████▊ | 885/1000 [00:08<00:01, 106.58it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.62it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.99it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.45it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.90it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.62it/s] 50%|█████     | 8/16 [00:00<00:00,  9.55it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.57it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.73it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.17it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.07it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.74it/s]100%|██████████| 16/16 [00:01<00:00,  9.99it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(363.3298, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5264, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
21 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149563])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.45it/s] 20%|██        | 200/1000 [00:01<00:07, 106.72it/s] 30%|███       | 300/1000 [00:02<00:06, 106.80it/s] 40%|████      | 400/1000 [00:03<00:05, 106.75it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.72it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.71it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.72it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.73it/s] 86%|████████▌ | 859/1000 [00:08<00:01, 106.59it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.97it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.53it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.27it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.69it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.75it/s] 50%|█████     | 8/16 [00:00<00:00, 10.27it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.08it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.96it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.82it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.55it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.49it/s]100%|██████████| 16/16 [00:01<00:00, 10.00it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.63it/s] 30%|███       | 30/100 [00:03<00:07,  9.49it/s] 40%|████      | 40/100 [00:04<00:06,  9.57it/s] 50%|█████     | 50/100 [00:05<00:05,  9.61it/s] 60%|██████    | 60/100 [00:06<00:04,  9.63it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.64it/s]
H_error tensor(365.6703, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5245, device='cuda:6', grad_fn=<DivBackward0>)
43321 MiB free out of 48676 MiB total
21 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148818])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.44it/s] 20%|██        | 200/1000 [00:01<00:07, 106.61it/s] 30%|███       | 300/1000 [00:02<00:06, 106.68it/s] 40%|████      | 400/1000 [00:03<00:05, 106.71it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.70it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.70it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.68it/s] 74%|███████▍  | 744/1000 [00:06<00:02, 106.53it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 12.67it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.79it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.98it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.74it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.34it/s] 50%|█████     | 8/16 [00:00<00:00, 10.19it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.69it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.37it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.17it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.18it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.19it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(267.7744, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5048, device='cuda:6', grad_fn=<DivBackward0>)
43353 MiB free out of 48676 MiB total
21 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148921])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.43it/s] 20%|██        | 200/1000 [00:01<00:07, 106.61it/s] 30%|███       | 300/1000 [00:02<00:06, 106.64it/s] 40%|████      | 400/1000 [00:03<00:05, 106.59it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.60it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.55it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.56it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.56it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.58it/s] 94%|█████████▍| 938/1000 [00:08<00:00, 106.46it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.23it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.27it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.49it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.16it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.42it/s] 50%|█████     | 8/16 [00:00<00:00, 10.92it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.34it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.91it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.67it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.51it/s]100%|██████████| 16/16 [00:01<00:00, 10.24it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.72it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(61.3135, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5226, device='cuda:6', grad_fn=<DivBackward0>)
43353 MiB free out of 48676 MiB total
21 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150319])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.94it/s] 20%|██        | 200/1000 [00:04<00:18, 43.90it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.85it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 89%|████████▉ | 888/1000 [00:20<00:02, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.50it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.69it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.60it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.41it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.95it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.77it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.16it/s] 50%|█████     | 8/16 [00:01<00:01,  6.92it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.30it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.72it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.25it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.96it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.42it/s]100%|██████████| 16/16 [00:02<00:00,  6.98it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.17it/s] 20%|██        | 20/100 [00:06<00:25,  3.17it/s] 30%|███       | 30/100 [00:09<00:22,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:22<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.17it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(530.7939, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5103, device='cuda:6', grad_fn=<DivBackward0>)
42671 MiB free out of 48676 MiB total
21 mlp.up_proj
Pruning ...
0.01
torch.Size([11150102])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.89it/s] 20%|██        | 200/1000 [00:04<00:18, 43.88it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.85it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.85it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.86it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.86it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.86it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.86it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.37it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.72it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.55it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.85it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.91it/s] 50%|█████     | 8/16 [00:01<00:01,  7.16it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.79it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.26it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.84it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.86it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.99it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.35it/s]100%|██████████| 16/16 [00:02<00:00,  7.07it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.17it/s] 20%|██        | 20/100 [00:06<00:25,  3.17it/s] 30%|███       | 30/100 [00:09<00:22,  3.17it/s] 40%|████      | 40/100 [00:12<00:18,  3.17it/s] 50%|█████     | 50/100 [00:15<00:15,  3.17it/s] 60%|██████    | 60/100 [00:18<00:12,  3.17it/s] 70%|███████   | 70/100 [00:22<00:09,  3.17it/s] 80%|████████  | 80/100 [00:25<00:06,  3.17it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]
H_error tensor(474.4050, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5086, device='cuda:6', grad_fn=<DivBackward0>)
42617 MiB free out of 48676 MiB total
21 mlp.down_proj
Pruning ...
0.01
torch.Size([11158764])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.91it/s] 20%|██        | 200/1000 [00:04<00:18, 43.92it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.89it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.88it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.88it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.88it/s] 96%|█████████▌| 961/1000 [00:21<00:00, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.98it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.44it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.61it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.13it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.45it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.17it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.42it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.40it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.93it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.85it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.88it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.91it/s]100%|██████████| 16/16 [00:02<00:00,  6.39it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.72it/s] 20%|██        | 20/100 [00:07<00:29,  2.72it/s] 30%|███       | 30/100 [00:11<00:25,  2.72it/s] 40%|████      | 40/100 [00:14<00:22,  2.72it/s] 50%|█████     | 50/100 [00:18<00:18,  2.72it/s] 60%|██████    | 60/100 [00:22<00:14,  2.72it/s] 70%|███████   | 70/100 [00:25<00:11,  2.72it/s] 80%|████████  | 80/100 [00:29<00:07,  2.72it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.72it/s]100%|██████████| 100/100 [00:36<00:00,  2.72it/s]100%|██████████| 100/100 [00:36<00:00,  2.72it/s]
H_error tensor(13.8826, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5122, device='cuda:6', grad_fn=<DivBackward0>)
42253 MiB free out of 48676 MiB total
22 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149184])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.67it/s] 20%|██        | 200/1000 [00:01<00:07, 106.75it/s] 30%|███       | 300/1000 [00:02<00:06, 106.87it/s] 40%|████      | 400/1000 [00:03<00:05, 106.91it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.89it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.88it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.87it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.89it/s] 88%|████████▊ | 879/1000 [00:08<00:01, 106.75it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.79it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.90it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.05it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.92it/s] 50%|█████     | 8/16 [00:00<00:00, 10.62it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.39it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.08it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.23it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.05it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.73it/s]100%|██████████| 16/16 [00:01<00:00,  9.56it/s]100%|██████████| 16/16 [00:01<00:00, 10.05it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.80it/s] 20%|██        | 20/100 [00:02<00:08,  9.80it/s] 30%|███       | 30/100 [00:03<00:07,  9.79it/s] 40%|████      | 40/100 [00:04<00:06,  9.79it/s] 50%|█████     | 50/100 [00:05<00:05,  9.78it/s] 60%|██████    | 60/100 [00:06<00:04,  9.74it/s] 70%|███████   | 70/100 [00:07<00:03,  9.73it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.73it/s]
H_error tensor(351.1156, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5245, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
22 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149423])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.67it/s] 20%|██        | 200/1000 [00:01<00:07, 106.83it/s] 30%|███       | 300/1000 [00:02<00:06, 106.90it/s] 40%|████      | 400/1000 [00:03<00:05, 106.98it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.99it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.98it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.98it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.97it/s] 89%|████████▉ | 889/1000 [00:08<00:01, 106.83it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.93it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.82it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.77it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.98it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.83it/s] 50%|█████     | 8/16 [00:00<00:00, 10.40it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.51it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.09it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.24it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.40it/s]100%|██████████| 16/16 [00:01<00:00, 10.24it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.72it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.66it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(357.1216, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5229, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
22 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148818])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.65it/s] 20%|██        | 200/1000 [00:01<00:07, 106.84it/s] 30%|███       | 300/1000 [00:02<00:06, 106.86it/s] 40%|████      | 400/1000 [00:03<00:05, 106.93it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.91it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.92it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.93it/s] 79%|███████▉  | 790/1000 [00:07<00:01, 106.77it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.65it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.06it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.57it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.46it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.01it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.68it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.15it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.97it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.92it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.13it/s]100%|██████████| 16/16 [00:01<00:00, 10.07it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(259.1293, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5058, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
22 self_attn.o_proj
Pruning ...
0.01
torch.Size([4149206])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.59it/s] 20%|██        | 200/1000 [00:01<00:07, 106.72it/s] 30%|███       | 300/1000 [00:02<00:06, 106.73it/s] 40%|████      | 400/1000 [00:03<00:05, 106.79it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.78it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.81it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.83it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.83it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.84it/s] 94%|█████████▎| 935/1000 [00:08<00:00, 106.69it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.62it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.43it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.22it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.05it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.62it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.80it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.51it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.51it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.19it/s]100%|██████████| 16/16 [00:01<00:00, 10.37it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.65it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]
H_error tensor(38.2480, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5296, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
22 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150185])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.74it/s] 20%|██        | 200/1000 [00:04<00:18, 43.81it/s] 30%|███       | 300/1000 [00:06<00:15, 43.84it/s] 40%|████      | 400/1000 [00:09<00:13, 43.85it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 74%|███████▍  | 744/1000 [00:16<00:05, 43.79it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.22it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.10it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.19it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.83it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.82it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.56it/s] 50%|█████     | 8/16 [00:01<00:01,  6.71it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.15it/s] 62%|██████▎   | 10/16 [00:01<00:01,  5.92it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.26it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.52it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.04it/s]100%|██████████| 16/16 [00:02<00:00,  7.29it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.23it/s] 20%|██        | 20/100 [00:06<00:24,  3.23it/s] 30%|███       | 30/100 [00:09<00:21,  3.24it/s] 40%|████      | 40/100 [00:12<00:18,  3.23it/s] 50%|█████     | 50/100 [00:15<00:15,  3.23it/s] 60%|██████    | 60/100 [00:18<00:12,  3.23it/s] 70%|███████   | 70/100 [00:21<00:09,  3.24it/s] 80%|████████  | 80/100 [00:24<00:06,  3.24it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.24it/s]100%|██████████| 100/100 [00:30<00:00,  3.23it/s]100%|██████████| 100/100 [00:30<00:00,  3.23it/s]
H_error tensor(511.7613, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5102, device='cuda:6', grad_fn=<DivBackward0>)
43047 MiB free out of 48676 MiB total
22 mlp.up_proj
Pruning ...
0.01
torch.Size([11150108])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.85it/s] 20%|██        | 200/1000 [00:04<00:18, 43.87it/s] 30%|███       | 300/1000 [00:06<00:15, 43.85it/s] 40%|████      | 400/1000 [00:09<00:13, 43.82it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.81it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.81it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.81it/s] 83%|████████▎ | 830/1000 [00:18<00:03, 43.76it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.38it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.97it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.97it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.60it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.69it/s] 38%|███▊      | 6/16 [00:01<00:01,  6.05it/s] 44%|████▍     | 7/16 [00:01<00:01,  5.72it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.67it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.48it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.47it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.41it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.81it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.76it/s]100%|██████████| 16/16 [00:02<00:00,  7.25it/s]100%|██████████| 16/16 [00:02<00:00,  6.92it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.22it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(455.8988, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5077, device='cuda:6', grad_fn=<DivBackward0>)
42993 MiB free out of 48676 MiB total
22 mlp.down_proj
Pruning ...
0.01
torch.Size([11158747])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.58it/s] 20%|██        | 200/1000 [00:04<00:18, 43.77it/s] 30%|███       | 300/1000 [00:06<00:15, 43.79it/s] 40%|████      | 400/1000 [00:09<00:13, 43.82it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.83it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.83it/s] 73%|███████▎  | 734/1000 [00:16<00:06, 43.75it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.39it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.68it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.98it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.84it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.13it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.68it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.45it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.54it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.48it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.96it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.41it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.69it/s]100%|██████████| 16/16 [00:02<00:00,  6.26it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.71it/s] 20%|██        | 20/100 [00:07<00:29,  2.71it/s] 30%|███       | 30/100 [00:11<00:25,  2.71it/s] 40%|████      | 40/100 [00:14<00:22,  2.71it/s] 50%|█████     | 50/100 [00:18<00:18,  2.71it/s] 60%|██████    | 60/100 [00:22<00:14,  2.71it/s] 70%|███████   | 70/100 [00:25<00:11,  2.71it/s] 80%|████████  | 80/100 [00:29<00:07,  2.71it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.71it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]
H_error tensor(13.0755, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5123, device='cuda:6', grad_fn=<DivBackward0>)
42629 MiB free out of 48676 MiB total
23 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149198])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.58it/s] 20%|██        | 200/1000 [00:01<00:07, 106.79it/s] 30%|███       | 300/1000 [00:02<00:06, 106.88it/s] 40%|████      | 400/1000 [00:03<00:05, 106.89it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.87it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.84it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.87it/s] 74%|███████▍  | 744/1000 [00:06<00:02, 106.71it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.35it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.40it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.09it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.35it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.69it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.77it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.74it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.54it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.15it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.81it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.05it/s]100%|██████████| 16/16 [00:01<00:00,  9.76it/s]100%|██████████| 16/16 [00:01<00:00,  9.45it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.69it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.65it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(340.6429, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5216, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
23 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149618])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.49it/s] 20%|██        | 200/1000 [00:01<00:07, 106.69it/s] 30%|███       | 300/1000 [00:02<00:06, 106.72it/s] 40%|████      | 400/1000 [00:03<00:05, 106.72it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.68it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.66it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.61it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.61it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.58it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.57it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.62it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.75it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.54it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.03it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.62it/s] 50%|█████     | 8/16 [00:00<00:00, 10.48it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.34it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.98it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.89it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.76it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.81it/s]100%|██████████| 16/16 [00:01<00:00,  9.66it/s]100%|██████████| 16/16 [00:01<00:00,  9.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(332.5306, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5175, device='cuda:6', grad_fn=<DivBackward0>)
43051 MiB free out of 48676 MiB total
23 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148808])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.39it/s] 20%|██        | 200/1000 [00:01<00:07, 106.51it/s] 30%|███       | 300/1000 [00:02<00:06, 106.55it/s] 40%|████      | 400/1000 [00:03<00:05, 106.60it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.64it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.63it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.64it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.64it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.64it/s] 98%|█████████▊| 979/1000 [00:09<00:00, 106.50it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.18it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.67it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.41it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.37it/s] 50%|█████     | 8/16 [00:00<00:00, 10.21it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.96it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.61it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.84it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.08it/s]100%|██████████| 16/16 [00:01<00:00,  9.73it/s]100%|██████████| 16/16 [00:01<00:00,  9.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.75it/s] 30%|███       | 30/100 [00:03<00:07,  9.74it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(288.0160, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5123, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
23 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148821])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.32it/s] 20%|██        | 200/1000 [00:01<00:07, 106.53it/s] 30%|███       | 300/1000 [00:02<00:06, 106.58it/s] 40%|████      | 400/1000 [00:03<00:05, 106.62it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.65it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.68it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.67it/s] 79%|███████▊  | 786/1000 [00:07<00:02, 106.49it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.19it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.16it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.95it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.96it/s] 50%|█████     | 8/16 [00:00<00:00,  9.58it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.27it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.71it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.88it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.43it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]100%|██████████| 16/16 [00:01<00:00,  9.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.71it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(93.0553, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5333, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
23 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150189])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.84it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.82it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.81it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.81it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.82it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.21it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.98it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.01it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.05it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.55it/s] 50%|█████     | 8/16 [00:01<00:01,  6.67it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.09it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.13it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.74it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.48it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.63it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.10it/s]100%|██████████| 16/16 [00:02<00:00,  6.71it/s]100%|██████████| 16/16 [00:02<00:00,  6.91it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:25,  3.20it/s] 30%|███       | 30/100 [00:09<00:21,  3.20it/s] 40%|████      | 40/100 [00:12<00:18,  3.20it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.20it/s] 70%|███████   | 70/100 [00:21<00:09,  3.20it/s] 80%|████████  | 80/100 [00:24<00:06,  3.20it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]
H_error tensor(541.9326, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5169, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
23 mlp.up_proj
Pruning ...
0.01
torch.Size([11150115])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.87it/s] 20%|██        | 200/1000 [00:04<00:18, 43.88it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.85it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.84it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.83it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.84it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.84it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.52it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.70it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.33it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.06it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.37it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.91it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.01it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.50it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.04it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.67it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.16it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.17it/s]100%|██████████| 16/16 [00:02<00:00,  7.08it/s]100%|██████████| 16/16 [00:02<00:00,  6.91it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:21,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.19it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(485.5537, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5167, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
23 mlp.down_proj
Pruning ...
0.01
torch.Size([11158699])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.90it/s] 20%|██        | 200/1000 [00:04<00:18, 43.93it/s] 30%|███       | 300/1000 [00:06<00:15, 43.90it/s] 40%|████      | 400/1000 [00:09<00:13, 43.90it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.91it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.89it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.90it/s] 86%|████████▋ | 863/1000 [00:19<00:03, 43.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.90it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.25it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.28it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.30it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.64it/s] 50%|█████     | 8/16 [00:01<00:01,  6.64it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.30it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.98it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.67it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.15it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.78it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.51it/s]100%|██████████| 16/16 [00:02<00:00,  7.60it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.70it/s] 20%|██        | 20/100 [00:07<00:29,  2.70it/s] 30%|███       | 30/100 [00:11<00:25,  2.70it/s] 40%|████      | 40/100 [00:14<00:22,  2.70it/s] 50%|█████     | 50/100 [00:18<00:18,  2.70it/s] 60%|██████    | 60/100 [00:22<00:14,  2.70it/s] 70%|███████   | 70/100 [00:25<00:11,  2.70it/s] 80%|████████  | 80/100 [00:29<00:07,  2.70it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.70it/s]100%|██████████| 100/100 [00:37<00:00,  2.70it/s]100%|██████████| 100/100 [00:37<00:00,  2.70it/s]
H_error tensor(12.3052, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5121, device='cuda:6', grad_fn=<DivBackward0>)
43001 MiB free out of 48676 MiB total
24 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149140])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.68it/s] 20%|██        | 200/1000 [00:01<00:07, 106.79it/s] 30%|███       | 300/1000 [00:02<00:06, 106.86it/s] 40%|████      | 400/1000 [00:03<00:05, 106.91it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.91it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.94it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.94it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.96it/s] 89%|████████▊ | 887/1000 [00:08<00:01, 106.79it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.94it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.84it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.35it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.97it/s] 50%|█████     | 8/16 [00:00<00:00,  9.65it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.48it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.01it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.00it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.05it/s]100%|██████████| 16/16 [00:01<00:00,  9.97it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.80it/s] 20%|██        | 20/100 [00:02<00:08,  9.79it/s] 30%|███       | 30/100 [00:03<00:07,  9.76it/s] 40%|████      | 40/100 [00:04<00:06,  9.73it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(357.0806, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5300, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
24 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149586])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.48it/s] 20%|██        | 200/1000 [00:01<00:07, 106.72it/s] 30%|███       | 300/1000 [00:02<00:06, 106.77it/s] 40%|████      | 400/1000 [00:03<00:05, 106.75it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.76it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.77it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.82it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.82it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.86it/s] 93%|█████████▎| 930/1000 [00:08<00:00, 106.69it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.09it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.44it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.39it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.22it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.90it/s] 50%|█████     | 8/16 [00:00<00:00,  9.61it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.38it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.19it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.85it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.72it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.29it/s]100%|██████████| 16/16 [00:01<00:00, 10.07it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]
H_error tensor(353.2982, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5299, device='cuda:6', grad_fn=<DivBackward0>)
43307 MiB free out of 48676 MiB total
24 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148802])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.42it/s] 20%|██        | 200/1000 [00:01<00:07, 106.64it/s] 30%|███       | 300/1000 [00:02<00:06, 106.72it/s] 40%|████      | 400/1000 [00:03<00:05, 106.76it/s] 50%|█████     | 500/1000 [00:04<00:04, 105.65it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.04it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.34it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.52it/s] 82%|████████▏ | 815/1000 [00:07<00:01, 106.27it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.07it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.96it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.41it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.76it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.45it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.43it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.33it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.08it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.05it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.86it/s]100%|██████████| 16/16 [00:01<00:00,  9.55it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.70it/s] 20%|██        | 20/100 [00:02<00:08,  9.74it/s] 30%|███       | 30/100 [00:03<00:07,  9.74it/s] 40%|████      | 40/100 [00:04<00:06,  9.73it/s] 50%|█████     | 50/100 [00:05<00:05,  9.74it/s] 60%|██████    | 60/100 [00:06<00:04,  9.72it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(320.6352, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5241, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
24 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148880])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.54it/s] 20%|██        | 200/1000 [00:01<00:07, 106.69it/s] 30%|███       | 300/1000 [00:02<00:06, 106.79it/s] 40%|████      | 400/1000 [00:03<00:05, 106.84it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.84it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.88it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.90it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.88it/s] 86%|████████▋ | 864/1000 [00:08<00:01, 106.70it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.35it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.99it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.50it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.95it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.63it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.79it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.73it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.89it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.75it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.64it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.71it/s] 20%|██        | 20/100 [00:02<00:08,  9.67it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.66it/s] 60%|██████    | 60/100 [00:06<00:04,  9.65it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.65it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]
H_error tensor(45.2998, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5250, device='cuda:6', grad_fn=<DivBackward0>)
43371 MiB free out of 48676 MiB total
24 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150231])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.75it/s] 20%|██        | 200/1000 [00:04<00:18, 43.79it/s] 30%|███       | 300/1000 [00:06<00:15, 43.81it/s] 40%|████      | 400/1000 [00:09<00:13, 43.82it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.83it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.84it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.84it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.83it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.24it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.11it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.93it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.55it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.66it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.05it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.21it/s] 50%|█████     | 8/16 [00:01<00:01,  6.13it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.74it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.26it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.73it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.51it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.41it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.24it/s] 20%|██        | 20/100 [00:06<00:24,  3.24it/s] 30%|███       | 30/100 [00:09<00:21,  3.24it/s] 40%|████      | 40/100 [00:12<00:18,  3.24it/s] 50%|█████     | 50/100 [00:15<00:15,  3.24it/s] 60%|██████    | 60/100 [00:18<00:12,  3.24it/s] 70%|███████   | 70/100 [00:21<00:09,  3.24it/s] 80%|████████  | 80/100 [00:24<00:06,  3.24it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.24it/s]100%|██████████| 100/100 [00:30<00:00,  3.24it/s]100%|██████████| 100/100 [00:30<00:00,  3.24it/s]
H_error tensor(632.3554, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5271, device='cuda:6', grad_fn=<DivBackward0>)
43239 MiB free out of 48676 MiB total
24 mlp.up_proj
Pruning ...
0.01
torch.Size([11150112])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.76it/s] 20%|██        | 200/1000 [00:04<00:18, 43.78it/s] 30%|███       | 300/1000 [00:06<00:15, 43.79it/s] 40%|████      | 400/1000 [00:09<00:13, 43.80it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.80it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.81it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.82it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.19it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.63it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.05it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.71it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.34it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.60it/s] 50%|█████     | 8/16 [00:01<00:01,  6.81it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.24it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.89it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.66it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.45it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.80it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.82it/s]100%|██████████| 16/16 [00:02<00:00,  6.53it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(572.4700, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5279, device='cuda:6', grad_fn=<DivBackward0>)
43271 MiB free out of 48676 MiB total
24 mlp.down_proj
Pruning ...
0.01
torch.Size([11158723])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.85it/s] 20%|██        | 200/1000 [00:04<00:18, 43.87it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.90it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.89it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.89it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.89it/s] 94%|█████████▍| 939/1000 [00:21<00:01, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.92it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.71it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.65it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.24it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.36it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.11it/s] 50%|█████     | 8/16 [00:01<00:01,  6.73it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.19it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.25it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.67it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.92it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.64it/s]100%|██████████| 16/16 [00:02<00:00,  6.81it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:32,  2.73it/s] 20%|██        | 20/100 [00:07<00:29,  2.73it/s] 30%|███       | 30/100 [00:10<00:25,  2.73it/s] 40%|████      | 40/100 [00:14<00:21,  2.73it/s] 50%|█████     | 50/100 [00:18<00:18,  2.73it/s] 60%|██████    | 60/100 [00:21<00:14,  2.73it/s] 70%|███████   | 70/100 [00:25<00:10,  2.73it/s] 80%|████████  | 80/100 [00:29<00:07,  2.73it/s] 90%|█████████ | 90/100 [00:32<00:03,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]100%|██████████| 100/100 [00:36<00:00,  2.73it/s]
H_error tensor(12.6793, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5125, device='cuda:6', grad_fn=<DivBackward0>)
42907 MiB free out of 48676 MiB total
25 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149144])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.64it/s] 20%|██        | 200/1000 [00:01<00:07, 106.85it/s] 30%|███       | 300/1000 [00:02<00:06, 106.71it/s] 40%|████      | 400/1000 [00:03<00:05, 106.80it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.76it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.75it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.79it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.79it/s] 83%|████████▎ | 833/1000 [00:07<00:01, 106.64it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.81it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.91it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.70it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.71it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.18it/s] 50%|█████     | 8/16 [00:00<00:00,  9.77it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.63it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.47it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.02it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.66it/s]100%|██████████| 16/16 [00:01<00:00, 10.07it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.70it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(356.5840, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5278, device='cuda:6', grad_fn=<DivBackward0>)
43339 MiB free out of 48676 MiB total
25 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149410])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.57it/s] 20%|██        | 200/1000 [00:01<00:07, 106.79it/s] 30%|███       | 300/1000 [00:02<00:06, 106.85it/s] 40%|████      | 400/1000 [00:03<00:05, 106.87it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.85it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.83it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.89it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.81it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.86it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.89it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.76it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.14it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.33it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.05it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.28it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.91it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.63it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.54it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.90it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.84it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.72it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.67it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(359.0975, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5260, device='cuda:6', grad_fn=<DivBackward0>)
43117 MiB free out of 48676 MiB total
25 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148806])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.59it/s] 20%|██        | 200/1000 [00:01<00:07, 106.73it/s] 30%|███       | 300/1000 [00:02<00:06, 106.81it/s] 40%|████      | 400/1000 [00:03<00:05, 106.83it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.83it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.83it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.82it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.79it/s] 80%|████████  | 803/1000 [00:07<00:01, 106.66it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.65it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.93it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.54it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.18it/s] 50%|█████     | 8/16 [00:00<00:00, 10.39it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.97it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.49it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.13it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.77it/s]100%|██████████| 16/16 [00:01<00:00,  9.83it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.73it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]
H_error tensor(308.6349, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5222, device='cuda:6', grad_fn=<DivBackward0>)
43149 MiB free out of 48676 MiB total
25 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148828])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.52it/s] 20%|██        | 200/1000 [00:01<00:07, 106.70it/s] 30%|███       | 300/1000 [00:02<00:06, 106.76it/s] 40%|████      | 400/1000 [00:03<00:05, 106.82it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.84it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.86it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.87it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.86it/s] 87%|████████▋ | 867/1000 [00:08<00:01, 106.70it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.72it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.62it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.15it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.00it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.71it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.36it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.11it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.92it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.70it/s]100%|██████████| 16/16 [00:01<00:00,  9.70it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.63it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(29.0690, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5311, device='cuda:6', grad_fn=<DivBackward0>)
43117 MiB free out of 48676 MiB total
25 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150248])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.81it/s] 20%|██        | 200/1000 [00:04<00:18, 43.85it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.88it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.88it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.89it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.89it/s] 90%|█████████ | 905/1000 [00:20<00:02, 43.83it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.14it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.61it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.87it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.99it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.21it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.82it/s] 50%|█████     | 8/16 [00:01<00:01,  7.03it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.55it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.21it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.13it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.80it/s] 88%|████████▊ | 14/16 [00:02<00:00,  8.33it/s] 94%|█████████▍| 15/16 [00:02<00:00,  8.05it/s]100%|██████████| 16/16 [00:02<00:00,  7.60it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.17it/s] 30%|███       | 30/100 [00:09<00:22,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:22<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(557.3016, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5207, device='cuda:6', grad_fn=<DivBackward0>)
42435 MiB free out of 48676 MiB total
25 mlp.up_proj
Pruning ...
0.01
torch.Size([11150108])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.86it/s] 20%|██        | 200/1000 [00:04<00:18, 43.85it/s] 30%|███       | 300/1000 [00:06<00:15, 43.83it/s] 40%|████      | 400/1000 [00:09<00:13, 43.83it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.83it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.82it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.83it/s] 73%|███████▎  | 728/1000 [00:16<00:06, 43.77it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.90it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.25it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.31it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.20it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.54it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.33it/s] 50%|█████     | 8/16 [00:01<00:01,  6.00it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.43it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.70it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.69it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.34it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.92it/s]100%|██████████| 16/16 [00:02<00:00,  7.70it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.21it/s] 40%|████      | 40/100 [00:12<00:18,  3.21it/s] 50%|█████     | 50/100 [00:15<00:15,  3.21it/s] 60%|██████    | 60/100 [00:18<00:12,  3.21it/s] 70%|███████   | 70/100 [00:21<00:09,  3.21it/s] 80%|████████  | 80/100 [00:24<00:06,  3.21it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]
H_error tensor(503.3880, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5202, device='cuda:6', grad_fn=<DivBackward0>)
41871 MiB free out of 48676 MiB total
25 mlp.down_proj
Pruning ...
0.01
torch.Size([11158686])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.88it/s] 20%|██        | 200/1000 [00:04<00:18, 43.94it/s] 30%|███       | 300/1000 [00:06<00:15, 43.93it/s] 40%|████      | 400/1000 [00:09<00:13, 43.92it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.92it/s] 56%|█████▋    | 563/1000 [00:12<00:09, 43.84it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.70it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.82it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.99it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.47it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.49it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.02it/s] 50%|█████     | 8/16 [00:01<00:01,  7.13it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.69it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.46it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.05it/s] 75%|███████▌  | 12/16 [00:01<00:00,  5.89it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.49it/s]100%|██████████| 16/16 [00:02<00:00,  6.67it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.70it/s] 20%|██        | 20/100 [00:07<00:29,  2.70it/s] 30%|███       | 30/100 [00:11<00:25,  2.70it/s] 40%|████      | 40/100 [00:14<00:22,  2.70it/s] 50%|█████     | 50/100 [00:18<00:18,  2.70it/s] 60%|██████    | 60/100 [00:22<00:14,  2.70it/s] 70%|███████   | 70/100 [00:25<00:11,  2.70it/s] 80%|████████  | 80/100 [00:29<00:07,  2.70it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.70it/s]100%|██████████| 100/100 [00:37<00:00,  2.70it/s]100%|██████████| 100/100 [00:37<00:00,  2.70it/s]
H_error tensor(13.0009, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5174, device='cuda:6', grad_fn=<DivBackward0>)
42189 MiB free out of 48676 MiB total
26 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149146])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.60it/s] 20%|██        | 200/1000 [00:01<00:07, 106.71it/s] 30%|███       | 300/1000 [00:02<00:06, 106.77it/s] 40%|████      | 400/1000 [00:03<00:05, 106.79it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.77it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.79it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.77it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.84it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.88it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.90it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.90it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.83it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.17it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.31it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.32it/s] 50%|█████     | 8/16 [00:00<00:00,  9.54it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.47it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.13it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.84it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.48it/s]100%|██████████| 16/16 [00:01<00:00, 10.87it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.75it/s] 20%|██        | 20/100 [00:02<00:08,  9.77it/s] 30%|███       | 30/100 [00:03<00:07,  9.78it/s] 40%|████      | 40/100 [00:04<00:06,  9.78it/s] 50%|█████     | 50/100 [00:05<00:05,  9.78it/s] 60%|██████    | 60/100 [00:06<00:04,  9.78it/s] 70%|███████   | 70/100 [00:07<00:03,  9.77it/s] 80%|████████  | 80/100 [00:08<00:02,  9.77it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.78it/s]100%|██████████| 100/100 [00:10<00:00,  9.79it/s]100%|██████████| 100/100 [00:10<00:00,  9.78it/s]
H_error tensor(436.7651, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5317, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
26 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149429])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.01it/s] 20%|██        | 200/1000 [00:01<00:07, 106.20it/s] 30%|███       | 300/1000 [00:02<00:06, 106.40it/s] 40%|████      | 400/1000 [00:03<00:05, 106.26it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.41it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.58it/s] 60%|██████    | 605/1000 [00:05<00:03, 106.25it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.45it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.79it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.24it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.99it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.59it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.95it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.64it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.62it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.85it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.58it/s]100%|██████████| 16/16 [00:01<00:00, 10.51it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.70it/s] 30%|███       | 30/100 [00:03<00:07,  9.72it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.71it/s] 60%|██████    | 60/100 [00:06<00:04,  9.70it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(701.2173, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5304, device='cuda:6', grad_fn=<DivBackward0>)
42861 MiB free out of 48676 MiB total
26 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148803])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.38it/s] 20%|██        | 200/1000 [00:01<00:07, 106.55it/s] 30%|███       | 300/1000 [00:02<00:06, 106.68it/s] 40%|████      | 400/1000 [00:03<00:05, 106.71it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.84it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.88it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.90it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.93it/s] 88%|████████▊ | 885/1000 [00:08<00:01, 106.72it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.61it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.24it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.08it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.84it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.04it/s] 50%|█████     | 8/16 [00:00<00:00,  9.66it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.82it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.86it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.60it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.59it/s]100%|██████████| 16/16 [00:01<00:00, 10.08it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.69it/s] 20%|██        | 20/100 [00:02<00:08,  9.66it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.65it/s] 50%|█████     | 50/100 [00:05<00:05,  9.65it/s] 60%|██████    | 60/100 [00:06<00:04,  9.65it/s] 70%|███████   | 70/100 [00:07<00:03,  9.64it/s] 80%|████████  | 80/100 [00:08<00:02,  9.64it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]
H_error tensor(379.5994, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5434, device='cuda:6', grad_fn=<DivBackward0>)
42893 MiB free out of 48676 MiB total
26 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148801])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.54it/s] 20%|██        | 200/1000 [00:01<00:07, 106.80it/s] 30%|███       | 300/1000 [00:02<00:06, 106.89it/s] 40%|████      | 400/1000 [00:03<00:05, 106.96it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.01it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.01it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.02it/s] 77%|███████▋  | 766/1000 [00:07<00:02, 106.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.80it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.46it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.73it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.47it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.18it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.12it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.91it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.23it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.84it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.54it/s]100%|██████████| 16/16 [00:01<00:00, 10.44it/s]100%|██████████| 16/16 [00:01<00:00, 10.09it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.71it/s] 20%|██        | 20/100 [00:02<00:08,  9.66it/s] 30%|███       | 30/100 [00:03<00:07,  9.65it/s] 40%|████      | 40/100 [00:04<00:06,  9.64it/s] 50%|█████     | 50/100 [00:05<00:05,  9.64it/s] 60%|██████    | 60/100 [00:06<00:04,  9.64it/s] 70%|███████   | 70/100 [00:07<00:03,  9.64it/s] 80%|████████  | 80/100 [00:08<00:02,  9.64it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.64it/s]100%|██████████| 100/100 [00:10<00:00,  9.64it/s]
H_error tensor(19.2215, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5242, device='cuda:6', grad_fn=<DivBackward0>)
42925 MiB free out of 48676 MiB total
26 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150179])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.89it/s] 20%|██        | 200/1000 [00:04<00:18, 43.91it/s] 30%|███       | 300/1000 [00:06<00:15, 43.89it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.85it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.84it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.84it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.86it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.37it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.02it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.20it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.66it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.43it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.67it/s] 50%|█████     | 8/16 [00:01<00:00,  8.60it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.32it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.89it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.78it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.39it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.22it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.70it/s]100%|██████████| 16/16 [00:02<00:00,  6.34it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:21,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:21<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(1338.0350, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5410, device='cuda:6', grad_fn=<DivBackward0>)
42839 MiB free out of 48676 MiB total
26 mlp.up_proj
Pruning ...
0.01
torch.Size([11150150])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.88it/s] 20%|██        | 200/1000 [00:04<00:18, 43.88it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.86it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.86it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.86it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.86it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.88it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.69it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.51it/s] 25%|██▌       | 4/16 [00:00<00:02,  5.70it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.63it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.56it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.53it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.38it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.69it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.02it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.00it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.34it/s]100%|██████████| 16/16 [00:02<00:00,  6.60it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.21it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(652.4591, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5317, device='cuda:6', grad_fn=<DivBackward0>)
42825 MiB free out of 48676 MiB total
26 mlp.down_proj
Pruning ...
0.01
torch.Size([11158673])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.78it/s] 20%|██        | 200/1000 [00:04<00:18, 43.87it/s] 30%|███       | 300/1000 [00:06<00:15, 43.87it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.88it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.88it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.87it/s] 72%|███████▏  | 720/1000 [00:16<00:06, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.21it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.00it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.27it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.60it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.95it/s] 50%|█████     | 8/16 [00:01<00:01,  6.91it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.27it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.86it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.38it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.62it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.81it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.83it/s]100%|██████████| 16/16 [00:02<00:00,  6.34it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.72it/s] 20%|██        | 20/100 [00:07<00:29,  2.72it/s] 30%|███       | 30/100 [00:11<00:25,  2.72it/s] 40%|████      | 40/100 [00:14<00:22,  2.72it/s] 50%|█████     | 50/100 [00:18<00:18,  2.72it/s] 60%|██████    | 60/100 [00:22<00:14,  2.72it/s] 70%|███████   | 70/100 [00:25<00:11,  2.72it/s] 80%|████████  | 80/100 [00:29<00:07,  2.72it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.72it/s]100%|██████████| 100/100 [00:36<00:00,  2.72it/s]100%|██████████| 100/100 [00:36<00:00,  2.72it/s]
H_error tensor(14.8062, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5196, device='cuda:6', grad_fn=<DivBackward0>)
42971 MiB free out of 48676 MiB total
27 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149301])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.42it/s] 20%|██        | 200/1000 [00:01<00:07, 106.62it/s] 30%|███       | 300/1000 [00:02<00:06, 106.66it/s] 40%|████      | 400/1000 [00:03<00:05, 106.72it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.64it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.69it/s] 66%|██████▌   | 660/1000 [00:06<00:03, 106.52it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.28it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.30it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.97it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.54it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.30it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.23it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.26it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.97it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.92it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.88it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.77it/s] 30%|███       | 30/100 [00:03<00:07,  9.76it/s] 40%|████      | 40/100 [00:04<00:06,  9.77it/s] 50%|█████     | 50/100 [00:05<00:05,  9.78it/s] 60%|██████    | 60/100 [00:06<00:04,  9.78it/s] 70%|███████   | 70/100 [00:07<00:03,  9.78it/s] 80%|████████  | 80/100 [00:08<00:02,  9.78it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.78it/s]100%|██████████| 100/100 [00:10<00:00,  9.77it/s]100%|██████████| 100/100 [00:10<00:00,  9.78it/s]
H_error tensor(446.7227, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5373, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
27 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149436])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.75it/s] 20%|██        | 200/1000 [00:01<00:07, 106.89it/s] 30%|███       | 300/1000 [00:02<00:06, 106.91it/s] 40%|████      | 400/1000 [00:03<00:05, 106.94it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.93it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.93it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.92it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.91it/s] 86%|████████▌ | 862/1000 [00:08<00:01, 106.79it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.26it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.92it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.43it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.28it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.00it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.96it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.66it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.63it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.39it/s]100%|██████████| 16/16 [00:01<00:00, 10.31it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.81it/s] 20%|██        | 20/100 [00:02<00:08,  9.79it/s] 30%|███       | 30/100 [00:03<00:07,  9.80it/s] 40%|████      | 40/100 [00:04<00:06,  9.80it/s] 50%|█████     | 50/100 [00:05<00:05,  9.80it/s] 60%|██████    | 60/100 [00:06<00:04,  9.78it/s] 70%|███████   | 70/100 [00:07<00:03,  9.77it/s] 80%|████████  | 80/100 [00:08<00:02,  9.77it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.75it/s]100%|██████████| 100/100 [00:10<00:00,  9.76it/s]100%|██████████| 100/100 [00:10<00:00,  9.77it/s]
H_error tensor(400.9995, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5385, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
27 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148807])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.53it/s] 20%|██        | 200/1000 [00:01<00:07, 106.71it/s] 30%|███       | 300/1000 [00:02<00:06, 106.79it/s] 40%|████      | 400/1000 [00:03<00:05, 106.85it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.85it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.88it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.87it/s] 75%|███████▍  | 748/1000 [00:07<00:02, 106.70it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.93it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.88it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.84it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.46it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.27it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.78it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.20it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.08it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.54it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.04it/s]100%|██████████| 16/16 [00:01<00:00,  9.87it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.71it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.67it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(515.0051, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5399, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
27 self_attn.o_proj
Pruning ...
0.01
torch.Size([4149317])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.48it/s] 20%|██        | 200/1000 [00:01<00:07, 106.61it/s] 30%|███       | 300/1000 [00:02<00:06, 106.71it/s] 40%|████      | 400/1000 [00:03<00:05, 106.73it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.74it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.74it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.71it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.72it/s] 86%|████████▌ | 857/1000 [00:08<00:01, 106.58it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.27it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.87it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.91it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.49it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.24it/s] 50%|█████     | 8/16 [00:00<00:00, 10.19it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.96it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.70it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.15it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.09it/s]100%|██████████| 16/16 [00:01<00:00, 10.41it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.70it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.66it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]
H_error tensor(16.3171, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5253, device='cuda:6', grad_fn=<DivBackward0>)
42893 MiB free out of 48676 MiB total
27 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150147])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.80it/s] 20%|██        | 200/1000 [00:04<00:18, 43.84it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.85it/s] 94%|█████████▍| 943/1000 [00:21<00:01, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.84it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.13it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.98it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.70it/s] 50%|█████     | 8/16 [00:01<00:01,  7.03it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.52it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.73it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.66it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.27it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.76it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.89it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.25it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.20it/s] 40%|████      | 40/100 [00:12<00:18,  3.20it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.20it/s] 70%|███████   | 70/100 [00:21<00:09,  3.20it/s] 80%|████████  | 80/100 [00:25<00:06,  3.20it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]
H_error tensor(959.6697, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5392, device='cuda:6', grad_fn=<DivBackward0>)
42721 MiB free out of 48676 MiB total
27 mlp.up_proj
Pruning ...
0.01
torch.Size([11150185])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.92it/s] 20%|██        | 200/1000 [00:04<00:18, 43.90it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.87it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.86it/s] 85%|████████▍ | 847/1000 [00:19<00:03, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.93it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.26it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.43it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.24it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.87it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.27it/s] 50%|█████     | 8/16 [00:01<00:01,  7.19it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.47it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.74it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.64it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.96it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.36it/s]100%|██████████| 16/16 [00:02<00:00,  6.65it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:24,  3.20it/s] 30%|███       | 30/100 [00:09<00:21,  3.20it/s] 40%|████      | 40/100 [00:12<00:18,  3.20it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.21it/s] 70%|███████   | 70/100 [00:21<00:09,  3.21it/s] 80%|████████  | 80/100 [00:24<00:06,  3.21it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]100%|██████████| 100/100 [00:31<00:00,  3.21it/s]
H_error tensor(922.5408, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5387, device='cuda:6', grad_fn=<DivBackward0>)
42839 MiB free out of 48676 MiB total
27 mlp.down_proj
Pruning ...
0.01
torch.Size([11158806])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.82it/s] 20%|██        | 200/1000 [00:04<00:18, 43.90it/s] 30%|███       | 300/1000 [00:06<00:15, 43.90it/s] 40%|████      | 400/1000 [00:09<00:13, 43.89it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.88it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.88it/s] 81%|████████▏ | 814/1000 [00:18<00:04, 43.83it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.27it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.21it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.02it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.81it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.21it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.43it/s] 44%|████▍     | 7/16 [00:01<00:01,  5.95it/s] 50%|█████     | 8/16 [00:01<00:01,  6.67it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.42it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.49it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.10it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.43it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.42it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.98it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.71it/s] 20%|██        | 20/100 [00:07<00:29,  2.71it/s] 30%|███       | 30/100 [00:11<00:25,  2.71it/s] 40%|████      | 40/100 [00:14<00:22,  2.71it/s] 50%|█████     | 50/100 [00:18<00:18,  2.71it/s] 60%|██████    | 60/100 [00:22<00:14,  2.71it/s] 70%|███████   | 70/100 [00:25<00:11,  2.71it/s] 80%|████████  | 80/100 [00:29<00:07,  2.71it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.71it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]100%|██████████| 100/100 [00:36<00:00,  2.71it/s]
H_error tensor(15.9956, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5284, device='cuda:6', grad_fn=<DivBackward0>)
42693 MiB free out of 48676 MiB total
28 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149251])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.58it/s] 20%|██        | 200/1000 [00:01<00:07, 106.87it/s] 30%|███       | 300/1000 [00:02<00:06, 106.86it/s] 40%|████      | 400/1000 [00:03<00:05, 106.90it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.92it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.93it/s] 67%|██████▋   | 669/1000 [00:06<00:03, 106.73it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.60it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.91it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.17it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.82it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.49it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.07it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.86it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.73it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.21it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.92it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.80it/s] 20%|██        | 20/100 [00:02<00:08,  9.81it/s] 30%|███       | 30/100 [00:03<00:07,  9.75it/s] 40%|████      | 40/100 [00:04<00:06,  9.74it/s] 50%|█████     | 50/100 [00:05<00:05,  9.71it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.72it/s]
H_error tensor(459.0449, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5396, device='cuda:6', grad_fn=<DivBackward0>)
42827 MiB free out of 48676 MiB total
28 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149621])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.66it/s] 20%|██        | 200/1000 [00:01<00:07, 106.88it/s] 30%|███       | 300/1000 [00:02<00:06, 106.85it/s] 40%|████      | 400/1000 [00:03<00:05, 106.86it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.83it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.86it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.88it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.92it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.96it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.97it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.90it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.74it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.98it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.82it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.18it/s] 50%|█████     | 8/16 [00:00<00:00, 10.27it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.86it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.64it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.65it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.58it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.38it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.09it/s]100%|██████████| 16/16 [00:01<00:00, 10.08it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.64it/s] 50%|█████     | 50/100 [00:05<00:05,  9.64it/s] 60%|██████    | 60/100 [00:06<00:04,  9.64it/s] 70%|███████   | 70/100 [00:07<00:03,  9.64it/s] 80%|████████  | 80/100 [00:08<00:02,  9.63it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.63it/s]100%|██████████| 100/100 [00:10<00:00,  9.63it/s]100%|██████████| 100/100 [00:10<00:00,  9.64it/s]
H_error tensor(361.1655, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5411, device='cuda:6', grad_fn=<DivBackward0>)
42859 MiB free out of 48676 MiB total
28 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148807])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.67it/s] 20%|██        | 200/1000 [00:01<00:07, 106.86it/s] 30%|███       | 300/1000 [00:02<00:06, 106.86it/s] 40%|████      | 400/1000 [00:03<00:05, 106.87it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.86it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.87it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.85it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.82it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.83it/s] 92%|█████████▏| 915/1000 [00:08<00:00, 106.72it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.26it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.14it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.30it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.08it/s] 50%|█████     | 8/16 [00:00<00:00,  9.68it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.69it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.38it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.25it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.78it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.66it/s]100%|██████████| 16/16 [00:01<00:00, 10.49it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.69it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(474.7498, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5369, device='cuda:6', grad_fn=<DivBackward0>)
42891 MiB free out of 48676 MiB total
28 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148872])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.45it/s] 20%|██        | 200/1000 [00:01<00:07, 106.68it/s] 30%|███       | 300/1000 [00:02<00:06, 106.75it/s] 40%|████      | 400/1000 [00:03<00:05, 106.85it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.93it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.95it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.95it/s] 73%|███████▎  | 733/1000 [00:06<00:02, 106.73it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.02it/s] 25%|██▌       | 4/16 [00:00<00:01, 11.41it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.74it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.12it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.64it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.91it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.64it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.18it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.87it/s]100%|██████████| 16/16 [00:01<00:00,  9.90it/s]100%|██████████| 16/16 [00:01<00:00, 10.04it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.70it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(72.8405, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5356, device='cuda:6', grad_fn=<DivBackward0>)
42923 MiB free out of 48676 MiB total
28 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150134])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.80it/s] 20%|██        | 200/1000 [00:04<00:18, 43.84it/s] 30%|███       | 300/1000 [00:06<00:15, 43.85it/s] 40%|████      | 400/1000 [00:09<00:13, 43.85it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.87it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.87it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.88it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.88it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.86it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.44it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.68it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.45it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.48it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.99it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.09it/s] 50%|█████     | 8/16 [00:01<00:01,  7.53it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.42it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.99it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.09it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.21it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.67it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.18it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.18it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:21,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.19it/s] 50%|█████     | 50/100 [00:15<00:15,  3.19it/s] 60%|██████    | 60/100 [00:18<00:12,  3.19it/s] 70%|███████   | 70/100 [00:21<00:09,  3.19it/s] 80%|████████  | 80/100 [00:25<00:06,  3.19it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]
H_error tensor(884.3614, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5350, device='cuda:6', grad_fn=<DivBackward0>)
42791 MiB free out of 48676 MiB total
28 mlp.up_proj
Pruning ...
0.01
torch.Size([11150179])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.72it/s] 20%|██        | 200/1000 [00:04<00:18, 43.80it/s] 30%|███       | 300/1000 [00:06<00:15, 43.82it/s] 40%|████      | 400/1000 [00:09<00:13, 43.82it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.82it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.83it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.84it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 84%|████████▍ | 840/1000 [00:19<00:03, 43.78it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.56it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.79it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.86it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.06it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.85it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.22it/s] 50%|█████     | 8/16 [00:01<00:01,  6.55it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.17it/s] 62%|██████▎   | 10/16 [00:01<00:01,  5.99it/s] 69%|██████▉   | 11/16 [00:01<00:00,  5.72it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.41it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.00it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.58it/s]100%|██████████| 16/16 [00:02<00:00,  8.12it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.17it/s] 20%|██        | 20/100 [00:06<00:25,  3.17it/s] 30%|███       | 30/100 [00:09<00:22,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:22<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]100%|██████████| 100/100 [00:31<00:00,  3.17it/s]
H_error tensor(781.6871, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5311, device='cuda:6', grad_fn=<DivBackward0>)
42823 MiB free out of 48676 MiB total
28 mlp.down_proj
Pruning ...
0.01
torch.Size([11158661])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.84it/s] 20%|██        | 200/1000 [00:04<00:18, 43.88it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.86it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.86it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.86it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.85it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.85it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.49it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.83it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.07it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.15it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.59it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.61it/s] 50%|█████     | 8/16 [00:01<00:01,  6.19it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.72it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.30it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.94it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.33it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.62it/s]100%|██████████| 16/16 [00:02<00:00,  7.21it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.68it/s] 20%|██        | 20/100 [00:07<00:29,  2.67it/s] 30%|███       | 30/100 [00:11<00:26,  2.68it/s] 40%|████      | 40/100 [00:14<00:22,  2.67it/s] 50%|█████     | 50/100 [00:18<00:18,  2.67it/s] 60%|██████    | 60/100 [00:22<00:14,  2.67it/s] 70%|███████   | 70/100 [00:26<00:11,  2.67it/s] 80%|████████  | 80/100 [00:29<00:07,  2.67it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.67it/s]100%|██████████| 100/100 [00:37<00:00,  2.67it/s]100%|██████████| 100/100 [00:37<00:00,  2.67it/s]
H_error tensor(20.6046, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5401, device='cuda:6', grad_fn=<DivBackward0>)
42677 MiB free out of 48676 MiB total
29 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149301])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.66it/s] 20%|██        | 200/1000 [00:01<00:07, 106.85it/s] 30%|███       | 300/1000 [00:02<00:06, 106.93it/s] 40%|████      | 400/1000 [00:03<00:05, 106.96it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.99it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.98it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.97it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.98it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.97it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.94it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.94it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.52it/s] 25%|██▌       | 4/16 [00:00<00:01, 11.53it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.54it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.11it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.01it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.15it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.87it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.66it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.43it/s]100%|██████████| 16/16 [00:01<00:00,  9.74it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.71it/s] 20%|██        | 20/100 [00:02<00:08,  9.67it/s] 30%|███       | 30/100 [00:03<00:07,  9.68it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(394.9153, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5398, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
29 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149478])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.75it/s] 20%|██        | 200/1000 [00:01<00:07, 106.76it/s] 30%|███       | 300/1000 [00:02<00:06, 106.82it/s] 40%|████      | 400/1000 [00:03<00:05, 106.85it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.86it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.85it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.85it/s] 71%|███████▏  | 713/1000 [00:06<00:02, 106.69it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.26it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.41it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.41it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.63it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.65it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.16it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.43it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.02it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.75it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.49it/s]100%|██████████| 16/16 [00:01<00:00,  9.52it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.72it/s] 40%|████      | 40/100 [00:04<00:06,  9.71it/s] 50%|█████     | 50/100 [00:05<00:05,  9.70it/s] 60%|██████    | 60/100 [00:06<00:04,  9.71it/s] 70%|███████   | 70/100 [00:07<00:03,  9.70it/s] 80%|████████  | 80/100 [00:08<00:02,  9.70it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.70it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(431.2522, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5414, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
29 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148831])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.66it/s] 20%|██        | 200/1000 [00:01<00:07, 106.75it/s] 30%|███       | 300/1000 [00:02<00:06, 106.84it/s] 40%|████      | 400/1000 [00:03<00:05, 106.86it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.90it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.91it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.93it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.94it/s] 84%|████████▍ | 839/1000 [00:07<00:01, 106.77it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 11.05it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.45it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.57it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.85it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.22it/s] 50%|█████     | 8/16 [00:00<00:00,  9.80it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.33it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.85it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.66it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.42it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.37it/s]100%|██████████| 16/16 [00:01<00:00, 10.05it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.70it/s] 20%|██        | 20/100 [00:02<00:08,  9.67it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.65it/s] 60%|██████    | 60/100 [00:06<00:04,  9.65it/s] 70%|███████   | 70/100 [00:07<00:03,  9.64it/s] 80%|████████  | 80/100 [00:08<00:02,  9.64it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]
H_error tensor(459.9957, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5357, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
29 self_attn.o_proj
Pruning ...
0.01
torch.Size([4149276])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.58it/s] 20%|██        | 200/1000 [00:01<00:07, 106.68it/s] 30%|███       | 300/1000 [00:02<00:06, 106.71it/s] 40%|████      | 400/1000 [00:03<00:05, 106.73it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.69it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.74it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.78it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.80it/s] 90%|████████▉ | 895/1000 [00:08<00:00, 106.65it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.47it/s] 25%|██▌       | 4/16 [00:00<00:01, 11.33it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.46it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.43it/s] 50%|█████     | 8/16 [00:00<00:00,  9.89it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.84it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.68it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.39it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.95it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.89it/s]100%|██████████| 16/16 [00:01<00:00,  9.53it/s]100%|██████████| 16/16 [00:01<00:00, 10.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.71it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.65it/s] 60%|██████    | 60/100 [00:06<00:04,  9.65it/s] 70%|███████   | 70/100 [00:07<00:03,  9.65it/s] 80%|████████  | 80/100 [00:08<00:02,  9.64it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]
H_error tensor(44.1097, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5380, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
29 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150129])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.79it/s] 20%|██        | 200/1000 [00:04<00:18, 43.82it/s] 30%|███       | 300/1000 [00:06<00:15, 43.81it/s] 40%|████      | 400/1000 [00:09<00:13, 43.81it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.81it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.82it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.81it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.81it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.82it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.81it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.19it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.16it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.53it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.23it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.76it/s] 50%|█████     | 8/16 [00:01<00:00,  8.08it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.52it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.86it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.02it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.38it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.58it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.34it/s] 94%|█████████▍| 15/16 [00:02<00:00,  5.91it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.22it/s] 20%|██        | 20/100 [00:06<00:24,  3.21it/s] 30%|███       | 30/100 [00:09<00:21,  3.22it/s] 40%|████      | 40/100 [00:12<00:18,  3.22it/s] 50%|█████     | 50/100 [00:15<00:15,  3.22it/s] 60%|██████    | 60/100 [00:18<00:12,  3.22it/s] 70%|███████   | 70/100 [00:21<00:09,  3.22it/s] 80%|████████  | 80/100 [00:24<00:06,  3.22it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]100%|██████████| 100/100 [00:31<00:00,  3.22it/s]
H_error tensor(882.5096, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5358, device='cuda:6', grad_fn=<DivBackward0>)
43093 MiB free out of 48676 MiB total
29 mlp.up_proj
Pruning ...
0.01
torch.Size([11150225])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.89it/s] 20%|██        | 200/1000 [00:04<00:18, 43.89it/s] 30%|███       | 300/1000 [00:06<00:15, 43.86it/s] 40%|████      | 400/1000 [00:09<00:13, 43.86it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.85it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.86it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.86it/s] 93%|█████████▎| 933/1000 [00:21<00:01, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.53it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.34it/s] 19%|█▉        | 3/16 [00:00<00:02,  5.81it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.20it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.38it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.51it/s] 50%|█████     | 8/16 [00:01<00:01,  7.85it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.02it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.01it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.89it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.26it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.18it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.48it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.17it/s]100%|██████████| 16/16 [00:02<00:00,  6.93it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.20it/s] 20%|██        | 20/100 [00:06<00:24,  3.20it/s] 30%|███       | 30/100 [00:09<00:21,  3.20it/s] 40%|████      | 40/100 [00:12<00:18,  3.20it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.20it/s] 70%|███████   | 70/100 [00:21<00:09,  3.20it/s] 80%|████████  | 80/100 [00:24<00:06,  3.20it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]
H_error tensor(730.4011, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5313, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
29 mlp.down_proj
Pruning ...
0.01
torch.Size([11158766])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.86it/s] 20%|██        | 200/1000 [00:04<00:18, 43.90it/s] 30%|███       | 300/1000 [00:06<00:15, 43.88it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.89it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.89it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.89it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.89it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.90it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.89it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.92it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.75it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.56it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.16it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.29it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.75it/s] 50%|█████     | 8/16 [00:01<00:01,  7.16it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.59it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.50it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.82it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.29it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.82it/s]100%|██████████| 16/16 [00:02<00:00,  6.32it/s]100%|██████████| 16/16 [00:02<00:00,  6.95it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:33,  2.67it/s] 20%|██        | 20/100 [00:07<00:29,  2.67it/s] 30%|███       | 30/100 [00:11<00:26,  2.67it/s] 40%|████      | 40/100 [00:14<00:22,  2.67it/s] 50%|█████     | 50/100 [00:18<00:18,  2.67it/s] 60%|██████    | 60/100 [00:22<00:14,  2.67it/s] 70%|███████   | 70/100 [00:26<00:11,  2.67it/s] 80%|████████  | 80/100 [00:29<00:07,  2.67it/s] 90%|█████████ | 90/100 [00:33<00:03,  2.67it/s]100%|██████████| 100/100 [00:37<00:00,  2.67it/s]100%|██████████| 100/100 [00:37<00:00,  2.67it/s]
H_error tensor(23.0749, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5535, device='cuda:6', grad_fn=<DivBackward0>)
42979 MiB free out of 48676 MiB total
30 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149461])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.49it/s] 20%|██        | 200/1000 [00:01<00:07, 106.66it/s] 30%|███       | 300/1000 [00:02<00:06, 106.66it/s] 40%|████      | 400/1000 [00:03<00:05, 106.67it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.66it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.61it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.64it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.66it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.67it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.68it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.65it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.31it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.91it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.44it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.00it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.46it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.33it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.00it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.89it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.58it/s]100%|██████████| 16/16 [00:01<00:00,  9.49it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.68it/s] 20%|██        | 20/100 [00:02<00:08,  9.65it/s] 30%|███       | 30/100 [00:03<00:07,  9.63it/s] 40%|████      | 40/100 [00:04<00:06,  9.63it/s] 50%|█████     | 50/100 [00:05<00:05,  9.63it/s] 60%|██████    | 60/100 [00:06<00:04,  9.63it/s] 70%|███████   | 70/100 [00:07<00:03,  9.63it/s] 80%|████████  | 80/100 [00:08<00:02,  9.63it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.63it/s]100%|██████████| 100/100 [00:10<00:00,  9.63it/s]100%|██████████| 100/100 [00:10<00:00,  9.63it/s]
H_error tensor(351.2914, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5390, device='cuda:6', grad_fn=<DivBackward0>)
43083 MiB free out of 48676 MiB total
30 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149684])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.35it/s] 20%|██        | 200/1000 [00:01<00:07, 106.60it/s] 30%|███       | 300/1000 [00:02<00:06, 106.67it/s] 40%|████      | 400/1000 [00:03<00:05, 106.70it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.74it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.74it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.77it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.80it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.80it/s] 94%|█████████▍| 944/1000 [00:08<00:00, 106.63it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01, 10.82it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.20it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.15it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.00it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.10it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.74it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.26it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.00it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.70it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.49it/s]100%|██████████| 16/16 [00:01<00:00,  9.98it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.70it/s] 20%|██        | 20/100 [00:02<00:08,  9.67it/s] 30%|███       | 30/100 [00:03<00:07,  9.66it/s] 40%|████      | 40/100 [00:04<00:06,  9.65it/s] 50%|█████     | 50/100 [00:05<00:05,  9.65it/s] 60%|██████    | 60/100 [00:06<00:04,  9.64it/s] 70%|███████   | 70/100 [00:07<00:03,  9.64it/s] 80%|████████  | 80/100 [00:08<00:02,  9.65it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.65it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.65it/s]
H_error tensor(350.8012, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5405, device='cuda:6', grad_fn=<DivBackward0>)
43115 MiB free out of 48676 MiB total
30 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148813])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.46it/s] 20%|██        | 200/1000 [00:01<00:07, 106.57it/s] 30%|███       | 300/1000 [00:02<00:06, 106.66it/s] 40%|████      | 400/1000 [00:03<00:05, 106.75it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.80it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.84it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.83it/s] 80%|████████  | 800/1000 [00:07<00:01, 106.82it/s] 90%|█████████ | 900/1000 [00:08<00:00, 106.81it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.80it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.77it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.61it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.00it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.97it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.33it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.05it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.12it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.66it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.39it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.14it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.81it/s]100%|██████████| 16/16 [00:01<00:00,  9.52it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.77it/s] 30%|███       | 30/100 [00:03<00:07,  9.78it/s] 40%|████      | 40/100 [00:04<00:06,  9.78it/s] 50%|█████     | 50/100 [00:05<00:05,  9.75it/s] 60%|██████    | 60/100 [00:06<00:04,  9.72it/s] 70%|███████   | 70/100 [00:07<00:03,  9.71it/s] 80%|████████  | 80/100 [00:08<00:02,  9.69it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.71it/s]
H_error tensor(404.3979, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5392, device='cuda:6', grad_fn=<DivBackward0>)
43147 MiB free out of 48676 MiB total
30 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148815])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.65it/s] 20%|██        | 200/1000 [00:01<00:07, 106.85it/s] 30%|███       | 300/1000 [00:02<00:06, 106.91it/s] 40%|████      | 400/1000 [00:03<00:05, 106.95it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.96it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.97it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.99it/s] 74%|███████▍  | 738/1000 [00:06<00:02, 106.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.54it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.41it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.03it/s] 50%|█████     | 8/16 [00:00<00:00, 10.73it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.39it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.92it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.33it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.86it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.83it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.56it/s]100%|██████████| 16/16 [00:01<00:00,  9.48it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.66it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.66it/s] 70%|███████   | 70/100 [00:07<00:03,  9.66it/s] 80%|████████  | 80/100 [00:08<00:02,  9.66it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.66it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]
H_error tensor(62.9748, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5479, device='cuda:6', grad_fn=<DivBackward0>)
43179 MiB free out of 48676 MiB total
30 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150293])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.82it/s] 20%|██        | 200/1000 [00:04<00:18, 43.85it/s] 30%|███       | 300/1000 [00:06<00:15, 43.89it/s] 40%|████      | 400/1000 [00:09<00:13, 43.90it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.90it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.89it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.88it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.88it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.88it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.88it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.41it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.25it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.86it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.73it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.35it/s] 50%|█████     | 8/16 [00:01<00:01,  7.30it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.85it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.94it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.98it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.63it/s] 88%|████████▊ | 14/16 [00:02<00:00,  6.16it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.87it/s]100%|██████████| 16/16 [00:02<00:00,  6.42it/s]100%|██████████| 16/16 [00:02<00:00,  6.96it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.15it/s] 20%|██        | 20/100 [00:06<00:25,  3.15it/s] 30%|███       | 30/100 [00:09<00:22,  3.15it/s] 40%|████      | 40/100 [00:12<00:19,  3.15it/s] 50%|█████     | 50/100 [00:15<00:15,  3.15it/s] 60%|██████    | 60/100 [00:19<00:12,  3.15it/s] 70%|███████   | 70/100 [00:22<00:09,  3.15it/s] 80%|████████  | 80/100 [00:25<00:06,  3.15it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.15it/s]100%|██████████| 100/100 [00:31<00:00,  3.15it/s]100%|██████████| 100/100 [00:31<00:00,  3.15it/s]
H_error tensor(671.2168, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5321, device='cuda:6', grad_fn=<DivBackward0>)
43047 MiB free out of 48676 MiB total
30 mlp.up_proj
Pruning ...
0.01
torch.Size([11150382])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.86it/s] 20%|██        | 200/1000 [00:04<00:18, 43.85it/s] 30%|███       | 300/1000 [00:06<00:15, 43.85it/s] 40%|████      | 400/1000 [00:09<00:13, 43.85it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.85it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.85it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.85it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.85it/s] 96%|█████████▌| 957/1000 [00:21<00:00, 43.81it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.55it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.57it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.49it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.81it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.34it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.95it/s] 50%|█████     | 8/16 [00:01<00:01,  6.31it/s] 56%|█████▋    | 9/16 [00:01<00:01,  6.50it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.28it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.22it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.51it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.46it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.98it/s]100%|██████████| 16/16 [00:02<00:00,  6.66it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:27,  3.23it/s] 20%|██        | 20/100 [00:06<00:24,  3.23it/s] 30%|███       | 30/100 [00:09<00:21,  3.23it/s] 40%|████      | 40/100 [00:12<00:18,  3.23it/s] 50%|█████     | 50/100 [00:15<00:15,  3.23it/s] 60%|██████    | 60/100 [00:18<00:12,  3.23it/s] 70%|███████   | 70/100 [00:21<00:09,  3.23it/s] 80%|████████  | 80/100 [00:24<00:06,  3.23it/s] 90%|█████████ | 90/100 [00:27<00:03,  3.23it/s]100%|██████████| 100/100 [00:30<00:00,  3.23it/s]100%|██████████| 100/100 [00:30<00:00,  3.23it/s]
H_error tensor(754.2512, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5347, device='cuda:6', grad_fn=<DivBackward0>)
42993 MiB free out of 48676 MiB total
30 mlp.down_proj
Pruning ...
0.01
torch.Size([11158880])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.87it/s] 20%|██        | 200/1000 [00:04<00:18, 43.93it/s] 30%|███       | 300/1000 [00:06<00:15, 43.94it/s] 40%|████      | 400/1000 [00:09<00:13, 43.93it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.93it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.93it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.93it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.92it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.92it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.92it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.92it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.14it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.08it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.02it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.22it/s] 31%|███▏      | 5/16 [00:00<00:01,  5.89it/s] 38%|███▊      | 6/16 [00:00<00:01,  6.76it/s] 44%|████▍     | 7/16 [00:01<00:01,  6.94it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.11it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.78it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.39it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.03it/s] 88%|████████▊ | 14/16 [00:02<00:00,  7.58it/s] 94%|█████████▍| 15/16 [00:02<00:00,  7.90it/s]100%|██████████| 16/16 [00:02<00:00,  8.01it/s]100%|██████████| 16/16 [00:02<00:00,  6.94it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:35,  2.54it/s] 20%|██        | 20/100 [00:07<00:31,  2.54it/s] 30%|███       | 30/100 [00:11<00:27,  2.54it/s] 40%|████      | 40/100 [00:15<00:23,  2.54it/s] 50%|█████     | 50/100 [00:19<00:19,  2.54it/s] 60%|██████    | 60/100 [00:23<00:15,  2.54it/s] 70%|███████   | 70/100 [00:27<00:11,  2.54it/s] 80%|████████  | 80/100 [00:31<00:07,  2.54it/s] 90%|█████████ | 90/100 [00:35<00:03,  2.54it/s]100%|██████████| 100/100 [00:39<00:00,  2.54it/s]100%|██████████| 100/100 [00:39<00:00,  2.54it/s]
H_error tensor(37.7209, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5851, device='cuda:6', grad_fn=<DivBackward0>)
42629 MiB free out of 48676 MiB total
31 self_attn.q_proj
Pruning ...
0.01
torch.Size([4149489])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.78it/s] 20%|██        | 200/1000 [00:01<00:07, 106.95it/s] 30%|███       | 300/1000 [00:02<00:06, 107.01it/s] 40%|████      | 400/1000 [00:03<00:05, 106.96it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.96it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.95it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.94it/s] 77%|███████▋  | 774/1000 [00:07<00:02, 106.80it/s]
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:01,  9.82it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.34it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.92it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.71it/s] 50%|█████     | 8/16 [00:00<00:00, 10.74it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.18it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.28it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.13it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.07it/s]100%|██████████| 16/16 [00:01<00:00,  9.93it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.73it/s] 20%|██        | 20/100 [00:02<00:08,  9.68it/s] 30%|███       | 30/100 [00:03<00:07,  9.67it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 60%|██████    | 60/100 [00:06<00:04,  9.67it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(210.8859, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5545, device='cuda:6', grad_fn=<DivBackward0>)
42827 MiB free out of 48676 MiB total
31 self_attn.k_proj
Pruning ...
0.01
torch.Size([4149708])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.77it/s] 20%|██        | 200/1000 [00:01<00:07, 106.93it/s] 30%|███       | 300/1000 [00:02<00:06, 106.98it/s] 40%|████      | 400/1000 [00:03<00:05, 107.00it/s] 50%|█████     | 500/1000 [00:04<00:04, 107.01it/s] 60%|██████    | 600/1000 [00:05<00:03, 107.00it/s] 70%|███████   | 700/1000 [00:06<00:02, 107.00it/s] 80%|████████  | 800/1000 [00:07<00:01, 107.03it/s] 90%|█████████ | 900/1000 [00:08<00:00, 107.04it/s] 99%|█████████▉| 990/1000 [00:09<00:00, 106.89it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.65it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.75it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.76it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.23it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.35it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.96it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.73it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.85it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.02it/s]100%|██████████| 16/16 [00:01<00:00,  9.85it/s]100%|██████████| 16/16 [00:01<00:00, 10.05it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.69it/s] 30%|███       | 30/100 [00:03<00:07,  9.69it/s] 40%|████      | 40/100 [00:04<00:06,  9.68it/s] 50%|█████     | 50/100 [00:05<00:05,  9.67it/s] 60%|██████    | 60/100 [00:06<00:04,  9.68it/s] 70%|███████   | 70/100 [00:07<00:03,  9.68it/s] 80%|████████  | 80/100 [00:08<00:02,  9.67it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
H_error tensor(233.9677, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5356, device='cuda:6', grad_fn=<DivBackward0>)
42859 MiB free out of 48676 MiB total
31 self_attn.v_proj
Pruning ...
0.01
torch.Size([4148829])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.56it/s] 20%|██        | 200/1000 [00:01<00:07, 106.74it/s] 30%|███       | 300/1000 [00:02<00:06, 106.80it/s] 40%|████      | 400/1000 [00:03<00:05, 106.84it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.82it/s] 58%|█████▊    | 582/1000 [00:05<00:03, 106.63it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.90it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.01it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.73it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.35it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.34it/s] 50%|█████     | 8/16 [00:00<00:00, 10.16it/s] 62%|██████▎   | 10/16 [00:00<00:00, 10.43it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.04it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.65it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.71it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.36it/s]100%|██████████| 16/16 [00:01<00:00,  9.90it/s]100%|██████████| 16/16 [00:01<00:00, 10.03it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.77it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.70it/s] 50%|█████     | 50/100 [00:05<00:05,  9.69it/s] 60%|██████    | 60/100 [00:06<00:04,  9.69it/s] 70%|███████   | 70/100 [00:07<00:03,  9.69it/s] 80%|████████  | 80/100 [00:08<00:02,  9.68it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.68it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]100%|██████████| 100/100 [00:10<00:00,  9.69it/s]
H_error tensor(155.4072, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5223, device='cuda:6', grad_fn=<DivBackward0>)
42891 MiB free out of 48676 MiB total
31 self_attn.o_proj
Pruning ...
0.01
torch.Size([4148932])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:08, 106.50it/s] 20%|██        | 200/1000 [00:01<00:07, 106.62it/s] 30%|███       | 300/1000 [00:02<00:06, 106.75it/s] 40%|████      | 400/1000 [00:03<00:05, 106.79it/s] 50%|█████     | 500/1000 [00:04<00:04, 106.88it/s] 60%|██████    | 600/1000 [00:05<00:03, 106.90it/s] 70%|███████   | 700/1000 [00:06<00:02, 106.95it/s] 76%|███████▋  | 764/1000 [00:07<00:02, 106.73it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.69it/s] 19%|█▉        | 3/16 [00:00<00:01, 11.42it/s] 25%|██▌       | 4/16 [00:00<00:01, 10.22it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.26it/s] 50%|█████     | 8/16 [00:00<00:00, 10.14it/s] 62%|██████▎   | 10/16 [00:00<00:00,  9.83it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.62it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.20it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.90it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.58it/s]100%|██████████| 16/16 [00:01<00:00, 10.02it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:01<00:09,  9.68it/s] 20%|██        | 20/100 [00:02<00:08,  9.66it/s] 30%|███       | 30/100 [00:03<00:07,  9.65it/s] 40%|████      | 40/100 [00:04<00:06,  9.65it/s] 50%|█████     | 50/100 [00:05<00:05,  9.52it/s] 60%|██████    | 60/100 [00:06<00:04,  9.51it/s] 70%|███████   | 70/100 [00:07<00:03,  9.55it/s] 80%|████████  | 80/100 [00:08<00:02,  9.58it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.60it/s]100%|██████████| 100/100 [00:10<00:00,  9.62it/s]100%|██████████| 100/100 [00:10<00:00,  9.60it/s]
H_error tensor(91.4007, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5418, device='cuda:6', grad_fn=<DivBackward0>)
42859 MiB free out of 48676 MiB total
31 mlp.gate_proj
Pruning ...
0.01
torch.Size([11150708])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.91it/s] 20%|██        | 200/1000 [00:04<00:18, 43.94it/s] 30%|███       | 300/1000 [00:06<00:15, 43.94it/s] 40%|████      | 400/1000 [00:09<00:13, 43.93it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.92it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.91it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.91it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.92it/s] 87%|████████▋ | 871/1000 [00:19<00:02, 43.87it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.45it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.25it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.21it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.27it/s] 31%|███▏      | 5/16 [00:00<00:01,  6.82it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.26it/s] 50%|█████     | 8/16 [00:01<00:00,  8.90it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.10it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.99it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.69it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.87it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.57it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.24it/s]100%|██████████| 16/16 [00:02<00:00,  5.89it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.19it/s] 30%|███       | 30/100 [00:09<00:21,  3.19it/s] 40%|████      | 40/100 [00:12<00:18,  3.19it/s] 50%|█████     | 50/100 [00:15<00:15,  3.20it/s] 60%|██████    | 60/100 [00:18<00:12,  3.20it/s] 70%|███████   | 70/100 [00:21<00:09,  3.20it/s] 80%|████████  | 80/100 [00:25<00:06,  3.20it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]100%|██████████| 100/100 [00:31<00:00,  3.20it/s]
H_error tensor(525.6517, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5356, device='cuda:6', grad_fn=<DivBackward0>)
42773 MiB free out of 48676 MiB total
31 mlp.up_proj
Pruning ...
0.01
torch.Size([11150651])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.91it/s] 20%|██        | 200/1000 [00:04<00:18, 43.93it/s] 30%|███       | 300/1000 [00:06<00:15, 43.90it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.87it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.87it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.86it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.85it/s] 83%|████████▎ | 833/1000 [00:19<00:03, 43.82it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.33it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.26it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.09it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.19it/s] 50%|█████     | 8/16 [00:00<00:00,  8.86it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.59it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.12it/s] 69%|██████▉   | 11/16 [00:01<00:00,  6.47it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.18it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.85it/s] 88%|████████▊ | 14/16 [00:01<00:00,  6.37it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.01it/s]100%|██████████| 16/16 [00:02<00:00,  6.28it/s]100%|██████████| 16/16 [00:02<00:00,  6.97it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:03<00:28,  3.19it/s] 20%|██        | 20/100 [00:06<00:25,  3.18it/s] 30%|███       | 30/100 [00:09<00:21,  3.18it/s] 40%|████      | 40/100 [00:12<00:18,  3.18it/s] 50%|█████     | 50/100 [00:15<00:15,  3.18it/s] 60%|██████    | 60/100 [00:18<00:12,  3.18it/s] 70%|███████   | 70/100 [00:21<00:09,  3.18it/s] 80%|████████  | 80/100 [00:25<00:06,  3.18it/s] 90%|█████████ | 90/100 [00:28<00:03,  3.18it/s]100%|██████████| 100/100 [00:31<00:00,  3.19it/s]100%|██████████| 100/100 [00:31<00:00,  3.18it/s]
H_error tensor(506.4132, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.5394, device='cuda:6', grad_fn=<DivBackward0>)
42759 MiB free out of 48676 MiB total
31 mlp.down_proj
Pruning ...
0.01
torch.Size([11158759])
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:02<00:20, 43.86it/s] 20%|██        | 200/1000 [00:04<00:18, 43.91it/s] 30%|███       | 300/1000 [00:06<00:15, 43.90it/s] 40%|████      | 400/1000 [00:09<00:13, 43.88it/s] 50%|█████     | 500/1000 [00:11<00:11, 43.88it/s] 60%|██████    | 600/1000 [00:13<00:09, 43.89it/s] 70%|███████   | 700/1000 [00:15<00:06, 43.89it/s] 80%|████████  | 800/1000 [00:18<00:04, 43.88it/s] 90%|█████████ | 900/1000 [00:20<00:02, 43.89it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.88it/s]100%|██████████| 1000/1000 [00:22<00:00, 43.89it/s]
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.34it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.46it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.75it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.48it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.83it/s] 44%|████▍     | 7/16 [00:00<00:01,  6.86it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.10it/s] 62%|██████▎   | 10/16 [00:01<00:00,  6.79it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.26it/s] 75%|███████▌  | 12/16 [00:01<00:00,  6.60it/s] 81%|████████▏ | 13/16 [00:01<00:00,  6.27it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.98it/s]100%|██████████| 16/16 [00:02<00:00,  7.27it/s]100%|██████████| 16/16 [00:02<00:00,  7.08it/s]
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:04<00:39,  2.30it/s] 20%|██        | 20/100 [00:08<00:34,  2.30it/s] 30%|███       | 30/100 [00:13<00:30,  2.30it/s] 40%|████      | 40/100 [00:17<00:26,  2.30it/s] 50%|█████     | 50/100 [00:21<00:21,  2.30it/s] 60%|██████    | 60/100 [00:26<00:17,  2.30it/s] 70%|███████   | 70/100 [00:30<00:13,  2.30it/s] 80%|████████  | 80/100 [00:34<00:08,  2.30it/s] 90%|█████████ | 90/100 [00:39<00:04,  2.30it/s]100%|██████████| 100/100 [00:43<00:00,  2.30it/s]100%|██████████| 100/100 [00:43<00:00,  2.30it/s]
H_error tensor(-15822.6113, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(1.8085, device='cuda:6', grad_fn=<DivBackward0>)
42395 MiB free out of 48676 MiB total
8380.705568552017
/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Token indices sequence length is longer than the specified maximum sequence length for this model (2824491 > 2048). Running this sequence through the model will result in indexing errors
Dataset: wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
Perplexity: 381.967621
