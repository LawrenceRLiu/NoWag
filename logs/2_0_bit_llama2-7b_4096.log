/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.52it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.41it/s]
Model loaded. LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 4096)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=4096, out_features=32000, bias=False)
)
4096
Loading tokenizer for meta-llama/Llama-2-7b-hf
Starting...
Ready.
0 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 20.26126742362976 s
stopped after 9 iterations
20.602 s H_error tensor(1.5280, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3511, device='cuda:6', grad_fn=<DivBackward0>)
38217 MiB free out of 48676 MiB total
0 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.30710530281067 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
18.605 s H_error tensor(1.1719, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3480, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
0 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.15276050567627 s
stopped after 9 iterations
18.442 s H_error tensor(0.0746, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3774, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
0 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.019345998764038 s
stopped after 9 iterations
18.301 s H_error tensor(0.0107, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3606, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
0 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.408902645111084 s
stopped after 9 iterations
46.324 s H_error tensor(3.6926, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3240, device='cuda:6', grad_fn=<DivBackward0>)
38355 MiB free out of 48676 MiB total
0 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.50480818748474 s
stopped after 9 iterations
46.433 s H_error tensor(3.3534, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3243, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
0 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.3560471534729 s
stopped after 9 iterations
46.8 s H_error tensor(0.0106, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3383, device='cuda:6', grad_fn=<DivBackward0>)
38619 MiB free out of 48676 MiB total
1 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.406500816345215 s
stopped after 9 iterations
19.701 s H_error tensor(-12.5118, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3788, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
1 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.09485936164856 s
stopped after 9 iterations
18.398 s H_error tensor(-7.0660, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3736, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
1 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.167881727218628 s
stopped after 9 iterations
18.464 s H_error tensor(0.7474, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3803, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
1 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.117066621780396 s
stopped after 9 iterations
18.42 s H_error tensor(0.0783, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3323, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
1 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.6567645072937 s
stopped after 9 iterations
46.57 s H_error tensor(15.0657, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3192, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
1 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.53811049461365 s
stopped after 9 iterations
46.456 s H_error tensor(12.8300, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
1 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.12855935096741 s
stopped after 9 iterations
46.571 s H_error tensor(-5.4364, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3361, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
2 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.567306518554688 s
stopped after 9 iterations
19.878 s H_error tensor(62.7048, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3377, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
2 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.115264892578125 s
stopped after 9 iterations
18.418 s H_error tensor(72.7565, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3398, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
2 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.069515466690063 s
stopped after 9 iterations
18.376 s H_error tensor(13.1123, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3295, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
2 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.071635961532593 s
stopped after 9 iterations
18.364 s H_error tensor(0.1908, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3248, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
2 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.64060568809509 s
stopped after 9 iterations
46.55 s H_error tensor(33.5539, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3163, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
2 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.299805641174316 s
stopped after 9 iterations
46.201 s H_error tensor(28.2479, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3142, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
2 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.177741050720215 s
stopped after 9 iterations
46.609 s H_error tensor(0.1707, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3170, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
3 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.469011306762695 s
stopped after 9 iterations
19.762 s H_error tensor(157.7913, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3340, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
3 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.055147171020508 s
stopped after 9 iterations
18.357 s H_error tensor(178.4360, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3363, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
3 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.231969594955444 s
stopped after 9 iterations
18.533 s H_error tensor(36.4291, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3269, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
3 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.99411177635193 s
stopped after 9 iterations
18.289 s H_error tensor(0.3130, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3239, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
3 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.51659154891968 s
stopped after 9 iterations
46.423 s H_error tensor(52.3619, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3146, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
3 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.42090153694153 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.342 s H_error tensor(43.8045, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3143, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
3 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.373384952545166 s
stopped after 9 iterations
46.813 s H_error tensor(0.2859, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
4 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.53839612007141 s
stopped after 9 iterations
19.829 s H_error tensor(149.2331, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3316, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
4 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.087160348892212 s
stopped after 9 iterations
18.384 s H_error tensor(168.6625, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3329, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
4 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.01305842399597 s
stopped after 9 iterations
18.307 s H_error tensor(35.6264, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3237, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
4 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.011980295181274 s
stopped after 9 iterations
18.303 s H_error tensor(0.5245, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3218, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
4 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.41540598869324 s
stopped after 9 iterations
46.341 s H_error tensor(79.3431, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
4 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.356260776519775 s
stopped after 9 iterations
46.261 s H_error tensor(63.2725, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
4 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.20305800437927 s
stopped after 9 iterations
46.63 s H_error tensor(0.5594, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3204, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
5 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.80643367767334 s
stopped after 9 iterations
20.095 s H_error tensor(165.5468, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3298, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
5 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.309894323349 s
stopped after 9 iterations
18.601 s H_error tensor(200.0039, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3314, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
5 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.04975414276123 s
stopped after 9 iterations
18.341 s H_error tensor(42.3190, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3235, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
5 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.041488647460938 s
stopped after 9 iterations
18.337 s H_error tensor(0.7921, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3232, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
5 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.430968046188354 s
stopped after 9 iterations
46.355 s H_error tensor(101.0921, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3156, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
5 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.80238175392151 s
stopped after 9 iterations
46.737 s H_error tensor(78.9932, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3152, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
5 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.656827211380005 s
stopped after 9 iterations
47.098 s H_error tensor(0.7837, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3184, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
6 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.740346670150757 s
stopped after 9 iterations
20.039 s H_error tensor(248.4735, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3302, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
6 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.579153537750244 s
stopped after 9 iterations
18.877 s H_error tensor(266.4767, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3309, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
6 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.19995880126953 s
stopped after 9 iterations
18.495 s H_error tensor(62.6631, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3271, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
6 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.44798731803894 s
stopped after 9 iterations
18.742 s H_error tensor(1.3285, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3197, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
6 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.19928574562073 s
stopped after 9 iterations
47.112 s H_error tensor(126.0733, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3160, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
6 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.48201274871826 s
stopped after 9 iterations
46.394 s H_error tensor(95.3731, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3157, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
6 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.561443567276 s
stopped after 9 iterations
46.996 s H_error tensor(1.2180, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3206, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
7 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.869445323944092 s
stopped after 9 iterations
20.163 s H_error tensor(266.2031, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3310, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
7 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.633748292922974 s
stopped after 9 iterations
18.929 s H_error tensor(279.5869, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3313, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
7 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.411755561828613 s
stopped after 9 iterations
18.713 s H_error tensor(69.1811, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3274, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
7 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.422604084014893 s
stopped after 9 iterations
18.723 s H_error tensor(2.3679, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3191, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
7 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.46285271644592 s
stopped after 9 iterations
46.377 s H_error tensor(142.4529, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
7 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.47848701477051 s
stopped after 9 iterations
46.392 s H_error tensor(108.8363, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
7 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.3011155128479 s
stopped after 9 iterations
46.739 s H_error tensor(1.7087, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3204, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
8 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.476136445999146 s
stopped after 9 iterations
19.778 s H_error tensor(255.6740, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3300, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
8 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.123180389404297 s
stopped after 9 iterations
18.417 s H_error tensor(272.5659, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3300, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
8 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.141618728637695 s
stopped after 9 iterations
18.441 s H_error tensor(70.6596, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3254, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
8 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.925647258758545 s
stopped after 9 iterations
18.215 s H_error tensor(3.8226, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3184, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
8 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.20875954627991 s
stopped after 9 iterations
46.113 s H_error tensor(147.8943, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3165, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
8 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.04560136795044 s
stopped after 9 iterations
46.989 s H_error tensor(119.3577, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
8 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.325963735580444 s
stopped after 9 iterations
46.761 s H_error tensor(2.1258, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
9 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.486180067062378 s
stopped after 9 iterations
19.788 s H_error tensor(266.4667, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3294, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
9 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.99817943572998 s
stopped after 9 iterations
18.297 s H_error tensor(303.2358, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3307, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
9 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.134201526641846 s
stopped after 9 iterations
18.431 s H_error tensor(76.6835, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3238, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
9 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.076348066329956 s
stopped after 9 iterations
18.367 s H_error tensor(5.1385, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3177, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
9 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.462584018707275 s
stopped after 9 iterations
46.373 s H_error tensor(152.6430, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
9 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.63996171951294 s
stopped after 9 iterations
46.549 s H_error tensor(127.4723, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3169, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
9 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.383474349975586 s
stopped after 9 iterations
46.816 s H_error tensor(2.5375, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
10 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.444430828094482 s
stopped after 9 iterations
19.75 s H_error tensor(266.5063, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3287, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
10 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.13491153717041 s
stopped after 9 iterations
18.432 s H_error tensor(313.4227, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3290, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
10 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.098547220230103 s
stopped after 9 iterations
18.393 s H_error tensor(76.1014, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3223, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
10 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.136255741119385 s
stopped after 9 iterations
18.427 s H_error tensor(7.8255, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3163, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
10 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.656548500061035 s
stopped after 9 iterations
46.575 s H_error tensor(160.7219, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3169, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
10 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.48230028152466 s
stopped after 9 iterations
46.41 s H_error tensor(138.2958, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
10 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.22010016441345 s
stopped after 9 iterations
46.654 s H_error tensor(2.9946, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
11 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.489927530288696 s
stopped after 9 iterations
19.783 s H_error tensor(303.7311, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3268, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
11 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.251096963882446 s
stopped after 9 iterations
18.543 s H_error tensor(316.2145, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3263, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
11 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.105226755142212 s
stopped after 9 iterations
18.402 s H_error tensor(103.4790, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3228, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
11 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.038707733154297 s
stopped after 9 iterations
18.329 s H_error tensor(8.7011, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
11 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.34803652763367 s
stopped after 9 iterations
47.276 s H_error tensor(175.0505, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3163, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
11 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.92981767654419 s
stopped after 9 iterations
47.835 s H_error tensor(154.8367, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3165, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
11 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.9608952999115 s
stopped after 9 iterations
47.392 s H_error tensor(3.4029, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3182, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
12 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.531468152999878 s
stopped after 9 iterations
19.824 s H_error tensor(305.4955, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3251, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
12 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.200056552886963 s
stopped after 9 iterations
18.499 s H_error tensor(341.4547, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3264, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
12 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.13252091407776 s
stopped after 9 iterations
18.432 s H_error tensor(100.5323, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3208, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
12 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.05566692352295 s
stopped after 9 iterations
18.352 s H_error tensor(8.8670, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3152, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
12 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.38514709472656 s
stopped after 9 iterations
46.297 s H_error tensor(183.6633, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3158, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
12 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.37128305435181 s
stopped after 9 iterations
46.279 s H_error tensor(167.8136, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3153, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
12 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.388678312301636 s
stopped after 9 iterations
46.819 s H_error tensor(3.6663, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3181, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
13 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.602028131484985 s
stopped after 9 iterations
19.897 s H_error tensor(319.5729, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3262, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
13 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.15445566177368 s
stopped after 9 iterations
18.449 s H_error tensor(352.0518, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3265, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
13 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.222256183624268 s
stopped after 9 iterations
18.519 s H_error tensor(112.1716, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3210, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
13 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.025026559829712 s
stopped after 9 iterations
18.32 s H_error tensor(9.2649, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3172, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
13 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.510977029800415 s
stopped after 9 iterations
46.42 s H_error tensor(192.3158, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3158, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
13 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.51948356628418 s
stopped after 9 iterations
46.428 s H_error tensor(179.6622, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
13 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.426095485687256 s
stopped after 9 iterations
46.871 s H_error tensor(4.2140, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3196, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
14 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.442100048065186 s
stopped after 9 iterations
19.738 s H_error tensor(328.2145, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3251, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
14 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.150818347930908 s
stopped after 9 iterations
18.447 s H_error tensor(353.8988, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3250, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
14 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.26692771911621 s
stopped after 9 iterations
18.561 s H_error tensor(111.9431, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3195, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
14 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.1126868724823 s
stopped after 9 iterations
18.404 s H_error tensor(12.2815, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
14 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.54186725616455 s
stopped after 9 iterations
46.463 s H_error tensor(207.2798, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
14 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.609074115753174 s
stopped after 9 iterations
46.51 s H_error tensor(194.9135, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3151, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
14 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.46394753456116 s
stopped after 9 iterations
46.9 s H_error tensor(4.9743, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3188, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
15 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.5046124458313 s
stopped after 9 iterations
19.807 s H_error tensor(304.4011, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3266, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
15 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.07425618171692 s
stopped after 9 iterations
18.367 s H_error tensor(351.2596, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3266, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
15 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.090981483459473 s
stopped after 9 iterations
18.387 s H_error tensor(115.4352, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3214, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
15 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.04421639442444 s
stopped after 9 iterations
18.335 s H_error tensor(11.0581, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3151, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
15 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.406267404556274 s
stopped after 9 iterations
46.313 s H_error tensor(226.0206, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3162, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
15 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.57556462287903 s
stopped after 9 iterations
46.481 s H_error tensor(212.6460, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3159, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
15 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.361085176467896 s
stopped after 9 iterations
46.791 s H_error tensor(6.0164, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3207, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
16 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.526509046554565 s
stopped after 9 iterations
19.825 s H_error tensor(315.5465, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3246, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
16 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.189192533493042 s
stopped after 9 iterations
18.485 s H_error tensor(348.6448, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3248, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
16 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.086989164352417 s
stopped after 9 iterations
18.381 s H_error tensor(130.7793, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3186, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
16 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.118977785110474 s
stopped after 9 iterations
18.412 s H_error tensor(13.4717, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3148, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
16 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.5019896030426 s
stopped after 9 iterations
46.423 s H_error tensor(263.5316, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
16 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.628921031951904 s
stopped after 9 iterations
46.534 s H_error tensor(244.5012, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
16 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.37426733970642 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
46.82 s H_error tensor(8.0558, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3220, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
17 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.61403799057007 s
stopped after 9 iterations
19.909 s H_error tensor(329.6978, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3236, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
17 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.07037854194641 s
stopped after 9 iterations
18.366 s H_error tensor(357.4441, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3238, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
17 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.10446810722351 s
stopped after 9 iterations
18.396 s H_error tensor(138.6712, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
17 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.080599546432495 s
stopped after 9 iterations
18.369 s H_error tensor(9.9399, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3146, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
17 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.51713514328003 s
stopped after 9 iterations
46.417 s H_error tensor(299.9147, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3152, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
17 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.56014394760132 s
stopped after 9 iterations
46.491 s H_error tensor(270.4114, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3133, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
17 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.53572940826416 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
46.976 s H_error tensor(8.9657, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3191, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
18 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.590106964111328 s
stopped after 9 iterations
19.888 s H_error tensor(356.8150, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3241, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
18 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.392637252807617 s
stopped after 9 iterations
18.701 s H_error tensor(386.8694, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3249, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
18 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.38765597343445 s
stopped after 9 iterations
18.682 s H_error tensor(169.1142, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3174, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
18 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.433118104934692 s
stopped after 9 iterations
18.727 s H_error tensor(8.4018, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3165, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
18 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.06459188461304 s
stopped after 9 iterations
46.984 s H_error tensor(340.7795, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3148, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
18 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.475602865219116 s
stopped after 9 iterations
46.39 s H_error tensor(298.6137, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3129, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
18 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.36443209648132 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
46.814 s H_error tensor(10.4339, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3206, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
19 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.64936637878418 s
stopped after 9 iterations
19.943 s H_error tensor(350.2447, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3233, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
19 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.13678479194641 s
stopped after 9 iterations
18.433 s H_error tensor(371.7594, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3236, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
19 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.125652313232422 s
stopped after 9 iterations
18.418 s H_error tensor(172.8074, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3186, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
19 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.098386526107788 s
stopped after 9 iterations
18.392 s H_error tensor(9.6325, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3160, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
19 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.24409103393555 s
stopped after 9 iterations
47.162 s H_error tensor(364.7131, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3144, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
19 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.287057399749756 s
stopped after 9 iterations
47.198 s H_error tensor(320.7491, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3129, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
19 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.7257034778595 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
47.159 s H_error tensor(11.1667, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3197, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
20 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.491516590118408 s
stopped after 9 iterations
19.788 s H_error tensor(355.1484, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3236, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
20 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.144789934158325 s
stopped after 9 iterations
18.434 s H_error tensor(373.0186, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3234, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
20 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.120912551879883 s
stopped after 9 iterations
18.419 s H_error tensor(176.3450, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
20 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.144514083862305 s
stopped after 9 iterations
18.439 s H_error tensor(12.6149, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3172, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
20 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.58229875564575 s
stopped after 9 iterations
46.48 s H_error tensor(393.5190, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
20 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.59662365913391 s
stopped after 9 iterations
46.493 s H_error tensor(341.9927, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3130, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
20 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.41136026382446 s
stopped after 9 iterations
46.869 s H_error tensor(13.8370, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3213, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
21 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.55394434928894 s
stopped after 9 iterations
19.848 s H_error tensor(377.4962, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3233, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
21 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.17985463142395 s
stopped after 9 iterations
18.473 s H_error tensor(393.8939, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3235, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
21 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.11660361289978 s
stopped after 9 iterations
18.41 s H_error tensor(212.7133, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3167, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
21 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.204822063446045 s
stopped after 9 iterations
18.51 s H_error tensor(10.1232, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3170, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
21 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.57501554489136 s
stopped after 9 iterations
46.494 s H_error tensor(424.3513, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3143, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
21 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.499693155288696 s
stopped after 9 iterations
46.409 s H_error tensor(363.5355, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3125, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
21 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.3836407661438 s
stopped after 9 iterations
46.827 s H_error tensor(14.5531, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
22 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.474441051483154 s
stopped after 9 iterations
19.77 s H_error tensor(411.6746, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3238, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
22 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.20556116104126 s
stopped after 9 iterations
18.498 s H_error tensor(428.0986, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3243, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
22 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.095601797103882 s
stopped after 9 iterations
18.387 s H_error tensor(221.0837, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
22 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.076672077178955 s
stopped after 9 iterations
18.369 s H_error tensor(53.4146, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3182, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
22 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.4932324886322 s
stopped after 9 iterations
46.394 s H_error tensor(439.3405, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3141, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
22 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.513248920440674 s
stopped after 9 iterations
46.42 s H_error tensor(372.2513, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3126, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
22 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.47921323776245 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.91 s H_error tensor(15.5575, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3183, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
23 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.421836853027344 s
stopped after 9 iterations
19.716 s H_error tensor(446.9526, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3224, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
23 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.079827308654785 s
stopped after 9 iterations
18.378 s H_error tensor(464.5421, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3233, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
23 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.264015436172485 s
stopped after 9 iterations
18.558 s H_error tensor(274.8742, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3157, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
23 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.0654296875 s
stopped after 9 iterations
18.361 s H_error tensor(13.6730, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3148, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
23 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.431769132614136 s
stopped after 9 iterations
46.332 s H_error tensor(493.8573, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3138, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
23 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.850322008132935 s
stopped after 9 iterations
46.759 s H_error tensor(418.5350, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3121, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
23 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.515316009521484 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
46.94 s H_error tensor(18.2369, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3173, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
24 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.47915816307068 s
stopped after 9 iterations
19.772 s H_error tensor(408.0708, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3215, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
24 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.30454659461975 s
stopped after 9 iterations
18.611 s H_error tensor(419.6906, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3229, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
24 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.085163354873657 s
stopped after 9 iterations
18.388 s H_error tensor(263.5635, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
24 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.08284068107605 s
stopped after 9 iterations
18.377 s H_error tensor(31.2665, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3180, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
24 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.428229570388794 s
stopped after 9 iterations
46.328 s H_error tensor(513.6255, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3136, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
24 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.537965297698975 s
stopped after 9 iterations
46.452 s H_error tensor(437.5900, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3118, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
24 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.49919033050537 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
46.948 s H_error tensor(19.1823, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3167, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
25 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.522626638412476 s
stopped after 9 iterations
19.816 s H_error tensor(482.5468, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3206, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
25 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.258909940719604 s
stopped after 9 iterations
18.561 s H_error tensor(492.3340, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3228, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
25 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.110596895217896 s
stopped after 9 iterations
18.403 s H_error tensor(329.6988, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3150, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
25 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.081096410751343 s
stopped after 9 iterations
18.377 s H_error tensor(18.9312, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3177, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
25 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.52484393119812 s
stopped after 9 iterations
46.461 s H_error tensor(566.4931, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3137, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
25 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.63383102416992 s
stopped after 9 iterations
46.537 s H_error tensor(482.4452, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3120, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
25 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.3540985584259 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
46.787 s H_error tensor(20.9777, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3179, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
26 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.54279088973999 s
stopped after 9 iterations
19.844 s H_error tensor(448.9207, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3218, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
26 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.13011908531189 s
stopped after 9 iterations
18.423 s H_error tensor(478.5405, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3227, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
26 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.314998149871826 s
stopped after 9 iterations
18.608 s H_error tensor(324.7200, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3159, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
26 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.13880753517151 s
stopped after 9 iterations
18.429 s H_error tensor(35.8410, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3215, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
26 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.43602204322815 s
stopped after 9 iterations
46.345 s H_error tensor(589.5817, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3142, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
26 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.62089729309082 s
stopped after 9 iterations
46.54 s H_error tensor(506.8071, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3123, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
26 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.27685070037842 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.734 s H_error tensor(22.7467, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3184, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
27 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.49599528312683 s
stopped after 9 iterations
19.798 s H_error tensor(506.0421, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3212, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
27 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.10330820083618 s
stopped after 9 iterations
18.402 s H_error tensor(525.2516, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3229, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
27 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.03855609893799 s
stopped after 9 iterations
18.335 s H_error tensor(347.1796, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3151, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
27 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.03933620452881 s
stopped after 9 iterations
18.329 s H_error tensor(19.5467, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3180, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
27 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.65051484107971 s
stopped after 9 iterations
46.58 s H_error tensor(642.0778, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3146, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
27 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.57578802108765 s
stopped after 9 iterations
46.486 s H_error tensor(556.1224, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3133, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
27 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.75445747375488 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
47.194 s H_error tensor(27.0914, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3211, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
28 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.534794092178345 s
stopped after 9 iterations
19.828 s H_error tensor(489.4899, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3202, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
28 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.07838463783264 s
stopped after 9 iterations
18.375 s H_error tensor(503.9091, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3213, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
28 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.098563194274902 s
stopped after 9 iterations
18.395 s H_error tensor(378.5585, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3151, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
28 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.083198308944702 s
stopped after 9 iterations
18.374 s H_error tensor(29.9215, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3189, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
28 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.58577489852905 s
stopped after 9 iterations
46.5 s H_error tensor(676.5947, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3147, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
28 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.52944087982178 s
stopped after 9 iterations
46.449 s H_error tensor(607.0734, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3146, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
28 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.338682889938354 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
46.784 s H_error tensor(32.6609, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3245, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
29 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.524000644683838 s
stopped after 9 iterations
19.816 s H_error tensor(419.9734, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3202, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
29 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.156195878982544 s
stopped after 9 iterations
18.45 s H_error tensor(441.9449, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3213, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
29 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.41391611099243 s
stopped after 9 iterations
18.704 s H_error tensor(352.9066, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3137, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
29 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.100388765335083 s
stopped after 9 iterations
18.394 s H_error tensor(30.6383, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3202, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
29 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.832452058792114 s
stopped after 9 iterations
46.738 s H_error tensor(702.8911, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3158, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
29 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.71715998649597 s
stopped after 9 iterations
46.632 s H_error tensor(634.9280, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
29 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.3157377243042 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.759 s H_error tensor(39.3071, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3306, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
30 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.53981876373291 s
stopped after 9 iterations
19.833 s H_error tensor(467.8381, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3203, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
30 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.169599771499634 s
stopped after 9 iterations
18.463 s H_error tensor(482.4424, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3200, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
30 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.10250425338745 s
stopped after 9 iterations
18.397 s H_error tensor(401.1374, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3151, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
30 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.088494777679443 s
stopped after 9 iterations
18.375 s H_error tensor(35.7392, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3213, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
30 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.64675211906433 s
stopped after 9 iterations
46.563 s H_error tensor(766.8120, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3175, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
30 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.01013779640198 s
stopped after 9 iterations
46.936 s H_error tensor(673.3339, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3173, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
30 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.05653786659241 s
stopped after 9 iterations
47.503 s H_error tensor(58.8443, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3503, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
31 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.492449522018433 s
stopped after 9 iterations
19.784 s H_error tensor(320.5583, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3183, device='cuda:6', grad_fn=<DivBackward0>)
38281 MiB free out of 48676 MiB total
31 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.179638147354126 s
stopped after 9 iterations
18.473 s H_error tensor(353.3711, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3194, device='cuda:6', grad_fn=<DivBackward0>)
38313 MiB free out of 48676 MiB total
31 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.136709690093994 s
stopped after 9 iterations
18.432 s H_error tensor(226.5860, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3134, device='cuda:6', grad_fn=<DivBackward0>)
38345 MiB free out of 48676 MiB total
31 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.112359762191772 s
stopped after 9 iterations
18.413 s H_error tensor(163.0121, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3247, device='cuda:6', grad_fn=<DivBackward0>)
38409 MiB free out of 48676 MiB total
31 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.654699087142944 s
stopped after 9 iterations
46.566 s H_error tensor(663.5897, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3192, device='cuda:6', grad_fn=<DivBackward0>)
38183 MiB free out of 48676 MiB total
31 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.00599694252014 s
stopped after 9 iterations
46.935 s H_error tensor(613.3081, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3205, device='cuda:6', grad_fn=<DivBackward0>)
38301 MiB free out of 48676 MiB total
31 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.52631974220276 s
stopped after 9 iterations
46.99 s H_error tensor(135.9516, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.4048, device='cuda:6', grad_fn=<DivBackward0>)
38447 MiB free out of 48676 MiB total
Total bits: 12995657728.0 Total params: 6476005376
average bits per value: 2.0067397992227978
7517.4855699539185
Loading tokenizer for meta-llama/Llama-2-7b-hf
/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Dataset: wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
Perplexity: 8.344377
