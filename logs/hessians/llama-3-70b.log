Generating hessians for meta-llama/Meta-Llama-3-70B with 128 samples
Using Llama-3 so setting seqlen to 8192
/data/lliu/huffman
/home/lliu/anaconda3/lib/python3.11/site-packages/torch/jit/annotations.py:389: UserWarning: TorchScript will treat type annotations of Tensor dtype-specific subtypes as if they are normal Tensors. dtype constraints are not enforced in compilation either.
  warnings.warn(
2024-12-23 15:27:33.105419: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-12-23 15:27:33.123332: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-12-23 15:27:33.128691: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-12-23 15:27:33.144236: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-12-23 15:27:34.387520: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:07,  4.03it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:06,  4.66it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:05,  4.95it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:05,  5.13it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:01<00:05,  4.95it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:01<00:04,  5.04it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:01<00:04,  5.12it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:04,  5.17it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:04,  5.21it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:03,  5.23it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:02<00:03,  5.25it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:02<00:03,  5.00it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:02<00:03,  4.84it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:02<00:03,  4.78it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:03<00:03,  4.57it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:03<00:03,  4.46it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:03<00:02,  4.57it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:03<00:02,  4.65it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:03<00:02,  4.73it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:04<00:02,  4.79it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:04<00:01,  4.85it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:04<00:01,  4.91it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:04<00:01,  4.96it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:04<00:01,  4.93it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:05<00:01,  4.99it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:05<00:00,  4.44it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:05<00:00,  4.67it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:05<00:00,  4.85it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:05<00:00,  5.00it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:06<00:00,  5.09it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:06<00:00,  4.88it/s]
Model loaded. LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(128256, 8192)
    (layers): ModuleList(
      (0-79): 80 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=8192, out_features=8192, bias=False)
          (k_proj): Linear(in_features=8192, out_features=1024, bias=False)
          (v_proj): Linear(in_features=8192, out_features=1024, bias=False)
          (o_proj): Linear(in_features=8192, out_features=8192, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=8192, out_features=28672, bias=False)
          (up_proj): Linear(in_features=8192, out_features=28672, bias=False)
          (down_proj): Linear(in_features=28672, out_features=8192, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((8192,), eps=1e-05)
        (post_attention_layernorm): LlamaRMSNorm((8192,), eps=1e-05)
      )
    )
    (norm): LlamaRMSNorm((8192,), eps=1e-05)
    (rotary_emb): LlamaRotaryEmbedding()
  )
  (lm_head): Linear(in_features=8192, out_features=128256, bias=False)
)
Starting...
getting inputs:   0%|          | 0/128 [00:00<?, ?it/s]getting inputs:   1%|          | 1/128 [00:00<01:30,  1.40it/s]getting inputs:   2%|▏         | 2/128 [00:00<00:45,  2.78it/s]getting inputs:   2%|▏         | 3/128 [00:00<00:30,  4.12it/s]getting inputs:   3%|▎         | 4/128 [00:01<00:23,  5.22it/s]getting inputs:   4%|▍         | 5/128 [00:01<00:19,  6.16it/s]getting inputs:   5%|▍         | 6/128 [00:01<00:17,  6.98it/s]getting inputs:   5%|▌         | 7/128 [00:01<00:15,  7.63it/s]getting inputs:   6%|▋         | 8/128 [00:01<00:14,  8.12it/s]getting inputs:   7%|▋         | 9/128 [00:01<00:14,  8.29it/s]getting inputs:   8%|▊         | 10/128 [00:01<00:13,  8.57it/s]getting inputs:   9%|▊         | 11/128 [00:01<00:13,  8.79it/s]getting inputs:   9%|▉         | 12/128 [00:01<00:12,  8.94it/s]getting inputs:  10%|█         | 13/128 [00:02<00:13,  8.83it/s]getting inputs:  11%|█         | 14/128 [00:02<00:12,  8.98it/s]getting inputs:  12%|█▏        | 15/128 [00:02<00:12,  9.08it/s]getting inputs:  12%|█▎        | 16/128 [00:02<00:12,  9.19it/s]getting inputs:  13%|█▎        | 17/128 [00:02<00:12,  9.07it/s]getting inputs:  14%|█▍        | 18/128 [00:02<00:12,  9.16it/s]getting inputs:  15%|█▍        | 19/128 [00:02<00:11,  9.22it/s]getting inputs:  16%|█▌        | 20/128 [00:02<00:11,  9.22it/s]getting inputs:  16%|█▋        | 21/128 [00:02<00:11,  9.09it/s]getting inputs:  17%|█▋        | 22/128 [00:03<00:11,  9.14it/s]getting inputs:  18%|█▊        | 23/128 [00:03<00:11,  9.17it/s]getting inputs:  19%|█▉        | 24/128 [00:03<00:11,  9.16it/s]getting inputs:  20%|█▉        | 25/128 [00:03<00:11,  8.94it/s]getting inputs:  20%|██        | 26/128 [00:03<00:11,  8.99it/s]getting inputs:  21%|██        | 27/128 [00:03<00:11,  9.04it/s]getting inputs:  22%|██▏       | 28/128 [00:03<00:11,  9.08it/s]getting inputs:  23%|██▎       | 29/128 [00:03<00:11,  8.92it/s]getting inputs:  23%|██▎       | 30/128 [00:03<00:10,  8.99it/s]getting inputs:  24%|██▍       | 31/128 [00:04<00:10,  9.05it/s]getting inputs:  25%|██▌       | 32/128 [00:04<00:10,  9.11it/s]getting inputs:  26%|██▌       | 33/128 [00:04<00:10,  9.02it/s]getting inputs:  27%|██▋       | 34/128 [00:04<00:10,  9.06it/s]getting inputs:  27%|██▋       | 35/128 [00:04<00:10,  9.09it/s]getting inputs:  28%|██▊       | 36/128 [00:04<00:10,  9.11it/s]getting inputs:  29%|██▉       | 37/128 [00:04<00:10,  8.96it/s]getting inputs:  30%|██▉       | 38/128 [00:04<00:09,  9.04it/s]getting inputs:  30%|███       | 39/128 [00:04<00:09,  9.08it/s]getting inputs:  31%|███▏      | 40/128 [00:04<00:09,  9.11it/s]getting inputs:  32%|███▏      | 41/128 [00:05<00:09,  9.13it/s]getting inputs:  33%|███▎      | 42/128 [00:05<00:09,  9.12it/s]getting inputs:  34%|███▎      | 43/128 [00:05<00:09,  9.16it/s]getting inputs:  34%|███▍      | 44/128 [00:05<00:09,  9.01it/s]getting inputs:  35%|███▌      | 45/128 [00:05<00:09,  9.03it/s]getting inputs:  36%|███▌      | 46/128 [00:05<00:09,  9.07it/s]getting inputs:  37%|███▋      | 47/128 [00:05<00:09,  8.93it/s]getting inputs:  38%|███▊      | 48/128 [00:05<00:08,  8.99it/s]getting inputs:  38%|███▊      | 49/128 [00:05<00:08,  9.03it/s]getting inputs:  39%|███▉      | 50/128 [00:06<00:08,  9.07it/s]getting inputs:  40%|███▉      | 51/128 [00:06<00:08,  8.98it/s]getting inputs:  41%|████      | 52/128 [00:06<00:08,  9.00it/s]getting inputs:  41%|████▏     | 53/128 [00:06<00:08,  8.99it/s]getting inputs:  42%|████▏     | 54/128 [00:06<00:08,  9.03it/s]getting inputs:  43%|████▎     | 55/128 [00:06<00:08,  8.92it/s]getting inputs:  44%|████▍     | 56/128 [00:06<00:08,  8.97it/s]getting inputs:  45%|████▍     | 57/128 [00:06<00:07,  8.99it/s]getting inputs:  45%|████▌     | 58/128 [00:06<00:07,  9.06it/s]getting inputs:  46%|████▌     | 59/128 [00:07<00:07,  8.94it/s]getting inputs:  47%|████▋     | 60/128 [00:07<00:07,  9.00it/s]getting inputs:  48%|████▊     | 61/128 [00:07<00:07,  9.05it/s]getting inputs:  48%|████▊     | 62/128 [00:07<00:07,  9.09it/s]getting inputs:  49%|████▉     | 63/128 [00:07<00:07,  8.99it/s]getting inputs:  50%|█████     | 64/128 [00:07<00:07,  9.04it/s]getting inputs:  51%|█████     | 65/128 [00:07<00:06,  9.07it/s]getting inputs:  52%|█████▏    | 66/128 [00:07<00:06,  9.10it/s]getting inputs:  52%|█████▏    | 67/128 [00:07<00:06,  9.00it/s]getting inputs:  53%|█████▎    | 68/128 [00:08<00:06,  9.07it/s]getting inputs:  54%|█████▍    | 69/128 [00:08<00:06,  9.10it/s]getting inputs:  55%|█████▍    | 70/128 [00:08<00:06,  9.07it/s]getting inputs:  55%|█████▌    | 71/128 [00:08<00:06,  8.92it/s]getting inputs:  56%|█████▋    | 72/128 [00:08<00:06,  8.96it/s]getting inputs:  57%|█████▋    | 73/128 [00:08<00:06,  9.00it/s]getting inputs:  58%|█████▊    | 74/128 [00:08<00:05,  9.02it/s]getting inputs:  59%|█████▊    | 75/128 [00:08<00:05,  8.90it/s]getting inputs:  59%|█████▉    | 76/128 [00:08<00:05,  8.96it/s]getting inputs:  60%|██████    | 77/128 [00:09<00:05,  8.98it/s]getting inputs:  61%|██████    | 78/128 [00:09<00:05,  9.01it/s]getting inputs:  62%|██████▏   | 79/128 [00:09<00:05,  8.90it/s]getting inputs:  62%|██████▎   | 80/128 [00:09<00:05,  8.96it/s]getting inputs:  63%|██████▎   | 81/128 [00:09<00:05,  8.95it/s]getting inputs:  64%|██████▍   | 82/128 [00:09<00:05,  8.95it/s]getting inputs:  65%|██████▍   | 83/128 [00:09<00:05,  8.80it/s]getting inputs:  66%|██████▌   | 84/128 [00:09<00:04,  8.85it/s]getting inputs:  67%|██████▋   | 86/128 [00:10<00:04,  8.77it/s]getting inputs:  68%|██████▊   | 87/128 [00:10<00:04,  8.63it/s]getting inputs:  69%|██████▉   | 88/128 [00:10<00:04,  8.61it/s]getting inputs:  70%|██████▉   | 89/128 [00:10<00:04,  8.55it/s]getting inputs:  70%|███████   | 90/128 [00:10<00:04,  8.60it/s]getting inputs:  71%|███████   | 91/128 [00:10<00:04,  8.65it/s]getting inputs:  72%|███████▏  | 92/128 [00:10<00:04,  8.70it/s]getting inputs:  73%|███████▎  | 93/128 [00:10<00:04,  8.55it/s]getting inputs:  73%|███████▎  | 94/128 [00:11<00:03,  8.61it/s]getting inputs:  74%|███████▍  | 95/128 [00:11<00:03,  8.67it/s]getting inputs:  75%|███████▌  | 96/128 [00:11<00:03,  8.44it/s]getting inputs:  76%|███████▌  | 97/128 [00:11<00:03,  8.45it/s]getting inputs:  77%|███████▋  | 98/128 [00:11<00:03,  8.46it/s]getting inputs:  77%|███████▋  | 99/128 [00:11<00:03,  8.49it/s]getting inputs:  78%|███████▊  | 100/128 [00:11<00:03,  8.60it/s]getting inputs:  79%|███████▉  | 101/128 [00:11<00:03,  8.59it/s]getting inputs:  80%|███████▉  | 102/128 [00:11<00:03,  8.60it/s]getting inputs:  80%|████████  | 103/128 [00:12<00:02,  8.37it/s]getting inputs:  81%|████████▏ | 104/128 [00:12<00:02,  8.43it/s]getting inputs:  82%|████████▏ | 105/128 [00:12<00:02,  8.53it/s]getting inputs:  83%|████████▎ | 106/128 [00:12<00:02,  8.55it/s]getting inputs:  84%|████████▎ | 107/128 [00:12<00:02,  8.57it/s]getting inputs:  84%|████████▍ | 108/128 [00:12<00:02,  8.61it/s]getting inputs:  85%|████████▌ | 109/128 [00:12<00:02,  8.42it/s]getting inputs:  86%|████████▌ | 110/128 [00:12<00:02,  8.50it/s]getting inputs:  87%|████████▋ | 111/128 [00:13<00:01,  8.52it/s]getting inputs:  88%|████████▊ | 112/128 [00:13<00:01,  8.59it/s]getting inputs:  88%|████████▊ | 113/128 [00:13<00:01,  8.40it/s]getting inputs:  89%|████████▉ | 114/128 [00:13<00:01,  8.51it/s]getting inputs:  90%|████████▉ | 115/128 [00:13<00:01,  8.57it/s]getting inputs:  91%|█████████ | 116/128 [00:13<00:01,  8.58it/s]getting inputs:  91%|█████████▏| 117/128 [00:13<00:01,  8.42it/s]getting inputs:  92%|█████████▏| 118/128 [00:13<00:01,  8.50it/s]getting inputs:  93%|█████████▎| 119/128 [00:13<00:01,  8.56it/s]getting inputs:  94%|█████████▍| 120/128 [00:14<00:00,  8.59it/s]getting inputs:  95%|█████████▍| 121/128 [00:14<00:00,  8.41it/s]getting inputs:  95%|█████████▌| 122/128 [00:14<00:00,  8.52it/s]getting inputs:  96%|█████████▌| 123/128 [00:14<00:00,  8.57it/s]getting inputs:  97%|█████████▋| 124/128 [00:14<00:00,  8.63it/s]getting inputs:  98%|█████████▊| 125/128 [00:14<00:00,  8.45it/s]getting inputs:  98%|█████████▊| 126/128 [00:14<00:00,  8.57it/s]getting inputs:  99%|█████████▉| 127/128 [00:14<00:00,  8.60it/s]getting inputs: 100%|██████████| 128/128 [00:15<00:00,  8.67it/s]getting inputs: 100%|██████████| 128/128 [00:15<00:00,  8.51it/s]
48305 MiB free out of 48676 MiB total
Ready.
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.30s/it]Inference:   9%|▉         | 3/32 [00:12<02:04,  4.30s/it]Inference:  12%|█▎        | 4/32 [00:16<01:58,  4.21s/it]Inference:  16%|█▌        | 5/32 [00:21<01:54,  4.24s/it]Inference:  19%|█▉        | 6/32 [00:25<01:51,  4.27s/it]Inference:  22%|██▏       | 7/32 [00:29<01:46,  4.26s/it]Inference:  25%|██▌       | 8/32 [00:34<01:42,  4.27s/it]Inference:  28%|██▊       | 9/32 [00:38<01:38,  4.27s/it]Inference:  31%|███▏      | 10/32 [00:42<01:34,  4.28s/it]Inference:  34%|███▍      | 11/32 [00:47<01:30,  4.29s/it]Inference:  38%|███▊      | 12/32 [00:51<01:25,  4.30s/it]Inference:  41%|████      | 13/32 [00:55<01:21,  4.30s/it]Inference:  44%|████▍     | 14/32 [00:59<01:17,  4.29s/it]Inference:  47%|████▋     | 15/32 [01:04<01:13,  4.30s/it]Inference:  50%|█████     | 16/32 [01:08<01:07,  4.25s/it]Inference:  53%|█████▎    | 17/32 [01:12<01:03,  4.26s/it]Inference:  56%|█████▋    | 18/32 [01:17<01:00,  4.29s/it]Inference:  59%|█████▉    | 19/32 [01:21<00:55,  4.30s/it]Inference:  62%|██████▎   | 20/32 [01:25<00:52,  4.34s/it]Inference:  66%|██████▌   | 21/32 [01:30<00:47,  4.34s/it]Inference:  69%|██████▉   | 22/32 [01:34<00:43,  4.34s/it]Inference:  72%|███████▏  | 23/32 [01:38<00:39,  4.35s/it]Inference:  75%|███████▌  | 24/32 [01:43<00:34,  4.34s/it]Inference:  78%|███████▊  | 25/32 [01:47<00:30,  4.35s/it]Inference:  81%|████████▏ | 26/32 [01:51<00:26,  4.34s/it]Inference:  84%|████████▍ | 27/32 [01:56<00:21,  4.36s/it]Inference:  88%|████████▊ | 28/32 [02:00<00:17,  4.39s/it]Inference:  91%|█████████ | 29/32 [02:05<00:13,  4.40s/it]Inference:  94%|█████████▍| 30/32 [02:09<00:08,  4.42s/it]Inference:  97%|█████████▋| 31/32 [02:14<00:04,  4.43s/it]Inference: 100%|██████████| 32/32 [02:18<00:00,  4.43s/it]Inference: 100%|██████████| 32/32 [02:18<00:00,  4.33s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 0
48299 MiB free out of 48676 MiB total
Done with layer 0 total_time elapsed: 178 estimated time left: 14066
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:09,  4.18s/it]Inference:   6%|▋         | 2/32 [00:08<02:07,  4.24s/it]Inference:   9%|▉         | 3/32 [00:12<02:04,  4.29s/it]Inference:  12%|█▎        | 4/32 [00:17<01:59,  4.26s/it]Inference:  16%|█▌        | 5/32 [00:21<01:56,  4.33s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.44s/it]Inference:  22%|██▏       | 7/32 [00:30<01:52,  4.50s/it]Inference:  25%|██▌       | 8/32 [00:35<01:50,  4.59s/it]Inference:  28%|██▊       | 9/32 [00:40<01:45,  4.61s/it]Inference:  31%|███▏      | 10/32 [00:44<01:41,  4.63s/it]Inference:  34%|███▍      | 11/32 [00:49<01:37,  4.66s/it]Inference:  38%|███▊      | 12/32 [00:54<01:34,  4.72s/it]Inference:  41%|████      | 13/32 [00:59<01:30,  4.74s/it]Inference:  44%|████▍     | 14/32 [01:04<01:25,  4.75s/it]Inference:  47%|████▋     | 15/32 [01:08<01:20,  4.74s/it]Inference:  50%|█████     | 16/32 [01:13<01:14,  4.66s/it]Inference:  53%|█████▎    | 17/32 [01:17<01:10,  4.67s/it]Inference:  56%|█████▋    | 18/32 [01:22<01:05,  4.67s/it]Inference:  59%|█████▉    | 19/32 [01:27<01:01,  4.72s/it]Inference:  62%|██████▎   | 20/32 [01:32<00:57,  4.83s/it]Inference:  66%|██████▌   | 21/32 [01:37<00:54,  4.91s/it]Inference:  69%|██████▉   | 22/32 [01:42<00:47,  4.79s/it]Inference:  72%|███████▏  | 23/32 [01:47<00:43,  4.84s/it]Inference:  75%|███████▌  | 24/32 [01:51<00:38,  4.80s/it]Inference:  78%|███████▊  | 25/32 [01:56<00:33,  4.83s/it]Inference:  81%|████████▏ | 26/32 [02:01<00:28,  4.78s/it]Inference:  84%|████████▍ | 27/32 [02:05<00:23,  4.75s/it]Inference:  88%|████████▊ | 28/32 [02:10<00:18,  4.70s/it]Inference:  91%|█████████ | 29/32 [02:15<00:14,  4.71s/it]Inference:  94%|█████████▍| 30/32 [02:19<00:09,  4.70s/it]Inference:  97%|█████████▋| 31/32 [02:24<00:04,  4.69s/it]Inference: 100%|██████████| 32/32 [02:29<00:00,  4.70s/it]Inference: 100%|██████████| 32/32 [02:29<00:00,  4.67s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 1
48299 MiB free out of 48676 MiB total
Done with layer 1 total_time elapsed: 348 estimated time left: 13555
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:19,  4.49s/it]Inference:   6%|▋         | 2/32 [00:09<02:18,  4.63s/it]Inference:   9%|▉         | 3/32 [00:13<02:15,  4.69s/it]Inference:  12%|█▎        | 4/32 [00:18<02:10,  4.66s/it]Inference:  16%|█▌        | 5/32 [00:23<02:06,  4.68s/it]Inference:  19%|█▉        | 6/32 [00:28<02:02,  4.71s/it]Inference:  22%|██▏       | 7/32 [00:32<01:58,  4.74s/it]Inference:  25%|██▌       | 8/32 [00:37<01:54,  4.77s/it]Inference:  28%|██▊       | 9/32 [00:42<01:48,  4.73s/it]Inference:  31%|███▏      | 10/32 [00:47<01:45,  4.80s/it]Inference:  34%|███▍      | 11/32 [00:52<01:40,  4.80s/it]Inference:  38%|███▊      | 12/32 [00:56<01:36,  4.80s/it]Inference:  41%|████      | 13/32 [01:01<01:30,  4.79s/it]Inference:  44%|████▍     | 14/32 [01:06<01:26,  4.82s/it]Inference:  47%|████▋     | 15/32 [01:11<01:21,  4.79s/it]Inference:  50%|█████     | 16/32 [01:15<01:15,  4.70s/it]Inference:  53%|█████▎    | 17/32 [01:20<01:10,  4.69s/it]Inference:  56%|█████▋    | 18/32 [01:25<01:06,  4.74s/it]Inference:  59%|█████▉    | 19/32 [01:30<01:02,  4.78s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:57,  4.77s/it]Inference:  66%|██████▌   | 21/32 [01:39<00:52,  4.74s/it]Inference:  69%|██████▉   | 22/32 [01:44<00:47,  4.73s/it]Inference:  72%|███████▏  | 23/32 [01:49<00:42,  4.76s/it]Inference:  75%|███████▌  | 24/32 [01:54<00:38,  4.82s/it]Inference:  78%|███████▊  | 25/32 [01:58<00:33,  4.82s/it]Inference:  81%|████████▏ | 26/32 [02:03<00:28,  4.79s/it]Inference:  84%|████████▍ | 27/32 [02:08<00:23,  4.76s/it]Inference:  88%|████████▊ | 28/32 [02:12<00:18,  4.71s/it]Inference:  91%|█████████ | 29/32 [02:17<00:14,  4.69s/it]Inference:  94%|█████████▍| 30/32 [02:22<00:09,  4.82s/it]Inference:  97%|█████████▋| 31/32 [02:27<00:04,  4.77s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.83s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.76s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 2
48299 MiB free out of 48676 MiB total
Done with layer 2 total_time elapsed: 519 estimated time left: 13310
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:28,  4.80s/it]Inference:   6%|▋         | 2/32 [00:09<02:20,  4.70s/it]Inference:   9%|▉         | 3/32 [00:14<02:15,  4.66s/it]Inference:  12%|█▎        | 4/32 [00:18<02:07,  4.55s/it]Inference:  16%|█▌        | 5/32 [00:23<02:04,  4.60s/it]Inference:  19%|█▉        | 6/32 [00:28<02:02,  4.71s/it]Inference:  22%|██▏       | 7/32 [00:32<01:56,  4.67s/it]Inference:  25%|██▌       | 8/32 [00:37<01:52,  4.67s/it]Inference:  28%|██▊       | 9/32 [00:41<01:46,  4.64s/it]Inference:  31%|███▏      | 10/32 [00:46<01:41,  4.63s/it]Inference:  34%|███▍      | 11/32 [00:51<01:37,  4.65s/it]Inference:  38%|███▊      | 12/32 [00:55<01:32,  4.64s/it]Inference:  41%|████      | 13/32 [01:00<01:29,  4.71s/it]Inference:  44%|████▍     | 14/32 [01:05<01:26,  4.78s/it]Inference:  47%|████▋     | 15/32 [01:10<01:21,  4.79s/it]Inference:  50%|█████     | 16/32 [01:14<01:15,  4.69s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:10,  4.68s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:06,  4.73s/it]Inference:  59%|█████▉    | 19/32 [01:29<01:01,  4.72s/it]Inference:  62%|██████▎   | 20/32 [01:33<00:56,  4.68s/it]Inference:  66%|██████▌   | 21/32 [01:38<00:51,  4.65s/it]Inference:  69%|██████▉   | 22/32 [01:43<00:47,  4.70s/it]Inference:  72%|███████▏  | 23/32 [01:47<00:42,  4.76s/it]Inference:  75%|███████▌  | 24/32 [01:52<00:37,  4.72s/it]Inference:  78%|███████▊  | 25/32 [01:57<00:32,  4.68s/it]Inference:  81%|████████▏ | 26/32 [02:01<00:28,  4.71s/it]Inference:  84%|████████▍ | 27/32 [02:06<00:23,  4.70s/it]Inference:  88%|████████▊ | 28/32 [02:11<00:18,  4.72s/it]Inference:  91%|█████████ | 29/32 [02:16<00:14,  4.72s/it]Inference:  94%|█████████▍| 30/32 [02:20<00:09,  4.69s/it]Inference:  97%|█████████▋| 31/32 [02:25<00:04,  4.64s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.74s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.69s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 3
48299 MiB free out of 48676 MiB total
Done with layer 3 total_time elapsed: 686 estimated time left: 13036
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:28,  4.78s/it]Inference:   6%|▋         | 2/32 [00:09<02:26,  4.87s/it]Inference:   9%|▉         | 3/32 [00:14<02:24,  4.98s/it]Inference:  12%|█▎        | 4/32 [00:19<02:15,  4.83s/it]Inference:  16%|█▌        | 5/32 [00:24<02:08,  4.77s/it]Inference:  19%|█▉        | 6/32 [00:28<02:04,  4.80s/it]Inference:  22%|██▏       | 7/32 [00:33<02:00,  4.82s/it]Inference:  25%|██▌       | 8/32 [00:38<01:54,  4.77s/it]Inference:  28%|██▊       | 9/32 [00:43<01:49,  4.76s/it]Inference:  31%|███▏      | 10/32 [00:47<01:44,  4.75s/it]Inference:  34%|███▍      | 11/32 [00:52<01:38,  4.69s/it]Inference:  38%|███▊      | 12/32 [00:57<01:33,  4.67s/it]Inference:  41%|████      | 13/32 [01:01<01:28,  4.68s/it]Inference:  44%|████▍     | 14/32 [01:06<01:25,  4.73s/it]Inference:  47%|████▋     | 15/32 [01:11<01:21,  4.77s/it]Inference:  50%|█████     | 16/32 [01:15<01:14,  4.68s/it]Inference:  53%|█████▎    | 17/32 [01:20<01:10,  4.70s/it]Inference:  56%|█████▋    | 18/32 [01:25<01:06,  4.76s/it]Inference:  59%|█████▉    | 19/32 [01:30<01:01,  4.75s/it]Inference:  62%|██████▎   | 20/32 [01:35<00:57,  4.80s/it]Inference:  66%|██████▌   | 21/32 [01:39<00:52,  4.77s/it]Inference:  69%|██████▉   | 22/32 [01:44<00:48,  4.81s/it]Inference:  72%|███████▏  | 23/32 [01:49<00:42,  4.78s/it]Inference:  75%|███████▌  | 24/32 [01:54<00:38,  4.80s/it]Inference:  78%|███████▊  | 25/32 [01:59<00:33,  4.85s/it]Inference:  81%|████████▏ | 26/32 [02:04<00:29,  4.83s/it]Inference:  84%|████████▍ | 27/32 [02:09<00:24,  4.84s/it]Inference:  88%|████████▊ | 28/32 [02:13<00:19,  4.84s/it]Inference:  91%|█████████ | 29/32 [02:18<00:14,  4.85s/it]Inference:  94%|█████████▍| 30/32 [02:23<00:09,  4.79s/it]Inference:  97%|█████████▋| 31/32 [02:28<00:04,  4.81s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.74s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.78s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 4
48299 MiB free out of 48676 MiB total
Done with layer 4 total_time elapsed: 857 estimated time left: 12861
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:09,  4.17s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.31s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.36s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.33s/it]Inference:  19%|█▉        | 6/32 [00:25<01:52,  4.32s/it]Inference:  22%|██▏       | 7/32 [00:30<01:47,  4.32s/it]Inference:  25%|██▌       | 8/32 [00:34<01:44,  4.34s/it]Inference:  28%|██▊       | 9/32 [00:38<01:39,  4.33s/it]Inference:  31%|███▏      | 10/32 [00:43<01:35,  4.34s/it]Inference:  34%|███▍      | 11/32 [00:47<01:31,  4.34s/it]Inference:  38%|███▊      | 12/32 [00:52<01:27,  4.40s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.40s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.44s/it]Inference:  47%|████▋     | 15/32 [01:05<01:15,  4.42s/it]Inference:  50%|█████     | 16/32 [01:09<01:09,  4.35s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.37s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:01,  4.40s/it]Inference:  59%|█████▉    | 19/32 [01:22<00:57,  4.41s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:52,  4.41s/it]Inference:  66%|██████▌   | 21/32 [01:31<00:48,  4.39s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:43,  4.39s/it]Inference:  72%|███████▏  | 23/32 [01:40<00:39,  4.42s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.42s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:30,  4.42s/it]Inference:  81%|████████▏ | 26/32 [01:53<00:26,  4.42s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:21,  4.40s/it]Inference:  88%|████████▊ | 28/32 [02:02<00:17,  4.40s/it]Inference:  91%|█████████ | 29/32 [02:06<00:13,  4.38s/it]Inference:  94%|█████████▍| 30/32 [02:11<00:08,  4.41s/it]Inference:  97%|█████████▋| 31/32 [02:15<00:04,  4.41s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.38s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.38s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 5
48299 MiB free out of 48676 MiB total
Done with layer 5 total_time elapsed: 1017 estimated time left: 12540
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:11,  4.24s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.33s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.38s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.33s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.36s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.39s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.39s/it]Inference:  25%|██▌       | 8/32 [00:34<01:45,  4.40s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.38s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.38s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.38s/it]Inference:  38%|███▊      | 12/32 [00:52<01:27,  4.38s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.39s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.42s/it]Inference:  47%|████▋     | 15/32 [01:05<01:14,  4.40s/it]Inference:  50%|█████     | 16/32 [01:09<01:09,  4.35s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.38s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:01,  4.41s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.40s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:53,  4.43s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.43s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.41s/it]Inference:  72%|███████▏  | 23/32 [01:40<00:39,  4.41s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.40s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:30,  4.41s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.43s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:21,  4.39s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.42s/it]Inference:  91%|█████████ | 29/32 [02:07<00:13,  4.43s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.46s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.42s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.44s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.40s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 6
48299 MiB free out of 48676 MiB total
Done with layer 6 total_time elapsed: 1176 estimated time left: 12264
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:09,  4.17s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.30s/it]Inference:   9%|▉         | 3/32 [00:12<02:06,  4.35s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.32s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.36s/it]Inference:  19%|█▉        | 6/32 [00:26<01:53,  4.36s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.37s/it]Inference:  25%|██▌       | 8/32 [00:34<01:45,  4.38s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.41s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.40s/it]Inference:  34%|███▍      | 11/32 [00:48<01:31,  4.38s/it]Inference:  38%|███▊      | 12/32 [00:52<01:27,  4.38s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.39s/it]Inference:  44%|████▍     | 14/32 [01:01<01:18,  4.38s/it]Inference:  47%|████▋     | 15/32 [01:05<01:15,  4.42s/it]Inference:  50%|█████     | 16/32 [01:09<01:10,  4.38s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.39s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:01,  4.42s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.40s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:52,  4.40s/it]Inference:  66%|██████▌   | 21/32 [01:31<00:48,  4.39s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:43,  4.40s/it]Inference:  72%|███████▏  | 23/32 [01:40<00:39,  4.40s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.41s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:30,  4.39s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.40s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:22,  4.43s/it]Inference:  88%|████████▊ | 28/32 [02:02<00:17,  4.43s/it]Inference:  91%|█████████ | 29/32 [02:07<00:13,  4.45s/it]Inference:  94%|█████████▍| 30/32 [02:11<00:08,  4.47s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.49s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.45s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.40s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 7
48299 MiB free out of 48676 MiB total
Done with layer 7 total_time elapsed: 1336 estimated time left: 12022
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:10,  4.21s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.33s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.39s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:55,  4.30s/it]Inference:  19%|█▉        | 6/32 [00:25<01:51,  4.29s/it]Inference:  22%|██▏       | 7/32 [00:30<01:46,  4.28s/it]Inference:  25%|██▌       | 8/32 [00:34<01:42,  4.29s/it]Inference:  28%|██▊       | 9/32 [00:38<01:38,  4.27s/it]Inference:  31%|███▏      | 10/32 [00:42<01:33,  4.26s/it]Inference:  34%|███▍      | 11/32 [00:47<01:30,  4.29s/it]Inference:  38%|███▊      | 12/32 [00:51<01:25,  4.29s/it]Inference:  41%|████      | 13/32 [00:55<01:21,  4.30s/it]Inference:  44%|████▍     | 14/32 [01:00<01:17,  4.31s/it]Inference:  47%|████▋     | 15/32 [01:04<01:13,  4.30s/it]Inference:  50%|█████     | 16/32 [01:08<01:07,  4.23s/it]Inference:  53%|█████▎    | 17/32 [01:12<01:03,  4.26s/it]Inference:  56%|█████▋    | 18/32 [01:17<01:00,  4.31s/it]Inference:  59%|█████▉    | 19/32 [01:21<00:55,  4.30s/it]Inference:  62%|██████▎   | 20/32 [01:25<00:51,  4.31s/it]Inference:  66%|██████▌   | 21/32 [01:30<00:47,  4.32s/it]Inference:  69%|██████▉   | 22/32 [01:34<00:43,  4.33s/it]Inference:  72%|███████▏  | 23/32 [01:38<00:38,  4.33s/it]Inference:  75%|███████▌  | 24/32 [01:43<00:34,  4.32s/it]Inference:  78%|███████▊  | 25/32 [01:47<00:30,  4.31s/it]Inference:  81%|████████▏ | 26/32 [01:51<00:25,  4.31s/it]Inference:  84%|████████▍ | 27/32 [01:56<00:21,  4.30s/it]Inference:  88%|████████▊ | 28/32 [02:00<00:17,  4.31s/it]Inference:  91%|█████████ | 29/32 [02:04<00:12,  4.31s/it]Inference:  94%|█████████▍| 30/32 [02:09<00:08,  4.32s/it]Inference:  97%|█████████▋| 31/32 [02:13<00:04,  4.33s/it]Inference: 100%|██████████| 32/32 [02:17<00:00,  4.33s/it]Inference: 100%|██████████| 32/32 [02:17<00:00,  4.30s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 8
48299 MiB free out of 48676 MiB total
Done with layer 8 total_time elapsed: 1492 estimated time left: 11770
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:23,  4.62s/it]Inference:   6%|▋         | 2/32 [00:09<02:26,  4.90s/it]Inference:   9%|▉         | 3/32 [00:14<02:21,  4.89s/it]Inference:  12%|█▎        | 4/32 [00:19<02:12,  4.73s/it]Inference:  16%|█▌        | 5/32 [00:24<02:10,  4.84s/it]Inference:  19%|█▉        | 6/32 [00:29<02:06,  4.87s/it]Inference:  22%|██▏       | 7/32 [00:33<02:00,  4.83s/it]Inference:  25%|██▌       | 8/32 [00:38<01:56,  4.85s/it]Inference:  28%|██▊       | 9/32 [00:43<01:51,  4.86s/it]Inference:  31%|███▏      | 10/32 [00:48<01:46,  4.86s/it]Inference:  34%|███▍      | 11/32 [00:53<01:42,  4.86s/it]Inference:  38%|███▊      | 12/32 [00:58<01:36,  4.85s/it]Inference:  41%|████      | 13/32 [01:02<01:32,  4.86s/it]Inference:  44%|████▍     | 14/32 [01:07<01:27,  4.86s/it]Inference:  47%|████▋     | 15/32 [01:13<01:24,  4.95s/it]Inference:  50%|█████     | 16/32 [01:18<01:20,  5.02s/it]Inference:  53%|█████▎    | 17/32 [01:23<01:15,  5.00s/it]Inference:  56%|█████▋    | 18/32 [01:28<01:09,  4.99s/it]Inference:  59%|█████▉    | 19/32 [01:33<01:05,  5.04s/it]Inference:  62%|██████▎   | 20/32 [01:38<00:59,  4.98s/it]Inference:  66%|██████▌   | 21/32 [01:43<00:54,  4.98s/it]Inference:  69%|██████▉   | 22/32 [01:47<00:49,  4.92s/it]Inference:  72%|███████▏  | 23/32 [01:52<00:44,  4.91s/it]Inference:  75%|███████▌  | 24/32 [01:58<00:40,  5.02s/it]Inference:  78%|███████▊  | 25/32 [02:03<00:35,  5.06s/it]Inference:  81%|████████▏ | 26/32 [02:08<00:30,  5.11s/it]Inference:  84%|████████▍ | 27/32 [02:13<00:25,  5.09s/it]Inference:  88%|████████▊ | 28/32 [02:18<00:20,  5.09s/it]Inference:  91%|█████████ | 29/32 [02:23<00:15,  5.08s/it]Inference:  94%|█████████▍| 30/32 [02:28<00:10,  5.05s/it]Inference:  97%|█████████▋| 31/32 [02:33<00:05,  5.12s/it]Inference: 100%|██████████| 32/32 [02:38<00:00,  5.06s/it]Inference: 100%|██████████| 32/32 [02:38<00:00,  4.96s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 9
48299 MiB free out of 48676 MiB total
Done with layer 9 total_time elapsed: 1668 estimated time left: 11673
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:28,  4.79s/it]Inference:   6%|▋         | 2/32 [00:09<02:26,  4.87s/it]Inference:   9%|▉         | 3/32 [00:14<02:22,  4.90s/it]Inference:  12%|█▎        | 4/32 [00:19<02:16,  4.89s/it]Inference:  16%|█▌        | 5/32 [00:24<02:16,  5.06s/it]Inference:  19%|█▉        | 6/32 [00:29<02:09,  4.99s/it]Inference:  22%|██▏       | 7/32 [00:34<02:04,  4.97s/it]Inference:  25%|██▌       | 8/32 [00:39<01:58,  4.95s/it]Inference:  28%|██▊       | 9/32 [00:44<01:52,  4.90s/it]Inference:  31%|███▏      | 10/32 [00:49<01:46,  4.84s/it]Inference:  34%|███▍      | 11/32 [00:53<01:41,  4.86s/it]Inference:  38%|███▊      | 12/32 [00:58<01:36,  4.84s/it]Inference:  41%|████      | 13/32 [01:03<01:32,  4.89s/it]Inference:  44%|████▍     | 14/32 [01:08<01:27,  4.88s/it]Inference:  47%|████▋     | 15/32 [01:13<01:23,  4.89s/it]Inference:  50%|█████     | 16/32 [01:18<01:18,  4.89s/it]Inference:  53%|█████▎    | 17/32 [01:23<01:13,  4.90s/it]Inference:  56%|█████▋    | 18/32 [01:28<01:09,  4.95s/it]Inference:  59%|█████▉    | 19/32 [01:33<01:03,  4.86s/it]Inference:  62%|██████▎   | 20/32 [01:37<00:57,  4.77s/it]Inference:  66%|██████▌   | 21/32 [01:42<00:52,  4.74s/it]Inference:  69%|██████▉   | 22/32 [01:46<00:46,  4.69s/it]Inference:  72%|███████▏  | 23/32 [01:51<00:41,  4.65s/it]Inference:  75%|███████▌  | 24/32 [01:56<00:37,  4.64s/it]Inference:  78%|███████▊  | 25/32 [02:00<00:32,  4.61s/it]Inference:  81%|████████▏ | 26/32 [02:05<00:27,  4.59s/it]Inference:  84%|████████▍ | 27/32 [02:09<00:22,  4.59s/it]Inference:  88%|████████▊ | 28/32 [02:14<00:18,  4.57s/it]Inference:  91%|█████████ | 29/32 [02:18<00:13,  4.57s/it]Inference:  94%|█████████▍| 30/32 [02:23<00:09,  4.57s/it]Inference:  97%|█████████▋| 31/32 [02:28<00:04,  4.59s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.58s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.77s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 10
48299 MiB free out of 48676 MiB total
Done with layer 10 total_time elapsed: 1839 estimated time left: 11534
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:22,  4.58s/it]Inference:   6%|▋         | 2/32 [00:09<02:26,  4.88s/it]Inference:   9%|▉         | 3/32 [00:14<02:22,  4.90s/it]Inference:  12%|█▎        | 4/32 [00:19<02:15,  4.84s/it]Inference:  16%|█▌        | 5/32 [00:24<02:09,  4.81s/it]Inference:  19%|█▉        | 6/32 [00:28<02:05,  4.82s/it]Inference:  22%|██▏       | 7/32 [00:33<01:59,  4.78s/it]Inference:  25%|██▌       | 8/32 [00:38<01:58,  4.96s/it]Inference:  28%|██▊       | 9/32 [00:43<01:52,  4.91s/it]Inference:  31%|███▏      | 10/32 [00:48<01:46,  4.85s/it]Inference:  34%|███▍      | 11/32 [00:53<01:42,  4.88s/it]Inference:  38%|███▊      | 12/32 [00:58<01:37,  4.88s/it]Inference:  41%|████      | 13/32 [01:03<01:32,  4.87s/it]Inference:  44%|████▍     | 14/32 [01:07<01:27,  4.85s/it]Inference:  47%|████▋     | 15/32 [01:12<01:22,  4.85s/it]Inference:  50%|█████     | 16/32 [01:17<01:16,  4.78s/it]Inference:  53%|█████▎    | 17/32 [01:22<01:11,  4.76s/it]Inference:  56%|█████▋    | 18/32 [01:26<01:06,  4.74s/it]Inference:  59%|█████▉    | 19/32 [01:31<01:02,  4.77s/it]Inference:  62%|██████▎   | 20/32 [01:36<00:57,  4.79s/it]Inference:  66%|██████▌   | 21/32 [01:41<00:52,  4.76s/it]Inference:  69%|██████▉   | 22/32 [01:45<00:47,  4.75s/it]Inference:  72%|███████▏  | 23/32 [01:50<00:43,  4.79s/it]Inference:  75%|███████▌  | 24/32 [01:55<00:38,  4.78s/it]Inference:  78%|███████▊  | 25/32 [02:00<00:33,  4.76s/it]Inference:  81%|████████▏ | 26/32 [02:05<00:28,  4.75s/it]Inference:  84%|████████▍ | 27/32 [02:09<00:23,  4.76s/it]Inference:  88%|████████▊ | 28/32 [02:14<00:19,  4.80s/it]Inference:  91%|█████████ | 29/32 [02:19<00:14,  4.80s/it]Inference:  94%|█████████▍| 30/32 [02:24<00:09,  4.77s/it]Inference:  97%|█████████▋| 31/32 [02:28<00:04,  4.70s/it]Inference: 100%|██████████| 32/32 [02:33<00:00,  4.70s/it]Inference: 100%|██████████| 32/32 [02:33<00:00,  4.80s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 11
48299 MiB free out of 48676 MiB total
Done with layer 11 total_time elapsed: 2010 estimated time left: 11390
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:20,  4.54s/it]Inference:   6%|▋         | 2/32 [00:09<02:19,  4.66s/it]Inference:   9%|▉         | 3/32 [00:14<02:17,  4.73s/it]Inference:  12%|█▎        | 4/32 [00:18<02:11,  4.68s/it]Inference:  16%|█▌        | 5/32 [00:23<02:06,  4.68s/it]Inference:  19%|█▉        | 6/32 [00:28<02:01,  4.68s/it]Inference:  22%|██▏       | 7/32 [00:32<01:57,  4.72s/it]Inference:  25%|██▌       | 8/32 [00:37<01:54,  4.76s/it]Inference:  28%|██▊       | 9/32 [00:42<01:51,  4.83s/it]Inference:  31%|███▏      | 10/32 [00:47<01:47,  4.89s/it]Inference:  34%|███▍      | 11/32 [00:52<01:42,  4.90s/it]Inference:  38%|███▊      | 12/32 [00:57<01:38,  4.91s/it]Inference:  41%|████      | 13/32 [01:02<01:33,  4.92s/it]Inference:  44%|████▍     | 14/32 [01:07<01:28,  4.91s/it]Inference:  47%|████▋     | 15/32 [01:12<01:24,  4.95s/it]Inference:  50%|█████     | 16/32 [01:17<01:19,  4.98s/it]Inference:  53%|█████▎    | 17/32 [01:22<01:14,  4.94s/it]Inference:  56%|█████▋    | 18/32 [01:27<01:09,  4.98s/it]Inference:  59%|█████▉    | 19/32 [01:32<01:04,  4.98s/it]Inference:  62%|██████▎   | 20/32 [01:37<01:00,  5.02s/it]Inference:  66%|██████▌   | 21/32 [01:42<00:55,  5.06s/it]Inference:  69%|██████▉   | 22/32 [01:47<00:50,  5.03s/it]Inference:  72%|███████▏  | 23/32 [01:52<00:44,  4.95s/it]Inference:  75%|███████▌  | 24/32 [01:57<00:39,  4.96s/it]Inference:  78%|███████▊  | 25/32 [02:02<00:34,  4.99s/it]Inference:  81%|████████▏ | 26/32 [02:07<00:29,  4.96s/it]Inference:  84%|████████▍ | 27/32 [02:12<00:24,  4.97s/it]Inference:  88%|████████▊ | 28/32 [02:17<00:19,  5.00s/it]Inference:  91%|█████████ | 29/32 [02:22<00:14,  4.98s/it]Inference:  94%|█████████▍| 30/32 [02:27<00:09,  4.97s/it]Inference:  97%|█████████▋| 31/32 [02:32<00:04,  4.91s/it]Inference: 100%|██████████| 32/32 [02:37<00:00,  4.94s/it]Inference: 100%|██████████| 32/32 [02:37<00:00,  4.91s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 12
48299 MiB free out of 48676 MiB total
Done with layer 12 total_time elapsed: 2186 estimated time left: 11266
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.32s/it]Inference:   6%|▋         | 2/32 [00:09<02:15,  4.53s/it]Inference:   9%|▉         | 3/32 [00:13<02:14,  4.64s/it]Inference:  12%|█▎        | 4/32 [00:18<02:08,  4.60s/it]Inference:  16%|█▌        | 5/32 [00:23<02:08,  4.78s/it]Inference:  19%|█▉        | 6/32 [00:28<02:06,  4.87s/it]Inference:  22%|██▏       | 7/32 [00:33<02:02,  4.90s/it]Inference:  25%|██▌       | 8/32 [00:38<01:56,  4.87s/it]Inference:  28%|██▊       | 9/32 [00:42<01:51,  4.84s/it]Inference:  31%|███▏      | 10/32 [00:47<01:46,  4.83s/it]Inference:  34%|███▍      | 11/32 [00:52<01:41,  4.85s/it]Inference:  38%|███▊      | 12/32 [00:57<01:38,  4.94s/it]Inference:  41%|████      | 13/32 [01:02<01:32,  4.88s/it]Inference:  44%|████▍     | 14/32 [01:07<01:27,  4.84s/it]Inference:  47%|████▋     | 15/32 [01:12<01:21,  4.81s/it]Inference:  50%|█████     | 16/32 [01:16<01:16,  4.76s/it]Inference:  53%|█████▎    | 17/32 [01:21<01:11,  4.76s/it]Inference:  56%|█████▋    | 18/32 [01:26<01:06,  4.78s/it]Inference:  59%|█████▉    | 19/32 [01:31<01:02,  4.79s/it]Inference:  62%|██████▎   | 20/32 [01:35<00:57,  4.76s/it]Inference:  66%|██████▌   | 21/32 [01:40<00:51,  4.71s/it]Inference:  69%|██████▉   | 22/32 [01:45<00:47,  4.76s/it]Inference:  72%|███████▏  | 23/32 [01:50<00:42,  4.76s/it]Inference:  75%|███████▌  | 24/32 [01:54<00:38,  4.75s/it]Inference:  78%|███████▊  | 25/32 [01:59<00:33,  4.73s/it]Inference:  81%|████████▏ | 26/32 [02:03<00:28,  4.67s/it]Inference:  84%|████████▍ | 27/32 [02:08<00:23,  4.67s/it]Inference:  88%|████████▊ | 28/32 [02:13<00:18,  4.62s/it]Inference:  91%|█████████ | 29/32 [02:17<00:14,  4.67s/it]Inference:  94%|█████████▍| 30/32 [02:22<00:09,  4.65s/it]Inference:  97%|█████████▋| 31/32 [02:27<00:04,  4.61s/it]Inference: 100%|██████████| 32/32 [02:31<00:00,  4.57s/it]Inference: 100%|██████████| 32/32 [02:31<00:00,  4.74s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 13
48299 MiB free out of 48676 MiB total
Done with layer 13 total_time elapsed: 2355 estimated time left: 11102
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:24,  4.65s/it]Inference:   6%|▋         | 2/32 [00:09<02:20,  4.69s/it]Inference:   9%|▉         | 3/32 [00:14<02:17,  4.73s/it]Inference:  12%|█▎        | 4/32 [00:18<02:08,  4.58s/it]Inference:  16%|█▌        | 5/32 [00:23<02:02,  4.55s/it]Inference:  19%|█▉        | 6/32 [00:27<01:57,  4.53s/it]Inference:  22%|██▏       | 7/32 [00:31<01:52,  4.48s/it]Inference:  25%|██▌       | 8/32 [00:36<01:47,  4.46s/it]Inference:  28%|██▊       | 9/32 [00:40<01:42,  4.46s/it]Inference:  31%|███▏      | 10/32 [00:45<01:37,  4.42s/it]Inference:  34%|███▍      | 11/32 [00:49<01:32,  4.42s/it]Inference:  38%|███▊      | 12/32 [00:53<01:27,  4.40s/it]Inference:  41%|████      | 13/32 [00:58<01:24,  4.42s/it]Inference:  44%|████▍     | 14/32 [01:02<01:19,  4.41s/it]Inference:  47%|████▋     | 15/32 [01:07<01:15,  4.45s/it]Inference:  50%|█████     | 16/32 [01:11<01:09,  4.37s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:05,  4.38s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:01,  4.42s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.43s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:53,  4.43s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:48,  4.44s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:44,  4.41s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:39,  4.43s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:35,  4.46s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:30,  4.42s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.44s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.45s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.46s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.49s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:09,  4.51s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.50s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.49s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.46s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 14
48299 MiB free out of 48676 MiB total
Done with layer 14 total_time elapsed: 2516 estimated time left: 10903
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:11,  4.40s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.38s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:56,  4.32s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.39s/it]Inference:  22%|██▏       | 7/32 [00:30<01:51,  4.45s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.45s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.42s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.38s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.41s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.41s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.45s/it]Inference:  44%|████▍     | 14/32 [01:01<01:20,  4.50s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.48s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.44s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.45s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.44s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.44s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.46s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.43s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.45s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.44s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.45s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:30,  4.41s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.42s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.46s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.47s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.48s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:08,  4.48s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.47s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 15
48299 MiB free out of 48676 MiB total
Done with layer 15 total_time elapsed: 2677 estimated time left: 10709
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.31s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.41s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.41s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.36s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.40s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.41s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.41s/it]Inference:  25%|██▌       | 8/32 [00:35<01:45,  4.41s/it]Inference:  28%|██▊       | 9/32 [00:39<01:42,  4.44s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.43s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.43s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.41s/it]Inference:  41%|████      | 13/32 [00:57<01:23,  4.38s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.41s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.43s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.38s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.37s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.39s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.41s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:52,  4.41s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.43s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.45s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:40,  4.47s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.49s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.48s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.47s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.47s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.47s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.47s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.48s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.45s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.46s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 16
48299 MiB free out of 48676 MiB total
Done with layer 16 total_time elapsed: 2838 estimated time left: 10516
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:08,  4.15s/it]Inference:   6%|▋         | 2/32 [00:08<02:10,  4.34s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.40s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.36s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.38s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.38s/it]Inference:  25%|██▌       | 8/32 [00:34<01:45,  4.39s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.39s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.39s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.45s/it]Inference:  38%|███▊      | 12/32 [00:53<01:31,  4.55s/it]Inference:  41%|████      | 13/32 [00:57<01:27,  4.59s/it]Inference:  44%|████▍     | 14/32 [01:02<01:23,  4.65s/it]Inference:  47%|████▋     | 15/32 [01:07<01:19,  4.69s/it]Inference:  50%|█████     | 16/32 [01:11<01:14,  4.64s/it]Inference:  53%|█████▎    | 17/32 [01:16<01:10,  4.67s/it]Inference:  56%|█████▋    | 18/32 [01:21<01:05,  4.66s/it]Inference:  59%|█████▉    | 19/32 [01:25<01:01,  4.70s/it]Inference:  62%|██████▎   | 20/32 [01:30<00:56,  4.69s/it]Inference:  66%|██████▌   | 21/32 [01:35<00:51,  4.71s/it]Inference:  69%|██████▉   | 22/32 [01:39<00:46,  4.67s/it]Inference:  72%|███████▏  | 23/32 [01:44<00:42,  4.67s/it]Inference:  75%|███████▌  | 24/32 [01:49<00:37,  4.71s/it]Inference:  78%|███████▊  | 25/32 [01:54<00:32,  4.71s/it]Inference:  81%|████████▏ | 26/32 [01:58<00:28,  4.70s/it]Inference:  84%|████████▍ | 27/32 [02:03<00:23,  4.71s/it]Inference:  88%|████████▊ | 28/32 [02:08<00:18,  4.70s/it]Inference:  91%|█████████ | 29/32 [02:13<00:14,  4.72s/it]Inference:  94%|█████████▍| 30/32 [02:17<00:09,  4.73s/it]Inference:  97%|█████████▋| 31/32 [02:22<00:04,  4.75s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.75s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.60s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 17
48299 MiB free out of 48676 MiB total
Done with layer 17 total_time elapsed: 3005 estimated time left: 10352
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:21,  4.57s/it]Inference:   6%|▋         | 2/32 [00:09<02:17,  4.59s/it]Inference:   9%|▉         | 3/32 [00:13<02:15,  4.66s/it]Inference:  12%|█▎        | 4/32 [00:18<02:08,  4.60s/it]Inference:  16%|█▌        | 5/32 [00:23<02:04,  4.63s/it]Inference:  19%|█▉        | 6/32 [00:27<02:01,  4.67s/it]Inference:  22%|██▏       | 7/32 [00:32<01:58,  4.73s/it]Inference:  25%|██▌       | 8/32 [00:37<01:53,  4.72s/it]Inference:  28%|██▊       | 9/32 [00:41<01:47,  4.66s/it]Inference:  31%|███▏      | 10/32 [00:46<01:41,  4.61s/it]Inference:  34%|███▍      | 11/32 [00:51<01:36,  4.61s/it]Inference:  38%|███▊      | 12/32 [00:55<01:33,  4.67s/it]Inference:  41%|████      | 13/32 [01:00<01:29,  4.71s/it]Inference:  44%|████▍     | 14/32 [01:05<01:26,  4.79s/it]Inference:  47%|████▋     | 15/32 [01:10<01:21,  4.79s/it]Inference:  50%|█████     | 16/32 [01:15<01:15,  4.74s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:10,  4.71s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:06,  4.72s/it]Inference:  59%|█████▉    | 19/32 [01:29<01:01,  4.74s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:57,  4.76s/it]Inference:  66%|██████▌   | 21/32 [01:38<00:51,  4.71s/it]Inference:  69%|██████▉   | 22/32 [01:43<00:46,  4.63s/it]Inference:  72%|███████▏  | 23/32 [01:47<00:40,  4.55s/it]Inference:  75%|███████▌  | 24/32 [01:51<00:36,  4.52s/it]Inference:  78%|███████▊  | 25/32 [01:56<00:31,  4.50s/it]Inference:  81%|████████▏ | 26/32 [02:00<00:26,  4.47s/it]Inference:  84%|████████▍ | 27/32 [02:05<00:22,  4.46s/it]Inference:  88%|████████▊ | 28/32 [02:09<00:17,  4.47s/it]Inference:  91%|█████████ | 29/32 [02:14<00:13,  4.48s/it]Inference:  94%|█████████▍| 30/32 [02:18<00:08,  4.47s/it]Inference:  97%|█████████▋| 31/32 [02:23<00:04,  4.46s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.43s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.61s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 18
48299 MiB free out of 48676 MiB total
Done with layer 18 total_time elapsed: 3171 estimated time left: 10181
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.32s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.42s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.37s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.33s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.38s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.40s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.41s/it]Inference:  25%|██▌       | 8/32 [00:35<01:44,  4.37s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.38s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.40s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.42s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.44s/it]Inference:  41%|████      | 13/32 [00:57<01:23,  4.41s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.40s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.43s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.38s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.39s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.43s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.41s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:52,  4.40s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.40s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:43,  4.38s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.38s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.39s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:30,  4.42s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.46s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.49s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.49s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.52s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:09,  4.50s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.49s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.47s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.42s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 19
48299 MiB free out of 48676 MiB total
Done with layer 19 total_time elapsed: 3331 estimated time left: 9992
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:15,  4.36s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.42s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.42s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.35s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.36s/it]Inference:  19%|█▉        | 6/32 [00:26<01:53,  4.37s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.42s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.42s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.39s/it]Inference:  31%|███▏      | 10/32 [00:43<01:35,  4.36s/it]Inference:  34%|███▍      | 11/32 [00:48<01:31,  4.37s/it]Inference:  38%|███▊      | 12/32 [00:52<01:27,  4.37s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.37s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.41s/it]Inference:  47%|████▋     | 15/32 [01:05<01:15,  4.42s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.38s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:06,  4.42s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.40s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.39s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:52,  4.39s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.43s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.45s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.42s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.45s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.46s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.47s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.49s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.50s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.48s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.44s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.43s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.48s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.42s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 20
48299 MiB free out of 48676 MiB total
Done with layer 20 total_time elapsed: 3490 estimated time left: 9805
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:09,  4.19s/it]Inference:   6%|▋         | 2/32 [00:08<02:11,  4.38s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.37s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:56,  4.30s/it]Inference:  19%|█▉        | 6/32 [00:25<01:52,  4.32s/it]Inference:  22%|██▏       | 7/32 [00:30<01:48,  4.33s/it]Inference:  25%|██▌       | 8/32 [00:34<01:45,  4.38s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.37s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.40s/it]Inference:  34%|███▍      | 11/32 [00:47<01:32,  4.40s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.43s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.42s/it]Inference:  44%|████▍     | 14/32 [01:01<01:20,  4.45s/it]Inference:  47%|████▋     | 15/32 [01:05<01:15,  4.47s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.40s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:06,  4.42s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.43s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:58,  4.49s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:55,  4.59s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:50,  4.61s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:46,  4.68s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:42,  4.70s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:37,  4.67s/it]Inference:  78%|███████▊  | 25/32 [01:52<00:32,  4.69s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:28,  4.67s/it]Inference:  84%|████████▍ | 27/32 [02:01<00:23,  4.70s/it]Inference:  88%|████████▊ | 28/32 [02:06<00:18,  4.74s/it]Inference:  91%|█████████ | 29/32 [02:11<00:14,  4.75s/it]Inference:  94%|█████████▍| 30/32 [02:15<00:09,  4.76s/it]Inference:  97%|█████████▋| 31/32 [02:20<00:04,  4.76s/it]Inference: 100%|██████████| 32/32 [02:25<00:00,  4.81s/it]Inference: 100%|██████████| 32/32 [02:25<00:00,  4.55s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 21
48299 MiB free out of 48676 MiB total
Done with layer 21 total_time elapsed: 3654 estimated time left: 9634
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.29s/it]Inference:   6%|▋         | 2/32 [00:08<02:11,  4.38s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.44s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:22<01:59,  4.41s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.42s/it]Inference:  22%|██▏       | 7/32 [00:31<01:51,  4.47s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.49s/it]Inference:  28%|██▊       | 9/32 [00:40<01:42,  4.48s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.49s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.46s/it]Inference:  38%|███▊      | 12/32 [00:53<01:28,  4.43s/it]Inference:  41%|████      | 13/32 [00:57<01:23,  4.41s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.39s/it]Inference:  47%|████▋     | 15/32 [01:06<01:14,  4.38s/it]Inference:  50%|█████     | 16/32 [01:10<01:09,  4.36s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.42s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.40s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.40s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.43s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.46s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.49s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:40,  4.45s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.44s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.47s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.47s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.46s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.44s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.45s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:08,  4.47s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.46s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.47s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.44s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 22
48299 MiB free out of 48676 MiB total
Done with layer 22 total_time elapsed: 3815 estimated time left: 9454
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:09,  4.18s/it]Inference:   6%|▋         | 2/32 [00:08<02:08,  4.27s/it]Inference:   9%|▉         | 3/32 [00:12<02:04,  4.30s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.35s/it]Inference:  19%|█▉        | 6/32 [00:26<01:53,  4.38s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.39s/it]Inference:  25%|██▌       | 8/32 [00:34<01:45,  4.40s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.37s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.39s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.40s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.43s/it]Inference:  41%|████      | 13/32 [00:56<01:24,  4.45s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.43s/it]Inference:  47%|████▋     | 15/32 [01:05<01:15,  4.45s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.40s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:06,  4.41s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.41s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.40s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:53,  4.42s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.43s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.43s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.44s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.41s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:30,  4.39s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.39s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:21,  4.38s/it]Inference:  88%|████████▊ | 28/32 [02:02<00:17,  4.37s/it]Inference:  91%|█████████ | 29/32 [02:07<00:13,  4.38s/it]Inference:  94%|█████████▍| 30/32 [02:11<00:08,  4.39s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.40s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.41s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.39s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 23
48299 MiB free out of 48676 MiB total
Done with layer 23 total_time elapsed: 3974 estimated time left: 9273
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.34s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.43s/it]Inference:   9%|▉         | 3/32 [00:13<02:10,  4.49s/it]Inference:  12%|█▎        | 4/32 [00:17<02:03,  4.40s/it]Inference:  16%|█▌        | 5/32 [00:22<01:59,  4.42s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.43s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.43s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.43s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.42s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.43s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.45s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.46s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.45s/it]Inference:  44%|████▍     | 14/32 [01:02<01:19,  4.42s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.41s/it]Inference:  50%|█████     | 16/32 [01:10<01:09,  4.35s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:05,  4.37s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.37s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.40s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.42s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.43s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.43s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.41s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.41s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:30,  4.41s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.42s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.44s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.42s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.44s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.45s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.43s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.45s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.42s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 24
48299 MiB free out of 48676 MiB total
Done with layer 24 total_time elapsed: 4134 estimated time left: 9096
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:11,  4.26s/it]Inference:   6%|▋         | 2/32 [00:08<02:11,  4.37s/it]Inference:   9%|▉         | 3/32 [00:13<02:05,  4.34s/it]Inference:  12%|█▎        | 4/32 [00:17<01:59,  4.27s/it]Inference:  16%|█▌        | 5/32 [00:21<01:56,  4.31s/it]Inference:  19%|█▉        | 6/32 [00:25<01:52,  4.33s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.39s/it]Inference:  25%|██▌       | 8/32 [00:34<01:44,  4.36s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.35s/it]Inference:  31%|███▏      | 10/32 [00:43<01:35,  4.36s/it]Inference:  34%|███▍      | 11/32 [00:47<01:32,  4.40s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.41s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.38s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.40s/it]Inference:  47%|████▋     | 15/32 [01:05<01:15,  4.44s/it]Inference:  50%|█████     | 16/32 [01:10<01:11,  4.45s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:07,  4.51s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:04,  4.60s/it]Inference:  59%|█████▉    | 19/32 [01:24<01:00,  4.62s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:55,  4.66s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:51,  4.70s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:47,  4.71s/it]Inference:  72%|███████▏  | 23/32 [01:43<00:42,  4.70s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:37,  4.71s/it]Inference:  78%|███████▊  | 25/32 [01:52<00:33,  4.74s/it]Inference:  81%|████████▏ | 26/32 [01:57<00:28,  4.73s/it]Inference:  84%|████████▍ | 27/32 [02:02<00:23,  4.72s/it]Inference:  88%|████████▊ | 28/32 [02:06<00:18,  4.68s/it]Inference:  91%|█████████ | 29/32 [02:11<00:13,  4.64s/it]Inference:  94%|█████████▍| 30/32 [02:15<00:09,  4.62s/it]Inference:  97%|█████████▋| 31/32 [02:20<00:04,  4.62s/it]Inference: 100%|██████████| 32/32 [02:25<00:00,  4.64s/it]Inference: 100%|██████████| 32/32 [02:25<00:00,  4.54s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 25
48299 MiB free out of 48676 MiB total
Done with layer 25 total_time elapsed: 4297 estimated time left: 8926
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:21,  4.56s/it]Inference:   6%|▋         | 2/32 [00:09<02:18,  4.61s/it]Inference:   9%|▉         | 3/32 [00:13<02:14,  4.64s/it]Inference:  12%|█▎        | 4/32 [00:18<02:09,  4.63s/it]Inference:  16%|█▌        | 5/32 [00:23<02:06,  4.69s/it]Inference:  19%|█▉        | 6/32 [00:28<02:02,  4.71s/it]Inference:  22%|██▏       | 7/32 [00:32<01:56,  4.65s/it]Inference:  25%|██▌       | 8/32 [00:37<01:52,  4.68s/it]Inference:  28%|██▊       | 9/32 [00:41<01:47,  4.66s/it]Inference:  31%|███▏      | 10/32 [00:46<01:43,  4.71s/it]Inference:  34%|███▍      | 11/32 [00:51<01:39,  4.72s/it]Inference:  38%|███▊      | 12/32 [00:56<01:34,  4.72s/it]Inference:  41%|████      | 13/32 [01:01<01:30,  4.75s/it]Inference:  44%|████▍     | 14/32 [01:05<01:24,  4.72s/it]Inference:  47%|████▋     | 15/32 [01:10<01:19,  4.65s/it]Inference:  50%|█████     | 16/32 [01:14<01:13,  4.57s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:08,  4.56s/it]Inference:  56%|█████▋    | 18/32 [01:23<01:03,  4.55s/it]Inference:  59%|█████▉    | 19/32 [01:28<01:00,  4.62s/it]Inference:  62%|██████▎   | 20/32 [01:33<00:56,  4.68s/it]Inference:  66%|██████▌   | 21/32 [01:37<00:51,  4.71s/it]Inference:  69%|██████▉   | 22/32 [01:42<00:47,  4.73s/it]Inference:  72%|███████▏  | 23/32 [01:47<00:42,  4.75s/it]Inference:  75%|███████▌  | 24/32 [01:52<00:38,  4.77s/it]Inference:  78%|███████▊  | 25/32 [01:57<00:33,  4.78s/it]Inference:  81%|████████▏ | 26/32 [02:02<00:28,  4.83s/it]Inference:  84%|████████▍ | 27/32 [02:06<00:24,  4.83s/it]Inference:  88%|████████▊ | 28/32 [02:12<00:19,  4.90s/it]Inference:  91%|█████████ | 29/32 [02:16<00:14,  4.89s/it]Inference:  94%|█████████▍| 30/32 [02:21<00:09,  4.90s/it]Inference:  97%|█████████▋| 31/32 [02:26<00:04,  4.95s/it]Inference: 100%|██████████| 32/32 [02:31<00:00,  4.94s/it]Inference: 100%|██████████| 32/32 [02:31<00:00,  4.74s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 26
48299 MiB free out of 48676 MiB total
Done with layer 26 total_time elapsed: 4468 estimated time left: 8770
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:18,  4.48s/it]Inference:   6%|▋         | 2/32 [00:09<02:18,  4.62s/it]Inference:   9%|▉         | 3/32 [00:13<02:14,  4.64s/it]Inference:  12%|█▎        | 4/32 [00:18<02:07,  4.56s/it]Inference:  16%|█▌        | 5/32 [00:22<02:04,  4.60s/it]Inference:  19%|█▉        | 6/32 [00:27<02:01,  4.66s/it]Inference:  22%|██▏       | 7/32 [00:32<01:57,  4.70s/it]Inference:  25%|██▌       | 8/32 [00:37<01:54,  4.79s/it]Inference:  28%|██▊       | 9/32 [00:42<01:49,  4.76s/it]Inference:  31%|███▏      | 10/32 [00:47<01:45,  4.78s/it]Inference:  34%|███▍      | 11/32 [00:51<01:39,  4.75s/it]Inference:  38%|███▊      | 12/32 [00:56<01:34,  4.75s/it]Inference:  41%|████      | 13/32 [01:01<01:30,  4.74s/it]Inference:  44%|████▍     | 14/32 [01:05<01:25,  4.76s/it]Inference:  47%|████▋     | 15/32 [01:10<01:20,  4.76s/it]Inference:  50%|█████     | 16/32 [01:15<01:14,  4.68s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:10,  4.70s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:05,  4.69s/it]Inference:  59%|█████▉    | 19/32 [01:29<01:00,  4.69s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:56,  4.69s/it]Inference:  66%|██████▌   | 21/32 [01:38<00:51,  4.72s/it]Inference:  69%|██████▉   | 22/32 [01:43<00:47,  4.71s/it]Inference:  72%|███████▏  | 23/32 [01:48<00:42,  4.71s/it]Inference:  75%|███████▌  | 24/32 [01:52<00:37,  4.71s/it]Inference:  78%|███████▊  | 25/32 [01:57<00:32,  4.71s/it]Inference:  81%|████████▏ | 26/32 [02:02<00:27,  4.66s/it]Inference:  84%|████████▍ | 27/32 [02:06<00:23,  4.65s/it]Inference:  88%|████████▊ | 28/32 [02:11<00:18,  4.61s/it]Inference:  91%|█████████ | 29/32 [02:15<00:13,  4.60s/it]Inference:  94%|█████████▍| 30/32 [02:20<00:09,  4.65s/it]Inference:  97%|█████████▋| 31/32 [02:25<00:04,  4.65s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.66s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.69s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 27
48299 MiB free out of 48676 MiB total
Done with layer 27 total_time elapsed: 4636 estimated time left: 8609
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.41s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.38s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.35s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.35s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.40s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.37s/it]Inference:  25%|██▌       | 8/32 [00:35<01:45,  4.41s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.37s/it]Inference:  31%|███▏      | 10/32 [00:43<01:37,  4.42s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.39s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.43s/it]Inference:  41%|████      | 13/32 [00:57<01:23,  4.41s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.40s/it]Inference:  47%|████▋     | 15/32 [01:05<01:14,  4.38s/it]Inference:  50%|█████     | 16/32 [01:09<01:09,  4.32s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.34s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:01,  4.36s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:56,  4.38s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:52,  4.41s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.42s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.40s/it]Inference:  72%|███████▏  | 23/32 [01:40<00:39,  4.41s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.40s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:30,  4.42s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.43s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:22,  4.44s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.46s/it]Inference:  91%|█████████ | 29/32 [02:07<00:13,  4.46s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.45s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.44s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.44s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.41s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 28
48299 MiB free out of 48676 MiB total
Done with layer 28 total_time elapsed: 4795 estimated time left: 8433
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:12,  4.29s/it]Inference:   6%|▋         | 2/32 [00:08<02:08,  4.29s/it]Inference:   9%|▉         | 3/32 [00:12<02:04,  4.31s/it]Inference:  12%|█▎        | 4/32 [00:17<01:59,  4.26s/it]Inference:  16%|█▌        | 5/32 [00:21<01:55,  4.29s/it]Inference:  19%|█▉        | 6/32 [00:25<01:52,  4.32s/it]Inference:  22%|██▏       | 7/32 [00:30<01:48,  4.34s/it]Inference:  25%|██▌       | 8/32 [00:34<01:45,  4.40s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.42s/it]Inference:  31%|███▏      | 10/32 [00:43<01:39,  4.51s/it]Inference:  34%|███▍      | 11/32 [00:48<01:35,  4.56s/it]Inference:  38%|███▊      | 12/32 [00:53<01:32,  4.64s/it]Inference:  41%|████      | 13/32 [00:58<01:28,  4.66s/it]Inference:  44%|████▍     | 14/32 [01:02<01:24,  4.67s/it]Inference:  47%|████▋     | 15/32 [01:07<01:19,  4.69s/it]Inference:  50%|█████     | 16/32 [01:12<01:14,  4.64s/it]Inference:  53%|█████▎    | 17/32 [01:16<01:10,  4.67s/it]Inference:  56%|█████▋    | 18/32 [01:21<01:06,  4.73s/it]Inference:  59%|█████▉    | 19/32 [01:26<01:01,  4.74s/it]Inference:  62%|██████▎   | 20/32 [01:31<00:56,  4.70s/it]Inference:  66%|██████▌   | 21/32 [01:35<00:51,  4.68s/it]Inference:  69%|██████▉   | 22/32 [01:40<00:47,  4.72s/it]Inference:  72%|███████▏  | 23/32 [01:45<00:42,  4.75s/it]Inference:  75%|███████▌  | 24/32 [01:50<00:38,  4.78s/it]Inference:  78%|███████▊  | 25/32 [01:54<00:33,  4.76s/it]Inference:  81%|████████▏ | 26/32 [01:59<00:28,  4.75s/it]Inference:  84%|████████▍ | 27/32 [02:04<00:23,  4.76s/it]Inference:  88%|████████▊ | 28/32 [02:09<00:18,  4.74s/it]Inference:  91%|█████████ | 29/32 [02:13<00:14,  4.69s/it]Inference:  94%|█████████▍| 30/32 [02:18<00:09,  4.64s/it]Inference:  97%|█████████▋| 31/32 [02:22<00:04,  4.65s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.64s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.61s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 29
48299 MiB free out of 48676 MiB total
Done with layer 29 total_time elapsed: 4961 estimated time left: 8269
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:20,  4.54s/it]Inference:   6%|▋         | 2/32 [00:09<02:17,  4.60s/it]Inference:   9%|▉         | 3/32 [00:13<02:15,  4.66s/it]Inference:  12%|█▎        | 4/32 [00:18<02:09,  4.62s/it]Inference:  16%|█▌        | 5/32 [00:23<02:04,  4.62s/it]Inference:  19%|█▉        | 6/32 [00:27<02:01,  4.67s/it]Inference:  22%|██▏       | 7/32 [00:32<01:57,  4.70s/it]Inference:  25%|██▌       | 8/32 [00:37<01:52,  4.69s/it]Inference:  28%|██▊       | 9/32 [00:42<01:48,  4.71s/it]Inference:  31%|███▏      | 10/32 [00:46<01:43,  4.72s/it]Inference:  34%|███▍      | 11/32 [00:51<01:38,  4.71s/it]Inference:  38%|███▊      | 12/32 [00:56<01:34,  4.72s/it]Inference:  41%|████      | 13/32 [01:00<01:29,  4.73s/it]Inference:  44%|████▍     | 14/32 [01:05<01:25,  4.74s/it]Inference:  47%|████▋     | 15/32 [01:10<01:20,  4.74s/it]Inference:  50%|█████     | 16/32 [01:14<01:14,  4.65s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:09,  4.64s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:04,  4.60s/it]Inference:  59%|█████▉    | 19/32 [01:28<00:59,  4.58s/it]Inference:  62%|██████▎   | 20/32 [01:33<00:54,  4.58s/it]Inference:  66%|██████▌   | 21/32 [01:37<00:51,  4.64s/it]Inference:  69%|██████▉   | 22/32 [01:42<00:46,  4.66s/it]Inference:  72%|███████▏  | 23/32 [01:47<00:42,  4.69s/it]Inference:  75%|███████▌  | 24/32 [01:52<00:37,  4.73s/it]Inference:  78%|███████▊  | 25/32 [01:56<00:32,  4.70s/it]Inference:  81%|████████▏ | 26/32 [02:01<00:28,  4.68s/it]Inference:  84%|████████▍ | 27/32 [02:06<00:23,  4.71s/it]Inference:  88%|████████▊ | 28/32 [02:11<00:18,  4.74s/it]Inference:  91%|█████████ | 29/32 [02:15<00:14,  4.72s/it]Inference:  94%|█████████▍| 30/32 [02:20<00:09,  4.77s/it]Inference:  97%|█████████▋| 31/32 [02:25<00:04,  4.78s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.72s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.69s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 30
48299 MiB free out of 48676 MiB total
Done with layer 30 total_time elapsed: 5129 estimated time left: 8107
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.30s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.41s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.39s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:56,  4.32s/it]Inference:  19%|█▉        | 6/32 [00:25<01:52,  4.31s/it]Inference:  22%|██▏       | 7/32 [00:30<01:47,  4.31s/it]Inference:  25%|██▌       | 8/32 [00:34<01:43,  4.32s/it]Inference:  28%|██▊       | 9/32 [00:38<01:39,  4.31s/it]Inference:  31%|███▏      | 10/32 [00:43<01:35,  4.34s/it]Inference:  34%|███▍      | 11/32 [00:47<01:30,  4.33s/it]Inference:  38%|███▊      | 12/32 [00:51<01:26,  4.33s/it]Inference:  41%|████      | 13/32 [00:56<01:22,  4.34s/it]Inference:  44%|████▍     | 14/32 [01:00<01:18,  4.36s/it]Inference:  47%|████▋     | 15/32 [01:05<01:14,  4.36s/it]Inference:  50%|█████     | 16/32 [01:09<01:09,  4.34s/it]Inference:  53%|█████▎    | 17/32 [01:13<01:05,  4.34s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:00,  4.34s/it]Inference:  59%|█████▉    | 19/32 [01:22<00:56,  4.38s/it]Inference:  62%|██████▎   | 20/32 [01:26<00:52,  4.38s/it]Inference:  66%|██████▌   | 21/32 [01:31<00:48,  4.41s/it]Inference:  69%|██████▉   | 22/32 [01:35<00:44,  4.40s/it]Inference:  72%|███████▏  | 23/32 [01:40<00:39,  4.43s/it]Inference:  75%|███████▌  | 24/32 [01:44<00:35,  4.41s/it]Inference:  78%|███████▊  | 25/32 [01:48<00:30,  4.39s/it]Inference:  81%|████████▏ | 26/32 [01:53<00:26,  4.40s/it]Inference:  84%|████████▍ | 27/32 [01:57<00:22,  4.41s/it]Inference:  88%|████████▊ | 28/32 [02:02<00:17,  4.41s/it]Inference:  91%|█████████ | 29/32 [02:06<00:13,  4.42s/it]Inference:  94%|█████████▍| 30/32 [02:10<00:08,  4.39s/it]Inference:  97%|█████████▋| 31/32 [02:15<00:04,  4.38s/it]Inference: 100%|██████████| 32/32 [02:19<00:00,  4.38s/it]Inference: 100%|██████████| 32/32 [02:19<00:00,  4.37s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 31
48299 MiB free out of 48676 MiB total
Done with layer 31 total_time elapsed: 5286 estimated time left: 7930
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.35s/it]Inference:   6%|▋         | 2/32 [00:08<02:13,  4.44s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.42s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.37s/it]Inference:  16%|█▌        | 5/32 [00:22<01:59,  4.43s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.44s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.41s/it]Inference:  25%|██▌       | 8/32 [00:35<01:45,  4.40s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.40s/it]Inference:  31%|███▏      | 10/32 [00:44<01:36,  4.40s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.39s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.42s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.45s/it]Inference:  44%|████▍     | 14/32 [01:01<01:20,  4.48s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.49s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.41s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.41s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.40s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.41s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:52,  4.41s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.41s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:43,  4.39s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.40s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.44s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.45s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.44s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.47s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.45s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.44s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.44s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.45s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 32
48299 MiB free out of 48676 MiB total
Done with layer 32 total_time elapsed: 5446 estimated time left: 7757
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:09,  4.18s/it]Inference:   6%|▋         | 2/32 [00:08<02:07,  4.26s/it]Inference:   9%|▉         | 3/32 [00:12<02:05,  4.34s/it]Inference:  12%|█▎        | 4/32 [00:17<01:59,  4.26s/it]Inference:  16%|█▌        | 5/32 [00:21<01:56,  4.32s/it]Inference:  19%|█▉        | 6/32 [00:25<01:53,  4.37s/it]Inference:  22%|██▏       | 7/32 [00:30<01:48,  4.34s/it]Inference:  25%|██▌       | 8/32 [00:34<01:44,  4.35s/it]Inference:  28%|██▊       | 9/32 [00:38<01:39,  4.33s/it]Inference:  31%|███▏      | 10/32 [00:43<01:35,  4.33s/it]Inference:  34%|███▍      | 11/32 [00:47<01:31,  4.34s/it]Inference:  38%|███▊      | 12/32 [00:52<01:27,  4.38s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.41s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.43s/it]Inference:  47%|████▋     | 15/32 [01:05<01:14,  4.41s/it]Inference:  50%|█████     | 16/32 [01:09<01:10,  4.38s/it]Inference:  53%|█████▎    | 17/32 [01:13<01:05,  4.36s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:01,  4.40s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.44s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:52,  4.41s/it]Inference:  66%|██████▌   | 21/32 [01:31<00:48,  4.41s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.42s/it]Inference:  72%|███████▏  | 23/32 [01:40<00:39,  4.44s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.43s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:31,  4.45s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.45s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:22,  4.43s/it]Inference:  88%|████████▊ | 28/32 [02:02<00:17,  4.41s/it]Inference:  91%|█████████ | 29/32 [02:07<00:13,  4.39s/it]Inference:  94%|█████████▍| 30/32 [02:11<00:08,  4.48s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.56s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.58s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.41s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 33
48299 MiB free out of 48676 MiB total
Done with layer 33 total_time elapsed: 5605 estimated time left: 7583
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.32s/it]Inference:   6%|▋         | 2/32 [00:09<02:18,  4.62s/it]Inference:   9%|▉         | 3/32 [00:14<02:17,  4.73s/it]Inference:  12%|█▎        | 4/32 [00:18<02:10,  4.65s/it]Inference:  16%|█▌        | 5/32 [00:23<02:05,  4.67s/it]Inference:  19%|█▉        | 6/32 [00:28<02:02,  4.70s/it]Inference:  22%|██▏       | 7/32 [00:32<01:58,  4.73s/it]Inference:  25%|██▌       | 8/32 [00:37<01:53,  4.74s/it]Inference:  28%|██▊       | 9/32 [00:42<01:48,  4.71s/it]Inference:  31%|███▏      | 10/32 [00:46<01:44,  4.73s/it]Inference:  34%|███▍      | 11/32 [00:51<01:38,  4.70s/it]Inference:  38%|███▊      | 12/32 [00:56<01:34,  4.72s/it]Inference:  41%|████      | 13/32 [01:01<01:30,  4.76s/it]Inference:  44%|████▍     | 14/32 [01:06<01:26,  4.78s/it]Inference:  47%|████▋     | 15/32 [01:10<01:20,  4.76s/it]Inference:  50%|█████     | 16/32 [01:15<01:15,  4.71s/it]Inference:  53%|█████▎    | 17/32 [01:20<01:11,  4.74s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:06,  4.73s/it]Inference:  59%|█████▉    | 19/32 [01:29<01:01,  4.73s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:56,  4.68s/it]Inference:  66%|██████▌   | 21/32 [01:38<00:50,  4.64s/it]Inference:  69%|██████▉   | 22/32 [01:43<00:46,  4.67s/it]Inference:  72%|███████▏  | 23/32 [01:48<00:42,  4.67s/it]Inference:  75%|███████▌  | 24/32 [01:52<00:37,  4.68s/it]Inference:  78%|███████▊  | 25/32 [01:57<00:33,  4.73s/it]Inference:  81%|████████▏ | 26/32 [02:02<00:28,  4.72s/it]Inference:  84%|████████▍ | 27/32 [02:07<00:23,  4.71s/it]Inference:  88%|████████▊ | 28/32 [02:11<00:18,  4.70s/it]Inference:  91%|█████████ | 29/32 [02:16<00:14,  4.73s/it]Inference:  94%|█████████▍| 30/32 [02:21<00:09,  4.77s/it]Inference:  97%|█████████▋| 31/32 [02:26<00:04,  4.74s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.73s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.71s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 34
48299 MiB free out of 48676 MiB total
Done with layer 34 total_time elapsed: 5774 estimated time left: 7424
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:09,  4.17s/it]Inference:   6%|▋         | 2/32 [00:08<02:10,  4.35s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.40s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.35s/it]Inference:  16%|█▌        | 5/32 [00:21<01:59,  4.41s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.43s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.41s/it]Inference:  25%|██▌       | 8/32 [00:35<01:45,  4.39s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.36s/it]Inference:  31%|███▏      | 10/32 [00:43<01:35,  4.35s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.39s/it]Inference:  38%|███▊      | 12/32 [00:52<01:27,  4.39s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.38s/it]Inference:  44%|████▍     | 14/32 [01:01<01:18,  4.38s/it]Inference:  47%|████▋     | 15/32 [01:05<01:14,  4.39s/it]Inference:  50%|█████     | 16/32 [01:09<01:09,  4.32s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.34s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:01,  4.39s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.42s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:53,  4.42s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.42s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:43,  4.39s/it]Inference:  72%|███████▏  | 23/32 [01:40<00:39,  4.40s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.42s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:30,  4.43s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.45s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:22,  4.45s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.45s/it]Inference:  91%|█████████ | 29/32 [02:07<00:13,  4.43s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.44s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.43s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.41s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.40s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 35
48299 MiB free out of 48676 MiB total
Done with layer 35 total_time elapsed: 5933 estimated time left: 7251
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.31s/it]Inference:   6%|▋         | 2/32 [00:08<02:10,  4.36s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.40s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.37s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.38s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.42s/it]Inference:  22%|██▏       | 7/32 [00:30<01:51,  4.45s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.45s/it]Inference:  28%|██▊       | 9/32 [00:39<01:42,  4.44s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.45s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.46s/it]Inference:  38%|███▊      | 12/32 [00:53<01:28,  4.44s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.46s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.46s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.48s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.42s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.40s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.43s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.44s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.42s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.40s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:43,  4.39s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.40s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.40s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:30,  4.42s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.44s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.44s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.41s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.43s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.44s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.45s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.46s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 36
48299 MiB free out of 48676 MiB total
Done with layer 36 total_time elapsed: 6093 estimated time left: 7081
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.32s/it]Inference:   6%|▋         | 2/32 [00:08<02:11,  4.39s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.42s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.35s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.39s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.40s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.42s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.43s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.39s/it]Inference:  31%|███▏      | 10/32 [00:43<01:35,  4.36s/it]Inference:  34%|███▍      | 11/32 [00:48<01:31,  4.36s/it]Inference:  38%|███▊      | 12/32 [00:52<01:27,  4.36s/it]Inference:  41%|████      | 13/32 [00:56<01:22,  4.36s/it]Inference:  44%|████▍     | 14/32 [01:01<01:18,  4.36s/it]Inference:  47%|████▋     | 15/32 [01:05<01:14,  4.40s/it]Inference:  50%|█████     | 16/32 [01:09<01:09,  4.35s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.39s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:01,  4.37s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:56,  4.37s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:52,  4.36s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.41s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.42s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:40,  4.45s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.44s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:31,  4.46s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.47s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.53s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:18,  4.59s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.64s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:09,  4.66s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.69s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.74s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.47s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 37
48299 MiB free out of 48676 MiB total
Done with layer 37 total_time elapsed: 6254 estimated time left: 6912
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:20,  4.52s/it]Inference:   6%|▋         | 2/32 [00:09<02:18,  4.62s/it]Inference:   9%|▉         | 3/32 [00:13<02:15,  4.66s/it]Inference:  12%|█▎        | 4/32 [00:18<02:08,  4.61s/it]Inference:  16%|█▌        | 5/32 [00:23<02:06,  4.70s/it]Inference:  19%|█▉        | 6/32 [00:28<02:03,  4.74s/it]Inference:  22%|██▏       | 7/32 [00:32<01:58,  4.72s/it]Inference:  25%|██▌       | 8/32 [00:37<01:54,  4.76s/it]Inference:  28%|██▊       | 9/32 [00:42<01:49,  4.77s/it]Inference:  31%|███▏      | 10/32 [00:47<01:44,  4.74s/it]Inference:  34%|███▍      | 11/32 [00:51<01:39,  4.75s/it]Inference:  38%|███▊      | 12/32 [00:56<01:35,  4.79s/it]Inference:  41%|████      | 13/32 [01:01<01:30,  4.75s/it]Inference:  44%|████▍     | 14/32 [01:06<01:24,  4.72s/it]Inference:  47%|████▋     | 15/32 [01:10<01:20,  4.74s/it]Inference:  50%|█████     | 16/32 [01:15<01:14,  4.65s/it]Inference:  53%|█████▎    | 17/32 [01:20<01:10,  4.72s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:06,  4.73s/it]Inference:  59%|█████▉    | 19/32 [01:29<01:01,  4.75s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:57,  4.78s/it]Inference:  66%|██████▌   | 21/32 [01:39<00:52,  4.75s/it]Inference:  69%|██████▉   | 22/32 [01:43<00:46,  4.68s/it]Inference:  72%|███████▏  | 23/32 [01:48<00:41,  4.62s/it]Inference:  75%|███████▌  | 24/32 [01:52<00:36,  4.54s/it]Inference:  78%|███████▊  | 25/32 [01:57<00:31,  4.53s/it]Inference:  81%|████████▏ | 26/32 [02:01<00:26,  4.50s/it]Inference:  84%|████████▍ | 27/32 [02:05<00:22,  4.47s/it]Inference:  88%|████████▊ | 28/32 [02:10<00:17,  4.46s/it]Inference:  91%|█████████ | 29/32 [02:14<00:13,  4.47s/it]Inference:  94%|█████████▍| 30/32 [02:19<00:08,  4.45s/it]Inference:  97%|█████████▋| 31/32 [02:23<00:04,  4.45s/it]Inference: 100%|██████████| 32/32 [02:28<00:00,  4.45s/it]Inference: 100%|██████████| 32/32 [02:28<00:00,  4.63s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 38
48299 MiB free out of 48676 MiB total
Done with layer 38 total_time elapsed: 6420 estimated time left: 6749
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:11,  4.25s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.31s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.36s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.33s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.37s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.41s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.39s/it]Inference:  25%|██▌       | 8/32 [00:35<01:45,  4.41s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.38s/it]Inference:  31%|███▏      | 10/32 [00:43<01:35,  4.36s/it]Inference:  34%|███▍      | 11/32 [00:47<01:31,  4.35s/it]Inference:  38%|███▊      | 12/32 [00:52<01:26,  4.34s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.38s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.41s/it]Inference:  47%|████▋     | 15/32 [01:05<01:15,  4.44s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.41s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:06,  4.45s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.48s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.45s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.45s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.43s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.45s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.42s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.46s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:30,  4.42s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.42s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:22,  4.41s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.44s/it]Inference:  91%|█████████ | 29/32 [02:07<00:13,  4.42s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.46s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.43s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.42s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.41s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 39
48299 MiB free out of 48676 MiB total
Done with layer 39 total_time elapsed: 6579 estimated time left: 6579
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:10,  4.22s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.31s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.40s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.38s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.42s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.40s/it]Inference:  25%|██▌       | 8/32 [00:35<01:45,  4.39s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.36s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.39s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.40s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.44s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.47s/it]Inference:  44%|████▍     | 14/32 [01:01<01:20,  4.45s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.45s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.38s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:06,  4.42s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.44s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.45s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.48s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.44s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.46s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.41s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.41s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:30,  4.39s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.38s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.43s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.45s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.45s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.43s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.44s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.46s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.42s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 40
48299 MiB free out of 48676 MiB total
Done with layer 40 total_time elapsed: 6739 estimated time left: 6410
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.29s/it]Inference:   6%|▋         | 2/32 [00:08<02:10,  4.35s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.39s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.34s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.37s/it]Inference:  19%|█▉        | 6/32 [00:26<01:53,  4.36s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.38s/it]Inference:  25%|██▌       | 8/32 [00:34<01:44,  4.37s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.40s/it]Inference:  31%|███▏      | 10/32 [00:43<01:37,  4.41s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.42s/it]Inference:  38%|███▊      | 12/32 [00:52<01:27,  4.39s/it]Inference:  41%|████      | 13/32 [00:56<01:23,  4.38s/it]Inference:  44%|████▍     | 14/32 [01:01<01:18,  4.38s/it]Inference:  47%|████▋     | 15/32 [01:05<01:14,  4.38s/it]Inference:  50%|█████     | 16/32 [01:10<01:09,  4.37s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.38s/it]Inference:  56%|█████▋    | 18/32 [01:18<01:01,  4.42s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.43s/it]Inference:  62%|██████▎   | 20/32 [01:27<00:53,  4.47s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.44s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.41s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.41s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.43s/it]Inference:  78%|███████▊  | 25/32 [01:49<00:30,  4.39s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.44s/it]Inference:  84%|████████▍ | 27/32 [01:58<00:22,  4.43s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.44s/it]Inference:  91%|█████████ | 29/32 [02:07<00:13,  4.42s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.42s/it]Inference:  97%|█████████▋| 31/32 [02:16<00:04,  4.41s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.43s/it]Inference: 100%|██████████| 32/32 [02:20<00:00,  4.40s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 41
48299 MiB free out of 48676 MiB total
Done with layer 41 total_time elapsed: 6899 estimated time left: 6242
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:08,  4.15s/it]Inference:   6%|▋         | 2/32 [00:08<02:08,  4.30s/it]Inference:   9%|▉         | 3/32 [00:12<02:06,  4.36s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:56,  4.31s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.39s/it]Inference:  22%|██▏       | 7/32 [00:30<01:49,  4.37s/it]Inference:  25%|██▌       | 8/32 [00:34<01:46,  4.43s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.40s/it]Inference:  31%|███▏      | 10/32 [00:43<01:37,  4.43s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.42s/it]Inference:  38%|███▊      | 12/32 [00:52<01:29,  4.45s/it]Inference:  41%|████      | 13/32 [00:57<01:25,  4.48s/it]Inference:  44%|████▍     | 14/32 [01:01<01:20,  4.49s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.46s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.42s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.46s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.47s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:58,  4.48s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.50s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:49,  4.46s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.48s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:40,  4.49s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.50s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.49s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.47s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.45s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.42s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.41s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.40s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.38s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.44s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 42
48299 MiB free out of 48676 MiB total
Done with layer 42 total_time elapsed: 7059 estimated time left: 6074
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.40s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.42s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.35s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.39s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.41s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.41s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.42s/it]Inference:  28%|██▊       | 9/32 [00:39<01:42,  4.44s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.44s/it]Inference:  34%|███▍      | 11/32 [00:48<01:34,  4.48s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.48s/it]Inference:  41%|████      | 13/32 [00:57<01:25,  4.49s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.49s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.48s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.39s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:05,  4.38s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.38s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.39s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:52,  4.39s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.46s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.46s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:40,  4.48s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.43s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.44s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.44s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.46s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.47s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.49s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:08,  4.48s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.46s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.47s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.44s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 43
48299 MiB free out of 48676 MiB total
Done with layer 43 total_time elapsed: 7220 estimated time left: 5908
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.30s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.41s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.44s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.35s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.36s/it]Inference:  19%|█▉        | 6/32 [00:26<01:53,  4.37s/it]Inference:  22%|██▏       | 7/32 [00:30<01:48,  4.36s/it]Inference:  25%|██▌       | 8/32 [00:34<01:44,  4.35s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.40s/it]Inference:  31%|███▏      | 10/32 [00:43<01:37,  4.44s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.43s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.44s/it]Inference:  41%|████      | 13/32 [00:57<01:25,  4.48s/it]Inference:  44%|████▍     | 14/32 [01:01<01:20,  4.45s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.49s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.43s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.46s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.46s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:58,  4.49s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.47s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.46s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.49s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.50s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.49s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.45s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.45s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.48s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.44s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.43s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:08,  4.41s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.40s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.38s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 44
48299 MiB free out of 48676 MiB total
Done with layer 44 total_time elapsed: 7381 estimated time left: 5741
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:16,  4.41s/it]Inference:   6%|▋         | 2/32 [00:08<02:11,  4.39s/it]Inference:   9%|▉         | 3/32 [00:13<02:09,  4.47s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:22<01:59,  4.44s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.45s/it]Inference:  22%|██▏       | 7/32 [00:31<01:50,  4.43s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.46s/it]Inference:  28%|██▊       | 9/32 [00:39<01:42,  4.44s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.45s/it]Inference:  34%|███▍      | 11/32 [00:48<01:34,  4.49s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.45s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.47s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.47s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.44s/it]Inference:  50%|█████     | 16/32 [01:10<01:09,  4.36s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:05,  4.38s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.41s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.39s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.46s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.48s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.49s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.50s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:36,  4.59s/it]Inference:  78%|███████▊  | 25/32 [01:52<00:32,  4.70s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:28,  4.72s/it]Inference:  84%|████████▍ | 27/32 [02:01<00:23,  4.74s/it]Inference:  88%|████████▊ | 28/32 [02:06<00:19,  4.77s/it]Inference:  91%|█████████ | 29/32 [02:11<00:14,  4.76s/it]Inference:  94%|█████████▍| 30/32 [02:16<00:09,  4.78s/it]Inference:  97%|█████████▋| 31/32 [02:20<00:04,  4.76s/it]Inference: 100%|██████████| 32/32 [02:25<00:00,  4.75s/it]Inference: 100%|██████████| 32/32 [02:25<00:00,  4.55s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 45
48299 MiB free out of 48676 MiB total
Done with layer 45 total_time elapsed: 7547 estimated time left: 5578
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:25,  4.69s/it]Inference:   6%|▋         | 2/32 [00:09<02:21,  4.71s/it]Inference:   9%|▉         | 3/32 [00:14<02:15,  4.68s/it]Inference:  12%|█▎        | 4/32 [00:18<02:10,  4.65s/it]Inference:  16%|█▌        | 5/32 [00:23<02:05,  4.63s/it]Inference:  19%|█▉        | 6/32 [00:28<02:01,  4.68s/it]Inference:  22%|██▏       | 7/32 [00:32<01:57,  4.71s/it]Inference:  25%|██▌       | 8/32 [00:37<01:54,  4.76s/it]Inference:  28%|██▊       | 9/32 [00:42<01:48,  4.73s/it]Inference:  31%|███▏      | 10/32 [00:47<01:44,  4.74s/it]Inference:  34%|███▍      | 11/32 [00:52<01:40,  4.80s/it]Inference:  38%|███▊      | 12/32 [00:56<01:35,  4.79s/it]Inference:  41%|████      | 13/32 [01:01<01:31,  4.82s/it]Inference:  44%|████▍     | 14/32 [01:06<01:27,  4.85s/it]Inference:  47%|████▋     | 15/32 [01:11<01:21,  4.82s/it]Inference:  50%|█████     | 16/32 [01:15<01:15,  4.72s/it]Inference:  53%|█████▎    | 17/32 [01:20<01:11,  4.76s/it]Inference:  56%|█████▋    | 18/32 [01:25<01:06,  4.76s/it]Inference:  59%|█████▉    | 19/32 [01:30<01:02,  4.78s/it]Inference:  62%|██████▎   | 20/32 [01:35<00:57,  4.83s/it]Inference:  66%|██████▌   | 21/32 [01:40<00:53,  4.85s/it]Inference:  69%|██████▉   | 22/32 [01:44<00:48,  4.83s/it]Inference:  72%|███████▏  | 23/32 [01:49<00:43,  4.83s/it]Inference:  75%|███████▌  | 24/32 [01:54<00:38,  4.84s/it]Inference:  78%|███████▊  | 25/32 [01:59<00:33,  4.83s/it]Inference:  81%|████████▏ | 26/32 [02:04<00:28,  4.77s/it]Inference:  84%|████████▍ | 27/32 [02:08<00:23,  4.79s/it]Inference:  88%|████████▊ | 28/32 [02:13<00:19,  4.80s/it]Inference:  91%|█████████ | 29/32 [02:18<00:14,  4.82s/it]Inference:  94%|█████████▍| 30/32 [02:23<00:09,  4.79s/it]Inference:  97%|█████████▋| 31/32 [02:28<00:04,  4.83s/it]Inference: 100%|██████████| 32/32 [02:33<00:00,  4.84s/it]Inference: 100%|██████████| 32/32 [02:33<00:00,  4.78s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 46
48299 MiB free out of 48676 MiB total
Done with layer 46 total_time elapsed: 7719 estimated time left: 5420
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:26,  4.71s/it]Inference:   6%|▋         | 2/32 [00:09<02:23,  4.78s/it]Inference:   9%|▉         | 3/32 [00:14<02:21,  4.89s/it]Inference:  12%|█▎        | 4/32 [00:19<02:14,  4.79s/it]Inference:  16%|█▌        | 5/32 [00:23<02:07,  4.74s/it]Inference:  19%|█▉        | 6/32 [00:28<02:03,  4.74s/it]Inference:  22%|██▏       | 7/32 [00:33<01:58,  4.75s/it]Inference:  25%|██▌       | 8/32 [00:38<01:53,  4.73s/it]Inference:  28%|██▊       | 9/32 [00:42<01:49,  4.78s/it]Inference:  31%|███▏      | 10/32 [00:47<01:45,  4.81s/it]Inference:  34%|███▍      | 11/32 [00:52<01:42,  4.88s/it]Inference:  38%|███▊      | 12/32 [00:57<01:37,  4.86s/it]Inference:  41%|████      | 13/32 [01:02<01:30,  4.78s/it]Inference:  44%|████▍     | 14/32 [01:07<01:26,  4.80s/it]Inference:  47%|████▋     | 15/32 [01:11<01:21,  4.81s/it]Inference:  50%|█████     | 16/32 [01:16<01:16,  4.77s/it]Inference:  53%|█████▎    | 17/32 [01:21<01:10,  4.71s/it]Inference:  56%|█████▋    | 18/32 [01:25<01:06,  4.74s/it]Inference:  59%|█████▉    | 19/32 [01:30<01:01,  4.71s/it]Inference:  62%|██████▎   | 20/32 [01:35<00:57,  4.76s/it]Inference:  66%|██████▌   | 21/32 [01:40<00:52,  4.75s/it]Inference:  69%|██████▉   | 22/32 [01:45<00:47,  4.79s/it]Inference:  72%|███████▏  | 23/32 [01:49<00:43,  4.78s/it]Inference:  75%|███████▌  | 24/32 [01:54<00:38,  4.80s/it]Inference:  78%|███████▊  | 25/32 [01:59<00:33,  4.76s/it]Inference:  81%|████████▏ | 26/32 [02:04<00:28,  4.79s/it]Inference:  84%|████████▍ | 27/32 [02:09<00:24,  4.81s/it]Inference:  88%|████████▊ | 28/32 [02:13<00:19,  4.81s/it]Inference:  91%|█████████ | 29/32 [02:18<00:14,  4.83s/it]Inference:  94%|█████████▍| 30/32 [02:23<00:09,  4.83s/it]Inference:  97%|█████████▋| 31/32 [02:28<00:04,  4.84s/it]Inference: 100%|██████████| 32/32 [02:33<00:00,  4.81s/it]Inference: 100%|██████████| 32/32 [02:33<00:00,  4.79s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 47
48299 MiB free out of 48676 MiB total
Done with layer 47 total_time elapsed: 7891 estimated time left: 5261
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:20,  4.53s/it]Inference:   6%|▋         | 2/32 [00:09<02:21,  4.71s/it]Inference:   9%|▉         | 3/32 [00:14<02:18,  4.79s/it]Inference:  12%|█▎        | 4/32 [00:18<02:10,  4.65s/it]Inference:  16%|█▌        | 5/32 [00:23<02:07,  4.72s/it]Inference:  19%|█▉        | 6/32 [00:28<02:03,  4.76s/it]Inference:  22%|██▏       | 7/32 [00:33<01:58,  4.73s/it]Inference:  25%|██▌       | 8/32 [00:37<01:54,  4.76s/it]Inference:  28%|██▊       | 9/32 [00:42<01:49,  4.77s/it]Inference:  31%|███▏      | 10/32 [00:47<01:44,  4.76s/it]Inference:  34%|███▍      | 11/32 [00:52<01:40,  4.78s/it]Inference:  38%|███▊      | 12/32 [00:57<01:35,  4.79s/it]Inference:  41%|████      | 13/32 [01:01<01:30,  4.77s/it]Inference:  44%|████▍     | 14/32 [01:06<01:26,  4.78s/it]Inference:  47%|████▋     | 15/32 [01:11<01:21,  4.79s/it]Inference:  50%|█████     | 16/32 [01:16<01:15,  4.75s/it]Inference:  53%|█████▎    | 17/32 [01:20<01:11,  4.75s/it]Inference:  56%|█████▋    | 18/32 [01:25<01:06,  4.77s/it]Inference:  59%|█████▉    | 19/32 [01:30<01:01,  4.75s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:56,  4.70s/it]Inference:  66%|██████▌   | 21/32 [01:39<00:51,  4.65s/it]Inference:  69%|██████▉   | 22/32 [01:44<00:46,  4.67s/it]Inference:  72%|███████▏  | 23/32 [01:48<00:42,  4.72s/it]Inference:  75%|███████▌  | 24/32 [01:53<00:37,  4.74s/it]Inference:  78%|███████▊  | 25/32 [01:58<00:33,  4.78s/it]Inference:  81%|████████▏ | 26/32 [02:03<00:28,  4.80s/it]Inference:  84%|████████▍ | 27/32 [02:08<00:24,  4.82s/it]Inference:  88%|████████▊ | 28/32 [02:13<00:19,  4.78s/it]Inference:  91%|█████████ | 29/32 [02:17<00:14,  4.81s/it]Inference:  94%|█████████▍| 30/32 [02:22<00:09,  4.81s/it]Inference:  97%|█████████▋| 31/32 [02:27<00:04,  4.83s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.84s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.76s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 48
48299 MiB free out of 48676 MiB total
Done with layer 48 total_time elapsed: 8063 estimated time left: 5101
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:21,  4.56s/it]Inference:   6%|▋         | 2/32 [00:09<02:20,  4.67s/it]Inference:   9%|▉         | 3/32 [00:14<02:17,  4.73s/it]Inference:  12%|█▎        | 4/32 [00:18<02:10,  4.65s/it]Inference:  16%|█▌        | 5/32 [00:23<02:05,  4.64s/it]Inference:  19%|█▉        | 6/32 [00:27<02:01,  4.66s/it]Inference:  22%|██▏       | 7/32 [00:32<01:57,  4.69s/it]Inference:  25%|██▌       | 8/32 [00:37<01:53,  4.73s/it]Inference:  28%|██▊       | 9/32 [00:42<01:48,  4.72s/it]Inference:  31%|███▏      | 10/32 [00:46<01:43,  4.71s/it]Inference:  34%|███▍      | 11/32 [00:51<01:39,  4.72s/it]Inference:  38%|███▊      | 12/32 [00:56<01:33,  4.69s/it]Inference:  41%|████      | 13/32 [01:00<01:28,  4.67s/it]Inference:  44%|████▍     | 14/32 [01:05<01:24,  4.68s/it]Inference:  47%|████▋     | 15/32 [01:10<01:20,  4.73s/it]Inference:  50%|█████     | 16/32 [01:15<01:15,  4.71s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:11,  4.74s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:06,  4.77s/it]Inference:  59%|█████▉    | 19/32 [01:29<01:02,  4.79s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:57,  4.78s/it]Inference:  66%|██████▌   | 21/32 [01:39<00:53,  4.83s/it]Inference:  69%|██████▉   | 22/32 [01:44<00:48,  4.84s/it]Inference:  72%|███████▏  | 23/32 [01:48<00:43,  4.81s/it]Inference:  75%|███████▌  | 24/32 [01:53<00:38,  4.78s/it]Inference:  78%|███████▊  | 25/32 [01:58<00:33,  4.77s/it]Inference:  81%|████████▏ | 26/32 [02:03<00:28,  4.75s/it]Inference:  84%|████████▍ | 27/32 [02:07<00:23,  4.76s/it]Inference:  88%|████████▊ | 28/32 [02:12<00:18,  4.69s/it]Inference:  91%|█████████ | 29/32 [02:17<00:14,  4.76s/it]Inference:  94%|█████████▍| 30/32 [02:22<00:09,  4.80s/it]Inference:  97%|█████████▋| 31/32 [02:27<00:04,  4.80s/it]Inference: 100%|██████████| 32/32 [02:31<00:00,  4.79s/it]Inference: 100%|██████████| 32/32 [02:31<00:00,  4.74s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 49
48299 MiB free out of 48676 MiB total
Done with layer 49 total_time elapsed: 8235 estimated time left: 4941
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:21,  4.58s/it]Inference:   6%|▋         | 2/32 [00:09<02:18,  4.62s/it]Inference:   9%|▉         | 3/32 [00:13<02:15,  4.67s/it]Inference:  12%|█▎        | 4/32 [00:18<02:09,  4.63s/it]Inference:  16%|█▌        | 5/32 [00:23<02:05,  4.64s/it]Inference:  19%|█▉        | 6/32 [00:27<02:00,  4.65s/it]Inference:  22%|██▏       | 7/32 [00:32<01:57,  4.69s/it]Inference:  25%|██▌       | 8/32 [00:37<01:52,  4.70s/it]Inference:  28%|██▊       | 9/32 [00:41<01:47,  4.67s/it]Inference:  31%|███▏      | 10/32 [00:46<01:43,  4.70s/it]Inference:  34%|███▍      | 11/32 [00:51<01:39,  4.73s/it]Inference:  38%|███▊      | 12/32 [00:56<01:33,  4.69s/it]Inference:  41%|████      | 13/32 [01:00<01:28,  4.67s/it]Inference:  44%|████▍     | 14/32 [01:05<01:23,  4.65s/it]Inference:  47%|████▋     | 15/32 [01:10<01:19,  4.69s/it]Inference:  50%|█████     | 16/32 [01:14<01:14,  4.63s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:10,  4.68s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:05,  4.71s/it]Inference:  59%|█████▉    | 19/32 [01:28<01:01,  4.73s/it]Inference:  62%|██████▎   | 20/32 [01:33<00:56,  4.72s/it]Inference:  66%|██████▌   | 21/32 [01:38<00:52,  4.74s/it]Inference:  69%|██████▉   | 22/32 [01:43<00:47,  4.75s/it]Inference:  72%|███████▏  | 23/32 [01:47<00:42,  4.75s/it]Inference:  75%|███████▌  | 24/32 [01:52<00:37,  4.74s/it]Inference:  78%|███████▊  | 25/32 [01:57<00:33,  4.74s/it]Inference:  81%|████████▏ | 26/32 [02:02<00:28,  4.73s/it]Inference:  84%|████████▍ | 27/32 [02:06<00:23,  4.76s/it]Inference:  88%|████████▊ | 28/32 [02:11<00:18,  4.73s/it]Inference:  91%|█████████ | 29/32 [02:16<00:14,  4.74s/it]Inference:  94%|█████████▍| 30/32 [02:21<00:09,  4.74s/it]Inference:  97%|█████████▋| 31/32 [02:25<00:04,  4.76s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.73s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.71s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 50
48299 MiB free out of 48676 MiB total
Done with layer 50 total_time elapsed: 8401 estimated time left: 4777
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:17,  4.42s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.41s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.42s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.37s/it]Inference:  16%|█▌        | 5/32 [00:22<01:58,  4.40s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.42s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.43s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.44s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.42s/it]Inference:  31%|███▏      | 10/32 [00:44<01:36,  4.40s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.41s/it]Inference:  38%|███▊      | 12/32 [00:53<01:28,  4.44s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.43s/it]Inference:  44%|████▍     | 14/32 [01:01<01:19,  4.43s/it]Inference:  47%|████▋     | 15/32 [01:06<01:14,  4.41s/it]Inference:  50%|█████     | 16/32 [01:10<01:09,  4.36s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:06,  4.40s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.40s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:57,  4.42s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.45s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.43s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.42s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.40s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.41s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.43s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.41s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.43s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.45s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.44s/it]Inference:  94%|█████████▍| 30/32 [02:12<00:08,  4.45s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.47s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.45s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.42s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 51
48299 MiB free out of 48676 MiB total
Done with layer 51 total_time elapsed: 8560 estimated time left: 4609
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.42s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.41s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.31s/it]Inference:  16%|█▌        | 5/32 [00:21<01:56,  4.32s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.39s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.42s/it]Inference:  25%|██▌       | 8/32 [00:35<01:45,  4.40s/it]Inference:  28%|██▊       | 9/32 [00:39<01:40,  4.37s/it]Inference:  31%|███▏      | 10/32 [00:43<01:36,  4.38s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.40s/it]Inference:  38%|███▊      | 12/32 [00:53<01:30,  4.53s/it]Inference:  41%|████      | 13/32 [00:57<01:25,  4.50s/it]Inference:  44%|████▍     | 14/32 [01:01<01:20,  4.48s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.47s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.38s/it]Inference:  53%|█████▎    | 17/32 [01:14<01:05,  4.38s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.37s/it]Inference:  59%|█████▉    | 19/32 [01:23<00:56,  4.37s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:52,  4.41s/it]Inference:  66%|██████▌   | 21/32 [01:32<00:48,  4.44s/it]Inference:  69%|██████▉   | 22/32 [01:36<00:44,  4.41s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.41s/it]Inference:  75%|███████▌  | 24/32 [01:45<00:35,  4.45s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.46s/it]Inference:  81%|████████▏ | 26/32 [01:54<00:26,  4.49s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.52s/it]Inference:  88%|████████▊ | 28/32 [02:03<00:17,  4.49s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.50s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:09,  4.50s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.51s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.48s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.44s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 52
48299 MiB free out of 48676 MiB total
Done with layer 52 total_time elapsed: 8717 estimated time left: 4441
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.31s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.40s/it]Inference:   9%|▉         | 3/32 [00:13<02:09,  4.46s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:22<02:00,  4.45s/it]Inference:  19%|█▉        | 6/32 [00:26<01:56,  4.47s/it]Inference:  22%|██▏       | 7/32 [00:31<01:50,  4.44s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.43s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.40s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.45s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.45s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.46s/it]Inference:  41%|████      | 13/32 [00:57<01:25,  4.49s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.47s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.49s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.39s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.44s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.42s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.41s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:52,  4.40s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:48,  4.41s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.40s/it]Inference:  72%|███████▏  | 23/32 [01:41<00:39,  4.43s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.44s/it]Inference:  78%|███████▊  | 25/32 [01:50<00:31,  4.44s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.42s/it]Inference:  84%|████████▍ | 27/32 [01:59<00:22,  4.44s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.46s/it]Inference:  91%|█████████ | 29/32 [02:08<00:13,  4.46s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:08,  4.47s/it]Inference:  97%|█████████▋| 31/32 [02:17<00:04,  4.46s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.43s/it]Inference: 100%|██████████| 32/32 [02:21<00:00,  4.44s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 53
48299 MiB free out of 48676 MiB total
Done with layer 53 total_time elapsed: 8876 estimated time left: 4274
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:13,  4.31s/it]Inference:   6%|▋         | 2/32 [00:08<02:11,  4.38s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.42s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:21<01:59,  4.41s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.45s/it]Inference:  22%|██▏       | 7/32 [00:30<01:51,  4.45s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.46s/it]Inference:  28%|██▊       | 9/32 [00:39<01:43,  4.48s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.49s/it]Inference:  34%|███▍      | 11/32 [00:49<01:34,  4.51s/it]Inference:  38%|███▊      | 12/32 [00:53<01:30,  4.52s/it]Inference:  41%|████      | 13/32 [00:58<01:25,  4.53s/it]Inference:  44%|████▍     | 14/32 [01:02<01:21,  4.52s/it]Inference:  47%|████▋     | 15/32 [01:07<01:16,  4.51s/it]Inference:  50%|█████     | 16/32 [01:11<01:10,  4.41s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.45s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:02,  4.47s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:58,  4.49s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:54,  4.56s/it]Inference:  66%|██████▌   | 21/32 [01:34<00:51,  4.65s/it]Inference:  69%|██████▉   | 22/32 [01:39<00:47,  4.71s/it]Inference:  72%|███████▏  | 23/32 [01:44<00:42,  4.74s/it]Inference:  75%|███████▌  | 24/32 [01:48<00:37,  4.72s/it]Inference:  78%|███████▊  | 25/32 [01:53<00:33,  4.74s/it]Inference:  81%|████████▏ | 26/32 [01:58<00:28,  4.75s/it]Inference:  84%|████████▍ | 27/32 [02:03<00:23,  4.78s/it]Inference:  88%|████████▊ | 28/32 [02:08<00:19,  4.82s/it]Inference:  91%|█████████ | 29/32 [02:12<00:14,  4.81s/it]Inference:  94%|█████████▍| 30/32 [02:17<00:09,  4.83s/it]Inference:  97%|█████████▋| 31/32 [02:22<00:04,  4.85s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.86s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.61s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 54
48299 MiB free out of 48676 MiB total
Done with layer 54 total_time elapsed: 9041 estimated time left: 4109
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:22,  4.59s/it]Inference:   6%|▋         | 2/32 [00:09<02:22,  4.74s/it]Inference:   9%|▉         | 3/32 [00:14<02:17,  4.73s/it]Inference:  12%|█▎        | 4/32 [00:18<02:12,  4.73s/it]Inference:  16%|█▌        | 5/32 [00:23<02:07,  4.73s/it]Inference:  19%|█▉        | 6/32 [00:28<02:04,  4.79s/it]Inference:  22%|██▏       | 7/32 [00:33<02:00,  4.81s/it]Inference:  25%|██▌       | 8/32 [00:38<01:55,  4.80s/it]Inference:  28%|██▊       | 9/32 [00:42<01:49,  4.77s/it]Inference:  31%|███▏      | 10/32 [00:47<01:44,  4.76s/it]Inference:  34%|███▍      | 11/32 [00:52<01:40,  4.81s/it]Inference:  38%|███▊      | 12/32 [00:57<01:36,  4.85s/it]Inference:  41%|████      | 13/32 [01:02<01:32,  4.88s/it]Inference:  44%|████▍     | 14/32 [01:07<01:28,  4.91s/it]Inference:  47%|████▋     | 15/32 [01:12<01:23,  4.92s/it]Inference:  50%|█████     | 16/32 [01:16<01:17,  4.83s/it]Inference:  53%|█████▎    | 17/32 [01:21<01:12,  4.84s/it]Inference:  56%|█████▋    | 18/32 [01:26<01:07,  4.83s/it]Inference:  59%|█████▉    | 19/32 [01:31<01:02,  4.84s/it]Inference:  62%|██████▎   | 20/32 [01:36<00:57,  4.77s/it]Inference:  66%|██████▌   | 21/32 [01:40<00:51,  4.69s/it]Inference:  69%|██████▉   | 22/32 [01:45<00:46,  4.63s/it]Inference:  72%|███████▏  | 23/32 [01:49<00:41,  4.58s/it]Inference:  75%|███████▌  | 24/32 [01:54<00:36,  4.56s/it]Inference:  78%|███████▊  | 25/32 [01:58<00:31,  4.52s/it]Inference:  81%|████████▏ | 26/32 [02:03<00:27,  4.52s/it]Inference:  84%|████████▍ | 27/32 [02:07<00:22,  4.52s/it]Inference:  88%|████████▊ | 28/32 [02:12<00:18,  4.52s/it]Inference:  91%|█████████ | 29/32 [02:16<00:13,  4.51s/it]Inference:  94%|█████████▍| 30/32 [02:21<00:09,  4.51s/it]Inference:  97%|█████████▋| 31/32 [02:25<00:04,  4.51s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.50s/it]Inference: 100%|██████████| 32/32 [02:30<00:00,  4.69s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 55
48299 MiB free out of 48676 MiB total
Done with layer 55 total_time elapsed: 9209 estimated time left: 3947
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.33s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.42s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:21<01:59,  4.42s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.40s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.42s/it]Inference:  25%|██▌       | 8/32 [00:35<01:45,  4.39s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.43s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.45s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.47s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.45s/it]Inference:  41%|████      | 13/32 [00:57<01:25,  4.47s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.49s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.49s/it]Inference:  50%|█████     | 16/32 [01:10<01:11,  4.45s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.44s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.48s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:58,  4.50s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:54,  4.52s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.51s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:45,  4.54s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.52s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:36,  4.52s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.54s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:27,  4.54s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.54s/it]Inference:  88%|████████▊ | 28/32 [02:05<00:18,  4.51s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.50s/it]Inference:  94%|█████████▍| 30/32 [02:14<00:08,  4.49s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.52s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.50s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.48s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 56
48299 MiB free out of 48676 MiB total
Done with layer 56 total_time elapsed: 9369 estimated time left: 3780
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.34s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.42s/it]Inference:   9%|▉         | 3/32 [00:13<02:10,  4.49s/it]Inference:  12%|█▎        | 4/32 [00:17<02:04,  4.43s/it]Inference:  16%|█▌        | 5/32 [00:22<01:59,  4.42s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.46s/it]Inference:  22%|██▏       | 7/32 [00:31<01:51,  4.47s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.46s/it]Inference:  28%|██▊       | 9/32 [00:40<01:43,  4.49s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.48s/it]Inference:  34%|███▍      | 11/32 [00:49<01:34,  4.51s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.50s/it]Inference:  41%|████      | 13/32 [00:58<01:25,  4.52s/it]Inference:  44%|████▍     | 14/32 [01:02<01:21,  4.55s/it]Inference:  47%|████▋     | 15/32 [01:07<01:17,  4.54s/it]Inference:  50%|█████     | 16/32 [01:11<01:11,  4.45s/it]Inference:  53%|█████▎    | 17/32 [01:16<01:07,  4.50s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:03,  4.53s/it]Inference:  59%|█████▉    | 19/32 [01:25<00:58,  4.53s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:54,  4.52s/it]Inference:  66%|██████▌   | 21/32 [01:34<00:49,  4.51s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:45,  4.53s/it]Inference:  72%|███████▏  | 23/32 [01:43<00:40,  4.55s/it]Inference:  75%|███████▌  | 24/32 [01:48<00:36,  4.55s/it]Inference:  78%|███████▊  | 25/32 [01:52<00:31,  4.55s/it]Inference:  81%|████████▏ | 26/32 [01:57<00:27,  4.54s/it]Inference:  84%|████████▍ | 27/32 [02:01<00:22,  4.50s/it]Inference:  88%|████████▊ | 28/32 [02:06<00:17,  4.49s/it]Inference:  91%|█████████ | 29/32 [02:10<00:13,  4.49s/it]Inference:  94%|█████████▍| 30/32 [02:15<00:09,  4.51s/it]Inference:  97%|█████████▋| 31/32 [02:19<00:04,  4.51s/it]Inference: 100%|██████████| 32/32 [02:24<00:00,  4.51s/it]Inference: 100%|██████████| 32/32 [02:24<00:00,  4.50s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 57
48299 MiB free out of 48676 MiB total
Done with layer 57 total_time elapsed: 9529 estimated time left: 3614
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:15,  4.36s/it]Inference:   6%|▋         | 2/32 [00:08<02:10,  4.34s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.41s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.36s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.41s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.44s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.43s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.39s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.44s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.45s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.46s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.46s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.48s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.46s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.42s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.44s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.44s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:58,  4.47s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:54,  4.50s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.49s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.50s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.49s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.50s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.48s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:27,  4.53s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:23,  4.63s/it]Inference:  88%|████████▊ | 28/32 [02:05<00:18,  4.66s/it]Inference:  91%|█████████ | 29/32 [02:10<00:14,  4.69s/it]Inference:  94%|█████████▍| 30/32 [02:15<00:09,  4.73s/it]Inference:  97%|█████████▋| 31/32 [02:19<00:04,  4.77s/it]Inference: 100%|██████████| 32/32 [02:24<00:00,  4.76s/it]Inference: 100%|██████████| 32/32 [02:24<00:00,  4.52s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 58
48299 MiB free out of 48676 MiB total
Done with layer 58 total_time elapsed: 9690 estimated time left: 3449
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:27,  4.76s/it]Inference:   6%|▋         | 2/32 [00:09<02:25,  4.86s/it]Inference:   9%|▉         | 3/32 [00:14<02:22,  4.90s/it]Inference:  12%|█▎        | 4/32 [00:19<02:14,  4.80s/it]Inference:  16%|█▌        | 5/32 [00:24<02:09,  4.79s/it]Inference:  19%|█▉        | 6/32 [00:28<02:04,  4.80s/it]Inference:  22%|██▏       | 7/32 [00:33<02:00,  4.83s/it]Inference:  25%|██▌       | 8/32 [00:38<01:55,  4.83s/it]Inference:  28%|██▊       | 9/32 [00:43<01:51,  4.87s/it]Inference:  31%|███▏      | 10/32 [00:48<01:46,  4.85s/it]Inference:  34%|███▍      | 11/32 [00:53<01:42,  4.89s/it]Inference:  38%|███▊      | 12/32 [00:58<01:38,  4.92s/it]Inference:  41%|████      | 13/32 [01:03<01:33,  4.91s/it]Inference:  44%|████▍     | 14/32 [01:08<01:28,  4.90s/it]Inference:  47%|████▋     | 15/32 [01:13<01:23,  4.92s/it]Inference:  50%|█████     | 16/32 [01:17<01:16,  4.80s/it]Inference:  53%|█████▎    | 17/32 [01:22<01:12,  4.82s/it]Inference:  56%|█████▋    | 18/32 [01:27<01:07,  4.81s/it]Inference:  59%|█████▉    | 19/32 [01:32<01:03,  4.85s/it]Inference:  62%|██████▎   | 20/32 [01:37<00:58,  4.88s/it]Inference:  66%|██████▌   | 21/32 [01:41<00:53,  4.83s/it]Inference:  69%|██████▉   | 22/32 [01:46<00:48,  4.82s/it]Inference:  72%|███████▏  | 23/32 [01:51<00:43,  4.84s/it]Inference:  75%|███████▌  | 24/32 [01:56<00:39,  4.88s/it]Inference:  78%|███████▊  | 25/32 [02:01<00:34,  4.89s/it]Inference:  81%|████████▏ | 26/32 [02:06<00:29,  4.93s/it]Inference:  84%|████████▍ | 27/32 [02:11<00:24,  4.91s/it]Inference:  88%|████████▊ | 28/32 [02:16<00:19,  4.90s/it]Inference:  91%|█████████ | 29/32 [02:21<00:14,  4.92s/it]Inference:  94%|█████████▍| 30/32 [02:25<00:09,  4.87s/it]Inference:  97%|█████████▋| 31/32 [02:30<00:04,  4.90s/it]Inference: 100%|██████████| 32/32 [02:35<00:00,  4.92s/it]Inference: 100%|██████████| 32/32 [02:35<00:00,  4.87s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 59
48299 MiB free out of 48676 MiB total
Done with layer 59 total_time elapsed: 9862 estimated time left: 3287
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:31,  4.89s/it]Inference:   6%|▋         | 2/32 [00:09<02:28,  4.95s/it]Inference:   9%|▉         | 3/32 [00:14<02:24,  5.00s/it]Inference:  12%|█▎        | 4/32 [00:19<02:18,  4.95s/it]Inference:  16%|█▌        | 5/32 [00:24<02:13,  4.96s/it]Inference:  19%|█▉        | 6/32 [00:29<02:09,  4.99s/it]Inference:  22%|██▏       | 7/32 [00:34<02:05,  5.01s/it]Inference:  25%|██▌       | 8/32 [00:39<01:59,  4.98s/it]Inference:  28%|██▊       | 9/32 [00:44<01:53,  4.93s/it]Inference:  31%|███▏      | 10/32 [00:49<01:49,  4.96s/it]Inference:  34%|███▍      | 11/32 [00:54<01:44,  4.96s/it]Inference:  38%|███▊      | 12/32 [00:59<01:39,  4.99s/it]Inference:  41%|████      | 13/32 [01:04<01:34,  4.98s/it]Inference:  44%|████▍     | 14/32 [01:09<01:29,  4.99s/it]Inference:  47%|████▋     | 15/32 [01:14<01:24,  4.99s/it]Inference:  50%|█████     | 16/32 [01:19<01:19,  4.94s/it]Inference:  53%|█████▎    | 17/32 [01:24<01:14,  4.94s/it]Inference:  56%|█████▋    | 18/32 [01:29<01:09,  4.97s/it]Inference:  59%|█████▉    | 19/32 [01:34<01:04,  4.99s/it]Inference:  62%|██████▎   | 20/32 [01:39<00:59,  4.99s/it]Inference:  66%|██████▌   | 21/32 [01:44<00:54,  4.93s/it]Inference:  69%|██████▉   | 22/32 [01:49<00:49,  4.92s/it]Inference:  72%|███████▏  | 23/32 [01:54<00:44,  4.95s/it]Inference:  75%|███████▌  | 24/32 [01:59<00:39,  4.92s/it]Inference:  78%|███████▊  | 25/32 [02:03<00:34,  4.88s/it]Inference:  81%|████████▏ | 26/32 [02:08<00:29,  4.89s/it]Inference:  84%|████████▍ | 27/32 [02:13<00:24,  4.86s/it]Inference:  88%|████████▊ | 28/32 [02:18<00:19,  4.86s/it]Inference:  91%|█████████ | 29/32 [02:23<00:14,  4.85s/it]Inference:  94%|█████████▍| 30/32 [02:27<00:09,  4.82s/it]Inference:  97%|█████████▋| 31/32 [02:32<00:04,  4.84s/it]Inference: 100%|██████████| 32/32 [02:37<00:00,  4.79s/it]Inference: 100%|██████████| 32/32 [02:37<00:00,  4.92s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 60
48299 MiB free out of 48676 MiB total
Done with layer 60 total_time elapsed: 10035 estimated time left: 3126
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:23,  4.62s/it]Inference:   6%|▋         | 2/32 [00:09<02:21,  4.72s/it]Inference:   9%|▉         | 3/32 [00:14<02:18,  4.78s/it]Inference:  12%|█▎        | 4/32 [00:18<02:12,  4.72s/it]Inference:  16%|█▌        | 5/32 [00:23<02:07,  4.74s/it]Inference:  19%|█▉        | 6/32 [00:28<02:04,  4.78s/it]Inference:  22%|██▏       | 7/32 [00:33<02:00,  4.81s/it]Inference:  25%|██▌       | 8/32 [00:38<01:55,  4.81s/it]Inference:  28%|██▊       | 9/32 [00:42<01:50,  4.80s/it]Inference:  31%|███▏      | 10/32 [00:47<01:45,  4.81s/it]Inference:  34%|███▍      | 11/32 [00:52<01:41,  4.83s/it]Inference:  38%|███▊      | 12/32 [00:57<01:36,  4.80s/it]Inference:  41%|████      | 13/32 [01:02<01:31,  4.82s/it]Inference:  44%|████▍     | 14/32 [01:07<01:27,  4.85s/it]Inference:  47%|████▋     | 15/32 [01:12<01:22,  4.85s/it]Inference:  50%|█████     | 16/32 [01:16<01:17,  4.82s/it]Inference:  53%|█████▎    | 17/32 [01:21<01:12,  4.82s/it]Inference:  56%|█████▋    | 18/32 [01:26<01:07,  4.85s/it]Inference:  59%|█████▉    | 19/32 [01:31<01:03,  4.86s/it]Inference:  62%|██████▎   | 20/32 [01:36<00:58,  4.89s/it]Inference:  66%|██████▌   | 21/32 [01:41<00:54,  4.91s/it]Inference:  69%|██████▉   | 22/32 [01:46<00:49,  4.95s/it]Inference:  72%|███████▏  | 23/32 [01:51<00:44,  4.99s/it]Inference:  75%|███████▌  | 24/32 [01:56<00:39,  4.99s/it]Inference:  78%|███████▊  | 25/32 [02:01<00:35,  5.01s/it]Inference:  81%|████████▏ | 26/32 [02:06<00:30,  5.02s/it]Inference:  84%|████████▍ | 27/32 [02:11<00:25,  5.01s/it]Inference:  88%|████████▊ | 28/32 [02:16<00:20,  5.01s/it]Inference:  91%|█████████ | 29/32 [02:21<00:14,  4.99s/it]Inference:  94%|█████████▍| 30/32 [02:26<00:10,  5.02s/it]Inference:  97%|█████████▋| 31/32 [02:31<00:05,  5.05s/it]Inference: 100%|██████████| 32/32 [02:36<00:00,  5.05s/it]Inference: 100%|██████████| 32/32 [02:36<00:00,  4.90s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 61
48299 MiB free out of 48676 MiB total
Done with layer 61 total_time elapsed: 10208 estimated time left: 2964
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:13,  4.46s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.44s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:22<01:59,  4.42s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.46s/it]Inference:  22%|██▏       | 7/32 [00:31<01:51,  4.47s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.50s/it]Inference:  28%|██▊       | 9/32 [00:40<01:42,  4.47s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.49s/it]Inference:  34%|███▍      | 11/32 [00:49<01:34,  4.50s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.49s/it]Inference:  41%|████      | 13/32 [00:58<01:25,  4.48s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.47s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.46s/it]Inference:  50%|█████     | 16/32 [01:11<01:10,  4.42s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.44s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:02,  4.43s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.44s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:53,  4.49s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.49s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:45,  4.51s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.52s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:36,  4.53s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.53s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:27,  4.50s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.46s/it]Inference:  88%|████████▊ | 28/32 [02:05<00:17,  4.45s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.43s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:08,  4.42s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.45s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.46s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.47s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 62
48299 MiB free out of 48676 MiB total
Done with layer 62 total_time elapsed: 10367 estimated time left: 2797
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:12,  4.26s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.42s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.41s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.37s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.37s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.42s/it]Inference:  22%|██▏       | 7/32 [00:30<01:50,  4.44s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.46s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.42s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.43s/it]Inference:  34%|███▍      | 11/32 [00:48<01:32,  4.41s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.46s/it]Inference:  41%|████      | 13/32 [00:57<01:25,  4.48s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.47s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.43s/it]Inference:  50%|█████     | 16/32 [01:10<01:10,  4.41s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.44s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:02,  4.48s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:58,  4.47s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.46s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:48,  4.44s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.48s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.51s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:36,  4.59s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:32,  4.62s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:28,  4.70s/it]Inference:  84%|████████▍ | 27/32 [02:01<00:23,  4.75s/it]Inference:  88%|████████▊ | 28/32 [02:06<00:19,  4.78s/it]Inference:  91%|█████████ | 29/32 [02:11<00:14,  4.80s/it]Inference:  94%|█████████▍| 30/32 [02:15<00:09,  4.77s/it]Inference:  97%|█████████▋| 31/32 [02:20<00:04,  4.77s/it]Inference: 100%|██████████| 32/32 [02:25<00:00,  4.78s/it]Inference: 100%|██████████| 32/32 [02:25<00:00,  4.55s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 63
48299 MiB free out of 48676 MiB total
Done with layer 63 total_time elapsed: 10528 estimated time left: 2632
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:26,  4.73s/it]Inference:   6%|▋         | 2/32 [00:09<02:24,  4.80s/it]Inference:   9%|▉         | 3/32 [00:14<02:18,  4.78s/it]Inference:  12%|█▎        | 4/32 [00:18<02:11,  4.71s/it]Inference:  16%|█▌        | 5/32 [00:23<02:06,  4.69s/it]Inference:  19%|█▉        | 6/32 [00:28<02:03,  4.75s/it]Inference:  22%|██▏       | 7/32 [00:33<01:59,  4.76s/it]Inference:  25%|██▌       | 8/32 [00:38<01:54,  4.78s/it]Inference:  28%|██▊       | 9/32 [00:42<01:50,  4.79s/it]Inference:  31%|███▏      | 10/32 [00:47<01:45,  4.79s/it]Inference:  34%|███▍      | 11/32 [00:52<01:41,  4.82s/it]Inference:  38%|███▊      | 12/32 [00:57<01:36,  4.80s/it]Inference:  41%|████      | 13/32 [01:02<01:31,  4.81s/it]Inference:  44%|████▍     | 14/32 [01:06<01:26,  4.80s/it]Inference:  47%|████▋     | 15/32 [01:11<01:21,  4.81s/it]Inference:  50%|█████     | 16/32 [01:16<01:15,  4.74s/it]Inference:  53%|█████▎    | 17/32 [01:21<01:11,  4.78s/it]Inference:  56%|█████▋    | 18/32 [01:26<01:07,  4.79s/it]Inference:  59%|█████▉    | 19/32 [01:30<01:02,  4.80s/it]Inference:  62%|██████▎   | 20/32 [01:35<00:58,  4.85s/it]Inference:  66%|██████▌   | 21/32 [01:40<00:53,  4.90s/it]Inference:  69%|██████▉   | 22/32 [01:45<00:49,  4.92s/it]Inference:  72%|███████▏  | 23/32 [01:50<00:44,  4.92s/it]Inference:  75%|███████▌  | 24/32 [01:55<00:39,  4.92s/it]Inference:  78%|███████▊  | 25/32 [02:00<00:34,  4.88s/it]Inference:  81%|████████▏ | 26/32 [02:05<00:29,  4.88s/it]Inference:  84%|████████▍ | 27/32 [02:10<00:24,  4.84s/it]Inference:  88%|████████▊ | 28/32 [02:14<00:19,  4.87s/it]Inference:  91%|█████████ | 29/32 [02:19<00:14,  4.90s/it]Inference:  94%|█████████▍| 30/32 [02:24<00:09,  4.90s/it]Inference:  97%|█████████▋| 31/32 [02:29<00:04,  4.92s/it]Inference: 100%|██████████| 32/32 [02:34<00:00,  4.92s/it]Inference: 100%|██████████| 32/32 [02:34<00:00,  4.84s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 64
48299 MiB free out of 48676 MiB total
Done with layer 64 total_time elapsed: 10699 estimated time left: 2469
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:25,  4.70s/it]Inference:   6%|▋         | 2/32 [00:09<02:24,  4.80s/it]Inference:   9%|▉         | 3/32 [00:14<02:19,  4.81s/it]Inference:  12%|█▎        | 4/32 [00:19<02:14,  4.79s/it]Inference:  16%|█▌        | 5/32 [00:23<02:09,  4.80s/it]Inference:  19%|█▉        | 6/32 [00:28<02:05,  4.81s/it]Inference:  22%|██▏       | 7/32 [00:33<02:00,  4.83s/it]Inference:  25%|██▌       | 8/32 [00:38<01:57,  4.90s/it]Inference:  28%|██▊       | 9/32 [00:43<01:51,  4.87s/it]Inference:  31%|███▏      | 10/32 [00:48<01:47,  4.90s/it]Inference:  34%|███▍      | 11/32 [00:53<01:42,  4.87s/it]Inference:  38%|███▊      | 12/32 [00:58<01:36,  4.84s/it]Inference:  41%|████      | 13/32 [01:02<01:31,  4.82s/it]Inference:  44%|████▍     | 14/32 [01:07<01:26,  4.80s/it]Inference:  47%|████▋     | 15/32 [01:12<01:22,  4.84s/it]Inference:  50%|█████     | 16/32 [01:17<01:17,  4.82s/it]Inference:  53%|█████▎    | 17/32 [01:22<01:12,  4.86s/it]Inference:  56%|█████▋    | 18/32 [01:27<01:08,  4.89s/it]Inference:  59%|█████▉    | 19/32 [01:32<01:03,  4.89s/it]Inference:  62%|██████▎   | 20/32 [01:36<00:58,  4.88s/it]Inference:  66%|██████▌   | 21/32 [01:41<00:53,  4.88s/it]Inference:  69%|██████▉   | 22/32 [01:46<00:48,  4.86s/it]Inference:  72%|███████▏  | 23/32 [01:51<00:43,  4.86s/it]Inference:  75%|███████▌  | 24/32 [01:56<00:38,  4.84s/it]Inference:  78%|███████▊  | 25/32 [02:01<00:33,  4.81s/it]Inference:  81%|████████▏ | 26/32 [02:05<00:28,  4.73s/it]Inference:  84%|████████▍ | 27/32 [02:10<00:23,  4.66s/it]Inference:  88%|████████▊ | 28/32 [02:14<00:18,  4.60s/it]Inference:  91%|█████████ | 29/32 [02:18<00:13,  4.54s/it]Inference:  94%|█████████▍| 30/32 [02:23<00:09,  4.53s/it]Inference:  97%|█████████▋| 31/32 [02:27<00:04,  4.52s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.48s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.76s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 65
48299 MiB free out of 48676 MiB total
Done with layer 65 total_time elapsed: 10867 estimated time left: 2305
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:15,  4.36s/it]Inference:   6%|▋         | 2/32 [00:08<02:13,  4.44s/it]Inference:   9%|▉         | 3/32 [00:13<02:09,  4.48s/it]Inference:  12%|█▎        | 4/32 [00:17<02:03,  4.41s/it]Inference:  16%|█▌        | 5/32 [00:22<02:00,  4.46s/it]Inference:  19%|█▉        | 6/32 [00:26<01:56,  4.48s/it]Inference:  22%|██▏       | 7/32 [00:31<01:51,  4.45s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.43s/it]Inference:  28%|██▊       | 9/32 [00:39<01:42,  4.44s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.47s/it]Inference:  34%|███▍      | 11/32 [00:49<01:33,  4.47s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.47s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.45s/it]Inference:  44%|████▍     | 14/32 [01:02<01:19,  4.43s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.46s/it]Inference:  50%|█████     | 16/32 [01:11<01:10,  4.42s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.46s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:02,  4.46s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.43s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:52,  4.42s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:48,  4.45s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.47s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.48s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.49s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.50s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.46s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.46s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.44s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.46s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:08,  4.48s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.50s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.47s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.46s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 66
48299 MiB free out of 48676 MiB total
Done with layer 66 total_time elapsed: 11025 estimated time left: 2139
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:16,  4.40s/it]Inference:   6%|▋         | 2/32 [00:08<02:15,  4.50s/it]Inference:   9%|▉         | 3/32 [00:13<02:11,  4.53s/it]Inference:  12%|█▎        | 4/32 [00:17<02:05,  4.46s/it]Inference:  16%|█▌        | 5/32 [00:22<02:01,  4.50s/it]Inference:  19%|█▉        | 6/32 [00:27<01:57,  4.52s/it]Inference:  22%|██▏       | 7/32 [00:31<01:53,  4.52s/it]Inference:  25%|██▌       | 8/32 [00:36<01:48,  4.53s/it]Inference:  28%|██▊       | 9/32 [00:40<01:43,  4.52s/it]Inference:  31%|███▏      | 10/32 [00:45<01:39,  4.53s/it]Inference:  34%|███▍      | 11/32 [00:49<01:35,  4.55s/it]Inference:  38%|███▊      | 12/32 [00:54<01:30,  4.53s/it]Inference:  41%|████      | 13/32 [00:58<01:26,  4.53s/it]Inference:  44%|████▍     | 14/32 [01:03<01:21,  4.52s/it]Inference:  47%|████▋     | 15/32 [01:07<01:17,  4.55s/it]Inference:  50%|█████     | 16/32 [01:12<01:11,  4.49s/it]Inference:  53%|█████▎    | 17/32 [01:16<01:07,  4.50s/it]Inference:  56%|█████▋    | 18/32 [01:21<01:03,  4.51s/it]Inference:  59%|█████▉    | 19/32 [01:25<00:58,  4.53s/it]Inference:  62%|██████▎   | 20/32 [01:30<00:54,  4.53s/it]Inference:  66%|██████▌   | 21/32 [01:34<00:49,  4.54s/it]Inference:  69%|██████▉   | 22/32 [01:39<00:45,  4.54s/it]Inference:  72%|███████▏  | 23/32 [01:44<00:40,  4.54s/it]Inference:  75%|███████▌  | 24/32 [01:48<00:36,  4.53s/it]Inference:  78%|███████▊  | 25/32 [01:53<00:31,  4.52s/it]Inference:  81%|████████▏ | 26/32 [01:57<00:27,  4.51s/it]Inference:  84%|████████▍ | 27/32 [02:02<00:22,  4.54s/it]Inference:  88%|████████▊ | 28/32 [02:06<00:18,  4.55s/it]Inference:  91%|█████████ | 29/32 [02:11<00:13,  4.55s/it]Inference:  94%|█████████▍| 30/32 [02:15<00:09,  4.53s/it]Inference:  97%|█████████▋| 31/32 [02:20<00:04,  4.50s/it]Inference: 100%|██████████| 32/32 [02:24<00:00,  4.52s/it]Inference: 100%|██████████| 32/32 [02:24<00:00,  4.52s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 67
48299 MiB free out of 48676 MiB total
Done with layer 67 total_time elapsed: 11185 estimated time left: 1974
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:15,  4.37s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.42s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.43s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.37s/it]Inference:  16%|█▌        | 5/32 [00:22<01:59,  4.42s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.44s/it]Inference:  22%|██▏       | 7/32 [00:31<01:51,  4.46s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.46s/it]Inference:  28%|██▊       | 9/32 [00:39<01:42,  4.44s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.46s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.47s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.49s/it]Inference:  41%|████      | 13/32 [00:57<01:25,  4.51s/it]Inference:  44%|████▍     | 14/32 [01:02<01:21,  4.50s/it]Inference:  47%|████▋     | 15/32 [01:06<01:15,  4.47s/it]Inference:  50%|█████     | 16/32 [01:11<01:10,  4.39s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:05,  4.37s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:01,  4.43s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.45s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.42s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:48,  4.44s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.47s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.49s/it]Inference:  75%|███████▌  | 24/32 [01:46<00:35,  4.49s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.45s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.41s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.46s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.46s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.47s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:08,  4.48s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.49s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.50s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.46s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 68
48299 MiB free out of 48676 MiB total
Done with layer 68 total_time elapsed: 11344 estimated time left: 1809
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:16,  4.41s/it]Inference:   6%|▋         | 2/32 [00:09<02:18,  4.61s/it]Inference:   9%|▉         | 3/32 [00:13<02:15,  4.66s/it]Inference:  12%|█▎        | 4/32 [00:18<02:09,  4.63s/it]Inference:  16%|█▌        | 5/32 [00:23<02:05,  4.65s/it]Inference:  19%|█▉        | 6/32 [00:27<02:01,  4.68s/it]Inference:  22%|██▏       | 7/32 [00:32<01:57,  4.70s/it]Inference:  25%|██▌       | 8/32 [00:37<01:53,  4.73s/it]Inference:  28%|██▊       | 9/32 [00:42<01:48,  4.73s/it]Inference:  31%|███▏      | 10/32 [00:46<01:43,  4.73s/it]Inference:  34%|███▍      | 11/32 [00:51<01:39,  4.73s/it]Inference:  38%|███▊      | 12/32 [00:56<01:35,  4.75s/it]Inference:  41%|████      | 13/32 [01:01<01:30,  4.76s/it]Inference:  44%|████▍     | 14/32 [01:05<01:25,  4.77s/it]Inference:  47%|████▋     | 15/32 [01:10<01:21,  4.78s/it]Inference:  50%|█████     | 16/32 [01:15<01:15,  4.72s/it]Inference:  53%|█████▎    | 17/32 [01:20<01:11,  4.75s/it]Inference:  56%|█████▋    | 18/32 [01:25<01:06,  4.78s/it]Inference:  59%|█████▉    | 19/32 [01:29<01:02,  4.80s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:57,  4.77s/it]Inference:  66%|██████▌   | 21/32 [01:39<00:52,  4.79s/it]Inference:  69%|██████▉   | 22/32 [01:44<00:48,  4.81s/it]Inference:  72%|███████▏  | 23/32 [01:49<00:43,  4.82s/it]Inference:  75%|███████▌  | 24/32 [01:54<00:38,  4.84s/it]Inference:  78%|███████▊  | 25/32 [01:58<00:33,  4.84s/it]Inference:  81%|████████▏ | 26/32 [02:03<00:29,  4.85s/it]Inference:  84%|████████▍ | 27/32 [02:08<00:24,  4.85s/it]Inference:  88%|████████▊ | 28/32 [02:13<00:19,  4.85s/it]Inference:  91%|█████████ | 29/32 [02:18<00:14,  4.84s/it]Inference:  94%|█████████▍| 30/32 [02:23<00:09,  4.84s/it]Inference:  97%|█████████▋| 31/32 [02:27<00:04,  4.84s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.86s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.78s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 69
48299 MiB free out of 48676 MiB total
Done with layer 69 total_time elapsed: 11512 estimated time left: 1645
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:28,  4.79s/it]Inference:   6%|▋         | 2/32 [00:09<02:27,  4.90s/it]Inference:   9%|▉         | 3/32 [00:14<02:23,  4.95s/it]Inference:  12%|█▎        | 4/32 [00:19<02:16,  4.88s/it]Inference:  16%|█▌        | 5/32 [00:24<02:11,  4.88s/it]Inference:  19%|█▉        | 6/32 [00:29<02:07,  4.91s/it]Inference:  22%|██▏       | 7/32 [00:34<02:03,  4.95s/it]Inference:  25%|██▌       | 8/32 [00:39<01:58,  4.93s/it]Inference:  28%|██▊       | 9/32 [00:44<01:53,  4.94s/it]Inference:  31%|███▏      | 10/32 [00:49<01:49,  4.97s/it]Inference:  34%|███▍      | 11/32 [00:54<01:43,  4.91s/it]Inference:  38%|███▊      | 12/32 [00:59<01:38,  4.93s/it]Inference:  41%|████      | 13/32 [01:04<01:34,  4.95s/it]Inference:  44%|████▍     | 14/32 [01:08<01:28,  4.93s/it]Inference:  47%|████▋     | 15/32 [01:13<01:24,  4.95s/it]Inference:  50%|█████     | 16/32 [01:18<01:17,  4.87s/it]Inference:  53%|█████▎    | 17/32 [01:23<01:13,  4.88s/it]Inference:  56%|█████▋    | 18/32 [01:28<01:08,  4.93s/it]Inference:  59%|█████▉    | 19/32 [01:33<01:04,  4.94s/it]Inference:  62%|██████▎   | 20/32 [01:38<00:58,  4.91s/it]Inference:  66%|██████▌   | 21/32 [01:43<00:54,  4.92s/it]Inference:  69%|██████▉   | 22/32 [01:48<00:49,  4.90s/it]Inference:  72%|███████▏  | 23/32 [01:53<00:44,  4.90s/it]Inference:  75%|███████▌  | 24/32 [01:57<00:39,  4.89s/it]Inference:  78%|███████▊  | 25/32 [02:02<00:34,  4.88s/it]Inference:  81%|████████▏ | 26/32 [02:07<00:29,  4.91s/it]Inference:  84%|████████▍ | 27/32 [02:12<00:24,  4.93s/it]Inference:  88%|████████▊ | 28/32 [02:17<00:19,  4.93s/it]Inference:  91%|█████████ | 29/32 [02:22<00:14,  4.88s/it]Inference:  94%|█████████▍| 30/32 [02:26<00:09,  4.76s/it]Inference:  97%|█████████▋| 31/32 [02:31<00:04,  4.69s/it]Inference: 100%|██████████| 32/32 [02:35<00:00,  4.62s/it]Inference: 100%|██████████| 32/32 [02:35<00:00,  4.87s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 70
48299 MiB free out of 48676 MiB total
Done with layer 70 total_time elapsed: 11684 estimated time left: 1481
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.35s/it]Inference:   6%|▋         | 2/32 [00:08<02:13,  4.44s/it]Inference:   9%|▉         | 3/32 [00:13<02:09,  4.46s/it]Inference:  12%|█▎        | 4/32 [00:17<02:03,  4.41s/it]Inference:  16%|█▌        | 5/32 [00:22<02:00,  4.46s/it]Inference:  19%|█▉        | 6/32 [00:26<01:56,  4.47s/it]Inference:  22%|██▏       | 7/32 [00:31<01:52,  4.49s/it]Inference:  25%|██▌       | 8/32 [00:35<01:48,  4.50s/it]Inference:  28%|██▊       | 9/32 [00:40<01:42,  4.46s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.46s/it]Inference:  34%|███▍      | 11/32 [00:49<01:34,  4.49s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.48s/it]Inference:  41%|████      | 13/32 [00:58<01:25,  4.48s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.50s/it]Inference:  47%|████▋     | 15/32 [01:07<01:16,  4.48s/it]Inference:  50%|█████     | 16/32 [01:11<01:10,  4.42s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.42s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:01,  4.42s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.40s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:52,  4.39s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:48,  4.44s/it]Inference:  69%|██████▉   | 22/32 [01:37<00:44,  4.45s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.47s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:35,  4.50s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.49s/it]Inference:  81%|████████▏ | 26/32 [01:55<00:26,  4.44s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.46s/it]Inference:  88%|████████▊ | 28/32 [02:04<00:17,  4.48s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.47s/it]Inference:  94%|█████████▍| 30/32 [02:13<00:09,  4.51s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.52s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.54s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.47s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 71
48299 MiB free out of 48676 MiB total
Done with layer 71 total_time elapsed: 11842 estimated time left: 1316
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:15,  4.38s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.43s/it]Inference:   9%|▉         | 3/32 [00:13<02:08,  4.41s/it]Inference:  12%|█▎        | 4/32 [00:17<02:01,  4.33s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.40s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.45s/it]Inference:  22%|██▏       | 7/32 [00:31<01:51,  4.47s/it]Inference:  25%|██▌       | 8/32 [00:35<01:48,  4.50s/it]Inference:  28%|██▊       | 9/32 [00:40<01:43,  4.50s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.50s/it]Inference:  34%|███▍      | 11/32 [00:49<01:34,  4.48s/it]Inference:  38%|███▊      | 12/32 [00:53<01:30,  4.52s/it]Inference:  41%|████      | 13/32 [00:58<01:26,  4.54s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.49s/it]Inference:  47%|████▋     | 15/32 [01:07<01:16,  4.51s/it]Inference:  50%|█████     | 16/32 [01:11<01:11,  4.46s/it]Inference:  53%|█████▎    | 17/32 [01:16<01:07,  4.48s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:02,  4.47s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:58,  4.48s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:53,  4.44s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.48s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:45,  4.51s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.48s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:36,  4.52s/it]Inference:  78%|███████▊  | 25/32 [01:52<00:31,  4.52s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:26,  4.50s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.50s/it]Inference:  88%|████████▊ | 28/32 [02:05<00:18,  4.51s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.51s/it]Inference:  94%|█████████▍| 30/32 [02:14<00:08,  4.50s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.50s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.52s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.49s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 72
48299 MiB free out of 48676 MiB total
Done with layer 72 total_time elapsed: 12002 estimated time left: 1151
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:10,  4.22s/it]Inference:   6%|▋         | 2/32 [00:08<02:13,  4.44s/it]Inference:   9%|▉         | 3/32 [00:13<02:09,  4.45s/it]Inference:  12%|█▎        | 4/32 [00:17<02:03,  4.42s/it]Inference:  16%|█▌        | 5/32 [00:22<01:59,  4.44s/it]Inference:  19%|█▉        | 6/32 [00:26<01:56,  4.48s/it]Inference:  22%|██▏       | 7/32 [00:31<01:51,  4.46s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.44s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.43s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.46s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.47s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.48s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.45s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.49s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.49s/it]Inference:  50%|█████     | 16/32 [01:11<01:11,  4.45s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:07,  4.47s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:02,  4.45s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.43s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:53,  4.44s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.47s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:45,  4.51s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.51s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:36,  4.50s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.45s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:26,  4.48s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.49s/it]Inference:  88%|████████▊ | 28/32 [02:05<00:17,  4.50s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.52s/it]Inference:  94%|█████████▍| 30/32 [02:14<00:08,  4.50s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.45s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.44s/it]Inference: 100%|██████████| 32/32 [02:22<00:00,  4.46s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 73
48299 MiB free out of 48676 MiB total
Done with layer 73 total_time elapsed: 12160 estimated time left: 986
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:12,  4.43s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.38s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.30s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.40s/it]Inference:  19%|█▉        | 6/32 [00:26<01:58,  4.57s/it]Inference:  22%|██▏       | 7/32 [00:31<01:55,  4.63s/it]Inference:  25%|██▌       | 8/32 [00:36<01:52,  4.69s/it]Inference:  28%|██▊       | 9/32 [00:41<01:48,  4.73s/it]Inference:  31%|███▏      | 10/32 [00:46<01:45,  4.77s/it]Inference:  34%|███▍      | 11/32 [00:50<01:39,  4.72s/it]Inference:  38%|███▊      | 12/32 [00:55<01:35,  4.77s/it]Inference:  41%|████      | 13/32 [01:00<01:31,  4.80s/it]Inference:  44%|████▍     | 14/32 [01:05<01:26,  4.80s/it]Inference:  47%|████▋     | 15/32 [01:10<01:21,  4.82s/it]Inference:  50%|█████     | 16/32 [01:14<01:16,  4.78s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:11,  4.79s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:06,  4.77s/it]Inference:  59%|█████▉    | 19/32 [01:29<01:02,  4.82s/it]Inference:  62%|██████▎   | 20/32 [01:34<00:58,  4.84s/it]Inference:  66%|██████▌   | 21/32 [01:38<00:53,  4.84s/it]Inference:  69%|██████▉   | 22/32 [01:43<00:48,  4.86s/it]Inference:  72%|███████▏  | 23/32 [01:48<00:43,  4.85s/it]Inference:  75%|███████▌  | 24/32 [01:53<00:38,  4.85s/it]Inference:  78%|███████▊  | 25/32 [01:58<00:33,  4.84s/it]Inference:  81%|████████▏ | 26/32 [02:03<00:29,  4.85s/it]Inference:  84%|████████▍ | 27/32 [02:07<00:24,  4.82s/it]Inference:  88%|████████▊ | 28/32 [02:12<00:19,  4.83s/it]Inference:  91%|█████████ | 29/32 [02:17<00:14,  4.83s/it]Inference:  94%|█████████▍| 30/32 [02:22<00:09,  4.90s/it]Inference:  97%|█████████▋| 31/32 [02:27<00:04,  4.94s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.97s/it]Inference: 100%|██████████| 32/32 [02:32<00:00,  4.78s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 74
48299 MiB free out of 48676 MiB total
Done with layer 74 total_time elapsed: 12329 estimated time left: 822
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:27,  4.76s/it]Inference:   6%|▋         | 2/32 [00:09<02:25,  4.86s/it]Inference:   9%|▉         | 3/32 [00:14<02:22,  4.90s/it]Inference:  12%|█▎        | 4/32 [00:19<02:14,  4.79s/it]Inference:  16%|█▌        | 5/32 [00:24<02:09,  4.80s/it]Inference:  19%|█▉        | 6/32 [00:28<02:04,  4.80s/it]Inference:  22%|██▏       | 7/32 [00:33<01:59,  4.78s/it]Inference:  25%|██▌       | 8/32 [00:38<01:54,  4.76s/it]Inference:  28%|██▊       | 9/32 [00:43<01:50,  4.79s/it]Inference:  31%|███▏      | 10/32 [00:47<01:45,  4.79s/it]Inference:  34%|███▍      | 11/32 [00:52<01:41,  4.81s/it]Inference:  38%|███▊      | 12/32 [00:57<01:35,  4.75s/it]Inference:  41%|████      | 13/32 [01:01<01:28,  4.67s/it]Inference:  44%|████▍     | 14/32 [01:06<01:23,  4.62s/it]Inference:  47%|████▋     | 15/32 [01:10<01:17,  4.57s/it]Inference:  50%|█████     | 16/32 [01:15<01:11,  4.49s/it]Inference:  53%|█████▎    | 17/32 [01:19<01:06,  4.45s/it]Inference:  56%|█████▋    | 18/32 [01:24<01:02,  4.47s/it]Inference:  59%|█████▉    | 19/32 [01:28<00:58,  4.48s/it]Inference:  62%|██████▎   | 20/32 [01:33<00:53,  4.48s/it]Inference:  66%|██████▌   | 21/32 [01:37<00:48,  4.45s/it]Inference:  69%|██████▉   | 22/32 [01:41<00:44,  4.42s/it]Inference:  72%|███████▏  | 23/32 [01:46<00:39,  4.43s/it]Inference:  75%|███████▌  | 24/32 [01:50<00:35,  4.46s/it]Inference:  78%|███████▊  | 25/32 [01:55<00:31,  4.47s/it]Inference:  81%|████████▏ | 26/32 [01:59<00:26,  4.49s/it]Inference:  84%|████████▍ | 27/32 [02:04<00:22,  4.49s/it]Inference:  88%|████████▊ | 28/32 [02:08<00:18,  4.51s/it]Inference:  91%|█████████ | 29/32 [02:13<00:13,  4.46s/it]Inference:  94%|█████████▍| 30/32 [02:17<00:08,  4.45s/it]Inference:  97%|█████████▋| 31/32 [02:22<00:04,  4.43s/it]Inference: 100%|██████████| 32/32 [02:26<00:00,  4.42s/it]Inference: 100%|██████████| 32/32 [02:26<00:00,  4.58s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 75
48299 MiB free out of 48676 MiB total
Done with layer 75 total_time elapsed: 12489 estimated time left: 657
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:09,  4.17s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.31s/it]Inference:   9%|▉         | 3/32 [00:12<02:05,  4.33s/it]Inference:  12%|█▎        | 4/32 [00:17<01:59,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:57,  4.35s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.42s/it]Inference:  22%|██▏       | 7/32 [00:30<01:51,  4.45s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.44s/it]Inference:  28%|██▊       | 9/32 [00:39<01:42,  4.45s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.45s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.47s/it]Inference:  38%|███▊      | 12/32 [00:52<01:29,  4.46s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.46s/it]Inference:  44%|████▍     | 14/32 [01:02<01:21,  4.51s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.52s/it]Inference:  50%|█████     | 16/32 [01:11<01:11,  4.49s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:07,  4.52s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:03,  4.53s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:58,  4.53s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:54,  4.53s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.52s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:45,  4.53s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.53s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:35,  4.48s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.50s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:27,  4.53s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.54s/it]Inference:  88%|████████▊ | 28/32 [02:05<00:18,  4.54s/it]Inference:  91%|█████████ | 29/32 [02:10<00:13,  4.56s/it]Inference:  94%|█████████▍| 30/32 [02:14<00:09,  4.56s/it]Inference:  97%|█████████▋| 31/32 [02:19<00:04,  4.56s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.57s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.49s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 76
48299 MiB free out of 48676 MiB total
Done with layer 76 total_time elapsed: 12648 estimated time left: 493
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:13,  4.45s/it]Inference:   9%|▉         | 3/32 [00:13<02:09,  4.45s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.38s/it]Inference:  16%|█▌        | 5/32 [00:22<02:00,  4.45s/it]Inference:  19%|█▉        | 6/32 [00:26<01:54,  4.42s/it]Inference:  22%|██▏       | 7/32 [00:31<01:51,  4.46s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.47s/it]Inference:  28%|██▊       | 9/32 [00:40<01:42,  4.47s/it]Inference:  31%|███▏      | 10/32 [00:44<01:38,  4.50s/it]Inference:  34%|███▍      | 11/32 [00:49<01:34,  4.51s/it]Inference:  38%|███▊      | 12/32 [00:53<01:29,  4.49s/it]Inference:  41%|████      | 13/32 [00:58<01:25,  4.51s/it]Inference:  44%|████▍     | 14/32 [01:02<01:21,  4.51s/it]Inference:  47%|████▋     | 15/32 [01:07<01:17,  4.54s/it]Inference:  50%|█████     | 16/32 [01:11<01:12,  4.51s/it]Inference:  53%|█████▎    | 17/32 [01:16<01:08,  4.53s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:03,  4.53s/it]Inference:  59%|█████▉    | 19/32 [01:25<00:58,  4.50s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:53,  4.47s/it]Inference:  66%|██████▌   | 21/32 [01:34<00:49,  4.49s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:44,  4.50s/it]Inference:  72%|███████▏  | 23/32 [01:43<00:40,  4.51s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:36,  4.53s/it]Inference:  78%|███████▊  | 25/32 [01:52<00:31,  4.53s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:27,  4.53s/it]Inference:  84%|████████▍ | 27/32 [02:01<00:22,  4.49s/it]Inference:  88%|████████▊ | 28/32 [02:05<00:18,  4.51s/it]Inference:  91%|█████████ | 29/32 [02:10<00:13,  4.51s/it]Inference:  94%|█████████▍| 30/32 [02:14<00:09,  4.52s/it]Inference:  97%|█████████▋| 31/32 [02:19<00:04,  4.53s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.52s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.50s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 77
48299 MiB free out of 48676 MiB total
Done with layer 77 total_time elapsed: 12807 estimated time left: 328
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.33s/it]Inference:   6%|▋         | 2/32 [00:08<02:10,  4.36s/it]Inference:   9%|▉         | 3/32 [00:13<02:06,  4.36s/it]Inference:  12%|█▎        | 4/32 [00:17<02:00,  4.29s/it]Inference:  16%|█▌        | 5/32 [00:21<01:58,  4.38s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.43s/it]Inference:  22%|██▏       | 7/32 [00:30<01:51,  4.45s/it]Inference:  25%|██▌       | 8/32 [00:35<01:46,  4.46s/it]Inference:  28%|██▊       | 9/32 [00:39<01:41,  4.43s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.44s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.44s/it]Inference:  38%|███▊      | 12/32 [00:52<01:28,  4.42s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.44s/it]Inference:  44%|████▍     | 14/32 [01:01<01:20,  4.47s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.50s/it]Inference:  50%|█████     | 16/32 [01:10<01:11,  4.45s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:07,  4.48s/it]Inference:  56%|█████▋    | 18/32 [01:19<01:03,  4.51s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:59,  4.57s/it]Inference:  62%|██████▎   | 20/32 [01:29<00:55,  4.66s/it]Inference:  66%|██████▌   | 21/32 [01:34<00:52,  4.74s/it]Inference:  69%|██████▉   | 22/32 [01:39<00:47,  4.77s/it]Inference:  72%|███████▏  | 23/32 [01:44<00:43,  4.80s/it]Inference:  75%|███████▌  | 24/32 [01:49<00:38,  4.83s/it]Inference:  78%|███████▊  | 25/32 [01:53<00:33,  4.81s/it]Inference:  81%|████████▏ | 26/32 [01:58<00:29,  4.84s/it]Inference:  84%|████████▍ | 27/32 [02:03<00:24,  4.85s/it]Inference:  88%|████████▊ | 28/32 [02:08<00:19,  4.84s/it]Inference:  91%|█████████ | 29/32 [02:13<00:14,  4.85s/it]Inference:  94%|█████████▍| 30/32 [02:18<00:09,  4.87s/it]Inference:  97%|█████████▋| 31/32 [02:23<00:04,  4.86s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.86s/it]Inference: 100%|██████████| 32/32 [02:27<00:00,  4.62s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 78
48299 MiB free out of 48676 MiB total
Done with layer 78 total_time elapsed: 12970 estimated time left: 164
layer original dtype torch.bfloat16
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=1024, bias=False)
sublayer Linear(in_features=8192, out_features=8192, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=8192, out_features=28672, bias=False)
sublayer Linear(in_features=28672, out_features=8192, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:04<02:14,  4.35s/it]Inference:   6%|▋         | 2/32 [00:08<02:09,  4.32s/it]Inference:   9%|▉         | 3/32 [00:13<02:07,  4.40s/it]Inference:  12%|█▎        | 4/32 [00:17<02:02,  4.36s/it]Inference:  16%|█▌        | 5/32 [00:21<01:59,  4.41s/it]Inference:  19%|█▉        | 6/32 [00:26<01:55,  4.45s/it]Inference:  22%|██▏       | 7/32 [00:30<01:51,  4.47s/it]Inference:  25%|██▌       | 8/32 [00:35<01:47,  4.47s/it]Inference:  28%|██▊       | 9/32 [00:39<01:43,  4.48s/it]Inference:  31%|███▏      | 10/32 [00:44<01:37,  4.45s/it]Inference:  34%|███▍      | 11/32 [00:48<01:33,  4.43s/it]Inference:  38%|███▊      | 12/32 [00:53<01:28,  4.45s/it]Inference:  41%|████      | 13/32 [00:57<01:24,  4.46s/it]Inference:  44%|████▍     | 14/32 [01:02<01:20,  4.49s/it]Inference:  47%|████▋     | 15/32 [01:06<01:16,  4.50s/it]Inference:  50%|█████     | 16/32 [01:11<01:10,  4.43s/it]Inference:  53%|█████▎    | 17/32 [01:15<01:06,  4.45s/it]Inference:  56%|█████▋    | 18/32 [01:20<01:02,  4.46s/it]Inference:  59%|█████▉    | 19/32 [01:24<00:57,  4.44s/it]Inference:  62%|██████▎   | 20/32 [01:28<00:53,  4.46s/it]Inference:  66%|██████▌   | 21/32 [01:33<00:49,  4.50s/it]Inference:  69%|██████▉   | 22/32 [01:38<00:45,  4.51s/it]Inference:  72%|███████▏  | 23/32 [01:42<00:40,  4.52s/it]Inference:  75%|███████▌  | 24/32 [01:47<00:36,  4.52s/it]Inference:  78%|███████▊  | 25/32 [01:51<00:31,  4.51s/it]Inference:  81%|████████▏ | 26/32 [01:56<00:27,  4.54s/it]Inference:  84%|████████▍ | 27/32 [02:00<00:22,  4.54s/it]Inference:  88%|████████▊ | 28/32 [02:05<00:18,  4.54s/it]Inference:  91%|█████████ | 29/32 [02:09<00:13,  4.54s/it]Inference:  94%|█████████▍| 30/32 [02:14<00:08,  4.49s/it]Inference:  97%|█████████▋| 31/32 [02:18<00:04,  4.50s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.51s/it]Inference: 100%|██████████| 32/32 [02:23<00:00,  4.48s/it]
46667 MiB free out of 48676 MiB total
after cleaning up 79
48299 MiB free out of 48676 MiB total
Done with layer 79 total_time elapsed: 13128 estimated time left: 0
Total bits: 0 Total params: 0
Traceback (most recent call last):
  File "/data/lliu/huffman/scripts/generate_hessians.py", line 407, in <module>
    generate_hessians(model, train_loader, val_loader, args.device)
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/lliu/huffman/scripts/generate_hessians.py", line 315, in generate_hessians
    print("average bits per value:", total_bits / total_params)
                                     ~~~~~~~~~~~^~~~~~~~~~~~~~
ZeroDivisionError: division by zero
/data/lliu/huffman/scripts/generate_hessians.bash: line 24: N: command not found
