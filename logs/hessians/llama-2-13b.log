Generating hessians for meta-llama/Llama-2-13b-hf with 128 samples
Using Llama-2 so setting seqlen to 4096
/data/lliu/huffman
/home/lliu/anaconda3/lib/python3.11/site-packages/torch/jit/annotations.py:389: UserWarning: TorchScript will treat type annotations of Tensor dtype-specific subtypes as if they are normal Tensors. dtype constraints are not enforced in compilation either.
  warnings.warn(
2024-12-23 15:29:53.012057: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-12-23 15:29:53.029065: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-12-23 15:29:53.037637: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-12-23 15:29:53.052966: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-12-23 15:29:54.351588: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:00,  4.31it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:00<00:00,  4.64it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.32it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:00<00:00,  4.37it/s]
Model loaded. LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 5120)
    (layers): ModuleList(
      (0-39): 40 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (k_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (v_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (o_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=5120, out_features=13824, bias=False)
          (up_proj): Linear(in_features=5120, out_features=13824, bias=False)
          (down_proj): Linear(in_features=13824, out_features=5120, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((5120,), eps=1e-05)
        (post_attention_layernorm): LlamaRMSNorm((5120,), eps=1e-05)
      )
    )
    (norm): LlamaRMSNorm((5120,), eps=1e-05)
    (rotary_emb): LlamaRotaryEmbedding()
  )
  (lm_head): Linear(in_features=5120, out_features=32000, bias=False)
)
Starting...
getting inputs:   0%|          | 0/128 [00:00<?, ?it/s]getting inputs:   1%|          | 1/128 [00:00<01:31,  1.38it/s]getting inputs:   3%|▎         | 4/128 [00:00<00:20,  6.03it/s]getting inputs:   5%|▌         | 7/128 [00:00<00:11, 10.26it/s]getting inputs:   8%|▊         | 10/128 [00:01<00:08, 14.19it/s]getting inputs:  10%|█         | 13/128 [00:01<00:06, 17.38it/s]getting inputs:  12%|█▎        | 16/128 [00:01<00:05, 19.91it/s]getting inputs:  15%|█▍        | 19/128 [00:01<00:05, 21.32it/s]getting inputs:  17%|█▋        | 22/128 [00:01<00:04, 22.30it/s]getting inputs:  20%|█▉        | 25/128 [00:01<00:04, 23.70it/s]getting inputs:  22%|██▏       | 28/128 [00:01<00:04, 24.20it/s]getting inputs:  24%|██▍       | 31/128 [00:01<00:04, 23.43it/s]getting inputs:  27%|██▋       | 34/128 [00:01<00:03, 24.61it/s]getting inputs:  29%|██▉       | 37/128 [00:02<00:03, 25.22it/s]getting inputs:  31%|███▏      | 40/128 [00:02<00:03, 25.55it/s]getting inputs:  34%|███▎      | 43/128 [00:02<00:03, 25.62it/s]getting inputs:  36%|███▌      | 46/128 [00:02<00:03, 25.24it/s]getting inputs:  38%|███▊      | 49/128 [00:02<00:03, 25.19it/s]getting inputs:  41%|████      | 52/128 [00:02<00:02, 25.71it/s]getting inputs:  43%|████▎     | 55/128 [00:02<00:02, 26.01it/s]getting inputs:  45%|████▌     | 58/128 [00:02<00:02, 26.34it/s]getting inputs:  48%|████▊     | 61/128 [00:03<00:02, 25.90it/s]getting inputs:  50%|█████     | 64/128 [00:03<00:02, 25.74it/s]getting inputs:  52%|█████▏    | 67/128 [00:03<00:02, 25.87it/s]getting inputs:  55%|█████▍    | 70/128 [00:03<00:02, 25.99it/s]getting inputs:  57%|█████▋    | 73/128 [00:03<00:02, 25.78it/s]getting inputs:  59%|█████▉    | 76/128 [00:03<00:02, 25.74it/s]getting inputs:  62%|██████▏   | 79/128 [00:03<00:01, 26.09it/s]getting inputs:  64%|██████▍   | 82/128 [00:03<00:01, 26.23it/s]getting inputs:  66%|██████▋   | 85/128 [00:03<00:01, 26.25it/s]getting inputs:  69%|██████▉   | 88/128 [00:04<00:01, 26.26it/s]getting inputs:  71%|███████   | 91/128 [00:04<00:01, 26.50it/s]getting inputs:  73%|███████▎  | 94/128 [00:04<00:01, 26.45it/s]getting inputs:  76%|███████▌  | 97/128 [00:04<00:01, 26.44it/s]getting inputs:  78%|███████▊  | 100/128 [00:04<00:01, 26.35it/s]getting inputs:  80%|████████  | 103/128 [00:04<00:00, 26.61it/s]getting inputs:  83%|████████▎ | 106/128 [00:04<00:00, 26.77it/s]getting inputs:  85%|████████▌ | 109/128 [00:04<00:00, 26.58it/s]getting inputs:  88%|████████▊ | 112/128 [00:04<00:00, 26.20it/s]getting inputs:  90%|████████▉ | 115/128 [00:05<00:00, 26.52it/s]getting inputs:  92%|█████████▏| 118/128 [00:05<00:00, 26.56it/s]getting inputs:  95%|█████████▍| 121/128 [00:05<00:00, 26.03it/s]getting inputs:  97%|█████████▋| 124/128 [00:05<00:00, 26.38it/s]getting inputs:  99%|█████████▉| 127/128 [00:05<00:00, 26.58it/s]getting inputs: 100%|██████████| 128/128 [00:05<00:00, 22.99it/s]
48323 MiB free out of 48676 MiB total
Ready.
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:27,  1.11it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.29it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.35it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.37it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.39it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.40it/s]Inference:  22%|██▏       | 7/32 [00:05<00:17,  1.40it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.40it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.41it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.40it/s]Inference:  34%|███▍      | 11/32 [00:07<00:14,  1.41it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.41it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.41it/s]Inference:  44%|████▍     | 14/32 [00:10<00:12,  1.40it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.41it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.40it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.40it/s]Inference:  56%|█████▋    | 18/32 [00:12<00:09,  1.41it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.41it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.39it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:07,  1.40it/s]Inference:  69%|██████▉   | 22/32 [00:15<00:07,  1.39it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.39it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.37it/s]Inference:  78%|███████▊  | 25/32 [00:17<00:05,  1.38it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.39it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.40it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.39it/s]Inference:  91%|█████████ | 29/32 [00:20<00:02,  1.40it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.40it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.40it/s]Inference: 100%|██████████| 32/32 [00:22<00:00,  1.41it/s]Inference: 100%|██████████| 32/32 [00:22<00:00,  1.39it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 0
48317 MiB free out of 48676 MiB total
Done with layer 0 total_time elapsed: 35 estimated time left: 1377
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:23,  1.32it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.27it/s]Inference:   9%|▉         | 3/32 [00:02<00:22,  1.29it/s]Inference:  12%|█▎        | 4/32 [00:03<00:21,  1.29it/s]Inference:  16%|█▌        | 5/32 [00:03<00:20,  1.30it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.31it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.31it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.31it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.31it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.32it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.31it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.31it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.33it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.32it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.32it/s]Inference:  50%|█████     | 16/32 [00:12<00:11,  1.34it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.33it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.34it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:09,  1.35it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:07,  1.38it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.38it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:06,  1.38it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.38it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.39it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.38it/s]Inference:  84%|████████▍ | 27/32 [00:20<00:03,  1.37it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.38it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.38it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.38it/s]Inference:  97%|█████████▋| 31/32 [00:23<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.40it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.35it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 1
48317 MiB free out of 48676 MiB total
Done with layer 1 total_time elapsed: 64 estimated time left: 1222
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.41it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.34it/s]Inference:  12%|█▎        | 4/32 [00:02<00:21,  1.32it/s]Inference:  16%|█▌        | 5/32 [00:03<00:20,  1.30it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.31it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.31it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.31it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.30it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.30it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.30it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.31it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.31it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.30it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.30it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.30it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.30it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.30it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:09,  1.30it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.29it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.29it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.30it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:07,  1.27it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.27it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.28it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.28it/s]Inference:  84%|████████▍ | 27/32 [00:20<00:03,  1.28it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:03,  1.29it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.29it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.29it/s]Inference:  97%|█████████▋| 31/32 [00:23<00:00,  1.30it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.31it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.30it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 2
48317 MiB free out of 48676 MiB total
Done with layer 2 total_time elapsed: 94 estimated time left: 1161
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:21,  1.41it/s]Inference:   6%|▋         | 2/32 [00:01<00:20,  1.43it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.41it/s]Inference:  12%|█▎        | 4/32 [00:02<00:19,  1.42it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.42it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.41it/s]Inference:  22%|██▏       | 7/32 [00:04<00:17,  1.41it/s]Inference:  25%|██▌       | 8/32 [00:05<00:16,  1.42it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.42it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.40it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.39it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.39it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.37it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.37it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.38it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.38it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.37it/s]Inference:  56%|█████▋    | 18/32 [00:12<00:10,  1.37it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.38it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.38it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:07,  1.38it/s]Inference:  69%|██████▉   | 22/32 [00:15<00:07,  1.39it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.39it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.39it/s]Inference:  78%|███████▊  | 25/32 [00:17<00:05,  1.39it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.39it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.39it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.40it/s]Inference:  91%|█████████ | 29/32 [00:20<00:02,  1.40it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.39it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:22<00:00,  1.39it/s]Inference: 100%|██████████| 32/32 [00:22<00:00,  1.39it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 3
48317 MiB free out of 48676 MiB total
Done with layer 3 total_time elapsed: 122 estimated time left: 1101
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:24,  1.28it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.27it/s]Inference:   9%|▉         | 3/32 [00:02<00:22,  1.28it/s]Inference:  12%|█▎        | 4/32 [00:03<00:21,  1.29it/s]Inference:  16%|█▌        | 5/32 [00:03<00:21,  1.28it/s]Inference:  19%|█▉        | 6/32 [00:04<00:20,  1.29it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.28it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.29it/s]Inference:  28%|██▊       | 9/32 [00:07<00:17,  1.28it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.28it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.28it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.28it/s]Inference:  41%|████      | 13/32 [00:10<00:14,  1.27it/s]Inference:  44%|████▍     | 14/32 [00:10<00:14,  1.28it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.28it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.28it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.28it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:10,  1.28it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.27it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.28it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.28it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:07,  1.28it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:07,  1.28it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.27it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.28it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.27it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:03,  1.26it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:03,  1.27it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.27it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.27it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.27it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.28it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 4
48317 MiB free out of 48676 MiB total
Done with layer 4 total_time elapsed: 153 estimated time left: 1068
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:25,  1.20it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.27it/s]Inference:   9%|▉         | 3/32 [00:02<00:23,  1.26it/s]Inference:  12%|█▎        | 4/32 [00:03<00:22,  1.27it/s]Inference:  16%|█▌        | 5/32 [00:03<00:21,  1.25it/s]Inference:  19%|█▉        | 6/32 [00:04<00:21,  1.24it/s]Inference:  22%|██▏       | 7/32 [00:05<00:20,  1.24it/s]Inference:  25%|██▌       | 8/32 [00:06<00:19,  1.25it/s]Inference:  28%|██▊       | 9/32 [00:07<00:18,  1.25it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.25it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.24it/s]Inference:  38%|███▊      | 12/32 [00:09<00:16,  1.23it/s]Inference:  41%|████      | 13/32 [00:10<00:15,  1.23it/s]Inference:  44%|████▍     | 14/32 [00:11<00:14,  1.24it/s]Inference:  47%|████▋     | 15/32 [00:12<00:13,  1.24it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.24it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:12,  1.23it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:11,  1.22it/s]Inference:  59%|█████▉    | 19/32 [00:15<00:10,  1.22it/s]Inference:  62%|██████▎   | 20/32 [00:16<00:09,  1.21it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:09,  1.22it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:08,  1.22it/s]Inference:  72%|███████▏  | 23/32 [00:18<00:07,  1.22it/s]Inference:  75%|███████▌  | 24/32 [00:19<00:06,  1.23it/s]Inference:  78%|███████▊  | 25/32 [00:20<00:05,  1.22it/s]Inference:  81%|████████▏ | 26/32 [00:21<00:04,  1.22it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:04,  1.23it/s]Inference:  88%|████████▊ | 28/32 [00:22<00:03,  1.23it/s]Inference:  91%|█████████ | 29/32 [00:23<00:02,  1.23it/s]Inference:  94%|█████████▍| 30/32 [00:24<00:01,  1.23it/s]Inference:  97%|█████████▋| 31/32 [00:25<00:00,  1.24it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.25it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.24it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 5
48317 MiB free out of 48676 MiB total
Done with layer 5 total_time elapsed: 184 estimated time left: 1042
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:23,  1.30it/s]Inference:   6%|▋         | 2/32 [00:01<00:22,  1.31it/s]Inference:   9%|▉         | 3/32 [00:02<00:22,  1.30it/s]Inference:  12%|█▎        | 4/32 [00:03<00:21,  1.29it/s]Inference:  16%|█▌        | 5/32 [00:03<00:21,  1.28it/s]Inference:  19%|█▉        | 6/32 [00:04<00:20,  1.27it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.27it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.28it/s]Inference:  28%|██▊       | 9/32 [00:07<00:17,  1.28it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.27it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.28it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.27it/s]Inference:  41%|████      | 13/32 [00:10<00:15,  1.26it/s]Inference:  44%|████▍     | 14/32 [00:11<00:14,  1.26it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.27it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.26it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.26it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:11,  1.26it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.26it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.25it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.26it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:08,  1.25it/s]Inference:  72%|███████▏  | 23/32 [00:18<00:07,  1.26it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.26it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.25it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.26it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:03,  1.27it/s]Inference:  88%|████████▊ | 28/32 [00:22<00:03,  1.27it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.28it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.28it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.29it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.27it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 6
48317 MiB free out of 48676 MiB total
Done with layer 6 total_time elapsed: 214 estimated time left: 1010
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:23,  1.30it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.30it/s]Inference:   9%|▉         | 3/32 [00:02<00:22,  1.29it/s]Inference:  12%|█▎        | 4/32 [00:03<00:21,  1.28it/s]Inference:  16%|█▌        | 5/32 [00:03<00:21,  1.27it/s]Inference:  19%|█▉        | 6/32 [00:04<00:20,  1.27it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.27it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.28it/s]Inference:  28%|██▊       | 9/32 [00:07<00:17,  1.29it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.28it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.28it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.28it/s]Inference:  41%|████      | 13/32 [00:10<00:14,  1.28it/s]Inference:  44%|████▍     | 14/32 [00:10<00:14,  1.28it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.28it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.29it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.28it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:10,  1.28it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.27it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.28it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.27it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:07,  1.28it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:07,  1.28it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.28it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.28it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.28it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:03,  1.28it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:03,  1.29it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.29it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.28it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.29it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.28it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 7
48317 MiB free out of 48676 MiB total
Done with layer 7 total_time elapsed: 245 estimated time left: 978
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.41it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.38it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.38it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.38it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.38it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.38it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.39it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.39it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.39it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.38it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.37it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.38it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.38it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.39it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.38it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.39it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.37it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.37it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.37it/s]Inference:  69%|██████▉   | 22/32 [00:15<00:07,  1.37it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.38it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.38it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.38it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.37it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.38it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.38it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.38it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.39it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.40it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 8
48317 MiB free out of 48676 MiB total
Done with layer 8 total_time elapsed: 273 estimated time left: 940
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:23,  1.30it/s]Inference:   6%|▋         | 2/32 [00:01<00:22,  1.31it/s]Inference:   9%|▉         | 3/32 [00:02<00:22,  1.29it/s]Inference:  12%|█▎        | 4/32 [00:03<00:21,  1.29it/s]Inference:  16%|█▌        | 5/32 [00:03<00:21,  1.28it/s]Inference:  19%|█▉        | 6/32 [00:04<00:20,  1.27it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.27it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.28it/s]Inference:  28%|██▊       | 9/32 [00:07<00:18,  1.27it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.27it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.28it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.27it/s]Inference:  41%|████      | 13/32 [00:10<00:14,  1.28it/s]Inference:  44%|████▍     | 14/32 [00:10<00:14,  1.28it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.27it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.27it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.27it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:10,  1.28it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.27it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.27it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.28it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:07,  1.27it/s]Inference:  72%|███████▏  | 23/32 [00:18<00:07,  1.27it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.26it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.27it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.28it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:03,  1.27it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:03,  1.28it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.26it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.25it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.26it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.27it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.27it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 9
48317 MiB free out of 48676 MiB total
Done with layer 9 total_time elapsed: 303 estimated time left: 910
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:23,  1.29it/s]Inference:   6%|▋         | 2/32 [00:01<00:22,  1.34it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.35it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.34it/s]Inference:  16%|█▌        | 5/32 [00:03<00:20,  1.34it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.36it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.36it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.38it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.37it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.37it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.37it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.37it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.38it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.37it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.37it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.38it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.38it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.37it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.38it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.35it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.35it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.36it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.36it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.36it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.35it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.35it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.35it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.35it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.36it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 10
48317 MiB free out of 48676 MiB total
Done with layer 10 total_time elapsed: 332 estimated time left: 875
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.41it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.39it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.39it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.38it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.38it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.36it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.37it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.37it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.37it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.37it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.38it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.36it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.35it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.30it/s]Inference:  50%|█████     | 16/32 [00:11<00:12,  1.31it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.31it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.31it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:09,  1.31it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:09,  1.32it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.32it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.34it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:06,  1.33it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.35it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.36it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:20<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.36it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.37it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.35it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 11
48317 MiB free out of 48676 MiB total
Done with layer 11 total_time elapsed: 361 estimated time left: 843
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.41it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.40it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.39it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.39it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.38it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.38it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.39it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.38it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.38it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.38it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.38it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.38it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.37it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.37it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.37it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.37it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.38it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.38it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:15<00:07,  1.37it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.38it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.38it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.37it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.36it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.37it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 12
48317 MiB free out of 48676 MiB total
Done with layer 12 total_time elapsed: 390 estimated time left: 810
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.38it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.38it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.37it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.36it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.37it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.36it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.37it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.36it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.37it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.37it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.37it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.37it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.35it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.36it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.35it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.36it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.36it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.36it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.37it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.37it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.36it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.37it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.36it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.37it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.37it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.38it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.37it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 13
48317 MiB free out of 48676 MiB total
Done with layer 13 total_time elapsed: 419 estimated time left: 777
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:25,  1.21it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.25it/s]Inference:   9%|▉         | 3/32 [00:02<00:23,  1.25it/s]Inference:  12%|█▎        | 4/32 [00:03<00:22,  1.22it/s]Inference:  16%|█▌        | 5/32 [00:04<00:21,  1.24it/s]Inference:  19%|█▉        | 6/32 [00:04<00:20,  1.24it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.26it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.27it/s]Inference:  28%|██▊       | 9/32 [00:07<00:18,  1.27it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.27it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.26it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.27it/s]Inference:  41%|████      | 13/32 [00:10<00:15,  1.26it/s]Inference:  44%|████▍     | 14/32 [00:11<00:14,  1.24it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.25it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.26it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.27it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:11,  1.25it/s]Inference:  59%|█████▉    | 19/32 [00:15<00:10,  1.25it/s]Inference:  62%|██████▎   | 20/32 [00:16<00:09,  1.22it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.24it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:08,  1.21it/s]Inference:  72%|███████▏  | 23/32 [00:18<00:07,  1.22it/s]Inference:  75%|███████▌  | 24/32 [00:19<00:06,  1.23it/s]Inference:  78%|███████▊  | 25/32 [00:20<00:05,  1.24it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.24it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:04,  1.24it/s]Inference:  88%|████████▊ | 28/32 [00:22<00:03,  1.25it/s]Inference:  91%|█████████ | 29/32 [00:23<00:02,  1.26it/s]Inference:  94%|█████████▍| 30/32 [00:24<00:01,  1.24it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.24it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.25it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.25it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 14
48317 MiB free out of 48676 MiB total
Done with layer 14 total_time elapsed: 450 estimated time left: 750
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.38it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.38it/s]Inference:   9%|▉         | 3/32 [00:02<00:22,  1.30it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.34it/s]Inference:  16%|█▌        | 5/32 [00:03<00:20,  1.34it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.35it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.34it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.35it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.35it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.35it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.35it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.36it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.37it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.37it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.37it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.37it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.37it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.38it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.36it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.36it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.37it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.38it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.38it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.38it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.38it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.37it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.36it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.36it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 15
48317 MiB free out of 48676 MiB total
Done with layer 15 total_time elapsed: 479 estimated time left: 719
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:24,  1.25it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.28it/s]Inference:   9%|▉         | 3/32 [00:02<00:22,  1.28it/s]Inference:  12%|█▎        | 4/32 [00:03<00:21,  1.29it/s]Inference:  16%|█▌        | 5/32 [00:03<00:21,  1.25it/s]Inference:  19%|█▉        | 6/32 [00:04<00:21,  1.22it/s]Inference:  22%|██▏       | 7/32 [00:05<00:20,  1.23it/s]Inference:  25%|██▌       | 8/32 [00:06<00:19,  1.24it/s]Inference:  28%|██▊       | 9/32 [00:07<00:18,  1.26it/s]Inference:  31%|███▏      | 10/32 [00:08<00:17,  1.22it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.24it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.26it/s]Inference:  41%|████      | 13/32 [00:10<00:15,  1.26it/s]Inference:  44%|████▍     | 14/32 [00:11<00:14,  1.27it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.26it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.27it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.28it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:10,  1.27it/s]Inference:  59%|█████▉    | 19/32 [00:15<00:10,  1.25it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.24it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.25it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:08,  1.24it/s]Inference:  72%|███████▏  | 23/32 [00:18<00:07,  1.24it/s]Inference:  75%|███████▌  | 24/32 [00:19<00:06,  1.25it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.26it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.27it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:03,  1.28it/s]Inference:  88%|████████▊ | 28/32 [00:22<00:03,  1.28it/s]Inference:  91%|█████████ | 29/32 [00:23<00:02,  1.28it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.27it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.27it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.26it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 16
48317 MiB free out of 48676 MiB total
Done with layer 16 total_time elapsed: 511 estimated time left: 691
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.41it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.42it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.41it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.40it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.39it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.36it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.37it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.38it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.38it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.38it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.37it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.37it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.37it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.38it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.38it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.37it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.37it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.38it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.39it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.38it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:07,  1.38it/s]Inference:  69%|██████▉   | 22/32 [00:15<00:07,  1.38it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.38it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.38it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.38it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.37it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.37it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.38it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.36it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.37it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 17
48317 MiB free out of 48676 MiB total
Done with layer 17 total_time elapsed: 540 estimated time left: 660
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.40it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.36it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.38it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.38it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.37it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.38it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.39it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.38it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.38it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.38it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.37it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.38it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.38it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.38it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.38it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.38it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.38it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.37it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:07,  1.38it/s]Inference:  69%|██████▉   | 22/32 [00:15<00:07,  1.39it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.35it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:06,  1.31it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.31it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.30it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.33it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:03,  1.32it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.33it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.34it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 18
48317 MiB free out of 48676 MiB total
Done with layer 18 total_time elapsed: 569 estimated time left: 629
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:23,  1.30it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.28it/s]Inference:   9%|▉         | 3/32 [00:02<00:22,  1.31it/s]Inference:  12%|█▎        | 4/32 [00:03<00:21,  1.31it/s]Inference:  16%|█▌        | 5/32 [00:03<00:20,  1.32it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.30it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.30it/s]Inference:  25%|██▌       | 8/32 [00:06<00:17,  1.34it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.32it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.32it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.31it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.30it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.28it/s]Inference:  44%|████▍     | 14/32 [00:10<00:14,  1.28it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.26it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.27it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.25it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:11,  1.26it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.25it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.25it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.26it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:07,  1.27it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:07,  1.26it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.27it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.27it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.27it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:03,  1.27it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:03,  1.27it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.28it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.28it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.28it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 19
48317 MiB free out of 48676 MiB total
Done with layer 19 total_time elapsed: 600 estimated time left: 600
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:23,  1.31it/s]Inference:   6%|▋         | 2/32 [00:01<00:22,  1.34it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.32it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.34it/s]Inference:  16%|█▌        | 5/32 [00:03<00:20,  1.35it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.34it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.35it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.36it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.37it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.35it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.36it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.36it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.33it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.33it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.34it/s]Inference:  50%|█████     | 16/32 [00:11<00:12,  1.32it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.34it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.35it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:09,  1.33it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:09,  1.33it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.34it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.32it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:06,  1.34it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.34it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.35it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:20<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.36it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.34it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.35it/s]Inference:  97%|█████████▋| 31/32 [00:23<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.34it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.34it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 20
48317 MiB free out of 48676 MiB total
Done with layer 20 total_time elapsed: 629 estimated time left: 569
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:24,  1.29it/s]Inference:   6%|▋         | 2/32 [00:01<00:23,  1.30it/s]Inference:   9%|▉         | 3/32 [00:02<00:23,  1.23it/s]Inference:  12%|█▎        | 4/32 [00:03<00:22,  1.25it/s]Inference:  16%|█▌        | 5/32 [00:03<00:21,  1.27it/s]Inference:  19%|█▉        | 6/32 [00:04<00:20,  1.25it/s]Inference:  22%|██▏       | 7/32 [00:05<00:20,  1.24it/s]Inference:  25%|██▌       | 8/32 [00:06<00:19,  1.26it/s]Inference:  28%|██▊       | 9/32 [00:07<00:18,  1.25it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.27it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.25it/s]Inference:  38%|███▊      | 12/32 [00:09<00:16,  1.24it/s]Inference:  41%|████      | 13/32 [00:10<00:15,  1.25it/s]Inference:  44%|████▍     | 14/32 [00:11<00:14,  1.25it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.25it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.25it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.25it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:11,  1.24it/s]Inference:  59%|█████▉    | 19/32 [00:15<00:10,  1.25it/s]Inference:  62%|██████▎   | 20/32 [00:16<00:09,  1.24it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.24it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:07,  1.26it/s]Inference:  72%|███████▏  | 23/32 [00:18<00:07,  1.23it/s]Inference:  75%|███████▌  | 24/32 [00:19<00:06,  1.21it/s]Inference:  78%|███████▊  | 25/32 [00:20<00:05,  1.23it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.22it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:04,  1.24it/s]Inference:  88%|████████▊ | 28/32 [00:22<00:03,  1.25it/s]Inference:  91%|█████████ | 29/32 [00:23<00:02,  1.26it/s]Inference:  94%|█████████▍| 30/32 [00:24<00:01,  1.25it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.23it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.24it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.25it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 21
48317 MiB free out of 48676 MiB total
Done with layer 21 total_time elapsed: 660 estimated time left: 540
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.41it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.41it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.40it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.37it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.38it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.39it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.40it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.32it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.34it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.31it/s]Inference:  38%|███▊      | 12/32 [00:08<00:15,  1.33it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.35it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.35it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.36it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.34it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.36it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.36it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.36it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.36it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.36it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.34it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.36it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.35it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.37it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.37it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.35it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 22
48317 MiB free out of 48676 MiB total
Done with layer 22 total_time elapsed: 689 estimated time left: 510
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.40it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.36it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.37it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.37it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.38it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.39it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.40it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.40it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.38it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.38it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.35it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.37it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.38it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.35it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.36it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.36it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.36it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.37it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.37it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.35it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.36it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.36it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.35it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.35it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.35it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.36it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.36it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.34it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.35it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 23
48317 MiB free out of 48676 MiB total
Done with layer 23 total_time elapsed: 719 estimated time left: 479
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.39it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.37it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.38it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.38it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.38it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.39it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.37it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.38it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.38it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.38it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.38it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.37it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.38it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.37it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.38it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.39it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.38it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.38it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:15<00:07,  1.37it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.37it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.37it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.38it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.37it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.36it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 24
48317 MiB free out of 48676 MiB total
Done with layer 24 total_time elapsed: 747 estimated time left: 448
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.35it/s]Inference:  12%|█▎        | 4/32 [00:02<00:21,  1.32it/s]Inference:  16%|█▌        | 5/32 [00:03<00:20,  1.30it/s]Inference:  19%|█▉        | 6/32 [00:04<00:20,  1.28it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.28it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.29it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.28it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.28it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.29it/s]Inference:  38%|███▊      | 12/32 [00:09<00:16,  1.24it/s]Inference:  41%|████      | 13/32 [00:10<00:15,  1.26it/s]Inference:  44%|████▍     | 14/32 [00:10<00:14,  1.25it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.24it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.26it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.27it/s]Inference:  56%|█████▋    | 18/32 [00:14<00:11,  1.27it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.28it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.26it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.27it/s]Inference:  69%|██████▉   | 22/32 [00:17<00:07,  1.28it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:07,  1.27it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.23it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:06,  1.16it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:05,  1.19it/s]Inference:  84%|████████▍ | 27/32 [00:21<00:04,  1.22it/s]Inference:  88%|████████▊ | 28/32 [00:22<00:03,  1.24it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.25it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.27it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.27it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.20it/s]Inference: 100%|██████████| 32/32 [00:25<00:00,  1.26it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 25
48317 MiB free out of 48676 MiB total
Done with layer 25 total_time elapsed: 779 estimated time left: 419
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:21,  1.41it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.42it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.40it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.39it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.39it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.39it/s]Inference:  22%|██▏       | 7/32 [00:05<00:17,  1.39it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.40it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.39it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.40it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.37it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.38it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.38it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.38it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.36it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.37it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.35it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.35it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.35it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.36it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.36it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.36it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.37it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.37it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.37it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.37it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.36it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.36it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.35it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 26
48317 MiB free out of 48676 MiB total
Done with layer 26 total_time elapsed: 807 estimated time left: 389
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.39it/s]Inference:   6%|▋         | 2/32 [00:01<00:22,  1.36it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.38it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.38it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.39it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.36it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.37it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.38it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.39it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.39it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.39it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.39it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.36it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.37it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.37it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.38it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.37it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.35it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.36it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.34it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.37it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.37it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.37it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.35it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.37it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.38it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.38it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.37it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 27
48317 MiB free out of 48676 MiB total
Done with layer 27 total_time elapsed: 836 estimated time left: 358
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.36it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.37it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.34it/s]Inference:  12%|█▎        | 4/32 [00:03<00:21,  1.29it/s]Inference:  16%|█▌        | 5/32 [00:03<00:20,  1.29it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.31it/s]Inference:  22%|██▏       | 7/32 [00:05<00:19,  1.28it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.31it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.28it/s]Inference:  31%|███▏      | 10/32 [00:07<00:17,  1.29it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.30it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.30it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.31it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.31it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.31it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.28it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.31it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.31it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.29it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.28it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.31it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.28it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:06,  1.31it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.29it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.30it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.30it/s]Inference:  84%|████████▍ | 27/32 [00:20<00:03,  1.28it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:03,  1.30it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.31it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.28it/s]Inference:  97%|█████████▋| 31/32 [00:23<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.29it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.30it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 28
48317 MiB free out of 48676 MiB total
Done with layer 28 total_time elapsed: 867 estimated time left: 329
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.39it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.36it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.38it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.39it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.35it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.35it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.34it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.33it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.32it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.31it/s]Inference:  34%|███▍      | 11/32 [00:08<00:16,  1.28it/s]Inference:  38%|███▊      | 12/32 [00:09<00:15,  1.26it/s]Inference:  41%|████      | 13/32 [00:09<00:15,  1.25it/s]Inference:  44%|████▍     | 14/32 [00:10<00:14,  1.26it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.26it/s]Inference:  50%|█████     | 16/32 [00:12<00:12,  1.27it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:11,  1.28it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.29it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.29it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.28it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:08,  1.28it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.28it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:07,  1.28it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.28it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.27it/s]Inference:  81%|████████▏ | 26/32 [00:20<00:04,  1.27it/s]Inference:  84%|████████▍ | 27/32 [00:20<00:03,  1.26it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:03,  1.26it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.27it/s]Inference:  94%|█████████▍| 30/32 [00:23<00:01,  1.27it/s]Inference:  97%|█████████▋| 31/32 [00:24<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.29it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.29it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 29
48317 MiB free out of 48676 MiB total
Done with layer 29 total_time elapsed: 897 estimated time left: 299
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.36it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.40it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.37it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.34it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.35it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.34it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.35it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.34it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.35it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.36it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.35it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.36it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.35it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.35it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.36it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.35it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.36it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.37it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:09,  1.35it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.37it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.37it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.35it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.36it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.37it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.37it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.37it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.36it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.38it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.38it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 30
48317 MiB free out of 48676 MiB total
Done with layer 30 total_time elapsed: 928 estimated time left: 269
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.35it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.38it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.38it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.39it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.39it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.37it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.37it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.37it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.36it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.36it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.36it/s]Inference:  38%|███▊      | 12/32 [00:08<00:15,  1.33it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.32it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.31it/s]Inference:  47%|████▋     | 15/32 [00:11<00:13,  1.29it/s]Inference:  50%|█████     | 16/32 [00:11<00:12,  1.29it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.28it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:11,  1.27it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:10,  1.27it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:09,  1.28it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.28it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.28it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:07,  1.27it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:06,  1.28it/s]Inference:  78%|███████▊  | 25/32 [00:19<00:05,  1.28it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.28it/s]Inference:  84%|████████▍ | 27/32 [00:20<00:03,  1.28it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:03,  1.27it/s]Inference:  91%|█████████ | 29/32 [00:22<00:02,  1.25it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.27it/s]Inference:  97%|█████████▋| 31/32 [00:23<00:00,  1.26it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.27it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.30it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 31
48317 MiB free out of 48676 MiB total
Done with layer 31 total_time elapsed: 959 estimated time left: 240
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:23,  1.32it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.39it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.40it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.40it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.40it/s]Inference:  22%|██▏       | 7/32 [00:05<00:17,  1.40it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.39it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.39it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.37it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.38it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.36it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.37it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.37it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.38it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.38it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.39it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.39it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.39it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.37it/s]Inference:  69%|██████▉   | 22/32 [00:15<00:07,  1.36it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.37it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.36it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.37it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.37it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.38it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.35it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 32
48317 MiB free out of 48676 MiB total
Done with layer 32 total_time elapsed: 989 estimated time left: 210
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:28,  1.09it/s]Inference:   6%|▋         | 2/32 [00:01<00:27,  1.08it/s]Inference:   9%|▉         | 3/32 [00:02<00:24,  1.16it/s]Inference:  12%|█▎        | 4/32 [00:03<00:23,  1.21it/s]Inference:  16%|█▌        | 5/32 [00:04<00:22,  1.22it/s]Inference:  19%|█▉        | 6/32 [00:05<00:21,  1.18it/s]Inference:  22%|██▏       | 7/32 [00:05<00:20,  1.23it/s]Inference:  25%|██▌       | 8/32 [00:06<00:18,  1.29it/s]Inference:  28%|██▊       | 9/32 [00:07<00:17,  1.30it/s]Inference:  31%|███▏      | 10/32 [00:08<00:16,  1.31it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.33it/s]Inference:  38%|███▊      | 12/32 [00:09<00:14,  1.35it/s]Inference:  41%|████      | 13/32 [00:10<00:14,  1.35it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.37it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.37it/s]Inference:  50%|█████     | 16/32 [00:12<00:11,  1.38it/s]Inference:  53%|█████▎    | 17/32 [00:13<00:10,  1.38it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.37it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:09,  1.37it/s]Inference:  62%|██████▎   | 20/32 [00:15<00:08,  1.38it/s]Inference:  66%|██████▌   | 21/32 [00:16<00:07,  1.38it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.39it/s]Inference:  72%|███████▏  | 23/32 [00:17<00:06,  1.36it/s]Inference:  75%|███████▌  | 24/32 [00:18<00:05,  1.37it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.37it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.35it/s]Inference:  84%|████████▍ | 27/32 [00:20<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:21<00:02,  1.37it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.36it/s]Inference:  97%|█████████▋| 31/32 [00:23<00:00,  1.34it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:24<00:00,  1.33it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 33
48317 MiB free out of 48676 MiB total
Done with layer 33 total_time elapsed: 1019 estimated time left: 180
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.41it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.36it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.36it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.35it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.37it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.35it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.36it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.35it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.35it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.33it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.35it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.35it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.34it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.34it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.35it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.35it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.37it/s]Inference:  59%|█████▉    | 19/32 [00:14<00:09,  1.35it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.36it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.37it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.36it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.37it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.32it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.34it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.35it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.36it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.38it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.39it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 34
48317 MiB free out of 48676 MiB total
Done with layer 34 total_time elapsed: 1048 estimated time left: 150
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.37it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.39it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.40it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.37it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.37it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.35it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.37it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.38it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.38it/s]Inference:  34%|███▍      | 11/32 [00:07<00:15,  1.38it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.37it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.37it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.36it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.36it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.37it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.35it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.36it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.35it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.36it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.37it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.37it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.38it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.38it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.36it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.34it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.32it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:03,  1.31it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.28it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.28it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.28it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.35it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 35
48317 MiB free out of 48676 MiB total
Done with layer 35 total_time elapsed: 1078 estimated time left: 120
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.39it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.40it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.38it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.36it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.37it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.37it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.36it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.35it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.37it/s]Inference:  31%|███▏      | 10/32 [00:07<00:15,  1.38it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.38it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.36it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.35it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.36it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.34it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.36it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:11,  1.36it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.37it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.38it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.36it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.37it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.38it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.38it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.39it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.33it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.33it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.33it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.34it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.36it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.35it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.29it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.35it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 36
48317 MiB free out of 48676 MiB total
Done with layer 36 total_time elapsed: 1107 estimated time left: 90
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.37it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.38it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.36it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.36it/s]Inference:  19%|█▉        | 6/32 [00:04<00:18,  1.38it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.38it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.37it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.38it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.36it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.37it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.38it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.38it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.38it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.37it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.38it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.38it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.38it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.38it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.36it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.36it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.36it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.35it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.36it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.35it/s]Inference:  81%|████████▏ | 26/32 [00:18<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.35it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.34it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.35it/s]Inference:  94%|█████████▍| 30/32 [00:21<00:01,  1.36it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 37
48317 MiB free out of 48676 MiB total
Done with layer 37 total_time elapsed: 1137 estimated time left: 60
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:21,  1.41it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.41it/s]Inference:   9%|▉         | 3/32 [00:02<00:21,  1.36it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.37it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.38it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.36it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.37it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.39it/s]Inference:  28%|██▊       | 9/32 [00:06<00:16,  1.38it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.36it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.37it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.36it/s]Inference:  41%|████      | 13/32 [00:09<00:13,  1.37it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.38it/s]Inference:  47%|████▋     | 15/32 [00:10<00:12,  1.36it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.37it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.37it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.38it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.36it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.37it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.37it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.36it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.35it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.34it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.35it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.36it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.35it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.33it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.35it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.33it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.35it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 38
48317 MiB free out of 48676 MiB total
Done with layer 38 total_time elapsed: 1166 estimated time left: 30
layer original dtype torch.float16
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=5120, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=5120, out_features=13824, bias=False)
sublayer Linear(in_features=13824, out_features=5120, bias=False)
Inference:   0%|          | 0/32 [00:00<?, ?it/s]Inference:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]Inference:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]Inference:   9%|▉         | 3/32 [00:02<00:20,  1.39it/s]Inference:  12%|█▎        | 4/32 [00:02<00:20,  1.39it/s]Inference:  16%|█▌        | 5/32 [00:03<00:19,  1.39it/s]Inference:  19%|█▉        | 6/32 [00:04<00:19,  1.36it/s]Inference:  22%|██▏       | 7/32 [00:05<00:18,  1.36it/s]Inference:  25%|██▌       | 8/32 [00:05<00:17,  1.36it/s]Inference:  28%|██▊       | 9/32 [00:06<00:17,  1.34it/s]Inference:  31%|███▏      | 10/32 [00:07<00:16,  1.36it/s]Inference:  34%|███▍      | 11/32 [00:08<00:15,  1.34it/s]Inference:  38%|███▊      | 12/32 [00:08<00:14,  1.34it/s]Inference:  41%|████      | 13/32 [00:09<00:14,  1.35it/s]Inference:  44%|████▍     | 14/32 [00:10<00:13,  1.34it/s]Inference:  47%|████▋     | 15/32 [00:11<00:12,  1.35it/s]Inference:  50%|█████     | 16/32 [00:11<00:11,  1.36it/s]Inference:  53%|█████▎    | 17/32 [00:12<00:10,  1.36it/s]Inference:  56%|█████▋    | 18/32 [00:13<00:10,  1.37it/s]Inference:  59%|█████▉    | 19/32 [00:13<00:09,  1.35it/s]Inference:  62%|██████▎   | 20/32 [00:14<00:08,  1.36it/s]Inference:  66%|██████▌   | 21/32 [00:15<00:08,  1.34it/s]Inference:  69%|██████▉   | 22/32 [00:16<00:07,  1.35it/s]Inference:  72%|███████▏  | 23/32 [00:16<00:06,  1.36it/s]Inference:  75%|███████▌  | 24/32 [00:17<00:05,  1.37it/s]Inference:  78%|███████▊  | 25/32 [00:18<00:05,  1.37it/s]Inference:  81%|████████▏ | 26/32 [00:19<00:04,  1.35it/s]Inference:  84%|████████▍ | 27/32 [00:19<00:03,  1.36it/s]Inference:  88%|████████▊ | 28/32 [00:20<00:02,  1.37it/s]Inference:  91%|█████████ | 29/32 [00:21<00:02,  1.37it/s]Inference:  94%|█████████▍| 30/32 [00:22<00:01,  1.37it/s]Inference:  97%|█████████▋| 31/32 [00:22<00:00,  1.35it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.37it/s]Inference: 100%|██████████| 32/32 [00:23<00:00,  1.36it/s]
47709 MiB free out of 48676 MiB total
after cleaning up 39
48317 MiB free out of 48676 MiB total
Done with layer 39 total_time elapsed: 1195 estimated time left: 0
Total bits: 0 Total params: 0
Traceback (most recent call last):
  File "/data/lliu/huffman/scripts/generate_hessians.py", line 407, in <module>
    generate_hessians(model, train_loader, val_loader, args.device)
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/lliu/huffman/scripts/generate_hessians.py", line 315, in generate_hessians
    print("average bits per value:", total_bits / total_params)
                                     ~~~~~~~~~~~^~~~~~~~~~~~~~
ZeroDivisionError: division by zero
