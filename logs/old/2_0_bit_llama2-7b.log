/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.23s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.24it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.15it/s]
Model loaded. LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 4096)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=4096, out_features=32000, bias=False)
)
Loading tokenizer for meta-llama/Llama-2-7b-hf
Starting...
Ready.
0 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.399986743927002 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
19.739 s H_error tensor(0.7198, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3513, device='cuda:7', grad_fn=<DivBackward0>)
43349 MiB free out of 48676 MiB total
0 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.058751583099365 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
18.355 s H_error tensor(0.5844, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3484, device='cuda:7', grad_fn=<DivBackward0>)
43349 MiB free out of 48676 MiB total
0 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.96683955192566 s
stopped after 9 iterations
18.253 s H_error tensor(0.0383, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3767, device='cuda:7', grad_fn=<DivBackward0>)
43413 MiB free out of 48676 MiB total
0 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.947258710861206 s
stopped after 9 iterations
18.226 s H_error tensor(0.0053, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3573, device='cuda:7', grad_fn=<DivBackward0>)
43445 MiB free out of 48676 MiB total
0 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.92110466957092 s
stopped after 9 iterations
45.815 s H_error tensor(1.8678, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3237, device='cuda:7', grad_fn=<DivBackward0>)
43391 MiB free out of 48676 MiB total
0 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.83451962471008 s
stopped after 9 iterations
45.759 s H_error tensor(1.6773, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3239, device='cuda:7', grad_fn=<DivBackward0>)
43337 MiB free out of 48676 MiB total
0 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.71183252334595 s
stopped after 9 iterations
46.113 s H_error tensor(0.0054, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3382, device='cuda:7', grad_fn=<DivBackward0>)
43311 MiB free out of 48676 MiB total
1 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.50467848777771 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
18.797 s H_error tensor(19.0690, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3778, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
1 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.812543869018555 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
18.114 s H_error tensor(21.7485, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3721, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
1 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.83520197868347 s
stopped after 9 iterations
18.124 s H_error tensor(0.3860, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3778, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
1 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.82764434814453 s
stopped after 9 iterations
18.123 s H_error tensor(0.0406, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3306, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
1 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.77982020378113 s
stopped after 9 iterations
45.67 s H_error tensor(7.5613, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3191, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
1 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.853803873062134 s
stopped after 9 iterations
45.758 s H_error tensor(6.4377, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
1 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.589311361312866 s
stopped after 9 iterations
45.989 s H_error tensor(-5.1745, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3373, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
2 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.52659273147583 s
stopped after 9 iterations
18.827 s H_error tensor(29.8697, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3350, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
2 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.792893409729004 s
stopped after 9 iterations
18.092 s H_error tensor(35.3797, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3373, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
2 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.81141233444214 s
stopped after 9 iterations
18.106 s H_error tensor(6.4965, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3279, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
2 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.82095217704773 s
stopped after 9 iterations
18.112 s H_error tensor(0.0935, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3237, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
2 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.79629850387573 s
stopped after 9 iterations
45.687 s H_error tensor(16.8947, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3162, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
2 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.72706365585327 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
45.61 s H_error tensor(14.0887, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3144, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
2 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.60219645500183 s
stopped after 9 iterations
45.992 s H_error tensor(0.0849, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3169, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
3 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.534844636917114 s
stopped after 9 iterations
18.823 s H_error tensor(69.6106, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3297, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
3 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.85533905029297 s
stopped after 9 iterations
18.165 s H_error tensor(80.2587, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3307, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
3 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.791712522506714 s
stopped after 9 iterations
18.083 s H_error tensor(17.5201, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3233, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
3 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.7835795879364 s
stopped after 9 iterations
18.074 s H_error tensor(0.1724, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3216, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
3 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.71936917304993 s
stopped after 9 iterations
45.611 s H_error tensor(26.5055, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3149, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
3 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.882802963256836 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
45.778 s H_error tensor(22.0905, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3143, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
3 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.545523166656494 s
stopped after 9 iterations
45.945 s H_error tensor(0.1470, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
4 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.527148723602295 s
stopped after 9 iterations
18.818 s H_error tensor(66.4391, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3285, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
4 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.829548358917236 s
stopped after 9 iterations
18.127 s H_error tensor(73.9267, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3293, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
4 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.800783157348633 s
stopped after 9 iterations
18.088 s H_error tensor(17.2426, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3216, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
4 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.818182468414307 s
stopped after 9 iterations
18.105 s H_error tensor(0.2652, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3201, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
4 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.74892282485962 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
45.64 s H_error tensor(39.7186, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
4 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.86300802230835 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
45.748 s H_error tensor(31.5750, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3159, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
4 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.659695863723755 s
stopped after 9 iterations
46.049 s H_error tensor(0.2849, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3202, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
5 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.555795431137085 s
stopped after 9 iterations
18.848 s H_error tensor(75.8324, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3260, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
5 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.93439793586731 s
stopped after 9 iterations
18.225 s H_error tensor(87.6376, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3279, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
5 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.83573603630066 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
18.125 s H_error tensor(20.7308, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3205, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
5 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.849249124526978 s
stopped after 9 iterations
18.139 s H_error tensor(0.4191, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3217, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
5 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.81473350524902 s
stopped after 9 iterations
45.717 s H_error tensor(50.4309, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
5 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.06744933128357 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
45.974 s H_error tensor(39.4184, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3152, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
5 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.74902939796448 s
stopped after 9 iterations
46.153 s H_error tensor(0.4072, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3179, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
6 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.51271963119507 s
stopped after 9 iterations
18.806 s H_error tensor(109.4701, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3265, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
6 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.854060649871826 s
stopped after 9 iterations
18.146 s H_error tensor(115.6553, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3260, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
6 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.858007669448853 s
stopped after 9 iterations
18.147 s H_error tensor(29.5395, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3225, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
6 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.799740076065063 s
stopped after 9 iterations
18.09 s H_error tensor(0.6904, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3185, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
6 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.79896521568298 s
stopped after 9 iterations
45.691 s H_error tensor(62.6746, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
6 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.78843450546265 s
stopped after 9 iterations
45.683 s H_error tensor(47.3770, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3157, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
6 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.59889364242554 s
stopped after 9 iterations
45.99 s H_error tensor(0.6340, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3200, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
7 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.591440677642822 s
stopped after 9 iterations
18.887 s H_error tensor(114.5728, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3255, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
7 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.8887619972229 s
stopped after 9 iterations
18.18 s H_error tensor(117.4510, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3260, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
7 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.913418531417847 s
stopped after 9 iterations
18.208 s H_error tensor(32.2005, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3208, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
7 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.892176151275635 s
stopped after 9 iterations
18.183 s H_error tensor(0.9958, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3184, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
7 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.97581481933594 s
stopped after 9 iterations
45.869 s H_error tensor(71.1180, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3165, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
7 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.83720421791077 s
stopped after 9 iterations
45.73 s H_error tensor(54.3600, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3160, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
7 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.93336725234985 s
stopped after 9 iterations
46.321 s H_error tensor(0.8211, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3194, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
8 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.52485203742981 s
stopped after 9 iterations
18.82 s H_error tensor(119.2554, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3258, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
8 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.03343963623047 s
stopped after 9 iterations
18.323 s H_error tensor(123.7881, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3259, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
8 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.902021646499634 s
stopped after 9 iterations
18.194 s H_error tensor(34.1314, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3218, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
8 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.834487676620483 s
stopped after 9 iterations
18.12 s H_error tensor(1.5150, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3172, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
8 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.93065404891968 s
stopped after 9 iterations
45.824 s H_error tensor(74.3511, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
8 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.40407919883728 s
stopped after 9 iterations
46.33 s H_error tensor(60.2699, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3163, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
8 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.891064405441284 s
stopped after 9 iterations
46.277 s H_error tensor(0.9829, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3188, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
9 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.57753586769104 s
stopped after 9 iterations
18.869 s H_error tensor(124.9479, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3249, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
9 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.91441011428833 s
stopped after 9 iterations
18.203 s H_error tensor(134.1271, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3247, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
9 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.84366464614868 s
stopped after 9 iterations
18.136 s H_error tensor(36.8445, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3207, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
9 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.776983499526978 s
stopped after 9 iterations
18.064 s H_error tensor(2.3133, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3174, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
9 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.81984329223633 s
stopped after 9 iterations
45.714 s H_error tensor(76.6844, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3164, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
9 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.969972372055054 s
stopped after 9 iterations
45.865 s H_error tensor(64.0998, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
9 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.77118253707886 s
stopped after 9 iterations
46.171 s H_error tensor(1.2266, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3183, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
10 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.57696843147278 s
stopped after 9 iterations
18.867 s H_error tensor(130.0662, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3246, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
10 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.84148931503296 s
stopped after 9 iterations
18.13 s H_error tensor(141.9668, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3245, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
10 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.884343147277832 s
stopped after 9 iterations
18.178 s H_error tensor(37.1961, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3204, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
10 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.903810739517212 s
stopped after 9 iterations
18.19 s H_error tensor(3.2067, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3158, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
10 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.00339865684509 s
stopped after 9 iterations
45.904 s H_error tensor(81.0688, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
10 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.01478409767151 s
stopped after 9 iterations
45.925 s H_error tensor(69.9598, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
10 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.71006155014038 s
stopped after 9 iterations
46.11 s H_error tensor(1.4085, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3181, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
11 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.59359645843506 s
stopped after 9 iterations
18.882 s H_error tensor(148.1486, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3251, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
11 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.943066596984863 s
stopped after 9 iterations
18.233 s H_error tensor(152.5979, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3247, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
11 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.91452670097351 s
stopped after 9 iterations
18.207 s H_error tensor(50.6307, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3208, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
11 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.920263051986694 s
stopped after 9 iterations
18.207 s H_error tensor(3.7902, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3167, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
11 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.17503118515015 s
stopped after 9 iterations
46.086 s H_error tensor(86.0144, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
11 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.0649893283844 s
stopped after 9 iterations
45.965 s H_error tensor(76.1202, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3162, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
11 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.03247594833374 s
stopped after 9 iterations
46.434 s H_error tensor(1.6064, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3180, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
12 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.645808458328247 s
stopped after 9 iterations
18.932 s H_error tensor(152.6751, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3240, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
12 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.969624996185303 s
stopped after 9 iterations
18.26 s H_error tensor(167.4350, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3250, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
12 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.84495759010315 s
stopped after 9 iterations
18.13 s H_error tensor(49.3039, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3195, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
12 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.885668992996216 s
stopped after 9 iterations
18.178 s H_error tensor(4.0862, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
12 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.15190124511719 s
stopped after 9 iterations
46.041 s H_error tensor(90.7912, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
12 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.9394326210022 s
stopped after 9 iterations
45.828 s H_error tensor(82.9764, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3152, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
12 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.85221600532532 s
stopped after 9 iterations
46.25 s H_error tensor(1.7822, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3179, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
13 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.66380500793457 s
stopped after 9 iterations
18.955 s H_error tensor(157.0109, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3241, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
13 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.956804037094116 s
stopped after 9 iterations
18.245 s H_error tensor(169.2865, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3238, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
13 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.919512271881104 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
18.213 s H_error tensor(54.8630, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3195, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
13 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.156036376953125 s
stopped after 9 iterations
18.447 s H_error tensor(4.0626, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3169, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
13 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.012091875076294 s
stopped after 9 iterations
45.904 s H_error tensor(95.5225, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
13 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.89489698410034 s
stopped after 9 iterations
45.789 s H_error tensor(89.2157, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
13 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.922807455062866 s
stopped after 9 iterations
46.322 s H_error tensor(2.0023, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3196, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
14 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.73184823989868 s
stopped after 9 iterations
19.017 s H_error tensor(160.6513, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3247, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
14 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.94542932510376 s
stopped after 9 iterations
18.237 s H_error tensor(174.6444, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3240, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
14 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.913583278656006 s
stopped after 9 iterations
18.206 s H_error tensor(54.7965, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
14 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.86328101158142 s
stopped after 9 iterations
18.15 s H_error tensor(5.3349, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3142, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
14 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.1182587146759 s
stopped after 9 iterations
46.022 s H_error tensor(103.1431, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3153, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
14 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.80541920661926 s
stopped after 9 iterations
45.696 s H_error tensor(96.9835, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3149, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
14 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.95394039154053 s
stopped after 9 iterations
46.367 s H_error tensor(2.4190, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3191, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
15 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.56166100502014 s
stopped after 9 iterations
18.85 s H_error tensor(149.7954, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3253, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
15 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.896429300308228 s
stopped after 9 iterations
18.184 s H_error tensor(170.2679, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3251, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
15 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.85339665412903 s
stopped after 9 iterations
18.149 s H_error tensor(57.0165, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3199, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
15 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.839290142059326 s
stopped after 9 iterations
18.13 s H_error tensor(5.0618, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3157, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
15 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.95910596847534 s
stopped after 9 iterations
45.853 s H_error tensor(111.3777, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3160, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
15 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.92357540130615 s
stopped after 9 iterations
45.818 s H_error tensor(105.0817, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
15 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.67517042160034 s
stopped after 9 iterations
47.073 s H_error tensor(2.9576, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3207, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
16 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.635250568389893 s
stopped after 9 iterations
18.928 s H_error tensor(160.2139, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3245, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
16 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.9105441570282 s
stopped after 9 iterations
18.205 s H_error tensor(178.6037, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3251, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
16 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.882378339767456 s
stopped after 9 iterations
18.172 s H_error tensor(64.9673, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
16 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.03665781021118 s
stopped after 9 iterations
18.324 s H_error tensor(6.2256, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3148, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
16 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.94439363479614 s
stopped after 9 iterations
45.851 s H_error tensor(130.0635, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3154, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
16 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.408628940582275 s
stopped after 9 iterations
46.299 s H_error tensor(120.9168, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
16 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.00545144081116 s
stopped after 9 iterations
46.417 s H_error tensor(4.0067, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3221, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
17 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.599767446517944 s
stopped after 9 iterations
18.886 s H_error tensor(157.9035, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3217, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
17 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.896766662597656 s
stopped after 9 iterations
18.189 s H_error tensor(168.9696, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3225, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
17 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.946590662002563 s
stopped after 9 iterations
18.232 s H_error tensor(67.8995, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3172, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
17 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.88672423362732 s
stopped after 9 iterations
18.173 s H_error tensor(4.4609, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3148, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
17 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.10227847099304 s
stopped after 9 iterations
45.994 s H_error tensor(147.9560, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3151, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
17 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.486119747161865 s
stopped after 9 iterations
46.408 s H_error tensor(133.7150, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3134, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
17 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.337119340896606 s
stopped after 9 iterations
46.764 s H_error tensor(4.3810, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
18 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.035629272460938 s
stopped after 9 iterations
19.327 s H_error tensor(171.1724, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3224, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
18 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.39380192756653 s
stopped after 9 iterations
18.685 s H_error tensor(184.5015, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3230, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
18 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.39510941505432 s
stopped after 9 iterations
18.682 s H_error tensor(82.9993, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3163, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
18 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.260233879089355 s
stopped after 9 iterations
18.551 s H_error tensor(3.9617, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3160, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
18 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.33257818222046 s
stopped after 9 iterations
46.233 s H_error tensor(168.7537, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3148, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
18 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.54995369911194 s
stopped after 9 iterations
46.444 s H_error tensor(147.8255, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3130, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
18 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.42289328575134 s
stopped after 9 iterations
46.84 s H_error tensor(5.1670, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3207, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
19 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.59810996055603 s
stopped after 9 iterations
18.89 s H_error tensor(165.1267, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3219, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
19 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.83849334716797 s
stopped after 9 iterations
18.128 s H_error tensor(175.3969, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3224, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
19 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.9644718170166 s
stopped after 9 iterations
18.252 s H_error tensor(84.3677, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3172, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
19 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.952763319015503 s
stopped after 9 iterations
18.244 s H_error tensor(4.5145, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3158, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
19 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.08619737625122 s
stopped after 9 iterations
45.993 s H_error tensor(180.2474, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
19 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.86527109146118 s
stopped after 9 iterations
45.761 s H_error tensor(158.6177, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3130, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
19 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.79508113861084 s
stopped after 9 iterations
46.206 s H_error tensor(5.6654, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3196, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
20 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.600755214691162 s
stopped after 9 iterations
18.893 s H_error tensor(169.7201, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3220, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
20 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.916977882385254 s
stopped after 9 iterations
18.207 s H_error tensor(183.0078, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3225, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
20 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.98435401916504 s
stopped after 9 iterations
18.28 s H_error tensor(86.7673, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3150, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
20 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.09610152244568 s
stopped after 9 iterations
18.387 s H_error tensor(5.6416, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3170, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
20 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.93317365646362 s
stopped after 9 iterations
45.818 s H_error tensor(195.6140, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
20 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.88943910598755 s
stopped after 9 iterations
45.773 s H_error tensor(169.9648, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3130, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
20 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.81440496444702 s
stopped after 9 iterations
46.224 s H_error tensor(7.0338, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3213, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
21 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.593589782714844 s
stopped after 9 iterations
18.88 s H_error tensor(179.1765, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3212, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
21 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.862441778182983 s
stopped after 9 iterations
18.155 s H_error tensor(188.9787, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3215, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
21 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.867746829986572 s
stopped after 9 iterations
18.157 s H_error tensor(104.5284, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3149, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
21 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.879487991333008 s
stopped after 9 iterations
18.178 s H_error tensor(4.7179, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
21 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.98522210121155 s
stopped after 9 iterations
45.886 s H_error tensor(211.1011, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3143, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
21 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.97645020484924 s
stopped after 9 iterations
45.876 s H_error tensor(180.7695, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3126, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
21 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.02252507209778 s
stopped after 9 iterations
46.422 s H_error tensor(7.4723, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
22 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.63521146774292 s
stopped after 9 iterations
18.93 s H_error tensor(196.7448, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3219, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
22 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.9274160861969 s
stopped after 9 iterations
18.216 s H_error tensor(209.5191, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3231, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
22 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.933699369430542 s
stopped after 9 iterations
18.221 s H_error tensor(108.7982, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3154, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
22 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.94832420349121 s
stopped after 9 iterations
18.236 s H_error tensor(25.2680, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3182, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
22 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.097635984420776 s
stopped after 9 iterations
45.996 s H_error tensor(219.5287, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3142, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
22 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.00238847732544 s
stopped after 9 iterations
45.894 s H_error tensor(185.7945, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3126, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
22 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.896042585372925 s
stopped after 9 iterations
46.3 s H_error tensor(7.9239, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3181, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
23 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.625802993774414 s
stopped after 9 iterations
18.917 s H_error tensor(214.3045, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3206, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
23 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.923118591308594 s
stopped after 9 iterations
18.219 s H_error tensor(224.8024, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3212, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
23 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.90625524520874 s
stopped after 9 iterations
18.194 s H_error tensor(134.8797, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3144, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
23 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.873207330703735 s
stopped after 9 iterations
18.166 s H_error tensor(6.5698, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3147, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
23 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.103819370269775 s
stopped after 9 iterations
45.991 s H_error tensor(246.2103, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3138, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
23 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.97803711891174 s
stopped after 9 iterations
45.876 s H_error tensor(208.8312, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3121, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
23 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.02571105957031 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.425 s H_error tensor(9.2617, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3170, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
24 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.632007837295532 s
stopped after 9 iterations
18.919 s H_error tensor(204.6550, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3215, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
24 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.90693950653076 s
stopped after 9 iterations
18.202 s H_error tensor(215.0841, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3223, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
24 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.881726503372192 s
stopped after 9 iterations
18.185 s H_error tensor(130.9787, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3165, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
24 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.883747339248657 s
stopped after 9 iterations
18.176 s H_error tensor(14.7009, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3176, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
24 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.98045754432678 s
stopped after 9 iterations
45.876 s H_error tensor(256.4469, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3136, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
24 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.9678270816803 s
stopped after 9 iterations
45.866 s H_error tensor(218.4074, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3118, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
24 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.945517778396606 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.36 s H_error tensor(9.7572, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3165, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
25 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.569817066192627 s
stopped after 9 iterations
18.858 s H_error tensor(233.9407, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
25 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.880773067474365 s
stopped after 9 iterations
18.176 s H_error tensor(243.3557, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3209, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
25 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.976834058761597 s
stopped after 9 iterations
18.268 s H_error tensor(162.8285, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3141, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
25 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.896991729736328 s
stopped after 9 iterations
18.188 s H_error tensor(8.3655, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3171, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
25 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.13969802856445 s
stopped after 9 iterations
46.055 s H_error tensor(283.0153, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3137, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
25 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.874062061309814 s
stopped after 9 iterations
45.763 s H_error tensor(240.8698, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3121, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
25 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.640480279922485 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.039 s H_error tensor(10.7140, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3174, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
26 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.651090621948242 s
stopped after 9 iterations
18.943 s H_error tensor(226.0895, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3205, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
26 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.8386812210083 s
stopped after 9 iterations
18.131 s H_error tensor(236.5744, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3217, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
26 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.82945466041565 s
stopped after 9 iterations
18.12 s H_error tensor(161.2868, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3153, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
26 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.85449457168579 s
stopped after 9 iterations
18.145 s H_error tensor(15.0393, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3211, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
26 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.930883169174194 s
stopped after 9 iterations
45.824 s H_error tensor(297.0410, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3141, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
26 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.83620810508728 s
stopped after 9 iterations
45.733 s H_error tensor(255.5603, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3123, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
26 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.78355669975281 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.193 s H_error tensor(11.6705, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3179, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
27 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.55471634864807 s
stopped after 9 iterations
18.845 s H_error tensor(236.7736, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3184, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
27 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.851083755493164 s
stopped after 9 iterations
18.148 s H_error tensor(248.1389, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3199, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
27 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.899340391159058 s
stopped after 9 iterations
18.196 s H_error tensor(169.1055, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3122, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
27 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.924468755722046 s
stopped after 9 iterations
18.212 s H_error tensor(9.9014, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3176, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
27 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.02568817138672 s
stopped after 9 iterations
45.937 s H_error tensor(322.3633, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3146, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
27 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.94778633117676 s
stopped after 9 iterations
45.851 s H_error tensor(278.7637, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3132, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
27 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.94015717506409 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
46.348 s H_error tensor(13.8510, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3207, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
28 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.831302404403687 s
stopped after 9 iterations
19.118 s H_error tensor(239.8901, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3197, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
28 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.88763689994812 s
stopped after 9 iterations
18.179 s H_error tensor(254.4912, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3208, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
28 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.80265522003174 s
stopped after 9 iterations
18.091 s H_error tensor(188.3940, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3142, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
28 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.910240173339844 s
stopped after 9 iterations
18.198 s H_error tensor(14.1776, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3186, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
28 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.0011146068573 s
stopped after 9 iterations
45.901 s H_error tensor(339.5258, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3147, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
28 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.98813462257385 s
stopped after 9 iterations
45.905 s H_error tensor(304.7171, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3147, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
28 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.726922273635864 s
stopped after 9 iterations
46.136 s H_error tensor(16.6501, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3237, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
29 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.564498901367188 s
stopped after 9 iterations
18.857 s H_error tensor(216.7645, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3204, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
29 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.106874465942383 s
stopped after 9 iterations
18.399 s H_error tensor(228.3053, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3217, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
29 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.89907455444336 s
stopped after 9 iterations
18.189 s H_error tensor(176.9292, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3142, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
29 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.835588932037354 s
stopped after 9 iterations
18.125 s H_error tensor(13.7465, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
29 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.91307067871094 s
stopped after 9 iterations
45.813 s H_error tensor(355.1828, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3157, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
29 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.85394787788391 s
stopped after 9 iterations
45.761 s H_error tensor(321.1273, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3160, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
29 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.62397217750549 s
stopped after 9 iterations
46.038 s H_error tensor(20.1186, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3296, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
30 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.534220457077026 s
stopped after 9 iterations
18.822 s H_error tensor(225.0715, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3186, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
30 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.980538368225098 s
stopped after 9 iterations
18.273 s H_error tensor(234.6375, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3189, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
30 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.892099618911743 s
stopped after 9 iterations
18.183 s H_error tensor(198.8140, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3129, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
30 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.878703832626343 s
stopped after 9 iterations
18.162 s H_error tensor(17.5679, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3205, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
30 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.99526810646057 s
stopped after 9 iterations
45.898 s H_error tensor(385.4886, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3174, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
30 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.00051832199097 s
stopped after 9 iterations
45.913 s H_error tensor(340.1346, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3173, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
30 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.584988832473755 s
stopped after 9 iterations
45.983 s H_error tensor(29.0266, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3469, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
31 self_attn.q_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.572020053863525 s
stopped after 9 iterations
18.856 s H_error tensor(160.2616, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3182, device='cuda:7', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
31 self_attn.k_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.952353715896606 s
stopped after 9 iterations
18.244 s H_error tensor(177.0475, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:7', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
31 self_attn.v_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.205953359603882 s
stopped after 9 iterations
18.5 s H_error tensor(113.8908, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3133, device='cuda:7', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
31 self_attn.o_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.26839280128479 s
stopped after 9 iterations
18.573 s H_error tensor(109.6896, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3242, device='cuda:7', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
31 mlp.gate_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.88499617576599 s
stopped after 9 iterations
46.783 s H_error tensor(329.5021, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3184, device='cuda:7', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
31 mlp.up_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.553438663482666 s
stopped after 9 iterations
46.464 s H_error tensor(304.8575, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.3194, device='cuda:7', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
31 mlp.down_proj
Pruning ...
Normalized clustering
using all the rows
using all the columns
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.200926780700684 s
stopped after 9 iterations
46.617 s H_error tensor(73.3413, device='cuda:7', grad_fn=<ViewBackward0>) average_error tensor(0.4058, device='cuda:7', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
Total bits: 12995657728.0 Total params: 6476005376
average bits per value: 2.0067397992227978
7067.530824422836
Loading tokenizer for meta-llama/Llama-2-7b-hf
/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Dataset: wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
Perplexity: 9.060719
