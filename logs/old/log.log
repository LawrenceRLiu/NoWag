/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.19s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.23it/s]
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. If you see this, DO NOT PANIC! This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=True`. This should only be set if you understand what it means, and thouroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Token indices sequence length is longer than the specified maximum sequence length for this model (3908 > 2048). Running this sequence through the model will result in indexing errors
Starting...
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 4096, padding_idx=0)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): VectorQuantizerLayer(nn.Linear(4096, 4096, quantized to 256 vectors))
          (k_proj): VectorQuantizerLayer(nn.Linear(4096, 4096, quantized to 256 vectors))
          (v_proj): VectorQuantizerLayer(nn.Linear(4096, 4096, quantized to 256 vectors))
          (o_proj): VectorQuantizerLayer(nn.Linear(4096, 4096, quantized to 256 vectors))
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=4096, out_features=32000, bias=False)
)
Batch: 0
torch.Size([1, 2048])
Batch: 1
torch.Size([1, 2048])
Batch: 2
torch.Size([1, 2048])
Batch: 3
torch.Size([1, 2048])
Batch: 4
torch.Size([1, 2048])
Batch: 5
torch.Size([1, 2048])
Batch: 6
torch.Size([1, 2048])
Batch: 7
torch.Size([1, 2048])
Batch: 8
torch.Size([1, 2048])
Batch: 9
torch.Size([1, 2048])
Batch: 10
torch.Size([1, 2048])
Batch: 11
torch.Size([1, 2048])
Batch: 12
torch.Size([1, 2048])
Batch: 13
torch.Size([1, 2048])
Batch: 14
torch.Size([1, 2048])
Batch: 15
torch.Size([1, 2048])
Batch: 16
torch.Size([1, 2048])
Batch: 17
torch.Size([1, 2048])
Batch: 18
torch.Size([1, 2048])
Batch: 19
torch.Size([1, 2048])
Batch: 20
torch.Size([1, 2048])
Batch: 21
torch.Size([1, 2048])
Batch: 22
torch.Size([1, 2048])
Batch: 23
torch.Size([1, 2048])
Batch: 24
torch.Size([1, 2048])
Batch: 25
torch.Size([1, 2048])
Batch: 26
torch.Size([1, 2048])
Batch: 27
torch.Size([1, 2048])
Batch: 28
torch.Size([1, 2048])
Batch: 29
torch.Size([1, 2048])
Batch: 30
torch.Size([1, 2048])
Batch: 31
torch.Size([1, 2048])
Batch: 32
torch.Size([1, 2048])
Batch: 33
torch.Size([1, 2048])
Batch: 34
torch.Size([1, 2048])
Batch: 35
torch.Size([1, 2048])
Batch: 36
torch.Size([1, 2048])
Batch: 37
torch.Size([1, 2048])
Batch: 38
torch.Size([1, 2048])
Batch: 39
torch.Size([1, 2048])
Batch: 40
torch.Size([1, 2048])
Batch: 41
torch.Size([1, 2048])
Batch: 42
torch.Size([1, 2048])
Batch: 43
torch.Size([1, 2048])
Batch: 44
torch.Size([1, 2048])
Batch: 45
torch.Size([1, 2048])
Batch: 46
torch.Size([1, 2048])
Batch: 47
torch.Size([1, 2048])
Batch: 48
torch.Size([1, 2048])
Batch: 49
torch.Size([1, 2048])
Batch: 50
torch.Size([1, 2048])
Batch: 51
torch.Size([1, 2048])
Batch: 52
torch.Size([1, 2048])
Batch: 53
torch.Size([1, 2048])
Batch: 54
torch.Size([1, 2048])
Batch: 55
torch.Size([1, 2048])
Batch: 56
torch.Size([1, 2048])
Batch: 57
torch.Size([1, 2048])
Batch: 58
torch.Size([1, 2048])
Batch: 59
torch.Size([1, 2048])
Batch: 60
torch.Size([1, 2048])
Batch: 61
torch.Size([1, 2048])
Batch: 62
torch.Size([1, 2048])
Batch: 63
torch.Size([1, 2048])
Batch: 64
torch.Size([1, 2048])
Batch: 65
torch.Size([1, 2048])
Batch: 66
torch.Size([1, 2048])
Batch: 67
torch.Size([1, 2048])
Batch: 68
torch.Size([1, 2048])
Batch: 69
torch.Size([1, 2048])
Batch: 70
torch.Size([1, 2048])
Batch: 71
torch.Size([1, 2048])
Batch: 72
torch.Size([1, 2048])
Batch: 73
torch.Size([1, 2048])
Batch: 74
torch.Size([1, 2048])
Batch: 75
torch.Size([1, 2048])
Batch: 76
torch.Size([1, 2048])
Batch: 77
torch.Size([1, 2048])
Batch: 78
torch.Size([1, 2048])
Batch: 79
torch.Size([1, 2048])
Batch: 80
torch.Size([1, 2048])
Batch: 81
torch.Size([1, 2048])
Batch: 82
torch.Size([1, 2048])
Batch: 83
torch.Size([1, 2048])
Batch: 84
torch.Size([1, 2048])
Batch: 85
torch.Size([1, 2048])
Batch: 86
torch.Size([1, 2048])
Batch: 87
torch.Size([1, 2048])
Batch: 88
torch.Size([1, 2048])
Batch: 89
torch.Size([1, 2048])
Batch: 90
torch.Size([1, 2048])
Batch: 91
torch.Size([1, 2048])
Batch: 92
torch.Size([1, 2048])
Batch: 93
torch.Size([1, 2048])
Batch: 94
torch.Size([1, 2048])
Batch: 95
torch.Size([1, 2048])
Batch: 96
torch.Size([1, 2048])
Batch: 97
torch.Size([1, 2048])
Batch: 98
torch.Size([1, 2048])
Batch: 99
torch.Size([1, 2048])
Batch: 100
torch.Size([1, 2048])
Batch: 101
torch.Size([1, 2048])
Batch: 102
torch.Size([1, 2048])
Batch: 103
torch.Size([1, 2048])
Batch: 104
torch.Size([1, 2048])
Batch: 105
torch.Size([1, 2048])
Batch: 106
torch.Size([1, 2048])
Batch: 107
torch.Size([1, 2048])
Batch: 108
torch.Size([1, 2048])
Batch: 109
torch.Size([1, 2048])
Batch: 110
torch.Size([1, 2048])
Batch: 111
torch.Size([1, 2048])
Batch: 112
torch.Size([1, 2048])
Batch: 113
torch.Size([1, 2048])
Batch: 114
torch.Size([1, 2048])
Batch: 115
torch.Size([1, 2048])
Batch: 116
torch.Size([1, 2048])
Batch: 117
torch.Size([1, 2048])
Batch: 118
torch.Size([1, 2048])
Batch: 119
torch.Size([1, 2048])
Batch: 120
torch.Size([1, 2048])
Batch: 121
torch.Size([1, 2048])
Batch: 122
torch.Size([1, 2048])
Batch: 123
torch.Size([1, 2048])
Batch: 124
torch.Size([1, 2048])
Batch: 125
torch.Size([1, 2048])
Batch: 126
torch.Size([1, 2048])
Batch: 127
torch.Size([1, 2048])
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<33:48,  4.93it/s]  0%|          | 3/10000 [00:00<44:01,  3.78it/s]  0%|          | 4/10000 [00:01<49:03,  3.40it/s]  0%|          | 5/10000 [00:01<51:48,  3.22it/s]  0%|          | 6/10000 [00:01<53:40,  3.10it/s]  0%|          | 7/10000 [00:02<54:47,  3.04it/s]  0%|          | 8/10000 [00:02<55:27,  3.00it/s]  0%|          | 9/10000 [00:02<55:48,  2.98it/s]  0%|          | 10/10000 [00:03<56:25,  2.95it/s]  0%|          | 11/10000 [00:03<56:34,  2.94it/s]  0%|          | 12/10000 [00:03<56:28,  2.95it/s]  0%|          | 13/10000 [00:04<56:31,  2.94it/s]  0%|          | 14/10000 [00:04<56:45,  2.93it/s]  0%|          | 15/10000 [00:04<56:53,  2.93it/s]  0%|          | 16/10000 [00:05<56:59,  2.92it/s]  0%|          | 17/10000 [00:05<57:08,  2.91it/s]  0%|          | 18/10000 [00:05<57:06,  2.91it/s]  0%|          | 19/10000 [00:06<57:05,  2.91it/s]  0%|          | 20/10000 [00:06<57:14,  2.91it/s]  0%|          | 21/10000 [00:06<56:55,  2.92it/s]  0%|          | 22/10000 [00:07<56:54,  2.92it/s]                                                  Converged after 21 iterations, error 110.875
  0%|          | 22/10000 [00:07<56:54,  2.92it/s] 10%|█         | 1000/10000 [00:07<00:10, 857.90it/s]                                                     Converged after 21 iterations, error 111.3125
 10%|█         | 1022/10000 [00:15<00:10, 857.90it/s] 20%|██        | 2000/10000 [00:15<00:39, 202.67it/s]                                                     Converged after 29 iterations, error 109.6875
 20%|██        | 2030/10000 [00:25<00:39, 202.67it/s] 30%|███       | 3000/10000 [00:25<00:51, 135.65it/s] 30%|███       | 3010/10000 [00:28<01:05, 107.43it/s]                                                     Converged after 21 iterations, error 110.6875
 30%|███       | 3022/10000 [00:32<01:04, 107.43it/s] 40%|████      | 4000/10000 [00:32<00:41, 143.07it/s]                                                     Converged after 30 iterations, error 112.6875
 40%|████      | 4031/10000 [00:43<00:41, 143.07it/s] 50%|█████     | 5000/10000 [00:43<00:42, 118.62it/s] 50%|█████     | 5010/10000 [00:46<00:50, 98.41it/s]                                                     Converged after 21 iterations, error 111.875
 50%|█████     | 5022/10000 [00:50<00:50, 98.41it/s] 60%|██████    | 6000/10000 [00:50<00:30, 131.62it/s] 60%|██████    | 6026/10000 [00:59<00:51, 77.43it/s]                                                     Converged after 26 iterations, error 110.25
 60%|██████    | 6027/10000 [01:00<00:51, 77.43it/s] 70%|███████   | 7000/10000 [01:00<00:21, 139.58it/s]                                                     Converged after 22 iterations, error 111.125
 70%|███████   | 7023/10000 [01:07<00:21, 139.58it/s] 80%|████████  | 8000/10000 [01:07<00:14, 134.49it/s]                                                     Converged after 20 iterations, error 111.5
 80%|████████  | 8021/10000 [01:15<00:14, 134.49it/s] 90%|█████████ | 9000/10000 [01:15<00:07, 136.35it/s]                                                     Converged after 18 iterations, error 113.125
 90%|█████████ | 9019/10000 [01:21<00:07, 136.35it/s]100%|██████████| 10000/10000 [01:21<00:00, 142.22it/s]quantized with best error tensor(109.6875, device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:21<00:00, 122.66it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<28:33,  5.84it/s]  0%|          | 3/10000 [00:00<40:37,  4.10it/s]  0%|          | 4/10000 [00:01<46:46,  3.56it/s]  0%|          | 5/10000 [00:01<50:30,  3.30it/s]  0%|          | 6/10000 [00:01<52:49,  3.15it/s]  0%|          | 7/10000 [00:02<54:12,  3.07it/s]  0%|          | 8/10000 [00:02<55:05,  3.02it/s]  0%|          | 9/10000 [00:02<55:48,  2.98it/s]  0%|          | 10/10000 [00:03<56:20,  2.96it/s]  0%|          | 11/10000 [00:03<56:32,  2.94it/s]  0%|          | 12/10000 [00:03<56:48,  2.93it/s]  0%|          | 13/10000 [00:04<56:53,  2.93it/s]  0%|          | 14/10000 [00:04<57:09,  2.91it/s]  0%|          | 15/10000 [00:04<57:01,  2.92it/s]  0%|          | 16/10000 [00:05<57:05,  2.91it/s]  0%|          | 17/10000 [00:05<56:58,  2.92it/s]  0%|          | 18/10000 [00:05<57:01,  2.92it/s]  0%|          | 19/10000 [00:06<57:09,  2.91it/s]  0%|          | 20/10000 [00:06<57:05,  2.91it/s]  0%|          | 21/10000 [00:06<57:02,  2.92it/s]  0%|          | 22/10000 [00:07<57:02,  2.92it/s]  0%|          | 23/10000 [00:07<57:04,  2.91it/s]  0%|          | 24/10000 [00:07<57:17,  2.90it/s]  0%|          | 25/10000 [00:08<56:58,  2.92it/s]  0%|          | 26/10000 [00:08<56:50,  2.92it/s]  0%|          | 27/10000 [00:08<57:05,  2.91it/s]  0%|          | 28/10000 [00:09<57:16,  2.90it/s]  0%|          | 29/10000 [00:09<57:19,  2.90it/s]  0%|          | 30/10000 [00:09<57:18,  2.90it/s]  0%|          | 31/10000 [00:10<57:12,  2.90it/s]                                                  Converged after 30 iterations, error 271.75
  0%|          | 31/10000 [00:10<57:12,  2.90it/s] 10%|█         | 1000/10000 [00:10<00:10, 842.48it/s]                                                     Converged after 19 iterations, error 269.75
 10%|█         | 1020/10000 [00:17<00:10, 842.48it/s] 20%|██        | 2000/10000 [00:17<00:36, 217.85it/s] 20%|██        | 2032/10000 [00:28<00:36, 217.85it/s] 20%|██        | 2033/10000 [00:28<01:47, 73.94it/s]  20%|██        | 2034/10000 [00:28<01:50, 71.87it/s]                                                    Converged after 37 iterations, error 270.75
 20%|██        | 2038/10000 [00:30<01:50, 71.87it/s] 30%|███       | 3000/10000 [00:30<00:44, 156.33it/s]                                                     Converged after 25 iterations, error 271.0
 30%|███       | 3026/10000 [00:39<00:44, 156.33it/s] 40%|████      | 4000/10000 [00:39<00:45, 131.68it/s]                                                     Converged after 18 iterations, error 271.5
 40%|████      | 4019/10000 [00:45<00:45, 131.68it/s] 50%|█████     | 5000/10000 [00:45<00:35, 139.85it/s]                                                     Converged after 25 iterations, error 270.25
 50%|█████     | 5026/10000 [00:54<00:35, 139.85it/s] 60%|██████    | 6000/10000 [00:54<00:31, 128.07it/s] 60%|██████    | 6025/10000 [01:03<00:47, 83.44it/s]                                                     Converged after 39 iterations, error 271.0
 60%|██████    | 6040/10000 [01:08<00:47, 83.44it/s] 70%|███████   | 7000/10000 [01:08<00:27, 107.28it/s] 70%|███████   | 7018/10000 [01:14<00:38, 78.32it/s]                                                     Converged after 21 iterations, error 271.25
 70%|███████   | 7022/10000 [01:16<00:38, 78.32it/s] 80%|████████  | 8000/10000 [01:16<00:15, 129.76it/s]                                                     Converged after 16 iterations, error 272.25
 80%|████████  | 8017/10000 [01:22<00:15, 129.76it/s] 90%|█████████ | 9000/10000 [01:22<00:06, 143.73it/s]                                                     Converged after 20 iterations, error 270.75
 90%|█████████ | 9021/10000 [01:29<00:06, 143.73it/s]100%|██████████| 10000/10000 [01:29<00:00, 141.97it/s]quantized with best error tensor(269.7500, device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:29<00:00, 111.99it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<28:18,  5.89it/s]  0%|          | 3/10000 [00:00<40:35,  4.11it/s]  0%|          | 4/10000 [00:01<46:34,  3.58it/s]  0%|          | 5/10000 [00:01<50:15,  3.31it/s]  0%|          | 6/10000 [00:01<52:24,  3.18it/s]  0%|          | 7/10000 [00:02<53:44,  3.10it/s]  0%|          | 8/10000 [00:02<54:49,  3.04it/s]  0%|          | 9/10000 [00:02<55:36,  2.99it/s]  0%|          | 10/10000 [00:03<56:00,  2.97it/s]  0%|          | 11/10000 [00:03<56:13,  2.96it/s]  0%|          | 12/10000 [00:03<56:30,  2.95it/s]  0%|          | 13/10000 [00:04<56:23,  2.95it/s]  0%|          | 14/10000 [00:04<56:42,  2.93it/s]  0%|          | 15/10000 [00:04<56:49,  2.93it/s]  0%|          | 16/10000 [00:05<56:59,  2.92it/s]  0%|          | 17/10000 [00:05<56:56,  2.92it/s]  0%|          | 18/10000 [00:05<56:51,  2.93it/s]  0%|          | 19/10000 [00:06<56:53,  2.92it/s]  0%|          | 20/10000 [00:06<56:46,  2.93it/s]  0%|          | 21/10000 [00:06<56:49,  2.93it/s]  0%|          | 22/10000 [00:07<56:48,  2.93it/s]  0%|          | 23/10000 [00:07<57:06,  2.91it/s]  0%|          | 24/10000 [00:07<57:27,  2.89it/s]  0%|          | 25/10000 [00:08<57:25,  2.89it/s]  0%|          | 26/10000 [00:08<57:41,  2.88it/s]  0%|          | 27/10000 [00:08<57:46,  2.88it/s]                                                  Converged after 26 iterations, error 373.25
  0%|          | 27/10000 [00:09<57:46,  2.88it/s] 10%|█         | 1000/10000 [00:09<00:10, 839.94it/s]                                                     Converged after 29 iterations, error 366.5
 10%|█         | 1030/10000 [00:19<00:10, 839.94it/s] 20%|██        | 2000/10000 [00:19<00:52, 153.42it/s] 20%|██        | 2010/10000 [00:22<01:12, 109.94it/s]                                                     Converged after 19 iterations, error 368.25
 20%|██        | 2020/10000 [00:26<01:12, 109.94it/s] 30%|███       | 3000/10000 [00:26<00:43, 159.82it/s]                                                     Converged after 18 iterations, error 367.0
 30%|███       | 3019/10000 [00:33<00:43, 159.82it/s] 40%|████      | 4000/10000 [00:33<00:38, 155.75it/s]                                                     Converged after 17 iterations, error 366.5
 40%|████      | 4018/10000 [00:39<00:38, 155.75it/s] 50%|█████     | 5000/10000 [00:39<00:31, 157.29it/s]                                                     Converged after 19 iterations, error 366.5
 50%|█████     | 5020/10000 [00:46<00:31, 157.29it/s] 60%|██████    | 6000/10000 [00:46<00:26, 152.23it/s]                                                     Converged after 18 iterations, error 365.0
 60%|██████    | 6019/10000 [00:52<00:26, 152.23it/s] 70%|███████   | 7000/10000 [00:52<00:19, 151.86it/s]                                                     Converged after 20 iterations, error 370.25
 70%|███████   | 7021/10000 [00:59<00:19, 151.86it/s] 80%|████████  | 8000/10000 [00:59<00:13, 148.08it/s] 80%|████████  | 8021/10000 [01:06<00:19, 102.04it/s]                                                     Converged after 22 iterations, error 370.75
 80%|████████  | 8023/10000 [01:07<00:19, 102.04it/s] 90%|█████████ | 9000/10000 [01:07<00:06, 156.79it/s]                                                     Converged after 24 iterations, error 370.25
 90%|█████████ | 9025/10000 [01:16<00:06, 156.79it/s]100%|██████████| 10000/10000 [01:16<00:00, 140.20it/s]quantized with best error tensor(365., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:16<00:00, 131.22it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:52,  5.98it/s]  0%|          | 3/10000 [00:00<40:29,  4.11it/s]  0%|          | 4/10000 [00:01<46:09,  3.61it/s]  0%|          | 5/10000 [00:01<50:22,  3.31it/s]  0%|          | 6/10000 [00:01<51:58,  3.20it/s]  0%|          | 7/10000 [00:02<53:51,  3.09it/s]  0%|          | 8/10000 [00:02<54:22,  3.06it/s]  0%|          | 9/10000 [00:02<55:30,  3.00it/s]  0%|          | 10/10000 [00:03<55:26,  3.00it/s]  0%|          | 11/10000 [00:03<56:19,  2.96it/s]  0%|          | 12/10000 [00:03<55:55,  2.98it/s]  0%|          | 13/10000 [00:04<56:34,  2.94it/s]  0%|          | 14/10000 [00:04<56:03,  2.97it/s]  0%|          | 15/10000 [00:04<56:37,  2.94it/s]  0%|          | 16/10000 [00:05<56:22,  2.95it/s]  0%|          | 17/10000 [00:05<57:14,  2.91it/s]  0%|          | 18/10000 [00:05<56:31,  2.94it/s]  0%|          | 19/10000 [00:06<57:11,  2.91it/s]  0%|          | 20/10000 [00:06<56:36,  2.94it/s]                                                  Converged after 19 iterations, error 485.25
  0%|          | 20/10000 [00:06<56:36,  2.94it/s] 10%|█         | 1000/10000 [00:06<00:10, 859.10it/s]                                                     Converged after 21 iterations, error 489.75
 10%|█         | 1022/10000 [00:14<00:10, 859.10it/s] 20%|██        | 2000/10000 [00:14<00:39, 204.54it/s]                                                     Converged after 27 iterations, error 491.25
 20%|██        | 2028/10000 [00:23<00:38, 204.54it/s] 30%|███       | 3000/10000 [00:23<00:49, 142.75it/s]                                                     Converged after 17 iterations, error 487.75
 30%|███       | 3018/10000 [00:29<00:48, 142.75it/s] 40%|████      | 4000/10000 [00:29<00:39, 150.55it/s]                                                     Converged after 21 iterations, error 489.25
 40%|████      | 4022/10000 [00:37<00:39, 150.55it/s] 50%|█████     | 5000/10000 [00:37<00:34, 143.92it/s]                                                     Converged after 24 iterations, error 494.25
 50%|█████     | 5025/10000 [00:45<00:34, 143.92it/s] 60%|██████    | 6000/10000 [00:45<00:29, 134.04it/s] 60%|██████    | 6025/10000 [00:53<00:44, 88.60it/s]                                                     Converged after 35 iterations, error 490.0
 60%|██████    | 6036/10000 [00:58<00:44, 88.60it/s] 70%|███████   | 7000/10000 [00:58<00:25, 118.62it/s] 70%|███████   | 7020/10000 [01:04<00:35, 82.84it/s]                                                     Converged after 21 iterations, error 494.25
 70%|███████   | 7022/10000 [01:05<00:35, 82.84it/s] 80%|████████  | 8000/10000 [01:05<00:14, 140.44it/s]                                                     Converged after 16 iterations, error 486.25
 80%|████████  | 8017/10000 [01:11<00:14, 140.44it/s] 90%|█████████ | 9000/10000 [01:11<00:06, 151.89it/s]                                                     Converged after 22 iterations, error 490.25
 90%|█████████ | 9023/10000 [01:19<00:06, 151.89it/s]100%|██████████| 10000/10000 [01:19<00:00, 142.43it/s]quantized with best error tensor(485.2500, device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:19<00:00, 126.54it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:57,  5.96it/s]  0%|          | 3/10000 [00:00<40:34,  4.11it/s]  0%|          | 4/10000 [00:01<46:00,  3.62it/s]  0%|          | 5/10000 [00:01<50:11,  3.32it/s]  0%|          | 6/10000 [00:01<52:07,  3.20it/s]  0%|          | 7/10000 [00:02<53:56,  3.09it/s]  0%|          | 8/10000 [00:02<54:22,  3.06it/s]  0%|          | 9/10000 [00:02<55:36,  2.99it/s]  0%|          | 10/10000 [00:03<55:43,  2.99it/s]  0%|          | 11/10000 [00:03<56:24,  2.95it/s]  0%|          | 12/10000 [00:03<55:58,  2.97it/s]  0%|          | 13/10000 [00:04<56:37,  2.94it/s]  0%|          | 14/10000 [00:04<56:38,  2.94it/s]  0%|          | 15/10000 [00:04<57:12,  2.91it/s]  0%|          | 16/10000 [00:05<56:40,  2.94it/s]  0%|          | 17/10000 [00:05<57:15,  2.91it/s]  0%|          | 18/10000 [00:05<56:34,  2.94it/s]  0%|          | 19/10000 [00:06<57:05,  2.91it/s]  0%|          | 20/10000 [00:06<56:34,  2.94it/s]  0%|          | 21/10000 [00:06<57:01,  2.92it/s]  0%|          | 22/10000 [00:07<56:38,  2.94it/s]  0%|          | 23/10000 [00:07<57:17,  2.90it/s]  0%|          | 24/10000 [00:07<56:48,  2.93it/s]  0%|          | 25/10000 [00:08<57:18,  2.90it/s]  0%|          | 26/10000 [00:08<56:36,  2.94it/s]  0%|          | 27/10000 [00:08<56:59,  2.92it/s]                                                  Converged after 26 iterations, error 689.5
  0%|          | 27/10000 [00:09<56:59,  2.92it/s] 10%|█         | 1000/10000 [00:09<00:10, 862.58it/s]                                                     Converged after 15 iterations, error 684.5
 10%|█         | 1016/10000 [00:14<00:10, 862.58it/s] 20%|██        | 2000/10000 [00:14<00:28, 276.02it/s]                                                     Converged after 22 iterations, error 680.0
 20%|██        | 2023/10000 [00:22<00:28, 276.02it/s] 30%|███       | 3000/10000 [00:22<00:38, 179.94it/s]                                                     Converged after 24 iterations, error 683.5
 30%|███       | 3025/10000 [00:30<00:38, 179.94it/s] 40%|████      | 4000/10000 [00:30<00:40, 149.05it/s]                                                     Converged after 16 iterations, error 694.5
 40%|████      | 4017/10000 [00:36<00:40, 149.05it/s] 50%|█████     | 5000/10000 [00:36<00:31, 156.93it/s]                                                     Converged after 27 iterations, error 683.0
 50%|█████     | 5028/10000 [00:46<00:31, 156.93it/s] 60%|██████    | 6000/10000 [00:46<00:29, 134.51it/s]                                                     Converged after 17 iterations, error 689.0
 60%|██████    | 6018/10000 [00:52<00:29, 134.51it/s] 70%|███████   | 7000/10000 [00:52<00:21, 142.83it/s]                                                     Converged after 19 iterations, error 688.5
 70%|███████   | 7020/10000 [00:59<00:20, 142.83it/s] 80%|████████  | 8000/10000 [00:59<00:13, 144.18it/s] 80%|████████  | 8021/10000 [01:05<00:19, 100.64it/s]                                                     Converged after 22 iterations, error 686.0
 80%|████████  | 8023/10000 [01:06<00:19, 100.64it/s] 90%|█████████ | 9000/10000 [01:06<00:06, 154.01it/s]                                                     Converged after 16 iterations, error 688.0
 90%|█████████ | 9017/10000 [01:12<00:06, 154.01it/s]100%|██████████| 10000/10000 [01:12<00:00, 160.46it/s]quantized with best error tensor(680., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:12<00:00, 137.77it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:47,  6.00it/s]  0%|          | 3/10000 [00:00<40:29,  4.11it/s]  0%|          | 4/10000 [00:01<45:59,  3.62it/s]  0%|          | 5/10000 [00:01<50:20,  3.31it/s]  0%|          | 6/10000 [00:01<52:01,  3.20it/s]  0%|          | 7/10000 [00:02<53:59,  3.08it/s]  0%|          | 8/10000 [00:02<54:22,  3.06it/s]  0%|          | 9/10000 [00:02<55:36,  2.99it/s]  0%|          | 10/10000 [00:03<55:35,  3.00it/s]  0%|          | 11/10000 [00:03<56:28,  2.95it/s]  0%|          | 12/10000 [00:03<56:15,  2.96it/s]  0%|          | 13/10000 [00:04<56:55,  2.92it/s]  0%|          | 14/10000 [00:04<56:28,  2.95it/s]  0%|          | 15/10000 [00:04<56:49,  2.93it/s]  0%|          | 16/10000 [00:05<56:37,  2.94it/s]  0%|          | 17/10000 [00:05<57:06,  2.91it/s]  0%|          | 18/10000 [00:05<56:27,  2.95it/s]  0%|          | 19/10000 [00:06<57:03,  2.92it/s]  0%|          | 20/10000 [00:06<56:39,  2.94it/s]  0%|          | 21/10000 [00:06<57:07,  2.91it/s]  0%|          | 22/10000 [00:07<56:33,  2.94it/s]                                                  Converged after 21 iterations, error 856.0
  0%|          | 22/10000 [00:07<56:33,  2.94it/s] 10%|█         | 1000/10000 [00:07<00:10, 858.00it/s]                                                     Converged after 19 iterations, error 848.0
 10%|█         | 1020/10000 [00:14<00:10, 858.00it/s] 20%|██        | 2000/10000 [00:14<00:35, 222.25it/s]                                                     Converged after 21 iterations, error 845.5
 20%|██        | 2022/10000 [00:21<00:35, 222.25it/s] 30%|███       | 3000/10000 [00:21<00:41, 170.26it/s]                                                     Converged after 15 iterations, error 840.0
 30%|███       | 3016/10000 [00:27<00:41, 170.26it/s] 40%|████      | 4000/10000 [00:27<00:33, 176.97it/s]                                                     Converged after 15 iterations, error 852.5
 40%|████      | 4016/10000 [00:32<00:33, 176.97it/s] 50%|█████     | 5000/10000 [00:32<00:27, 179.24it/s]                                                     Converged after 19 iterations, error 843.5
 50%|█████     | 5020/10000 [00:39<00:27, 179.24it/s] 60%|██████    | 6000/10000 [00:39<00:24, 166.60it/s]                                                     Converged after 19 iterations, error 850.0
 60%|██████    | 6020/10000 [00:46<00:23, 166.60it/s] 70%|███████   | 7000/10000 [00:46<00:18, 159.47it/s]                                                     Converged after 18 iterations, error 853.0
 70%|███████   | 7019/10000 [00:52<00:18, 159.47it/s] 80%|████████  | 8000/10000 [00:52<00:12, 157.88it/s]                                                     Converged after 17 iterations, error 851.0
 80%|████████  | 8018/10000 [00:58<00:12, 157.88it/s] 90%|█████████ | 9000/10000 [00:58<00:06, 159.53it/s] 90%|█████████ | 9020/10000 [01:05<00:08, 110.15it/s]                                                     Converged after 21 iterations, error 834.0
 90%|█████████ | 9022/10000 [01:06<00:08, 110.15it/s]100%|██████████| 10000/10000 [01:06<00:00, 166.40it/s]quantized with best error tensor(834., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:06<00:00, 150.80it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:59,  5.95it/s]  0%|          | 3/10000 [00:00<40:34,  4.11it/s]  0%|          | 4/10000 [00:01<46:11,  3.61it/s]  0%|          | 5/10000 [00:01<50:20,  3.31it/s]  0%|          | 6/10000 [00:01<52:34,  3.17it/s]  0%|          | 7/10000 [00:02<54:35,  3.05it/s]  0%|          | 8/10000 [00:02<55:00,  3.03it/s]  0%|          | 9/10000 [00:02<55:51,  2.98it/s]  0%|          | 10/10000 [00:03<55:40,  2.99it/s]  0%|          | 11/10000 [00:03<56:25,  2.95it/s]  0%|          | 12/10000 [00:03<56:09,  2.96it/s]  0%|          | 13/10000 [00:04<56:44,  2.93it/s]  0%|          | 14/10000 [00:04<56:18,  2.96it/s]  0%|          | 15/10000 [00:04<56:59,  2.92it/s]  0%|          | 16/10000 [00:05<56:36,  2.94it/s]  0%|          | 17/10000 [00:05<57:03,  2.92it/s]  0%|          | 18/10000 [00:05<56:44,  2.93it/s]  0%|          | 19/10000 [00:06<57:04,  2.91it/s]  0%|          | 20/10000 [00:06<56:27,  2.95it/s]  0%|          | 21/10000 [00:06<56:57,  2.92it/s]  0%|          | 22/10000 [00:07<56:22,  2.95it/s]  0%|          | 23/10000 [00:07<57:06,  2.91it/s]  0%|          | 24/10000 [00:07<56:42,  2.93it/s]                                                  Converged after 23 iterations, error 882.5
  0%|          | 24/10000 [00:08<56:42,  2.93it/s] 10%|█         | 1000/10000 [00:08<00:10, 854.47it/s]                                                     Converged after 16 iterations, error 887.0
 10%|█         | 1017/10000 [00:14<00:10, 854.47it/s] 20%|██        | 2000/10000 [00:14<00:32, 249.52it/s]                                                     Converged after 26 iterations, error 875.5
 20%|██        | 2027/10000 [00:23<00:31, 249.52it/s] 30%|███       | 3000/10000 [00:23<00:45, 153.82it/s] 30%|███       | 3034/10000 [00:35<00:45, 153.82it/s]                                                     Converged after 33 iterations, error 887.5
 30%|███       | 3034/10000 [00:35<00:45, 153.82it/s] 40%|████      | 4000/10000 [00:35<00:51, 117.48it/s] 40%|████      | 4009/10000 [00:37<00:59, 99.91it/s]                                                     Converged after 17 iterations, error 879.5
 40%|████      | 4018/10000 [00:41<00:59, 99.91it/s] 50%|█████     | 5000/10000 [00:41<00:35, 140.95it/s]                                                     Converged after 23 iterations, error 896.5
 50%|█████     | 5024/10000 [00:49<00:35, 140.95it/s] 60%|██████    | 6000/10000 [00:49<00:30, 132.91it/s]                                                     Converged after 21 iterations, error 892.0
 60%|██████    | 6022/10000 [00:57<00:29, 132.91it/s] 70%|███████   | 7000/10000 [00:57<00:22, 132.98it/s]                                                     Converged after 20 iterations, error 896.5
 70%|███████   | 7021/10000 [01:04<00:22, 132.98it/s] 80%|████████  | 8000/10000 [01:04<00:14, 135.07it/s] 80%|████████  | 8020/10000 [01:10<00:20, 95.88it/s]                                                     Converged after 24 iterations, error 871.5
 80%|████████  | 8025/10000 [01:12<00:20, 95.88it/s] 90%|█████████ | 9000/10000 [01:12<00:07, 141.10it/s]                                                     Converged after 19 iterations, error 880.5
 90%|█████████ | 9020/10000 [01:19<00:06, 141.10it/s]100%|██████████| 10000/10000 [01:19<00:00, 143.06it/s]quantized with best error tensor(871.5000, device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:19<00:00, 125.68it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:15,  5.69it/s]  0%|          | 3/10000 [00:00<40:21,  4.13it/s]  0%|          | 4/10000 [00:01<47:06,  3.54it/s]  0%|          | 5/10000 [00:01<49:49,  3.34it/s]  0%|          | 6/10000 [00:01<52:35,  3.17it/s]  0%|          | 7/10000 [00:02<53:35,  3.11it/s]  0%|          | 8/10000 [00:02<54:53,  3.03it/s]  0%|          | 9/10000 [00:02<55:01,  3.03it/s]  0%|          | 10/10000 [00:03<55:58,  2.97it/s]  0%|          | 11/10000 [00:03<55:42,  2.99it/s]  0%|          | 12/10000 [00:03<56:36,  2.94it/s]  0%|          | 13/10000 [00:04<56:04,  2.97it/s]  0%|          | 14/10000 [00:04<56:53,  2.93it/s]  0%|          | 15/10000 [00:04<56:11,  2.96it/s]  0%|          | 16/10000 [00:05<56:47,  2.93it/s]  0%|          | 17/10000 [00:05<56:21,  2.95it/s]  0%|          | 18/10000 [00:05<57:03,  2.92it/s]  0%|          | 19/10000 [00:06<56:25,  2.95it/s]  0%|          | 20/10000 [00:06<57:07,  2.91it/s]  0%|          | 21/10000 [00:06<56:35,  2.94it/s]  0%|          | 22/10000 [00:07<57:11,  2.91it/s]  0%|          | 23/10000 [00:07<56:41,  2.93it/s]  0%|          | 24/10000 [00:07<57:10,  2.91it/s]  0%|          | 25/10000 [00:08<56:29,  2.94it/s]  0%|          | 26/10000 [00:08<56:54,  2.92it/s]  0%|          | 27/10000 [00:08<56:13,  2.96it/s]  0%|          | 28/10000 [00:09<56:44,  2.93it/s]  0%|          | 29/10000 [00:09<56:09,  2.96it/s]  0%|          | 30/10000 [00:09<56:44,  2.93it/s]  0%|          | 31/10000 [00:10<56:17,  2.95it/s]  0%|          | 32/10000 [00:10<56:58,  2.92it/s]  0%|          | 33/10000 [00:10<56:14,  2.95it/s]                                                  Converged after 32 iterations, error 964.0
  0%|          | 33/10000 [00:11<56:14,  2.95it/s] 10%|█         | 1000/10000 [00:11<00:10, 850.86it/s]                                                     Converged after 27 iterations, error 966.0
 10%|█         | 1028/10000 [00:21<00:10, 850.86it/s] 20%|██        | 2000/10000 [00:21<00:50, 158.60it/s]                                                     Converged after 37 iterations, error 969.0
 20%|██        | 2038/10000 [00:34<00:50, 158.60it/s] 30%|███       | 3000/10000 [00:34<01:06, 105.25it/s] 30%|███       | 3008/10000 [00:36<01:17, 90.53it/s]                                                     Converged after 23 iterations, error 974.0
 30%|███       | 3024/10000 [00:42<01:17, 90.53it/s] 40%|████      | 4000/10000 [00:42<00:51, 116.10it/s]                                                     Converged after 18 iterations, error 963.0
 40%|████      | 4019/10000 [00:49<00:51, 116.10it/s] 50%|█████     | 5000/10000 [00:49<00:39, 128.07it/s]                                                     Converged after 23 iterations, error 967.0
 50%|█████     | 5024/10000 [00:57<00:38, 128.07it/s] 60%|██████    | 6000/10000 [00:57<00:31, 125.88it/s]                                                     Converged after 17 iterations, error 960.0
 60%|██████    | 6018/10000 [01:03<00:31, 125.88it/s] 70%|███████   | 7000/10000 [01:03<00:21, 136.52it/s] 70%|███████   | 7022/10000 [01:10<00:31, 93.11it/s]                                                     Converged after 25 iterations, error 960.0
 70%|███████   | 7026/10000 [01:12<00:31, 93.11it/s] 80%|████████  | 8000/10000 [01:12<00:14, 141.04it/s]                                                     Converged after 17 iterations, error 967.0
 80%|████████  | 8018/10000 [01:18<00:14, 141.04it/s] 90%|█████████ | 9000/10000 [01:18<00:06, 148.58it/s]                                                     Converged after 18 iterations, error 966.5
 90%|█████████ | 9019/10000 [01:25<00:06, 148.58it/s]100%|██████████| 10000/10000 [01:25<00:00, 150.62it/s]quantized with best error tensor(960., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:25<00:00, 117.50it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<28:44,  5.80it/s]  0%|          | 3/10000 [00:00<40:07,  4.15it/s]  0%|          | 4/10000 [00:01<46:51,  3.56it/s]  0%|          | 5/10000 [00:01<49:40,  3.35it/s]  0%|          | 6/10000 [00:01<52:36,  3.17it/s]  0%|          | 7/10000 [00:02<53:17,  3.12it/s]  0%|          | 8/10000 [00:02<54:39,  3.05it/s]  0%|          | 9/10000 [00:02<54:43,  3.04it/s]  0%|          | 10/10000 [00:03<55:45,  2.99it/s]  0%|          | 11/10000 [00:03<55:25,  3.00it/s]  0%|          | 12/10000 [00:03<56:09,  2.96it/s]  0%|          | 13/10000 [00:04<55:45,  2.99it/s]  0%|          | 14/10000 [00:04<56:31,  2.94it/s]  0%|          | 15/10000 [00:04<55:58,  2.97it/s]  0%|          | 16/10000 [00:05<56:26,  2.95it/s]  0%|          | 17/10000 [00:05<56:00,  2.97it/s]                                                  Converged after 16 iterations, error 1085.0
  0%|          | 17/10000 [00:05<56:00,  2.97it/s] 10%|█         | 1000/10000 [00:05<00:10, 868.84it/s]                                                     Converged after 38 iterations, error 1082.0
 10%|█         | 1039/10000 [00:19<00:10, 868.84it/s] 20%|██        | 2000/10000 [00:19<01:08, 117.64it/s] 20%|██        | 2008/10000 [00:21<01:23, 95.67it/s]                                                     Converged after 22 iterations, error 1097.0
 20%|██        | 2023/10000 [00:27<01:23, 95.67it/s] 30%|███       | 3000/10000 [00:27<00:54, 128.89it/s]                                                     Converged after 21 iterations, error 1081.0
 30%|███       | 3022/10000 [00:34<00:54, 128.89it/s] 40%|████      | 4000/10000 [00:34<00:45, 130.89it/s]                                                     Converged after 13 iterations, error 1079.0
 40%|████      | 4014/10000 [00:39<00:45, 130.89it/s] 50%|█████     | 5000/10000 [00:39<00:32, 151.96it/s]                                                     Converged after 18 iterations, error 1087.0
 50%|█████     | 5019/10000 [00:46<00:32, 151.96it/s] 60%|██████    | 6000/10000 [00:46<00:26, 152.98it/s]                                                     Converged after 19 iterations, error 1085.0
 60%|██████    | 6020/10000 [00:52<00:26, 152.98it/s] 70%|███████   | 7000/10000 [00:52<00:19, 151.00it/s] 70%|███████   | 7024/10000 [01:00<00:30, 97.49it/s]                                                     Converged after 34 iterations, error 1077.0
 70%|███████   | 7035/10000 [01:04<00:30, 97.49it/s] 80%|████████  | 8000/10000 [01:04<00:15, 127.68it/s] 80%|████████  | 8019/10000 [01:10<00:22, 88.69it/s]                                                     Converged after 21 iterations, error 1087.0
 80%|████████  | 8022/10000 [01:12<00:22, 88.69it/s] 90%|█████████ | 9000/10000 [01:12<00:06, 145.88it/s]                                                     Converged after 21 iterations, error 1067.0
 90%|█████████ | 9022/10000 [01:19<00:06, 145.88it/s]100%|██████████| 10000/10000 [01:19<00:00, 140.95it/s]quantized with best error tensor(1067., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:19<00:00, 125.56it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<28:53,  5.77it/s]  0%|          | 3/10000 [00:00<39:55,  4.17it/s]  0%|          | 4/10000 [00:01<46:33,  3.58it/s]  0%|          | 5/10000 [00:01<49:36,  3.36it/s]  0%|          | 6/10000 [00:01<52:10,  3.19it/s]  0%|          | 7/10000 [00:02<53:09,  3.13it/s]  0%|          | 8/10000 [00:02<54:44,  3.04it/s]  0%|          | 9/10000 [00:02<54:50,  3.04it/s]  0%|          | 10/10000 [00:03<55:49,  2.98it/s]  0%|          | 11/10000 [00:03<55:28,  3.00it/s]  0%|          | 12/10000 [00:03<56:14,  2.96it/s]  0%|          | 13/10000 [00:04<55:53,  2.98it/s]  0%|          | 14/10000 [00:04<56:31,  2.94it/s]  0%|          | 15/10000 [00:04<56:06,  2.97it/s]  0%|          | 16/10000 [00:05<56:47,  2.93it/s]  0%|          | 17/10000 [00:05<56:05,  2.97it/s]  0%|          | 18/10000 [00:05<56:48,  2.93it/s]  0%|          | 19/10000 [00:06<56:25,  2.95it/s]  0%|          | 20/10000 [00:06<56:57,  2.92it/s]  0%|          | 21/10000 [00:06<56:18,  2.95it/s]  0%|          | 22/10000 [00:07<57:00,  2.92it/s]  0%|          | 23/10000 [00:07<56:16,  2.95it/s]  0%|          | 24/10000 [00:07<56:56,  2.92it/s]                                                  Converged after 23 iterations, error 1100.0
  0%|          | 24/10000 [00:08<56:56,  2.92it/s] 10%|█         | 1000/10000 [00:08<00:10, 867.13it/s]                                                     Converged after 22 iterations, error 1078.0
 10%|█         | 1023/10000 [00:16<00:10, 867.13it/s] 20%|██        | 2000/10000 [00:16<00:41, 195.02it/s]                                                     Converged after 29 iterations, error 1101.0
 20%|██        | 2030/10000 [00:26<00:40, 195.02it/s] 30%|███       | 3000/10000 [00:26<00:53, 131.97it/s] 30%|███       | 3010/10000 [00:29<01:06, 104.39it/s]                                                     Converged after 22 iterations, error 1103.0
 30%|███       | 3023/10000 [00:34<01:06, 104.39it/s] 40%|████      | 4000/10000 [00:34<00:44, 135.98it/s]                                                     Converged after 32 iterations, error 1098.0
 40%|████      | 4033/10000 [00:46<00:43, 135.98it/s] 50%|█████     | 5000/10000 [00:46<00:45, 110.36it/s] 50%|█████     | 5009/10000 [00:48<00:53, 94.01it/s]                                                     Converged after 19 iterations, error 1095.0
 50%|█████     | 5020/10000 [00:53<00:52, 94.01it/s] 60%|██████    | 6000/10000 [00:53<00:30, 129.21it/s] 60%|██████    | 6027/10000 [01:02<00:53, 74.57it/s]                                                     Converged after 28 iterations, error 1090.0
 60%|██████    | 6029/10000 [01:03<00:53, 74.57it/s] 70%|███████   | 7000/10000 [01:03<00:22, 131.50it/s]                                                     Converged after 28 iterations, error 1091.0
 70%|███████   | 7029/10000 [01:13<00:22, 131.50it/s] 80%|████████  | 8000/10000 [01:13<00:17, 116.01it/s] 80%|████████  | 8010/10000 [01:16<00:20, 96.16it/s]                                                     Converged after 29 iterations, error 1099.0
 80%|████████  | 8030/10000 [01:23<00:20, 96.16it/s] 90%|█████████ | 9000/10000 [01:23<00:09, 110.53it/s]                                                     Converged after 18 iterations, error 1095.0
 90%|█████████ | 9019/10000 [01:30<00:08, 110.53it/s]100%|██████████| 10000/10000 [01:30<00:00, 123.57it/s]quantized with best error tensor(1078., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:30<00:00, 110.71it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:13,  5.70it/s]  0%|          | 3/10000 [00:00<41:18,  4.03it/s]  0%|          | 4/10000 [00:01<47:49,  3.48it/s]  0%|          | 5/10000 [00:01<51:24,  3.24it/s]  0%|          | 6/10000 [00:01<53:45,  3.10it/s]  0%|          | 7/10000 [00:02<55:06,  3.02it/s]  0%|          | 8/10000 [00:02<56:14,  2.96it/s]  0%|          | 9/10000 [00:02<56:51,  2.93it/s]  0%|          | 10/10000 [00:03<57:15,  2.91it/s]  0%|          | 11/10000 [00:03<57:21,  2.90it/s]  0%|          | 12/10000 [00:03<57:48,  2.88it/s]  0%|          | 13/10000 [00:04<57:56,  2.87it/s]  0%|          | 14/10000 [00:04<57:53,  2.88it/s]  0%|          | 15/10000 [00:04<57:47,  2.88it/s]  0%|          | 16/10000 [00:05<58:06,  2.86it/s]  0%|          | 17/10000 [00:05<57:58,  2.87it/s]  0%|          | 18/10000 [00:05<57:59,  2.87it/s]  0%|          | 19/10000 [00:06<57:43,  2.88it/s]  0%|          | 20/10000 [00:06<58:00,  2.87it/s]  0%|          | 21/10000 [00:06<57:50,  2.88it/s]  0%|          | 22/10000 [00:07<57:53,  2.87it/s]  0%|          | 23/10000 [00:07<57:32,  2.89it/s]                                                  Converged after 22 iterations, error 1068.0
  0%|          | 23/10000 [00:08<57:32,  2.89it/s] 10%|█         | 1000/10000 [00:08<00:10, 845.40it/s]                                                     Converged after 20 iterations, error 1073.0
 10%|█         | 1021/10000 [00:15<00:10, 845.40it/s] 20%|██        | 2000/10000 [00:15<00:37, 212.21it/s]                                                     Converged after 27 iterations, error 1087.0
 20%|██        | 2028/10000 [00:24<00:37, 212.21it/s] 30%|███       | 3000/10000 [00:24<00:48, 144.66it/s]                                                     Converged after 23 iterations, error 1089.0
 30%|███       | 3024/10000 [00:32<00:48, 144.66it/s] 40%|████      | 4000/10000 [00:32<00:44, 135.12it/s]                                                     Converged after 25 iterations, error 1080.0
 40%|████      | 4026/10000 [00:41<00:44, 135.12it/s] 50%|█████     | 5000/10000 [00:41<00:39, 126.33it/s] 50%|█████     | 5030/10000 [00:51<01:03, 78.12it/s]                                                     Converged after 33 iterations, error 1069.0
 50%|█████     | 5034/10000 [00:53<01:03, 78.12it/s] 60%|██████    | 6000/10000 [00:53<00:32, 121.47it/s]                                                     Converged after 20 iterations, error 1081.0
 60%|██████    | 6021/10000 [01:00<00:32, 121.47it/s] 70%|███████   | 7000/10000 [01:00<00:23, 127.95it/s]                                                     Converged after 18 iterations, error 1083.0
 70%|███████   | 7019/10000 [01:06<00:23, 127.95it/s] 80%|████████  | 8000/10000 [01:06<00:14, 136.32it/s]                                                     Converged after 15 iterations, error 1090.0
 80%|████████  | 8016/10000 [01:12<00:14, 136.32it/s] 90%|█████████ | 9000/10000 [01:12<00:06, 149.24it/s] 90%|█████████ | 9022/10000 [01:19<00:09, 99.95it/s]                                                     Converged after 22 iterations, error 1069.0
 90%|█████████ | 9023/10000 [01:20<00:09, 99.95it/s]100%|██████████| 10000/10000 [01:20<00:00, 158.55it/s]quantized with best error tensor(1068., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:20<00:00, 124.95it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:59,  5.95it/s]  0%|          | 3/10000 [00:00<40:27,  4.12it/s]  0%|          | 4/10000 [00:01<45:54,  3.63it/s]  0%|          | 5/10000 [00:01<50:05,  3.33it/s]  0%|          | 6/10000 [00:01<51:53,  3.21it/s]  0%|          | 7/10000 [00:02<54:04,  3.08it/s]  0%|          | 8/10000 [00:02<54:48,  3.04it/s]  0%|          | 9/10000 [00:02<56:06,  2.97it/s]  0%|          | 10/10000 [00:03<56:06,  2.97it/s]  0%|          | 11/10000 [00:03<56:57,  2.92it/s]  0%|          | 12/10000 [00:03<56:27,  2.95it/s]  0%|          | 13/10000 [00:04<56:40,  2.94it/s]  0%|          | 14/10000 [00:04<56:31,  2.94it/s]  0%|          | 15/10000 [00:04<56:53,  2.93it/s]  0%|          | 16/10000 [00:05<56:30,  2.94it/s]  0%|          | 17/10000 [00:05<56:51,  2.93it/s]  0%|          | 18/10000 [00:05<56:26,  2.95it/s]  0%|          | 19/10000 [00:06<56:55,  2.92it/s]                                                  Converged after 18 iterations, error 990.5
  0%|          | 19/10000 [00:06<56:55,  2.92it/s] 10%|█         | 1000/10000 [00:06<00:10, 868.00it/s]                                                     Converged after 20 iterations, error 979.0
 10%|█         | 1021/10000 [00:13<00:10, 868.00it/s] 20%|██        | 2000/10000 [00:13<00:36, 217.79it/s]                                                     Converged after 29 iterations, error 992.5
 20%|██        | 2030/10000 [00:23<00:36, 217.79it/s] 30%|███       | 3000/10000 [00:23<00:49, 140.01it/s] 30%|███       | 3010/10000 [00:26<01:03, 110.14it/s]                                                     Converged after 24 iterations, error 982.5
 30%|███       | 3025/10000 [00:32<01:03, 110.14it/s] 40%|████      | 4000/10000 [00:32<00:44, 135.95it/s] 40%|████      | 4038/10000 [00:44<01:33, 64.04it/s]  40%|████      | 4039/10000 [00:44<01:34, 62.82it/s]                                                    Converged after 38 iterations, error 970.5
 40%|████      | 4039/10000 [00:45<01:34, 62.82it/s] 50%|█████     | 5000/10000 [00:45<00:35, 141.45it/s]                                                     Converged after 33 iterations, error 969.5
 50%|█████     | 5034/10000 [00:56<00:35, 141.45it/s] 60%|██████    | 6000/10000 [00:56<00:36, 109.49it/s] 60%|██████    | 6009/10000 [00:59<00:43, 92.27it/s]                                                     Converged after 25 iterations, error 978.0
 60%|██████    | 6026/10000 [01:05<00:43, 92.27it/s] 70%|███████   | 7000/10000 [01:05<00:25, 116.54it/s]                                                     Converged after 17 iterations, error 973.5
 70%|███████   | 7018/10000 [01:11<00:25, 116.54it/s] 80%|████████  | 8000/10000 [01:11<00:15, 132.31it/s]                                                     Converged after 30 iterations, error 973.5
 80%|████████  | 8031/10000 [01:22<00:14, 132.31it/s] 90%|█████████ | 9000/10000 [01:22<00:08, 115.80it/s] 90%|█████████ | 9010/10000 [01:25<00:10, 98.15it/s]                                                     Converged after 33 iterations, error 976.5
 90%|█████████ | 9034/10000 [01:33<00:09, 98.15it/s]100%|██████████| 10000/10000 [01:33<00:00, 105.45it/s]quantized with best error tensor(969.5000, device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:33<00:00, 106.71it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<28:05,  5.93it/s]  0%|          | 3/10000 [00:00<40:50,  4.08it/s]  0%|          | 4/10000 [00:01<46:20,  3.60it/s]  0%|          | 5/10000 [00:01<50:11,  3.32it/s]  0%|          | 6/10000 [00:01<51:54,  3.21it/s]  0%|          | 7/10000 [00:02<53:47,  3.10it/s]  0%|          | 8/10000 [00:02<54:26,  3.06it/s]  0%|          | 9/10000 [00:02<55:29,  3.00it/s]  0%|          | 10/10000 [00:03<55:24,  3.00it/s]  0%|          | 11/10000 [00:03<56:09,  2.96it/s]  0%|          | 12/10000 [00:03<55:59,  2.97it/s]  0%|          | 13/10000 [00:04<56:26,  2.95it/s]  0%|          | 14/10000 [00:04<56:06,  2.97it/s]  0%|          | 15/10000 [00:04<56:28,  2.95it/s]  0%|          | 16/10000 [00:05<56:06,  2.97it/s]  0%|          | 17/10000 [00:05<56:30,  2.94it/s]  0%|          | 18/10000 [00:05<56:13,  2.96it/s]  0%|          | 19/10000 [00:06<56:56,  2.92it/s]                                                  Converged after 18 iterations, error 1132.0
  0%|          | 19/10000 [00:06<56:56,  2.92it/s] 10%|█         | 1000/10000 [00:06<00:10, 869.40it/s]                                                     Converged after 20 iterations, error 1150.0
 10%|█         | 1021/10000 [00:13<00:10, 869.40it/s] 20%|██        | 2000/10000 [00:13<00:36, 217.51it/s]                                                     Converged after 28 iterations, error 1136.0
 20%|██        | 2029/10000 [00:23<00:36, 217.51it/s] 30%|███       | 3000/10000 [00:23<00:48, 144.90it/s]                                                     Converged after 20 iterations, error 1125.0
 30%|███       | 3021/10000 [00:30<00:48, 144.90it/s] 40%|████      | 4000/10000 [00:30<00:41, 144.16it/s]                                                     Converged after 18 iterations, error 1129.0
 40%|████      | 4019/10000 [00:36<00:41, 144.16it/s] 50%|█████     | 5000/10000 [00:36<00:33, 148.15it/s]                                                     Converged after 27 iterations, error 1139.0
 50%|█████     | 5028/10000 [00:45<00:33, 148.15it/s] 60%|██████    | 6000/10000 [00:45<00:30, 130.17it/s] 60%|██████    | 6026/10000 [00:54<00:46, 85.86it/s]                                                     Converged after 25 iterations, error 1151.0
 60%|██████    | 6026/10000 [00:54<00:46, 85.86it/s] 70%|███████   | 7000/10000 [00:54<00:21, 140.47it/s]                                                     Converged after 21 iterations, error 1125.0
 70%|███████   | 7022/10000 [01:02<00:21, 140.47it/s] 80%|████████  | 8000/10000 [01:02<00:14, 137.98it/s]                                                     Converged after 19 iterations, error 1146.0
 80%|████████  | 8020/10000 [01:08<00:14, 137.98it/s] 90%|█████████ | 9000/10000 [01:08<00:07, 141.09it/s]                                                     Converged after 19 iterations, error 1141.0
 90%|█████████ | 9020/10000 [01:15<00:06, 141.09it/s]100%|██████████| 10000/10000 [01:15<00:00, 143.22it/s]quantized with best error tensor(1125., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:15<00:00, 131.98it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:36,  6.04it/s]  0%|          | 3/10000 [00:00<40:20,  4.13it/s]  0%|          | 4/10000 [00:01<45:46,  3.64it/s]  0%|          | 5/10000 [00:01<50:08,  3.32it/s]  0%|          | 6/10000 [00:01<51:57,  3.21it/s]  0%|          | 7/10000 [00:02<53:43,  3.10it/s]  0%|          | 8/10000 [00:02<54:14,  3.07it/s]  0%|          | 9/10000 [00:02<55:37,  2.99it/s]  0%|          | 10/10000 [00:03<55:22,  3.01it/s]  0%|          | 11/10000 [00:03<55:57,  2.98it/s]  0%|          | 12/10000 [00:03<55:47,  2.98it/s]  0%|          | 13/10000 [00:04<56:23,  2.95it/s]  0%|          | 14/10000 [00:04<55:59,  2.97it/s]  0%|          | 15/10000 [00:04<56:32,  2.94it/s]  0%|          | 16/10000 [00:05<56:06,  2.97it/s]  0%|          | 17/10000 [00:05<56:39,  2.94it/s]  0%|          | 18/10000 [00:05<56:03,  2.97it/s]  0%|          | 19/10000 [00:06<56:29,  2.94it/s]  0%|          | 20/10000 [00:06<56:10,  2.96it/s]  0%|          | 21/10000 [00:06<56:38,  2.94it/s]  0%|          | 22/10000 [00:07<56:03,  2.97it/s]  0%|          | 23/10000 [00:07<56:41,  2.93it/s]  0%|          | 24/10000 [00:07<56:13,  2.96it/s]  0%|          | 25/10000 [00:08<56:41,  2.93it/s]  0%|          | 26/10000 [00:08<56:17,  2.95it/s]  0%|          | 27/10000 [00:08<56:33,  2.94it/s]  0%|          | 28/10000 [00:09<56:15,  2.95it/s]  0%|          | 29/10000 [00:09<56:34,  2.94it/s]  0%|          | 30/10000 [00:09<56:07,  2.96it/s]  0%|          | 31/10000 [00:10<56:36,  2.93it/s]  0%|          | 32/10000 [00:10<56:03,  2.96it/s]  0%|          | 33/10000 [00:10<56:33,  2.94it/s]  0%|          | 34/10000 [00:11<56:10,  2.96it/s]                                                  Converged after 33 iterations, error 1162.0
  0%|          | 34/10000 [00:11<56:10,  2.96it/s] 10%|█         | 1000/10000 [00:11<00:10, 853.15it/s]                                                     Converged after 21 iterations, error 1149.0
 10%|█         | 1022/10000 [00:18<00:10, 853.15it/s] 20%|██        | 2000/10000 [00:18<00:39, 203.79it/s]                                                     Converged after 32 iterations, error 1153.0
 20%|██        | 2033/10000 [00:30<00:39, 203.79it/s] 30%|███       | 3000/10000 [00:30<00:54, 128.13it/s] 30%|███       | 3009/10000 [00:32<01:06, 104.77it/s]                                                     Converged after 43 iterations, error 1154.0
 30%|███       | 3044/10000 [00:45<01:06, 104.77it/s] 40%|████      | 4000/10000 [00:45<01:05, 91.77it/s]  40%|████      | 4009/10000 [00:47<01:16, 78.73it/s]                                                    Converged after 21 iterations, error 1162.0
 40%|████      | 4022/10000 [00:52<01:15, 78.73it/s] 50%|█████     | 5000/10000 [00:52<00:43, 113.65it/s]                                                     Converged after 24 iterations, error 1163.0
 50%|█████     | 5025/10000 [01:01<00:43, 113.65it/s] 60%|██████    | 6000/10000 [01:01<00:34, 115.29it/s] 60%|██████    | 6024/10000 [01:08<00:52, 76.23it/s]                                                     Converged after 32 iterations, error 1173.0
 60%|██████    | 6033/10000 [01:12<00:52, 76.23it/s] 70%|███████   | 7000/10000 [01:12<00:26, 113.78it/s] 70%|███████   | 7020/10000 [01:18<00:38, 77.72it/s]                                                     Converged after 24 iterations, error 1164.0
 70%|███████   | 7025/10000 [01:20<00:38, 77.72it/s] 80%|████████  | 8000/10000 [01:20<00:15, 129.40it/s] 80%|████████  | 8025/10000 [01:29<00:26, 75.92it/s]                                                     Converged after 25 iterations, error 1158.0
 80%|████████  | 8026/10000 [01:29<00:25, 75.92it/s] 90%|█████████ | 9000/10000 [01:29<00:07, 140.93it/s]                                                     Converged after 22 iterations, error 1148.0
 90%|█████████ | 9023/10000 [01:37<00:06, 140.93it/s]100%|██████████| 10000/10000 [01:37<00:00, 135.24it/s]quantized with best error tensor(1148., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:37<00:00, 102.56it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:47,  6.00it/s]  0%|          | 3/10000 [00:00<39:50,  4.18it/s]  0%|          | 4/10000 [00:01<46:21,  3.59it/s]  0%|          | 5/10000 [00:01<49:44,  3.35it/s]  0%|          | 6/10000 [00:01<51:40,  3.22it/s]  0%|          | 7/10000 [00:02<52:45,  3.16it/s]  0%|          | 8/10000 [00:02<53:44,  3.10it/s]  0%|          | 9/10000 [00:02<54:18,  3.07it/s]  0%|          | 10/10000 [00:03<55:01,  3.03it/s]  0%|          | 11/10000 [00:03<55:10,  3.02it/s]  0%|          | 12/10000 [00:03<55:28,  3.00it/s]  0%|          | 13/10000 [00:04<55:21,  3.01it/s]  0%|          | 14/10000 [00:04<55:26,  3.00it/s]  0%|          | 15/10000 [00:04<55:21,  3.01it/s]  0%|          | 16/10000 [00:05<55:40,  2.99it/s]  0%|          | 17/10000 [00:05<55:24,  3.00it/s]  0%|          | 18/10000 [00:05<55:25,  3.00it/s]  0%|          | 19/10000 [00:06<55:15,  3.01it/s]  0%|          | 20/10000 [00:06<55:22,  3.00it/s]  0%|          | 21/10000 [00:06<55:30,  3.00it/s]  0%|          | 22/10000 [00:07<55:50,  2.98it/s]  0%|          | 23/10000 [00:07<55:41,  2.99it/s]                                                  Converged after 22 iterations, error 1157.0
  0%|          | 23/10000 [00:07<55:41,  2.99it/s] 10%|█         | 1000/10000 [00:07<00:10, 878.23it/s]                                                     Converged after 20 iterations, error 1146.0
 10%|█         | 1021/10000 [00:14<00:10, 878.23it/s] 20%|██        | 2000/10000 [00:14<00:36, 217.39it/s]                                                     Converged after 33 iterations, error 1169.0
 20%|██        | 2034/10000 [00:25<00:36, 217.39it/s] 30%|███       | 3000/10000 [00:25<00:53, 130.61it/s] 30%|███       | 3009/10000 [00:28<01:05, 107.14it/s]                                                     Converged after 30 iterations, error 1170.0
 30%|███       | 3031/10000 [00:36<01:05, 107.14it/s] 40%|████      | 4000/10000 [00:36<00:51, 117.16it/s]                                                     Converged after 24 iterations, error 1171.0
 40%|████      | 4025/10000 [00:44<00:50, 117.16it/s] 50%|█████     | 5000/10000 [00:44<00:42, 118.60it/s]                                                     Converged after 15 iterations, error 1166.0
 50%|█████     | 5016/10000 [00:49<00:42, 118.60it/s] 60%|██████    | 6000/10000 [00:49<00:29, 137.35it/s]                                                     Converged after 23 iterations, error 1155.0
 60%|██████    | 6024/10000 [00:57<00:28, 137.35it/s] 70%|███████   | 7000/10000 [00:57<00:22, 133.10it/s] 70%|███████   | 7022/10000 [01:04<00:32, 92.51it/s]                                                     Converged after 24 iterations, error 1159.0
 70%|███████   | 7025/10000 [01:05<00:32, 92.51it/s] 80%|████████  | 8000/10000 [01:05<00:13, 143.28it/s] 80%|████████  | 8033/10000 [01:16<00:25, 76.96it/s]  80%|████████  | 8034/10000 [01:16<00:26, 75.43it/s]                                                    Converged after 35 iterations, error 1153.0
 80%|████████  | 8036/10000 [01:17<00:26, 75.43it/s] 90%|█████████ | 9000/10000 [01:17<00:06, 148.46it/s]                                                     Converged after 14 iterations, error 1161.0
 90%|█████████ | 9015/10000 [01:22<00:06, 148.46it/s]100%|██████████| 10000/10000 [01:22<00:00, 167.91it/s]quantized with best error tensor(1146., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:22<00:00, 120.67it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:55,  5.97it/s]  0%|          | 3/10000 [00:00<39:46,  4.19it/s]  0%|          | 4/10000 [00:01<45:33,  3.66it/s]  0%|          | 5/10000 [00:01<48:48,  3.41it/s]  0%|          | 6/10000 [00:01<51:00,  3.27it/s]  0%|          | 7/10000 [00:01<52:17,  3.18it/s]  0%|          | 8/10000 [00:02<53:12,  3.13it/s]  0%|          | 9/10000 [00:02<54:00,  3.08it/s]  0%|          | 10/10000 [00:03<54:41,  3.04it/s]  0%|          | 11/10000 [00:03<54:49,  3.04it/s]  0%|          | 12/10000 [00:03<55:47,  2.98it/s]  0%|          | 13/10000 [00:04<56:00,  2.97it/s]  0%|          | 14/10000 [00:04<56:20,  2.95it/s]  0%|          | 15/10000 [00:04<55:56,  2.98it/s]  0%|          | 16/10000 [00:05<55:46,  2.98it/s]  0%|          | 17/10000 [00:05<55:49,  2.98it/s]  0%|          | 18/10000 [00:05<55:41,  2.99it/s]  0%|          | 19/10000 [00:06<55:33,  2.99it/s]  0%|          | 20/10000 [00:06<55:35,  2.99it/s]  0%|          | 21/10000 [00:06<55:31,  3.00it/s]  0%|          | 22/10000 [00:07<55:26,  3.00it/s]  0%|          | 23/10000 [00:07<55:20,  3.00it/s]  0%|          | 24/10000 [00:07<55:22,  3.00it/s]  0%|          | 25/10000 [00:08<55:08,  3.02it/s]  0%|          | 26/10000 [00:08<55:24,  3.00it/s]  0%|          | 27/10000 [00:08<55:26,  3.00it/s]  0%|          | 28/10000 [00:09<55:31,  2.99it/s]  0%|          | 29/10000 [00:09<55:22,  3.00it/s]  0%|          | 30/10000 [00:09<55:22,  3.00it/s]                                                  Converged after 29 iterations, error 1170.0
  0%|          | 30/10000 [00:10<55:22,  3.00it/s] 10%|█         | 1000/10000 [00:10<00:10, 876.80it/s]                                                     Converged after 22 iterations, error 1155.0
 10%|█         | 1023/10000 [00:17<00:10, 876.80it/s] 20%|██        | 2000/10000 [00:17<00:39, 201.10it/s]                                                     Converged after 29 iterations, error 1167.0
 20%|██        | 2030/10000 [00:27<00:39, 201.10it/s] 30%|███       | 3000/10000 [00:27<00:50, 137.72it/s] 30%|███       | 3040/10000 [00:40<00:50, 137.72it/s] 30%|███       | 3041/10000 [00:40<01:48, 64.26it/s]  30%|███       | 3042/10000 [00:41<01:50, 63.10it/s]                                                    Converged after 41 iterations, error 1156.0
 30%|███       | 3042/10000 [00:41<01:50, 63.10it/s] 40%|████      | 4000/10000 [00:41<00:43, 138.08it/s] 40%|████      | 4031/10000 [00:51<00:43, 138.08it/s] 40%|████      | 4032/10000 [00:51<01:31, 65.15it/s]  40%|████      | 4033/10000 [00:52<01:33, 63.63it/s]                                                    Converged after 33 iterations, error 1171.0
 40%|████      | 4034/10000 [00:52<01:33, 63.63it/s] 50%|█████     | 5000/10000 [00:52<00:32, 154.07it/s]                                                     Converged after 34 iterations, error 1167.0
 50%|█████     | 5035/10000 [01:04<00:32, 154.07it/s] 60%|██████    | 6000/10000 [01:04<00:35, 111.96it/s] 60%|██████    | 6009/10000 [01:07<00:42, 93.72it/s]                                                     Converged after 34 iterations, error 1163.0
 60%|██████    | 6035/10000 [01:16<00:42, 93.72it/s] 70%|███████   | 7000/10000 [01:16<00:29, 101.15it/s]                                                     Converged after 36 iterations, error 1176.0
 70%|███████   | 7037/10000 [01:28<00:29, 101.15it/s] 80%|████████  | 8000/10000 [01:28<00:21, 92.09it/s]  80%|████████  | 8009/10000 [01:30<00:24, 80.92it/s]                                                    Converged after 25 iterations, error 1164.0
 80%|████████  | 8026/10000 [01:36<00:24, 80.92it/s] 90%|█████████ | 9000/10000 [01:36<00:09, 105.52it/s]                                                     Converged after 19 iterations, error 1181.0
 90%|█████████ | 9020/10000 [01:43<00:09, 105.52it/s]100%|██████████| 10000/10000 [01:43<00:00, 119.68it/s]quantized with best error tensor(1155., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:43<00:00, 96.58it/s] 
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<28:03,  5.94it/s]  0%|          | 3/10000 [00:00<39:47,  4.19it/s]  0%|          | 4/10000 [00:01<45:41,  3.65it/s]  0%|          | 5/10000 [00:01<49:01,  3.40it/s]  0%|          | 6/10000 [00:01<50:58,  3.27it/s]  0%|          | 7/10000 [00:02<52:19,  3.18it/s]  0%|          | 8/10000 [00:02<53:14,  3.13it/s]  0%|          | 9/10000 [00:02<54:13,  3.07it/s]  0%|          | 10/10000 [00:03<54:43,  3.04it/s]  0%|          | 11/10000 [00:03<54:59,  3.03it/s]  0%|          | 12/10000 [00:03<55:20,  3.01it/s]  0%|          | 13/10000 [00:04<55:22,  3.01it/s]  0%|          | 14/10000 [00:04<55:36,  2.99it/s]  0%|          | 15/10000 [00:04<55:32,  3.00it/s]  0%|          | 16/10000 [00:05<55:30,  3.00it/s]  0%|          | 17/10000 [00:05<55:30,  3.00it/s]  0%|          | 18/10000 [00:05<55:36,  2.99it/s]  0%|          | 19/10000 [00:06<55:33,  2.99it/s]  0%|          | 20/10000 [00:06<55:40,  2.99it/s]                                                  Converged after 19 iterations, error 1022.0
  0%|          | 20/10000 [00:06<55:40,  2.99it/s] 10%|█         | 1000/10000 [00:06<00:10, 883.04it/s]                                                     Converged after 24 iterations, error 1006.5
 10%|█         | 1025/10000 [00:14<00:10, 883.04it/s] 20%|██        | 2000/10000 [00:14<00:42, 186.19it/s]                                                     Converged after 26 iterations, error 1023.5
 20%|██        | 2027/10000 [00:23<00:42, 186.19it/s] 30%|███       | 3000/10000 [00:23<00:49, 142.04it/s]                                                     Converged after 22 iterations, error 1022.5
 30%|███       | 3023/10000 [00:31<00:49, 142.04it/s] 40%|████      | 4000/10000 [00:31<00:43, 137.33it/s]                                                     Converged after 27 iterations, error 1017.5
 40%|████      | 4028/10000 [00:40<00:43, 137.33it/s] 50%|█████     | 5000/10000 [00:40<00:39, 125.02it/s]                                                     Converged after 26 iterations, error 1014.0
 50%|█████     | 5027/10000 [00:49<00:39, 125.02it/s] 60%|██████    | 6000/10000 [00:49<00:33, 120.05it/s] 60%|██████    | 6025/10000 [00:57<00:47, 82.99it/s]                                                     Converged after 29 iterations, error 1015.5
 60%|██████    | 6030/10000 [00:59<00:47, 82.99it/s] 70%|███████   | 7000/10000 [00:59<00:24, 124.29it/s]                                                     Converged after 16 iterations, error 1010.5
 70%|███████   | 7017/10000 [01:05<00:24, 124.29it/s] 80%|████████  | 8000/10000 [01:05<00:14, 139.65it/s]                                                     Converged after 17 iterations, error 1002.0
 80%|████████  | 8018/10000 [01:11<00:14, 139.65it/s] 90%|█████████ | 9000/10000 [01:11<00:06, 148.12it/s] 90%|█████████ | 9022/10000 [01:18<00:09, 99.02it/s]                                                     Converged after 31 iterations, error 1013.5
 90%|█████████ | 9032/10000 [01:22<00:09, 99.02it/s]100%|██████████| 10000/10000 [01:22<00:00, 132.87it/s]quantized with best error tensor(1002., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:22<00:00, 121.74it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:38,  6.03it/s]  0%|          | 3/10000 [00:00<39:24,  4.23it/s]  0%|          | 4/10000 [00:01<45:24,  3.67it/s]  0%|          | 5/10000 [00:01<49:21,  3.38it/s]  0%|          | 6/10000 [00:01<51:20,  3.24it/s]  0%|          | 7/10000 [00:02<52:39,  3.16it/s]  0%|          | 8/10000 [00:02<53:42,  3.10it/s]  0%|          | 9/10000 [00:02<54:01,  3.08it/s]  0%|          | 10/10000 [00:03<54:38,  3.05it/s]  0%|          | 11/10000 [00:03<54:54,  3.03it/s]  0%|          | 12/10000 [00:03<55:02,  3.02it/s]  0%|          | 13/10000 [00:04<55:09,  3.02it/s]  0%|          | 14/10000 [00:04<55:40,  2.99it/s]  0%|          | 15/10000 [00:04<55:54,  2.98it/s]  0%|          | 16/10000 [00:05<56:08,  2.96it/s]  0%|          | 17/10000 [00:05<55:52,  2.98it/s]  0%|          | 18/10000 [00:05<55:36,  2.99it/s]  0%|          | 19/10000 [00:06<55:17,  3.01it/s]                                                  Converged after 18 iterations, error 1123.0
  0%|          | 19/10000 [00:06<55:17,  3.01it/s] 10%|█         | 1000/10000 [00:06<00:10, 887.70it/s]                                                     Converged after 15 iterations, error 1152.0
 10%|█         | 1016/10000 [00:11<00:10, 887.70it/s] 20%|██        | 2000/10000 [00:11<00:28, 277.31it/s]                                                     Converged after 24 iterations, error 1130.0
 20%|██        | 2025/10000 [00:19<00:28, 277.31it/s] 30%|███       | 3000/10000 [00:19<00:40, 173.50it/s]                                                     Converged after 25 iterations, error 1159.0
 30%|███       | 3026/10000 [00:28<00:40, 173.50it/s] 40%|████      | 4000/10000 [00:28<00:41, 145.01it/s]                                                     Converged after 17 iterations, error 1144.0
 40%|████      | 4018/10000 [00:34<00:41, 145.01it/s] 50%|█████     | 5000/10000 [00:34<00:32, 152.42it/s]                                                     Converged after 19 iterations, error 1146.0
 50%|█████     | 5020/10000 [00:41<00:32, 152.42it/s] 60%|██████    | 6000/10000 [00:41<00:26, 151.61it/s]                                                     Converged after 24 iterations, error 1144.0
 60%|██████    | 6025/10000 [00:49<00:26, 151.61it/s] 70%|███████   | 7000/10000 [00:49<00:21, 139.78it/s] 70%|███████   | 7023/10000 [00:56<00:31, 95.57it/s]                                                     Converged after 23 iterations, error 1144.0
 70%|███████   | 7024/10000 [00:57<00:31, 95.57it/s] 80%|████████  | 8000/10000 [00:57<00:13, 150.88it/s]                                                     Converged after 21 iterations, error 1152.0
 80%|████████  | 8022/10000 [01:04<00:13, 150.88it/s] 90%|█████████ | 9000/10000 [01:04<00:06, 145.24it/s]                                                     Converged after 27 iterations, error 1150.0
 90%|█████████ | 9028/10000 [01:14<00:06, 145.24it/s]100%|██████████| 10000/10000 [01:14<00:00, 129.64it/s]quantized with best error tensor(1123., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:14<00:00, 134.83it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:40,  6.02it/s]  0%|          | 3/10000 [00:00<39:26,  4.22it/s]  0%|          | 4/10000 [00:01<45:35,  3.65it/s]  0%|          | 5/10000 [00:01<48:59,  3.40it/s]  0%|          | 6/10000 [00:01<51:07,  3.26it/s]  0%|          | 7/10000 [00:02<53:06,  3.14it/s]  0%|          | 8/10000 [00:02<54:27,  3.06it/s]  0%|          | 9/10000 [00:02<54:51,  3.04it/s]  0%|          | 10/10000 [00:03<55:37,  2.99it/s]  0%|          | 11/10000 [00:03<55:27,  3.00it/s]  0%|          | 12/10000 [00:03<55:46,  2.98it/s]  0%|          | 13/10000 [00:04<55:32,  3.00it/s]  0%|          | 14/10000 [00:04<55:36,  2.99it/s]  0%|          | 15/10000 [00:04<55:20,  3.01it/s]  0%|          | 16/10000 [00:05<55:30,  3.00it/s]  0%|          | 17/10000 [00:05<55:26,  3.00it/s]  0%|          | 18/10000 [00:05<55:22,  3.00it/s]  0%|          | 19/10000 [00:06<55:10,  3.02it/s]  0%|          | 20/10000 [00:06<55:15,  3.01it/s]  0%|          | 21/10000 [00:06<55:21,  3.00it/s]  0%|          | 22/10000 [00:07<55:20,  3.00it/s]  0%|          | 23/10000 [00:07<55:22,  3.00it/s]  0%|          | 24/10000 [00:07<55:28,  3.00it/s]  0%|          | 25/10000 [00:08<55:14,  3.01it/s]  0%|          | 26/10000 [00:08<55:17,  3.01it/s]  0%|          | 27/10000 [00:08<55:11,  3.01it/s]  0%|          | 28/10000 [00:09<55:21,  3.00it/s]  0%|          | 29/10000 [00:09<55:22,  3.00it/s]  0%|          | 30/10000 [00:09<55:23,  3.00it/s]  0%|          | 31/10000 [00:10<55:21,  3.00it/s]                                                  Converged after 30 iterations, error 1173.0
  0%|          | 31/10000 [00:10<55:21,  3.00it/s] 10%|█         | 1000/10000 [00:10<00:10, 874.31it/s]                                                     Converged after 21 iterations, error 1178.0
 10%|█         | 1022/10000 [00:17<00:10, 874.31it/s] 20%|██        | 2000/10000 [00:17<00:39, 202.42it/s]                                                     Converged after 26 iterations, error 1169.0
 20%|██        | 2027/10000 [00:27<00:39, 202.42it/s] 30%|███       | 3000/10000 [00:27<00:48, 144.46it/s]                                                     Converged after 26 iterations, error 1175.0
 30%|███       | 3027/10000 [00:36<00:48, 144.46it/s] 40%|████      | 4000/10000 [00:36<00:47, 127.61it/s]                                                     Converged after 17 iterations, error 1168.0
 40%|████      | 4018/10000 [00:42<00:46, 127.61it/s] 50%|█████     | 5000/10000 [00:42<00:36, 138.36it/s]                                                     Converged after 21 iterations, error 1172.0
 50%|█████     | 5022/10000 [00:50<00:35, 138.36it/s] 60%|██████    | 6000/10000 [00:50<00:29, 136.46it/s] 60%|██████    | 6026/10000 [00:58<00:45, 88.09it/s]                                                     Converged after 27 iterations, error 1180.0
 60%|██████    | 6028/10000 [00:59<00:45, 88.09it/s] 70%|███████   | 7000/10000 [00:59<00:21, 138.48it/s]                                                     Converged after 26 iterations, error 1169.0
 70%|███████   | 7027/10000 [01:08<00:21, 138.48it/s] 80%|████████  | 8000/10000 [01:08<00:15, 125.57it/s]                                                     Converged after 18 iterations, error 1171.0
 80%|████████  | 8019/10000 [01:15<00:15, 125.57it/s] 90%|█████████ | 9000/10000 [01:15<00:07, 134.13it/s]                                                     Converged after 20 iterations, error 1176.0
 90%|█████████ | 9021/10000 [01:22<00:07, 134.13it/s]100%|██████████| 10000/10000 [01:22<00:00, 135.61it/s]quantized with best error tensor(1168., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:22<00:00, 121.13it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:18,  5.68it/s]  0%|          | 3/10000 [00:00<40:08,  4.15it/s]  0%|          | 4/10000 [00:01<46:50,  3.56it/s]  0%|          | 5/10000 [00:01<49:49,  3.34it/s]  0%|          | 6/10000 [00:01<52:52,  3.15it/s]  0%|          | 7/10000 [00:02<53:42,  3.10it/s]  0%|          | 8/10000 [00:02<55:06,  3.02it/s]  0%|          | 9/10000 [00:02<55:10,  3.02it/s]  0%|          | 10/10000 [00:03<56:02,  2.97it/s]  0%|          | 11/10000 [00:03<55:48,  2.98it/s]  0%|          | 12/10000 [00:03<56:37,  2.94it/s]  0%|          | 13/10000 [00:04<56:12,  2.96it/s]  0%|          | 14/10000 [00:04<56:43,  2.93it/s]  0%|          | 15/10000 [00:04<56:09,  2.96it/s]  0%|          | 16/10000 [00:05<56:43,  2.93it/s]  0%|          | 17/10000 [00:05<56:26,  2.95it/s]  0%|          | 18/10000 [00:05<56:56,  2.92it/s]  0%|          | 19/10000 [00:06<56:43,  2.93it/s]  0%|          | 20/10000 [00:06<57:08,  2.91it/s]  0%|          | 21/10000 [00:06<56:34,  2.94it/s]  0%|          | 22/10000 [00:07<57:05,  2.91it/s]  0%|          | 23/10000 [00:07<56:42,  2.93it/s]  0%|          | 24/10000 [00:07<57:06,  2.91it/s]  0%|          | 25/10000 [00:08<56:25,  2.95it/s]  0%|          | 26/10000 [00:08<57:00,  2.92it/s]  0%|          | 27/10000 [00:08<56:19,  2.95it/s]  0%|          | 28/10000 [00:09<56:56,  2.92it/s]  0%|          | 29/10000 [00:09<56:16,  2.95it/s]  0%|          | 30/10000 [00:09<56:44,  2.93it/s]  0%|          | 31/10000 [00:10<56:16,  2.95it/s]  0%|          | 32/10000 [00:10<56:43,  2.93it/s]                                                  Converged after 31 iterations, error 1081.0
  0%|          | 32/10000 [00:10<56:43,  2.93it/s] 10%|█         | 1000/10000 [00:10<00:10, 860.53it/s]                                                     Converged after 20 iterations, error 1084.0
 10%|█         | 1021/10000 [00:18<00:10, 860.53it/s] 20%|██        | 2000/10000 [00:18<00:37, 210.80it/s] 20%|██        | 2030/10000 [00:28<00:37, 210.80it/s]                                                     Converged after 29 iterations, error 1079.0
 20%|██        | 2030/10000 [00:28<00:37, 210.80it/s] 30%|███       | 3000/10000 [00:28<00:50, 137.33it/s] 30%|███       | 3010/10000 [00:31<01:04, 107.56it/s]                                                     Converged after 13 iterations, error 1081.0
 30%|███       | 3014/10000 [00:33<01:04, 107.56it/s] 40%|████      | 4000/10000 [00:33<00:34, 175.92it/s]                                                     Converged after 24 iterations, error 1089.0
 40%|████      | 4025/10000 [00:42<00:33, 175.92it/s] 50%|█████     | 5000/10000 [00:42<00:34, 143.90it/s]                                                     Converged after 16 iterations, error 1072.0
 50%|█████     | 5017/10000 [00:48<00:34, 143.90it/s] 60%|██████    | 6000/10000 [00:48<00:26, 151.87it/s]                                                     Converged after 15 iterations, error 1074.0
 60%|██████    | 6016/10000 [00:53<00:26, 151.87it/s] 70%|███████   | 7000/10000 [00:53<00:18, 161.21it/s]                                                     Converged after 15 iterations, error 1084.0
 70%|███████   | 7016/10000 [00:58<00:18, 161.21it/s] 80%|████████  | 8000/10000 [00:58<00:11, 167.90it/s] 80%|████████  | 8025/10000 [01:07<00:19, 103.13it/s]                                                     Converged after 25 iterations, error 1073.0
 80%|████████  | 8026/10000 [01:07<00:19, 103.13it/s] 90%|█████████ | 9000/10000 [01:07<00:06, 162.45it/s]                                                     Converged after 25 iterations, error 1058.0
 90%|█████████ | 9026/10000 [01:16<00:05, 162.45it/s]100%|██████████| 10000/10000 [01:16<00:00, 140.07it/s]quantized with best error tensor(1058., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:16<00:00, 130.47it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:07,  5.72it/s]  0%|          | 3/10000 [00:00<40:19,  4.13it/s]  0%|          | 4/10000 [00:01<47:03,  3.54it/s]  0%|          | 5/10000 [00:01<49:55,  3.34it/s]  0%|          | 6/10000 [00:01<52:57,  3.14it/s]  0%|          | 7/10000 [00:02<53:51,  3.09it/s]  0%|          | 8/10000 [00:02<55:25,  3.00it/s]  0%|          | 9/10000 [00:02<55:18,  3.01it/s]  0%|          | 10/10000 [00:03<56:17,  2.96it/s]  0%|          | 11/10000 [00:03<56:02,  2.97it/s]  0%|          | 12/10000 [00:03<56:44,  2.93it/s]  0%|          | 13/10000 [00:04<56:23,  2.95it/s]  0%|          | 14/10000 [00:04<57:13,  2.91it/s]  0%|          | 15/10000 [00:04<56:27,  2.95it/s]  0%|          | 16/10000 [00:05<57:03,  2.92it/s]  0%|          | 17/10000 [00:05<56:25,  2.95it/s]  0%|          | 18/10000 [00:05<56:57,  2.92it/s]  0%|          | 19/10000 [00:06<56:32,  2.94it/s]  0%|          | 20/10000 [00:06<57:06,  2.91it/s]  0%|          | 21/10000 [00:06<56:25,  2.95it/s]  0%|          | 22/10000 [00:07<57:05,  2.91it/s]  0%|          | 23/10000 [00:07<56:28,  2.94it/s]  0%|          | 24/10000 [00:07<57:17,  2.90it/s]                                                  Converged after 23 iterations, error 1125.0
  0%|          | 24/10000 [00:08<57:17,  2.90it/s] 10%|█         | 1000/10000 [00:08<00:10, 863.00it/s]                                                     Converged after 22 iterations, error 1128.0
 10%|█         | 1023/10000 [00:16<00:10, 863.00it/s] 20%|██        | 2000/10000 [00:16<00:40, 195.51it/s]                                                     Converged after 25 iterations, error 1122.0
 20%|██        | 2026/10000 [00:24<00:40, 195.51it/s] 30%|███       | 3000/10000 [00:24<00:47, 146.59it/s]                                                     Converged after 25 iterations, error 1125.0
 30%|███       | 3026/10000 [00:33<00:47, 146.59it/s] 40%|████      | 4000/10000 [00:33<00:46, 129.54it/s]                                                     Converged after 20 iterations, error 1129.0
 40%|████      | 4021/10000 [00:41<00:46, 129.54it/s] 50%|█████     | 5000/10000 [00:41<00:37, 131.76it/s]                                                     Converged after 19 iterations, error 1127.0
 50%|█████     | 5020/10000 [00:48<00:37, 131.76it/s] 60%|██████    | 6000/10000 [00:48<00:29, 135.29it/s] 60%|██████    | 6026/10000 [00:57<00:45, 86.83it/s]                                                     Converged after 25 iterations, error 1130.0
 60%|██████    | 6026/10000 [00:57<00:45, 86.83it/s] 70%|███████   | 7000/10000 [00:57<00:21, 141.89it/s]                                                     Converged after 31 iterations, error 1124.0
 70%|███████   | 7032/10000 [01:08<00:20, 141.89it/s] 80%|████████  | 8000/10000 [01:08<00:17, 116.32it/s] 80%|████████  | 8009/10000 [01:11<00:19, 99.68it/s]                                                     Converged after 17 iterations, error 1120.0
 80%|████████  | 8018/10000 [01:15<00:19, 99.68it/s] 90%|█████████ | 9000/10000 [01:15<00:07, 137.71it/s]                                                     Converged after 24 iterations, error 1114.0
 90%|█████████ | 9025/10000 [01:23<00:07, 137.71it/s]100%|██████████| 10000/10000 [01:23<00:00, 128.84it/s]quantized with best error tensor(1114., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:23<00:00, 119.64it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:10,  5.71it/s]  0%|          | 3/10000 [00:00<41:28,  4.02it/s]  0%|          | 4/10000 [00:01<47:48,  3.48it/s]  0%|          | 5/10000 [00:01<51:35,  3.23it/s]  0%|          | 6/10000 [00:01<53:52,  3.09it/s]  0%|          | 7/10000 [00:02<55:14,  3.01it/s]  0%|          | 8/10000 [00:02<56:20,  2.96it/s]  0%|          | 9/10000 [00:02<56:59,  2.92it/s]  0%|          | 10/10000 [00:03<57:17,  2.91it/s]  0%|          | 11/10000 [00:03<57:32,  2.89it/s]  0%|          | 12/10000 [00:03<57:57,  2.87it/s]  0%|          | 13/10000 [00:04<58:15,  2.86it/s]  0%|          | 14/10000 [00:04<58:23,  2.85it/s]  0%|          | 15/10000 [00:04<58:26,  2.85it/s]  0%|          | 16/10000 [00:05<58:41,  2.84it/s]  0%|          | 17/10000 [00:05<58:21,  2.85it/s]  0%|          | 18/10000 [00:05<58:29,  2.84it/s]  0%|          | 19/10000 [00:06<58:38,  2.84it/s]  0%|          | 20/10000 [00:06<58:45,  2.83it/s]  0%|          | 21/10000 [00:07<58:38,  2.84it/s]  0%|          | 22/10000 [00:07<58:42,  2.83it/s]  0%|          | 23/10000 [00:07<58:43,  2.83it/s]                                                  Converged after 22 iterations, error 1126.0
  0%|          | 23/10000 [00:08<58:43,  2.83it/s] 10%|█         | 1000/10000 [00:08<00:10, 832.69it/s]                                                     Converged after 25 iterations, error 1104.0
 10%|█         | 1026/10000 [00:17<00:10, 832.69it/s] 20%|██        | 2000/10000 [00:17<00:47, 168.64it/s] 20%|██        | 2031/10000 [00:27<00:47, 168.64it/s] 20%|██        | 2032/10000 [00:28<01:57, 67.82it/s]  20%|██        | 2033/10000 [00:28<02:00, 66.05it/s]                                                    Converged after 37 iterations, error 1119.0
 20%|██        | 2038/10000 [00:30<02:00, 66.05it/s] 30%|███       | 3000/10000 [00:30<00:49, 140.50it/s]                                                     Converged after 19 iterations, error 1118.0
 30%|███       | 3020/10000 [00:37<00:49, 140.50it/s] 40%|████      | 4000/10000 [00:37<00:42, 141.41it/s]                                                     Converged after 16 iterations, error 1123.0
 40%|████      | 4017/10000 [00:43<00:42, 141.41it/s] 50%|█████     | 5000/10000 [00:43<00:33, 150.91it/s]                                                     Converged after 21 iterations, error 1108.0
 50%|█████     | 5022/10000 [00:51<00:32, 150.91it/s] 60%|██████    | 6000/10000 [00:51<00:28, 142.35it/s]                                                     Converged after 17 iterations, error 1107.0
 60%|██████    | 6018/10000 [00:57<00:27, 142.35it/s] 70%|███████   | 7000/10000 [00:57<00:20, 147.49it/s] 70%|███████   | 7022/10000 [01:05<00:30, 97.06it/s]  70%|███████   | 7038/10000 [01:10<00:41, 71.21it/s] 70%|███████   | 7049/10000 [01:14<00:52, 56.69it/s]                                                    Converged after 54 iterations, error 1105.0
 71%|███████   | 7055/10000 [01:16<00:51, 56.69it/s] 80%|████████  | 8000/10000 [01:16<00:18, 110.15it/s] 80%|████████  | 8018/10000 [01:22<00:27, 71.53it/s]                                                     Converged after 17 iterations, error 1101.0
 80%|████████  | 8018/10000 [01:23<00:27, 71.53it/s] 90%|█████████ | 9000/10000 [01:23<00:06, 151.38it/s]                                                     Converged after 28 iterations, error 1104.0
 90%|█████████ | 9029/10000 [01:33<00:06, 151.38it/s]100%|██████████| 10000/10000 [01:33<00:00, 122.03it/s]quantized with best error tensor(1101., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:33<00:00, 106.94it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:20,  5.68it/s]  0%|          | 3/10000 [00:00<41:41,  4.00it/s]  0%|          | 4/10000 [00:01<48:01,  3.47it/s]  0%|          | 5/10000 [00:01<51:45,  3.22it/s]  0%|          | 6/10000 [00:01<54:11,  3.07it/s]  0%|          | 7/10000 [00:02<55:42,  2.99it/s]  0%|          | 8/10000 [00:02<56:25,  2.95it/s]  0%|          | 9/10000 [00:02<57:02,  2.92it/s]  0%|          | 10/10000 [00:03<57:25,  2.90it/s]  0%|          | 11/10000 [00:03<57:52,  2.88it/s]  0%|          | 12/10000 [00:03<58:08,  2.86it/s]  0%|          | 13/10000 [00:04<58:03,  2.87it/s]  0%|          | 14/10000 [00:04<58:24,  2.85it/s]  0%|          | 15/10000 [00:04<58:23,  2.85it/s]  0%|          | 16/10000 [00:05<58:35,  2.84it/s]  0%|          | 17/10000 [00:05<58:36,  2.84it/s]  0%|          | 18/10000 [00:05<58:29,  2.84it/s]  0%|          | 19/10000 [00:06<58:27,  2.85it/s]  0%|          | 20/10000 [00:06<58:28,  2.84it/s]                                                  Converged after 19 iterations, error 1136.0
  0%|          | 20/10000 [00:07<58:28,  2.84it/s] 10%|█         | 1000/10000 [00:07<00:10, 836.86it/s]                                                     Converged after 19 iterations, error 1131.0
 10%|█         | 1020/10000 [00:13<00:10, 836.86it/s] 20%|██        | 2000/10000 [00:13<00:36, 221.02it/s]                                                     Converged after 28 iterations, error 1143.0
 20%|██        | 2029/10000 [00:24<00:36, 221.02it/s] 30%|███       | 3000/10000 [00:24<00:49, 140.37it/s] 30%|███       | 3010/10000 [00:27<01:03, 109.47it/s]                                                     Converged after 21 iterations, error 1141.0
 30%|███       | 3022/10000 [00:31<01:03, 109.47it/s] 40%|████      | 4000/10000 [00:31<00:41, 143.50it/s]                                                     Converged after 16 iterations, error 1137.0
 40%|████      | 4017/10000 [00:37<00:41, 143.50it/s] 50%|█████     | 5000/10000 [00:37<00:32, 152.48it/s]                                                     Converged after 15 iterations, error 1142.0
 50%|█████     | 5016/10000 [00:43<00:32, 152.48it/s] 60%|██████    | 6000/10000 [00:43<00:24, 160.93it/s] 60%|██████    | 6028/10000 [00:52<00:43, 90.47it/s]                                                     Converged after 27 iterations, error 1134.0
 60%|██████    | 6028/10000 [00:53<00:43, 90.47it/s] 70%|███████   | 7000/10000 [00:53<00:19, 152.13it/s]                                                     Converged after 24 iterations, error 1133.0
 70%|███████   | 7025/10000 [01:02<00:19, 152.13it/s] 80%|████████  | 8000/10000 [01:02<00:14, 134.69it/s]                                                     Converged after 17 iterations, error 1133.0
 80%|████████  | 8018/10000 [01:08<00:14, 134.69it/s] 90%|█████████ | 9000/10000 [01:08<00:07, 142.04it/s]                                                     Converged after 25 iterations, error 1148.0
 90%|█████████ | 9026/10000 [01:17<00:06, 142.04it/s]100%|██████████| 10000/10000 [01:17<00:00, 129.23it/s]quantized with best error tensor(1131., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:17<00:00, 129.06it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:16,  5.69it/s]  0%|          | 3/10000 [00:00<41:22,  4.03it/s]  0%|          | 4/10000 [00:01<47:48,  3.49it/s]  0%|          | 5/10000 [00:01<51:28,  3.24it/s]  0%|          | 6/10000 [00:01<53:45,  3.10it/s]  0%|          | 7/10000 [00:02<55:09,  3.02it/s]  0%|          | 8/10000 [00:02<56:10,  2.96it/s]  0%|          | 9/10000 [00:02<56:41,  2.94it/s]  0%|          | 10/10000 [00:03<57:24,  2.90it/s]  0%|          | 11/10000 [00:03<57:37,  2.89it/s]  0%|          | 12/10000 [00:03<57:54,  2.87it/s]  0%|          | 13/10000 [00:04<57:56,  2.87it/s]  0%|          | 14/10000 [00:04<58:15,  2.86it/s]  0%|          | 15/10000 [00:04<58:08,  2.86it/s]  0%|          | 16/10000 [00:05<58:16,  2.86it/s]  0%|          | 17/10000 [00:05<58:14,  2.86it/s]  0%|          | 18/10000 [00:05<58:24,  2.85it/s]  0%|          | 19/10000 [00:06<58:27,  2.85it/s]  0%|          | 20/10000 [00:06<58:20,  2.85it/s]  0%|          | 21/10000 [00:07<58:12,  2.86it/s]  0%|          | 22/10000 [00:07<58:15,  2.85it/s]  0%|          | 23/10000 [00:07<58:13,  2.86it/s]  0%|          | 24/10000 [00:08<58:24,  2.85it/s]  0%|          | 25/10000 [00:08<58:25,  2.85it/s]  0%|          | 26/10000 [00:08<58:17,  2.85it/s]  0%|          | 27/10000 [00:09<58:22,  2.85it/s]  0%|          | 28/10000 [00:09<58:12,  2.86it/s]                                                  Converged after 27 iterations, error 1130.0
  0%|          | 28/10000 [00:09<58:12,  2.86it/s] 10%|█         | 1000/10000 [00:09<00:10, 834.02it/s]                                                     Converged after 24 iterations, error 1116.0
 10%|█         | 1025/10000 [00:18<00:10, 834.02it/s] 20%|██        | 2000/10000 [00:18<00:44, 180.51it/s]                                                     Converged after 25 iterations, error 1125.0
 20%|██        | 2026/10000 [00:27<00:44, 180.51it/s] 30%|███       | 3000/10000 [00:27<00:49, 141.50it/s]                                                     Converged after 25 iterations, error 1130.0
 30%|███       | 3026/10000 [00:36<00:49, 141.50it/s] 40%|████      | 4000/10000 [00:36<00:46, 128.57it/s]                                                     Converged after 18 iterations, error 1122.0
 40%|████      | 4019/10000 [00:42<00:46, 128.57it/s] 50%|█████     | 5000/10000 [00:42<00:36, 136.89it/s]                                                     Converged after 18 iterations, error 1118.0
 50%|█████     | 5019/10000 [00:49<00:36, 136.89it/s] 60%|██████    | 6000/10000 [00:49<00:28, 142.25it/s]                                                     Converged after 17 iterations, error 1113.0
 60%|██████    | 6018/10000 [00:55<00:27, 142.25it/s] 70%|███████   | 7000/10000 [00:55<00:20, 148.27it/s]                                                     Converged after 15 iterations, error 1116.0
 70%|███████   | 7016/10000 [01:00<00:20, 148.27it/s] 80%|████████  | 8000/10000 [01:00<00:12, 156.68it/s] 80%|████████  | 8022/10000 [01:08<00:19, 103.78it/s]                                                     Converged after 26 iterations, error 1109.0
 80%|████████  | 8027/10000 [01:10<00:19, 103.78it/s] 90%|█████████ | 9000/10000 [01:10<00:06, 148.24it/s]                                                     Converged after 21 iterations, error 1118.0
 90%|█████████ | 9022/10000 [01:17<00:06, 148.24it/s]100%|██████████| 10000/10000 [01:17<00:00, 142.51it/s]quantized with best error tensor(1109., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:17<00:00, 128.62it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:52,  5.98it/s]  0%|          | 3/10000 [00:00<40:36,  4.10it/s]  0%|          | 4/10000 [00:01<46:10,  3.61it/s]  0%|          | 5/10000 [00:01<50:22,  3.31it/s]  0%|          | 6/10000 [00:01<52:05,  3.20it/s]  0%|          | 7/10000 [00:02<54:09,  3.07it/s]  0%|          | 8/10000 [00:02<54:43,  3.04it/s]  0%|          | 9/10000 [00:02<55:53,  2.98it/s]  0%|          | 10/10000 [00:03<55:59,  2.97it/s]  0%|          | 11/10000 [00:03<56:38,  2.94it/s]  0%|          | 12/10000 [00:03<56:22,  2.95it/s]  0%|          | 13/10000 [00:04<56:55,  2.92it/s]  0%|          | 14/10000 [00:04<56:43,  2.93it/s]  0%|          | 15/10000 [00:04<57:16,  2.91it/s]  0%|          | 16/10000 [00:05<56:56,  2.92it/s]  0%|          | 17/10000 [00:05<57:30,  2.89it/s]  0%|          | 18/10000 [00:05<57:10,  2.91it/s]                                                  Converged after 17 iterations, error 1145.0
  0%|          | 18/10000 [00:06<57:10,  2.91it/s] 10%|█         | 1000/10000 [00:06<00:10, 856.30it/s]                                                     Converged after 19 iterations, error 1150.0
 10%|█         | 1020/10000 [00:12<00:10, 856.30it/s] 20%|██        | 2000/10000 [00:12<00:35, 222.30it/s]                                                     Converged after 21 iterations, error 1135.0
 20%|██        | 2022/10000 [00:20<00:35, 222.30it/s] 30%|███       | 3000/10000 [00:20<00:41, 170.62it/s]                                                     Converged after 21 iterations, error 1139.0
 30%|███       | 3022/10000 [00:27<00:40, 170.62it/s] 40%|████      | 4000/10000 [00:27<00:39, 153.24it/s]                                                     Converged after 25 iterations, error 1145.0
 40%|████      | 4026/10000 [00:36<00:38, 153.24it/s] 50%|█████     | 5000/10000 [00:36<00:36, 135.26it/s]                                                     Converged after 17 iterations, error 1148.0
 50%|█████     | 5018/10000 [00:43<00:36, 135.26it/s] 60%|██████    | 6000/10000 [00:43<00:27, 143.42it/s]                                                     Converged after 12 iterations, error 1144.0
 60%|██████    | 6013/10000 [00:47<00:27, 143.42it/s] 70%|███████   | 7000/10000 [00:47<00:18, 162.74it/s]                                                     Converged after 18 iterations, error 1140.0
 70%|███████   | 7019/10000 [00:54<00:18, 162.74it/s] 80%|████████  | 8000/10000 [00:54<00:12, 159.64it/s]                                                     Converged after 20 iterations, error 1149.0
 80%|████████  | 8021/10000 [01:01<00:12, 159.64it/s] 90%|█████████ | 9000/10000 [01:01<00:06, 152.56it/s] 90%|█████████ | 9020/10000 [01:07<00:09, 106.48it/s]                                                     Converged after 26 iterations, error 1142.0
 90%|█████████ | 9027/10000 [01:10<00:09, 106.48it/s]100%|██████████| 10000/10000 [01:10<00:00, 145.37it/s]quantized with best error tensor(1135., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:10<00:00, 141.77it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<27:56,  5.96it/s]  0%|          | 3/10000 [00:00<40:37,  4.10it/s]  0%|          | 4/10000 [00:01<46:07,  3.61it/s]  0%|          | 5/10000 [00:01<50:22,  3.31it/s]  0%|          | 6/10000 [00:01<52:14,  3.19it/s]  0%|          | 7/10000 [00:02<54:09,  3.07it/s]  0%|          | 8/10000 [00:02<54:42,  3.04it/s]  0%|          | 9/10000 [00:02<55:53,  2.98it/s]  0%|          | 10/10000 [00:03<55:48,  2.98it/s]  0%|          | 11/10000 [00:03<56:35,  2.94it/s]  0%|          | 12/10000 [00:03<56:11,  2.96it/s]  0%|          | 13/10000 [00:04<56:48,  2.93it/s]  0%|          | 14/10000 [00:04<56:33,  2.94it/s]  0%|          | 15/10000 [00:04<57:06,  2.91it/s]  0%|          | 16/10000 [00:05<56:56,  2.92it/s]  0%|          | 17/10000 [00:05<57:18,  2.90it/s]  0%|          | 18/10000 [00:05<56:59,  2.92it/s]  0%|          | 19/10000 [00:06<57:32,  2.89it/s]  0%|          | 20/10000 [00:06<57:24,  2.90it/s]  0%|          | 21/10000 [00:06<57:41,  2.88it/s]  0%|          | 22/10000 [00:07<57:04,  2.91it/s]                                                  Converged after 21 iterations, error 1163.0
  0%|          | 22/10000 [00:07<57:04,  2.91it/s] 10%|█         | 1000/10000 [00:07<00:10, 851.45it/s]                                                     Converged after 19 iterations, error 1170.0
 10%|█         | 1020/10000 [00:14<00:10, 851.45it/s] 20%|██        | 2000/10000 [00:14<00:36, 221.04it/s]                                                     Converged after 22 iterations, error 1151.0
 20%|██        | 2023/10000 [00:22<00:36, 221.04it/s] 30%|███       | 3000/10000 [00:22<00:42, 165.40it/s]                                                     Converged after 27 iterations, error 1156.0
 30%|███       | 3028/10000 [00:31<00:42, 165.40it/s] 40%|████      | 4000/10000 [00:31<00:44, 135.78it/s]                                                     Converged after 19 iterations, error 1160.0
 40%|████      | 4020/10000 [00:38<00:44, 135.78it/s] 50%|█████     | 5000/10000 [00:38<00:35, 140.50it/s]                                                     Converged after 12 iterations, error 1160.0
 50%|█████     | 5013/10000 [00:42<00:35, 140.50it/s] 60%|██████    | 6000/10000 [00:42<00:24, 161.76it/s]                                                     Converged after 15 iterations, error 1168.0
 60%|██████    | 6016/10000 [00:47<00:24, 161.76it/s] 70%|███████   | 7000/10000 [00:47<00:17, 169.26it/s] 70%|███████   | 7026/10000 [00:56<00:28, 103.17it/s]                                                     Converged after 27 iterations, error 1165.0
 70%|███████   | 7028/10000 [00:57<00:28, 103.17it/s] 80%|████████  | 8000/10000 [00:57<00:12, 158.71it/s]                                                     Converged after 27 iterations, error 1160.0
 80%|████████  | 8028/10000 [01:06<00:12, 158.71it/s] 90%|█████████ | 9000/10000 [01:06<00:07, 134.99it/s] 90%|█████████ | 9033/10000 [01:17<00:12, 78.38it/s]  90%|█████████ | 9034/10000 [01:17<00:12, 76.95it/s]                                                    Converged after 33 iterations, error 1162.0
 90%|█████████ | 9034/10000 [01:18<00:12, 76.95it/s]100%|██████████| 10000/10000 [01:18<00:00, 150.59it/s]quantized with best error tensor(1151., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:18<00:00, 128.14it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<28:06,  5.93it/s]  0%|          | 3/10000 [00:00<39:40,  4.20it/s]  0%|          | 4/10000 [00:01<45:34,  3.66it/s]  0%|          | 5/10000 [00:01<49:03,  3.40it/s]  0%|          | 6/10000 [00:01<51:27,  3.24it/s]  0%|          | 7/10000 [00:02<52:54,  3.15it/s]  0%|          | 8/10000 [00:02<53:56,  3.09it/s]  0%|          | 9/10000 [00:02<54:25,  3.06it/s]  0%|          | 10/10000 [00:03<54:52,  3.03it/s]  0%|          | 11/10000 [00:03<55:09,  3.02it/s]  0%|          | 12/10000 [00:03<55:21,  3.01it/s]  0%|          | 13/10000 [00:04<55:14,  3.01it/s]  0%|          | 14/10000 [00:04<55:40,  2.99it/s]  0%|          | 15/10000 [00:04<55:29,  3.00it/s]  0%|          | 16/10000 [00:05<55:29,  3.00it/s]  0%|          | 17/10000 [00:05<55:36,  2.99it/s]                                                  Converged after 16 iterations, error 1207.0
  0%|          | 17/10000 [00:05<55:36,  2.99it/s] 10%|█         | 1000/10000 [00:05<00:10, 885.63it/s]                                                     Converged after 20 iterations, error 1218.0
 10%|█         | 1021/10000 [00:12<00:10, 885.63it/s] 20%|██        | 2000/10000 [00:12<00:38, 210.28it/s]                                                     Converged after 18 iterations, error 1212.0
 20%|██        | 2019/10000 [00:19<00:37, 210.28it/s] 30%|███       | 3000/10000 [00:19<00:38, 179.55it/s]                                                     Converged after 27 iterations, error 1208.0
 30%|███       | 3028/10000 [00:29<00:38, 179.55it/s] 40%|████      | 4000/10000 [00:29<00:43, 139.12it/s]                                                     Converged after 18 iterations, error 1212.0
 40%|████      | 4019/10000 [00:35<00:42, 139.12it/s] 50%|█████     | 5000/10000 [00:35<00:34, 143.76it/s]                                                     Converged after 24 iterations, error 1211.0
 50%|█████     | 5025/10000 [00:44<00:34, 143.76it/s] 60%|██████    | 6000/10000 [00:44<00:30, 133.01it/s]                                                     Converged after 21 iterations, error 1215.0
 60%|██████    | 6022/10000 [00:51<00:29, 133.01it/s] 70%|███████   | 7000/10000 [00:51<00:22, 132.71it/s]                                                     Converged after 15 iterations, error 1215.0
 70%|███████   | 7016/10000 [00:57<00:22, 132.71it/s] 80%|████████  | 8000/10000 [00:57<00:13, 145.29it/s]                                                     Converged after 19 iterations, error 1211.0
 80%|████████  | 8020/10000 [01:04<00:13, 145.29it/s] 90%|█████████ | 9000/10000 [01:04<00:06, 145.32it/s] 90%|█████████ | 9019/10000 [01:10<00:09, 104.55it/s]                                                     Converged after 19 iterations, error 1207.0
 90%|█████████ | 9020/10000 [01:11<00:09, 104.55it/s]100%|██████████| 10000/10000 [01:11<00:00, 162.07it/s]quantized with best error tensor(1207., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:11<00:00, 140.62it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:23,  5.67it/s]  0%|          | 3/10000 [00:00<41:02,  4.06it/s]  0%|          | 4/10000 [00:01<47:24,  3.51it/s]  0%|          | 5/10000 [00:01<50:16,  3.31it/s]  0%|          | 6/10000 [00:01<53:06,  3.14it/s]  0%|          | 7/10000 [00:02<53:46,  3.10it/s]  0%|          | 8/10000 [00:02<55:15,  3.01it/s]  0%|          | 9/10000 [00:02<55:21,  3.01it/s]  0%|          | 10/10000 [00:03<56:18,  2.96it/s]  0%|          | 11/10000 [00:03<55:48,  2.98it/s]  0%|          | 12/10000 [00:03<56:36,  2.94it/s]  0%|          | 13/10000 [00:04<56:15,  2.96it/s]  0%|          | 14/10000 [00:04<56:53,  2.93it/s]  0%|          | 15/10000 [00:04<56:25,  2.95it/s]  0%|          | 16/10000 [00:05<57:04,  2.92it/s]  0%|          | 17/10000 [00:05<56:30,  2.94it/s]  0%|          | 18/10000 [00:05<57:03,  2.92it/s]  0%|          | 19/10000 [00:06<56:33,  2.94it/s]  0%|          | 20/10000 [00:06<57:01,  2.92it/s]  0%|          | 21/10000 [00:06<56:41,  2.93it/s]  0%|          | 22/10000 [00:07<57:11,  2.91it/s]  0%|          | 23/10000 [00:07<57:10,  2.91it/s]  0%|          | 24/10000 [00:07<57:31,  2.89it/s]  0%|          | 25/10000 [00:08<57:32,  2.89it/s]                                                  Converged after 24 iterations, error 1205.0
  0%|          | 25/10000 [00:08<57:32,  2.89it/s] 10%|█         | 1000/10000 [00:08<00:10, 842.40it/s]                                                     Converged after 16 iterations, error 1195.0
 10%|█         | 1017/10000 [00:14<00:10, 842.40it/s] 20%|██        | 2000/10000 [00:14<00:32, 247.53it/s]                                                     Converged after 27 iterations, error 1204.0
 20%|██        | 2028/10000 [00:24<00:32, 247.53it/s] 30%|███       | 3000/10000 [00:24<00:46, 152.02it/s]                                                     Converged after 21 iterations, error 1194.0
 30%|███       | 3022/10000 [00:31<00:45, 152.02it/s] 40%|████      | 4000/10000 [00:31<00:41, 143.70it/s]                                                     Converged after 22 iterations, error 1203.0
 40%|████      | 4023/10000 [00:39<00:41, 143.70it/s] 50%|█████     | 5000/10000 [00:39<00:36, 137.08it/s]                                                     Converged after 28 iterations, error 1200.0
 50%|█████     | 5029/10000 [00:49<00:36, 137.08it/s] 60%|██████    | 6000/10000 [00:49<00:32, 122.15it/s]                                                     Converged after 14 iterations, error 1201.0
 60%|██████    | 6015/10000 [00:54<00:32, 122.15it/s] 70%|███████   | 7000/10000 [00:54<00:21, 139.09it/s] 70%|███████   | 7023/10000 [01:02<00:31, 94.36it/s]                                                     Converged after 27 iterations, error 1208.0
 70%|███████   | 7028/10000 [01:04<00:31, 94.36it/s] 80%|████████  | 8000/10000 [01:04<00:14, 137.73it/s]                                                     Converged after 17 iterations, error 1202.0
 80%|████████  | 8018/10000 [01:10<00:14, 137.73it/s] 90%|█████████ | 9000/10000 [01:10<00:06, 145.82it/s]                                                     Converged after 16 iterations, error 1196.0
 90%|█████████ | 9017/10000 [01:16<00:06, 145.82it/s]100%|██████████| 10000/10000 [01:16<00:00, 153.88it/s]quantized with best error tensor(1194., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:16<00:00, 131.26it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:24,  5.67it/s]  0%|          | 3/10000 [00:00<40:14,  4.14it/s]  0%|          | 4/10000 [00:01<47:07,  3.54it/s]  0%|          | 5/10000 [00:01<49:57,  3.33it/s]  0%|          | 6/10000 [00:01<52:55,  3.15it/s]  0%|          | 7/10000 [00:02<53:52,  3.09it/s]  0%|          | 8/10000 [00:02<55:13,  3.02it/s]  0%|          | 9/10000 [00:02<55:06,  3.02it/s]  0%|          | 10/10000 [00:03<56:09,  2.96it/s]  0%|          | 11/10000 [00:03<56:26,  2.95it/s]  0%|          | 12/10000 [00:03<57:02,  2.92it/s]  0%|          | 13/10000 [00:04<56:37,  2.94it/s]  0%|          | 14/10000 [00:04<57:10,  2.91it/s]  0%|          | 15/10000 [00:04<56:30,  2.94it/s]  0%|          | 16/10000 [00:05<57:04,  2.92it/s]  0%|          | 17/10000 [00:05<56:23,  2.95it/s]  0%|          | 18/10000 [00:05<57:12,  2.91it/s]  0%|          | 19/10000 [00:06<56:38,  2.94it/s]  0%|          | 20/10000 [00:06<57:12,  2.91it/s]  0%|          | 21/10000 [00:06<56:31,  2.94it/s]  0%|          | 22/10000 [00:07<57:00,  2.92it/s]  0%|          | 23/10000 [00:07<56:33,  2.94it/s]  0%|          | 24/10000 [00:07<57:14,  2.90it/s]  0%|          | 25/10000 [00:08<56:46,  2.93it/s]                                                  Converged after 24 iterations, error 1161.0
  0%|          | 25/10000 [00:08<56:46,  2.93it/s] 10%|█         | 1000/10000 [00:08<00:10, 849.66it/s]                                                     Converged after 26 iterations, error 1168.0
 10%|█         | 1027/10000 [00:18<00:10, 849.66it/s] 20%|██        | 2000/10000 [00:18<00:48, 163.92it/s]                                                     Converged after 16 iterations, error 1167.0
 20%|██        | 2017/10000 [00:24<00:48, 163.92it/s] 30%|███       | 3000/10000 [00:24<00:42, 165.52it/s]                                                     Converged after 19 iterations, error 1167.0
 30%|███       | 3020/10000 [00:31<00:42, 165.52it/s] 40%|████      | 4000/10000 [00:31<00:38, 155.53it/s] 40%|████      | 4035/10000 [00:43<00:38, 155.53it/s] 40%|████      | 4036/10000 [00:43<01:18, 76.17it/s]  40%|████      | 4037/10000 [00:43<01:19, 74.65it/s]                                                    Converged after 38 iterations, error 1176.0
 40%|████      | 4039/10000 [00:44<01:19, 74.65it/s] 50%|█████     | 5000/10000 [00:44<00:34, 143.20it/s]                                                     Converged after 22 iterations, error 1169.0
 50%|█████     | 5023/10000 [00:52<00:34, 143.20it/s] 60%|██████    | 6000/10000 [00:52<00:29, 134.07it/s] 60%|██████    | 6030/10000 [01:03<00:29, 134.07it/s] 60%|██████    | 6031/10000 [01:03<00:54, 72.69it/s]                                                     Converged after 30 iterations, error 1167.0
 60%|██████    | 6031/10000 [01:03<00:54, 72.69it/s] 70%|███████   | 7000/10000 [01:03<00:22, 131.27it/s]                                                     Converged after 17 iterations, error 1174.0
 70%|███████   | 7018/10000 [01:10<00:22, 131.27it/s] 80%|████████  | 8000/10000 [01:10<00:14, 140.80it/s]                                                     Converged after 20 iterations, error 1177.0
 80%|████████  | 8021/10000 [01:17<00:14, 140.80it/s] 90%|█████████ | 9000/10000 [01:17<00:07, 138.70it/s]                                                     Converged after 26 iterations, error 1166.0
 90%|█████████ | 9027/10000 [01:26<00:07, 138.70it/s]100%|██████████| 10000/10000 [01:26<00:00, 125.12it/s]quantized with best error tensor(1161., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:26<00:00, 115.01it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:34,  5.63it/s]  0%|          | 3/10000 [00:00<41:29,  4.02it/s]  0%|          | 4/10000 [00:01<47:51,  3.48it/s]  0%|          | 5/10000 [00:01<51:27,  3.24it/s]  0%|          | 6/10000 [00:01<54:01,  3.08it/s]  0%|          | 7/10000 [00:02<55:30,  3.00it/s]  0%|          | 8/10000 [00:02<56:21,  2.96it/s]  0%|          | 9/10000 [00:02<56:52,  2.93it/s]  0%|          | 10/10000 [00:03<57:37,  2.89it/s]  0%|          | 11/10000 [00:03<57:56,  2.87it/s]  0%|          | 12/10000 [00:03<58:11,  2.86it/s]  0%|          | 13/10000 [00:04<58:02,  2.87it/s]  0%|          | 14/10000 [00:04<58:07,  2.86it/s]  0%|          | 15/10000 [00:04<58:12,  2.86it/s]  0%|          | 16/10000 [00:05<58:17,  2.85it/s]                                                  Converged after 15 iterations, error 1186.0
  0%|          | 16/10000 [00:05<58:17,  2.85it/s] 10%|█         | 1000/10000 [00:05<00:10, 846.64it/s]                                                     Converged after 16 iterations, error 1180.0
 10%|█         | 1017/10000 [00:11<00:10, 846.64it/s] 20%|██        | 2000/10000 [00:11<00:32, 249.13it/s]                                                     Converged after 18 iterations, error 1175.0
 20%|██        | 2019/10000 [00:18<00:32, 249.13it/s] 30%|███       | 3000/10000 [00:18<00:36, 191.12it/s]                                                     Converged after 24 iterations, error 1175.0
 30%|███       | 3025/10000 [00:27<00:36, 191.12it/s] 40%|████      | 4000/10000 [00:27<00:39, 150.99it/s]                                                     Converged after 24 iterations, error 1178.0
 40%|████      | 4025/10000 [00:35<00:39, 150.99it/s] 50%|█████     | 5000/10000 [00:35<00:36, 135.21it/s]                                                     Converged after 27 iterations, error 1189.0
 50%|█████     | 5028/10000 [00:45<00:36, 135.21it/s] 60%|██████    | 6000/10000 [00:45<00:32, 121.71it/s]                                                     Converged after 22 iterations, error 1176.0
 60%|██████    | 6023/10000 [00:53<00:32, 121.71it/s] 70%|███████   | 7000/10000 [00:53<00:24, 122.53it/s]                                                     Converged after 17 iterations, error 1180.0
 70%|███████   | 7018/10000 [00:59<00:24, 122.53it/s] 80%|████████  | 8000/10000 [00:59<00:15, 132.08it/s]                                                     Converged after 15 iterations, error 1171.0
 80%|████████  | 8016/10000 [01:05<00:15, 132.08it/s] 90%|█████████ | 9000/10000 [01:05<00:06, 143.70it/s] 90%|█████████ | 9019/10000 [01:11<00:09, 103.04it/s]                                                     Converged after 22 iterations, error 1178.0
 90%|█████████ | 9023/10000 [01:13<00:09, 103.04it/s]100%|██████████| 10000/10000 [01:13<00:00, 149.84it/s]quantized with best error tensor(1171., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:13<00:00, 135.79it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<29:17,  5.69it/s]  0%|          | 3/10000 [00:00<41:14,  4.04it/s]  0%|          | 4/10000 [00:01<47:45,  3.49it/s]  0%|          | 5/10000 [00:01<51:24,  3.24it/s]  0%|          | 6/10000 [00:01<53:47,  3.10it/s]  0%|          | 7/10000 [00:02<55:14,  3.02it/s]  0%|          | 8/10000 [00:02<56:25,  2.95it/s]  0%|          | 9/10000 [00:02<57:04,  2.92it/s]  0%|          | 10/10000 [00:03<57:28,  2.90it/s]  0%|          | 11/10000 [00:03<57:31,  2.89it/s]  0%|          | 12/10000 [00:03<57:47,  2.88it/s]  0%|          | 13/10000 [00:04<57:52,  2.88it/s]  0%|          | 14/10000 [00:04<58:09,  2.86it/s]  0%|          | 15/10000 [00:04<58:06,  2.86it/s]                                                  Converged after 14 iterations, error 1140.0
  0%|          | 15/10000 [00:05<58:06,  2.86it/s] 10%|█         | 1000/10000 [00:05<00:10, 847.56it/s]                                                     Converged after 37 iterations, error 1169.0
 10%|█         | 1038/10000 [00:18<00:10, 847.56it/s] 20%|██        | 2000/10000 [00:18<01:05, 122.59it/s] 20%|██        | 2008/10000 [00:20<01:20, 99.06it/s]                                                     Converged after 20 iterations, error 1157.0
 20%|██        | 2021/10000 [00:25<01:20, 99.06it/s] 30%|███       | 3000/10000 [00:25<00:50, 138.44it/s]                                                     Converged after 15 iterations, error 1149.0
 30%|███       | 3016/10000 [00:30<00:50, 138.44it/s] 40%|████      | 4000/10000 [00:30<00:38, 154.83it/s]                                                     Converged after 18 iterations, error 1155.0
 40%|████      | 4019/10000 [00:37<00:38, 154.83it/s] 50%|█████     | 5000/10000 [00:37<00:32, 154.64it/s]                                                     Converged after 23 iterations, error 1144.0
 50%|█████     | 5024/10000 [00:45<00:32, 154.64it/s] 60%|██████    | 6000/10000 [00:45<00:28, 141.22it/s]                                                     Converged after 24 iterations, error 1149.0
 60%|██████    | 6025/10000 [00:54<00:28, 141.22it/s] 70%|███████   | 7000/10000 [00:54<00:22, 132.18it/s]                                                     Converged after 17 iterations, error 1165.0
 70%|███████   | 7018/10000 [01:00<00:22, 132.18it/s] 80%|████████  | 8000/10000 [01:00<00:14, 140.60it/s] 80%|████████  | 8020/10000 [01:06<00:19, 99.62it/s]                                                     Converged after 21 iterations, error 1153.0
 80%|████████  | 8022/10000 [01:07<00:19, 99.62it/s] 90%|█████████ | 9000/10000 [01:07<00:06, 153.53it/s]                                                     Converged after 24 iterations, error 1152.0
 90%|█████████ | 9025/10000 [01:16<00:06, 153.53it/s]100%|██████████| 10000/10000 [01:16<00:00, 137.66it/s]quantized with best error tensor(1140., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:16<00:00, 131.00it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
  0%|          | 0/10000 [00:00<?, ?it/s]  0%|          | 2/10000 [00:00<28:19,  5.88it/s]  0%|          | 3/10000 [00:00<40:41,  4.10it/s]  0%|          | 4/10000 [00:01<46:10,  3.61it/s]  0%|          | 5/10000 [00:01<50:14,  3.32it/s]  0%|          | 6/10000 [00:01<52:11,  3.19it/s]  0%|          | 7/10000 [00:02<54:03,  3.08it/s]  0%|          | 8/10000 [00:02<54:54,  3.03it/s]  0%|          | 9/10000 [00:02<55:51,  2.98it/s]  0%|          | 10/10000 [00:03<55:58,  2.97it/s]  0%|          | 11/10000 [00:03<56:49,  2.93it/s]  0%|          | 12/10000 [00:03<56:44,  2.93it/s]  0%|          | 13/10000 [00:04<57:24,  2.90it/s]  0%|          | 14/10000 [00:04<56:56,  2.92it/s]  0%|          | 15/10000 [00:04<57:08,  2.91it/s]  0%|          | 16/10000 [00:05<56:34,  2.94it/s]  0%|          | 17/10000 [00:05<56:57,  2.92it/s]  0%|          | 18/10000 [00:05<56:36,  2.94it/s]  0%|          | 19/10000 [00:06<56:59,  2.92it/s]  0%|          | 20/10000 [00:06<56:47,  2.93it/s]  0%|          | 21/10000 [00:06<57:11,  2.91it/s]  0%|          | 22/10000 [00:07<56:57,  2.92it/s]  0%|          | 23/10000 [00:07<57:31,  2.89it/s]  0%|          | 24/10000 [00:07<57:11,  2.91it/s]                                                  Converged after 23 iterations, error 972.0
  0%|          | 24/10000 [00:08<57:11,  2.91it/s] 10%|█         | 1000/10000 [00:08<00:10, 846.27it/s]                                                     Converged after 37 iterations, error 979.0
 10%|█         | 1038/10000 [00:21<00:10, 846.27it/s] 20%|██        | 2000/10000 [00:21<01:04, 123.11it/s] 20%|██        | 2008/10000 [00:23<01:20, 99.33it/s]                                                     Converged after 19 iterations, error 969.0
 20%|██        | 2020/10000 [00:27<01:20, 99.33it/s] 30%|███       | 3000/10000 [00:27<00:49, 142.46it/s]                                                     Converged after 21 iterations, error 964.0
 30%|███       | 3022/10000 [00:35<00:48, 142.46it/s] 40%|████      | 4000/10000 [00:35<00:43, 138.27it/s] 40%|████      | 4033/10000 [00:46<00:43, 138.27it/s] 40%|████      | 4034/10000 [00:46<01:23, 71.51it/s]                                                     Converged after 33 iterations, error 968.0
 40%|████      | 4034/10000 [00:47<01:23, 71.51it/s] 50%|█████     | 5000/10000 [00:47<00:38, 129.32it/s]                                                     Converged after 19 iterations, error 968.5
 50%|█████     | 5020/10000 [00:53<00:38, 129.32it/s] 60%|██████    | 6000/10000 [00:53<00:29, 135.99it/s]                                                     Converged after 17 iterations, error 974.0
 60%|██████    | 6018/10000 [00:59<00:29, 135.99it/s] 70%|███████   | 7000/10000 [00:59<00:20, 144.85it/s]                                                     Converged after 19 iterations, error 966.0
 70%|███████   | 7020/10000 [01:06<00:20, 144.85it/s] 80%|████████  | 8000/10000 [01:06<00:13, 145.57it/s]                                                     Converged after 26 iterations, error 966.0
 80%|████████  | 8027/10000 [01:15<00:13, 145.57it/s] 90%|█████████ | 9000/10000 [01:15<00:07, 131.06it/s]                                                     Converged after 16 iterations, error 969.0
 90%|█████████ | 9017/10000 [01:21<00:07, 131.06it/s]100%|██████████| 10000/10000 [01:21<00:00, 141.93it/s]quantized with best error tensor(964., device='cuda:0', dtype=torch.float16)
100%|██████████| 10000/10000 [01:21<00:00, 122.37it/s]
self.bias None
self.bias None
quantized, to self.quantized_vectors and self.assignments
2713.5824887752533
/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Token indices sequence length is longer than the specified maximum sequence length for this model (2824491 > 2048). Running this sequence through the model will result in indexing errors
Dataset: wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
Traceback (most recent call last):
  File "/home/lliu/huffman/llama.py", line 373, in <module>
    llama_eval(model, testloader, args.device, dataset, args.log_wandb)
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/huffman/llama.py", line 243, in llama_eval
    outs[j] = layer(inps[j].unsqueeze(0), attention_mask=attention_mask)[0]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 413, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
                                                          ^^^^^^^^^^^^^^^
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/transformers/models/llama/modeling_llama.py", line 311, in forward
    key_states = self.k_proj(hidden_states)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/anaconda3/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lliu/huffman/vector_quantizer.py", line 194, in forward
    x = F.linear(x, self.original_weights, self.b)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
