/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.16it/s]
Model loaded. LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 4096, padding_idx=0)
    (layers): ModuleList(
      (0-31): 32 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
          (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=4096, out_features=32000, bias=False)
)
Loading tokenizer for huggyllama/llama-7b
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. If you see this, DO NOT PANIC! This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=True`. This should only be set if you understand what it means, and thouroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Token indices sequence length is longer than the specified maximum sequence length for this model (2824491 > 2048). Running this sequence through the model will result in indexing errors
Starting...
Ready.
0 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.387540340423584 s
stopped after 9 iterations
19.717 s H_error tensor(1.7372, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3426, device='cuda:6', grad_fn=<DivBackward0>)
43351 MiB free out of 48676 MiB total
0 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.916098833084106 s
stopped after 9 iterations
18.221 s H_error tensor(1.6683, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3375, device='cuda:6', grad_fn=<DivBackward0>)
43351 MiB free out of 48676 MiB total
0 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.894613027572632 s
stopped after 9 iterations
18.193 s H_error tensor(0.2042, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3340, device='cuda:6', grad_fn=<DivBackward0>)
43415 MiB free out of 48676 MiB total
0 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.95506739616394 s
stopped after 9 iterations
18.247 s H_error tensor(0.0171, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3352, device='cuda:6', grad_fn=<DivBackward0>)
43447 MiB free out of 48676 MiB total
0 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.10049653053284 s
stopped after 9 iterations
46.03 s H_error tensor(2.4270, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3198, device='cuda:6', grad_fn=<DivBackward0>)
43391 MiB free out of 48676 MiB total
0 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.06506896018982 s
stopped after 9 iterations
45.989 s H_error tensor(2.2916, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3197, device='cuda:6', grad_fn=<DivBackward0>)
43337 MiB free out of 48676 MiB total
0 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.48906850814819 s
stopped after 9 iterations
46.92 s H_error tensor(0.0239, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3276, device='cuda:6', grad_fn=<DivBackward0>)
43311 MiB free out of 48676 MiB total
1 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.742485284805298 s
stopped after 9 iterations
19.038 s H_error tensor(10.0939, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3372, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
1 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.99053144454956 s
stopped after 9 iterations
18.288 s H_error tensor(10.5547, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3372, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
1 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.040955781936646 s
stopped after 9 iterations
18.34 s H_error tensor(0.9322, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3337, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
1 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.98144507408142 s
stopped after 9 iterations
18.279 s H_error tensor(0.1004, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3208, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
1 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.17950224876404 s
stopped after 9 iterations
46.097 s H_error tensor(9.5911, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3129, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
1 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.161659955978394 s
stopped after 9 iterations
46.084 s H_error tensor(8.6510, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3140, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
1 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.180840492248535 s
stopped after 9 iterations
46.612 s H_error tensor(0.0948, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3177, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
2 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.684215307235718 s
stopped after 9 iterations
18.98 s H_error tensor(20.6886, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3256, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
2 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.916170120239258 s
stopped after 9 iterations
18.201 s H_error tensor(22.6869, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3271, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
2 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.10749864578247 s
stopped after 9 iterations
18.407 s H_error tensor(2.6608, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3201, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
2 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.911507606506348 s
stopped after 9 iterations
18.207 s H_error tensor(0.2293, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3142, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
2 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.02452373504639 s
stopped after 9 iterations
45.947 s H_error tensor(20.8330, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3114, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
2 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.95997405052185 s
stopped after 9 iterations
45.869 s H_error tensor(17.2651, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3121, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
2 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 44.943482875823975 s
stopped after 9 iterations
46.383 s H_error tensor(0.2320, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3153, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
3 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.67518639564514 s
stopped after 9 iterations
18.963 s H_error tensor(42.2948, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3245, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
3 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.88875913619995 s
stopped after 9 iterations
18.182 s H_error tensor(51.9158, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3251, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
3 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.04291582107544 s
stopped after 9 iterations
18.338 s H_error tensor(11.7301, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3186, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
3 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.918941974639893 s
stopped after 9 iterations
18.214 s H_error tensor(0.2182, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3135, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
3 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.130170822143555 s
stopped after 9 iterations
46.048 s H_error tensor(30.7758, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3104, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
3 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.14141225814819 s
stopped after 9 iterations
46.066 s H_error tensor(25.9401, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3109, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
3 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.04435443878174 s
stopped after 9 iterations
46.476 s H_error tensor(0.3388, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3124, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
4 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.669113159179688 s
stopped after 9 iterations
18.963 s H_error tensor(66.3199, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3235, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
4 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.965389490127563 s
stopped after 9 iterations
18.267 s H_error tensor(70.3590, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3244, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
4 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.105575799942017 s
stopped after 9 iterations
18.4 s H_error tensor(18.0345, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3180, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
4 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.225022077560425 s
stopped after 9 iterations
18.523 s H_error tensor(0.5099, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3110, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
4 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.22840452194214 s
stopped after 9 iterations
46.136 s H_error tensor(43.0601, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3110, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
4 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.07001876831055 s
stopped after 9 iterations
45.985 s H_error tensor(35.5688, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3108, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
4 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.258840560913086 s
stopped after 9 iterations
46.691 s H_error tensor(0.5645, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3141, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
5 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.793893337249756 s
stopped after 9 iterations
19.088 s H_error tensor(95.3394, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3234, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
5 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.031763076782227 s
stopped after 9 iterations
18.33 s H_error tensor(99.1347, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3244, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
5 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.148486852645874 s
stopped after 9 iterations
18.447 s H_error tensor(29.3523, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3165, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
5 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.075448036193848 s
stopped after 9 iterations
18.37 s H_error tensor(0.8019, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3113, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
5 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.571563959121704 s
stopped after 9 iterations
46.493 s H_error tensor(59.7919, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3106, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
5 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.571861028671265 s
stopped after 9 iterations
46.487 s H_error tensor(46.8637, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3102, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
5 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.345481634140015 s
stopped after 9 iterations
46.777 s H_error tensor(0.9297, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3151, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
6 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.7502658367157 s
stopped after 9 iterations
19.044 s H_error tensor(102.1953, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3230, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
6 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.068084478378296 s
stopped after 9 iterations
18.366 s H_error tensor(107.6709, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3232, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
6 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.15468454360962 s
stopped after 9 iterations
18.453 s H_error tensor(31.3071, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3165, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
6 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.03749942779541 s
stopped after 9 iterations
18.333 s H_error tensor(1.2034, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3122, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
6 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.20242524147034 s
stopped after 9 iterations
46.115 s H_error tensor(67.0576, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3115, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
6 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.34797930717468 s
stopped after 9 iterations
46.268 s H_error tensor(55.5733, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3110, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
6 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.23888897895813 s
stopped after 9 iterations
46.68 s H_error tensor(1.2586, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3158, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
7 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.85206961631775 s
stopped after 9 iterations
19.15 s H_error tensor(105.2212, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3219, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
7 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.993640422821045 s
stopped after 9 iterations
18.291 s H_error tensor(106.8281, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3246, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
7 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.207284927368164 s
stopped after 9 iterations
18.502 s H_error tensor(34.7793, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3175, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
7 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.052717447280884 s
stopped after 9 iterations
18.351 s H_error tensor(2.2393, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3108, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
7 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.31417775154114 s
stopped after 9 iterations
46.245 s H_error tensor(70.1907, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3122, device='cuda:6', grad_fn=<DivBackward0>)
42995 MiB free out of 48676 MiB total
7 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.42731547355652 s
stopped after 9 iterations
46.343 s H_error tensor(59.7943, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3121, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
7 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.39770269393921 s
stopped after 9 iterations
46.851 s H_error tensor(1.6015, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3172, device='cuda:6', grad_fn=<DivBackward0>)
43087 MiB free out of 48676 MiB total
8 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.745419025421143 s
stopped after 9 iterations
19.039 s H_error tensor(114.4953, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3213, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
8 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.249452829360962 s
stopped after 9 iterations
18.547 s H_error tensor(117.8082, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3232, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
8 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.11026096343994 s
stopped after 9 iterations
18.409 s H_error tensor(40.1200, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3176, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
8 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.945486068725586 s
stopped after 9 iterations
18.239 s H_error tensor(3.5216, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3110, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
8 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.336549520492554 s
stopped after 9 iterations
46.274 s H_error tensor(74.7389, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3121, device='cuda:6', grad_fn=<DivBackward0>)
42995 MiB free out of 48676 MiB total
8 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.23217844963074 s
stopped after 9 iterations
46.14 s H_error tensor(63.8871, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3117, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
8 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.276110887527466 s
stopped after 9 iterations
46.723 s H_error tensor(1.9056, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3153, device='cuda:6', grad_fn=<DivBackward0>)
43087 MiB free out of 48676 MiB total
9 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.7879319190979 s
stopped after 9 iterations
19.087 s H_error tensor(123.9764, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3203, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
9 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.15103769302368 s
stopped after 9 iterations
18.452 s H_error tensor(123.6188, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3231, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
9 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.02963614463806 s
stopped after 9 iterations
18.325 s H_error tensor(44.1626, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3175, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
9 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.038130521774292 s
stopped after 9 iterations
18.333 s H_error tensor(4.3778, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3106, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
9 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.56142258644104 s
stopped after 9 iterations
46.479 s H_error tensor(78.8733, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3117, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
9 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.60434103012085 s
stopped after 9 iterations
46.514 s H_error tensor(70.8781, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3126, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
9 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.342560052871704 s
stopped after 9 iterations
46.769 s H_error tensor(2.3315, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3155, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
10 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.6837158203125 s
stopped after 9 iterations
18.977 s H_error tensor(128.1904, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3219, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
10 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.029781818389893 s
stopped after 9 iterations
18.321 s H_error tensor(132.9897, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3230, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
10 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.0487961769104 s
stopped after 9 iterations
18.344 s H_error tensor(50.4042, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3167, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
10 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.004291534423828 s
stopped after 9 iterations
18.294 s H_error tensor(6.2806, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3096, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
10 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.49631667137146 s
stopped after 9 iterations
46.41 s H_error tensor(84.3060, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3117, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
10 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.40834879875183 s
stopped after 9 iterations
46.331 s H_error tensor(78.6152, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3117, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
10 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.83424520492554 s
stopped after 9 iterations
47.27 s H_error tensor(2.8649, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
11 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.761512994766235 s
stopped after 9 iterations
19.053 s H_error tensor(113.4408, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3218, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
11 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.199232816696167 s
stopped after 9 iterations
18.504 s H_error tensor(118.6325, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3223, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
11 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.01774024963379 s
stopped after 9 iterations
18.316 s H_error tensor(46.1641, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3158, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
11 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.067301034927368 s
stopped after 9 iterations
18.359 s H_error tensor(7.9778, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3078, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
11 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.25231051445007 s
stopped after 9 iterations
46.162 s H_error tensor(88.7240, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3118, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
11 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.20122218132019 s
stopped after 9 iterations
46.131 s H_error tensor(84.2723, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3126, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
11 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.140724658966064 s
stopped after 9 iterations
46.562 s H_error tensor(3.5927, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
12 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.735551118850708 s
stopped after 9 iterations
19.026 s H_error tensor(139.9837, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3185, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
12 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.14601182937622 s
stopped after 9 iterations
18.447 s H_error tensor(153.9224, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
12 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.996613025665283 s
stopped after 9 iterations
18.292 s H_error tensor(59.0057, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3137, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
12 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.054566860198975 s
stopped after 9 iterations
18.349 s H_error tensor(10.1618, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3077, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
12 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.41514801979065 s
stopped after 9 iterations
46.326 s H_error tensor(103.3915, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3115, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
12 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.15614414215088 s
stopped after 9 iterations
46.067 s H_error tensor(97.8848, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3112, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
12 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.09667110443115 s
stopped after 9 iterations
46.532 s H_error tensor(4.4699, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
13 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.69890260696411 s
stopped after 9 iterations
18.99 s H_error tensor(146.9509, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3178, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
13 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.191420793533325 s
stopped after 9 iterations
18.483 s H_error tensor(154.3536, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3188, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
13 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.053327322006226 s
stopped after 9 iterations
18.348 s H_error tensor(71.7886, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3136, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
13 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.110438585281372 s
stopped after 9 iterations
18.405 s H_error tensor(10.0427, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3080, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
13 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.45844388008118 s
stopped after 9 iterations
46.379 s H_error tensor(110.5381, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3111, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
13 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.42477869987488 s
stopped after 9 iterations
46.324 s H_error tensor(107.8346, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3101, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
13 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.15363645553589 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
46.58 s H_error tensor(4.8234, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
14 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.758370399475098 s
stopped after 9 iterations
19.053 s H_error tensor(146.9909, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3183, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
14 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.12751603126526 s
stopped after 9 iterations
18.429 s H_error tensor(152.0699, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3198, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
14 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.06567931175232 s
stopped after 9 iterations
18.36 s H_error tensor(70.9009, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3134, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
14 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.033923625946045 s
stopped after 9 iterations
18.33 s H_error tensor(10.9981, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3077, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
14 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.187336444854736 s
stopped after 9 iterations
46.11 s H_error tensor(122.0465, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3102, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
14 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.31102013587952 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
46.244 s H_error tensor(120.9357, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3101, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
14 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.59375238418579 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
47.037 s H_error tensor(5.5725, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3159, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
15 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.7258243560791 s
stopped after 9 iterations
19.02 s H_error tensor(148.7286, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3174, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
15 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.14230966567993 s
stopped after 9 iterations
18.437 s H_error tensor(155.4457, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3187, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
15 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.01102876663208 s
stopped after 9 iterations
18.308 s H_error tensor(71.5522, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3118, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
15 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.027742624282837 s
stopped after 9 iterations
18.325 s H_error tensor(12.0599, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3079, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
15 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.63222146034241 s
stopped after 9 iterations
46.539 s H_error tensor(134.1139, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3103, device='cuda:6', grad_fn=<DivBackward0>)
42995 MiB free out of 48676 MiB total
15 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.307907581329346 s
stopped after 9 iterations
46.223 s H_error tensor(132.2192, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3099, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
15 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.37564563751221 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
stopped after 9 iterations
46.814 s H_error tensor(7.1214, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3154, device='cuda:6', grad_fn=<DivBackward0>)
42967 MiB free out of 48676 MiB total
16 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.829264402389526 s
stopped after 9 iterations
19.126 s H_error tensor(142.6657, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3181, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
16 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.139208793640137 s
stopped after 9 iterations
18.435 s H_error tensor(153.1418, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3193, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
16 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.076377391815186 s
stopped after 9 iterations
18.374 s H_error tensor(80.2810, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3117, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
16 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.005794525146484 s
stopped after 9 iterations
18.305 s H_error tensor(10.6075, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3083, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
16 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.365476846694946 s
stopped after 9 iterations
46.286 s H_error tensor(154.9025, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3106, device='cuda:6', grad_fn=<DivBackward0>)
42995 MiB free out of 48676 MiB total
16 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.36601448059082 s
stopped after 9 iterations
46.271 s H_error tensor(149.0294, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3098, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
16 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.23968434333801 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.674 s H_error tensor(9.1782, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
42967 MiB free out of 48676 MiB total
17 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.06569266319275 s
stopped after 9 iterations
19.359 s H_error tensor(154.8086, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3167, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
17 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.590883493423462 s
stopped after 9 iterations
18.887 s H_error tensor(163.2960, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3183, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
17 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.366554498672485 s
stopped after 9 iterations
18.661 s H_error tensor(92.0809, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3110, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
17 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.430110692977905 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
18.727 s H_error tensor(13.4105, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3084, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
17 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.844929933547974 s
stopped after 9 iterations
46.755 s H_error tensor(174.2996, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3105, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
17 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.9626145362854 s
stopped after 9 iterations
46.891 s H_error tensor(167.9318, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3096, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
17 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.011171102523804 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
47.448 s H_error tensor(11.2306, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3163, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
18 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.108028888702393 s
stopped after 9 iterations
19.405 s H_error tensor(157.3342, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
18 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.05133605003357 s
stopped after 9 iterations
18.349 s H_error tensor(170.2228, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
18 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.129482746124268 s
stopped after 9 iterations
18.436 s H_error tensor(96.6984, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3116, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
18 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.01915144920349 s
stopped after 9 iterations
18.319 s H_error tensor(15.3605, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3103, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
18 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.19346284866333 s
stopped after 9 iterations
46.098 s H_error tensor(197.0749, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3095, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
18 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.26098871231079 s
stopped after 9 iterations
46.191 s H_error tensor(185.2476, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3088, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
18 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.50779747962952 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.944 s H_error tensor(13.0668, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3167, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
19 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.910603284835815 s
stopped after 9 iterations
19.208 s H_error tensor(149.7033, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3172, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
19 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.017669916152954 s
stopped after 9 iterations
18.32 s H_error tensor(154.3823, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3174, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
19 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.02451777458191 s
stopped after 9 iterations
18.32 s H_error tensor(104.4017, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3113, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
19 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.999969959259033 s
stopped after 9 iterations
18.297 s H_error tensor(15.2543, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3102, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
19 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.28926658630371 s
stopped after 9 iterations
46.206 s H_error tensor(216.9961, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3095, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
19 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.65603542327881 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
46.556 s H_error tensor(200.8115, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3086, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
19 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.32694149017334 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.76 s H_error tensor(15.1191, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3170, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
20 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.885856866836548 s
stopped after 9 iterations
19.182 s H_error tensor(167.1490, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3164, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
20 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.012704372406006 s
stopped after 9 iterations
18.308 s H_error tensor(172.5118, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3181, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
20 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.95059370994568 s
stopped after 9 iterations
18.246 s H_error tensor(120.0379, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3105, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
20 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.97337508201599 s
stopped after 9 iterations
18.266 s H_error tensor(16.9675, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3094, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
20 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.23513340950012 s
stopped after 9 iterations
46.154 s H_error tensor(237.2949, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3093, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
20 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.17773485183716 s
stopped after 9 iterations
46.092 s H_error tensor(218.1207, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3089, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
20 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.2069456577301 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.647 s H_error tensor(18.2354, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3167, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
21 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.87167000770569 s
stopped after 9 iterations
19.168 s H_error tensor(160.1830, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3162, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
21 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.11461043357849 s
stopped after 9 iterations
18.415 s H_error tensor(165.0821, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3170, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
21 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.04606032371521 s
stopped after 9 iterations
18.341 s H_error tensor(126.2298, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3102, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
21 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.19783902168274 s
stopped after 9 iterations
18.489 s H_error tensor(38.7718, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3124, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
21 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.458301305770874 s
stopped after 9 iterations
46.382 s H_error tensor(255.9090, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3095, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
21 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.348138093948364 s
stopped after 9 iterations
46.287 s H_error tensor(231.6642, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3084, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
21 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.11660099029541 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.555 s H_error tensor(20.3764, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3160, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
22 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.758787393569946 s
stopped after 9 iterations
19.055 s H_error tensor(176.1445, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3156, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
22 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.94434380531311 s
stopped after 9 iterations
18.236 s H_error tensor(180.8396, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
22 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.079225778579712 s
stopped after 9 iterations
18.375 s H_error tensor(133.7106, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3104, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
22 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.070835828781128 s
stopped after 9 iterations
18.366 s H_error tensor(15.5945, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3121, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
22 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.45778012275696 s
stopped after 9 iterations
46.364 s H_error tensor(274.4566, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3088, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
22 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.19283699989319 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
46.109 s H_error tensor(250.5797, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3084, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
22 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.109301805496216 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.551 s H_error tensor(21.9014, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3164, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
23 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.822680950164795 s
stopped after 9 iterations
19.12 s H_error tensor(169.3722, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3157, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
23 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.987301111221313 s
stopped after 9 iterations
18.285 s H_error tensor(171.2297, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3164, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
23 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.02097463607788 s
stopped after 9 iterations
18.313 s H_error tensor(147.4539, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3097, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
23 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.976818561553955 s
stopped after 9 iterations
18.271 s H_error tensor(51.3476, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3154, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
23 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.27767777442932 s
stopped after 9 iterations
46.195 s H_error tensor(286.3848, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3089, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
23 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.23920822143555 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
46.165 s H_error tensor(260.9714, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3081, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
23 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.260509729385376 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
46.69 s H_error tensor(22.8623, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3149, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
24 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.92612361907959 s
stopped after 9 iterations
19.219 s H_error tensor(185.6695, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3149, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
24 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.032562255859375 s
stopped after 9 iterations
18.33 s H_error tensor(188.0179, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3164, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
24 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.029065132141113 s
stopped after 9 iterations
18.323 s H_error tensor(164.3929, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3094, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
24 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.043537378311157 s
stopped after 9 iterations
18.339 s H_error tensor(26.7617, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3119, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
24 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.19210457801819 s
stopped after 9 iterations
47.11 s H_error tensor(306.2958, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3087, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
24 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.32950401306152 s
stopped after 9 iterations
46.267 s H_error tensor(281.9365, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3079, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
24 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.17964482307434 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
46.625 s H_error tensor(24.8800, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3147, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
25 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.834166765213013 s
stopped after 9 iterations
19.128 s H_error tensor(201.2564, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3152, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
25 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.1128830909729 s
stopped after 9 iterations
18.41 s H_error tensor(208.5334, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3160, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
25 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.071310997009277 s
stopped after 9 iterations
18.366 s H_error tensor(172.2465, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3096, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
25 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.003347873687744 s
stopped after 9 iterations
18.302 s H_error tensor(21.0430, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3114, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
25 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.39407157897949 s
stopped after 9 iterations
46.3 s H_error tensor(322.6707, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3086, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
25 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.42056393623352 s
reducing lr to  0.0009000000000000001
stopped after 9 iterations
46.355 s H_error tensor(298.4126, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3080, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
25 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.30511784553528 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
46.748 s H_error tensor(26.8101, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3148, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
26 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.949835300445557 s
stopped after 9 iterations
19.25 s H_error tensor(209.9520, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3144, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
26 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.048850536346436 s
stopped after 9 iterations
18.345 s H_error tensor(218.4551, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3156, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
26 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.988887071609497 s
stopped after 9 iterations
18.285 s H_error tensor(197.9042, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3095, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
26 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.039961338043213 s
stopped after 9 iterations
18.334 s H_error tensor(19.8256, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3103, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
26 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.569419860839844 s
stopped after 9 iterations
46.489 s H_error tensor(336.7247, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3088, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
26 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.503604888916016 s
stopped after 9 iterations
46.414 s H_error tensor(315.7728, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3081, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
26 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.08030676841736 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
reducing lr to  0.00059049
stopped after 9 iterations
46.515 s H_error tensor(28.0001, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3145, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
27 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.8679301738739 s
stopped after 9 iterations
19.164 s H_error tensor(211.3271, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3150, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
27 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.046820163726807 s
stopped after 9 iterations
18.345 s H_error tensor(216.4973, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3147, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
27 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.988871812820435 s
stopped after 9 iterations
18.285 s H_error tensor(205.9073, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3095, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
27 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.93691849708557 s
stopped after 9 iterations
18.229 s H_error tensor(14.7790, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3085, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
27 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.282490491867065 s
stopped after 9 iterations
46.202 s H_error tensor(347.0676, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3090, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
27 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.14905619621277 s
stopped after 9 iterations
46.092 s H_error tensor(331.0077, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3089, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
27 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.26981234550476 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.701 s H_error tensor(29.8317, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
28 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.83533811569214 s
stopped after 9 iterations
19.132 s H_error tensor(192.6292, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
28 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.116376876831055 s
stopped after 9 iterations
18.415 s H_error tensor(196.2566, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3166, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
28 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.99104881286621 s
stopped after 9 iterations
18.291 s H_error tensor(193.6235, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3095, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
28 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.92722463607788 s
stopped after 9 iterations
18.222 s H_error tensor(33.5854, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3102, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
28 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.538899183273315 s
stopped after 9 iterations
46.471 s H_error tensor(362.2006, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3094, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
28 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.44991707801819 s
stopped after 9 iterations
46.379 s H_error tensor(351.3209, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3094, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
28 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.384068727493286 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
reducing lr to  0.000729
reducing lr to  0.0006561000000000001
stopped after 9 iterations
46.827 s H_error tensor(33.5662, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3205, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
29 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.723275899887085 s
stopped after 9 iterations
19.017 s H_error tensor(194.7084, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3161, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
29 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.16420578956604 s
stopped after 9 iterations
18.458 s H_error tensor(202.2929, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3168, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
29 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.969826698303223 s
stopped after 9 iterations
18.264 s H_error tensor(213.7110, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3100, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
29 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 17.970030069351196 s
reducing lr to  0.0009000000000000001
reducing lr to  0.0008100000000000001
stopped after 9 iterations
18.263 s H_error tensor(30.3099, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3105, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
29 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.23511219024658 s
stopped after 9 iterations
46.15 s H_error tensor(368.1938, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3106, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
29 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.36934447288513 s
stopped after 9 iterations
46.299 s H_error tensor(362.1889, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3114, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
29 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.192529916763306 s
stopped after 9 iterations
46.635 s H_error tensor(36.8519, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3262, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
30 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.787965059280396 s
stopped after 9 iterations
19.081 s H_error tensor(179.3221, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3152, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
30 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.21106719970703 s
stopped after 9 iterations
18.507 s H_error tensor(187.6819, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3170, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
30 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.398964881896973 s
stopped after 9 iterations
18.696 s H_error tensor(189.6402, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3102, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
30 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.440855026245117 s
stopped after 9 iterations
18.735 s H_error tensor(30.2874, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3118, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
30 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.884164810180664 s
stopped after 9 iterations
46.802 s H_error tensor(369.8085, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3122, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
30 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.06101202964783 s
stopped after 9 iterations
46.98 s H_error tensor(364.6713, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3129, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
30 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.73099374771118 s
stopped after 9 iterations
47.171 s H_error tensor(49.7819, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3477, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
31 self_attn.q_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 19.11289143562317 s
stopped after 9 iterations
19.41 s H_error tensor(125.5853, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3167, device='cuda:6', grad_fn=<DivBackward0>)
43125 MiB free out of 48676 MiB total
31 self_attn.k_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.409043073654175 s
stopped after 9 iterations
18.713 s H_error tensor(135.9820, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3175, device='cuda:6', grad_fn=<DivBackward0>)
43157 MiB free out of 48676 MiB total
31 self_attn.v_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.647371530532837 s
stopped after 9 iterations
18.943 s H_error tensor(103.5598, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3130, device='cuda:6', grad_fn=<DivBackward0>)
43189 MiB free out of 48676 MiB total
31 self_attn.o_proj
Pruning ...
Normalized clustering
torch.Size([4096, 1024, 4]) torch.Size([1024, 4])
torch.Size([4194304, 4])
torch.Size([4194304, 4])
finished clustering in 18.453483819961548 s
stopped after 9 iterations
18.737 s H_error tensor(38.2582, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3204, device='cuda:6', grad_fn=<DivBackward0>)
43221 MiB free out of 48676 MiB total
31 mlp.gate_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 46.248788595199585 s
stopped after 9 iterations
47.166 s H_error tensor(326.4338, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3150, device='cuda:6', grad_fn=<DivBackward0>)
43167 MiB free out of 48676 MiB total
31 mlp.up_proj
Pruning ...
Normalized clustering
torch.Size([11008, 1024, 4]) torch.Size([1024, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.76031494140625 s
stopped after 9 iterations
46.682 s H_error tensor(319.0116, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3153, device='cuda:6', grad_fn=<DivBackward0>)
43113 MiB free out of 48676 MiB total
31 mlp.down_proj
Pruning ...
Normalized clustering
torch.Size([4096, 2752, 4]) torch.Size([2752, 4])
torch.Size([11272192, 4])
torch.Size([11272192, 4])
finished clustering in 45.06602692604065 s
stopped after 9 iterations
46.521 s H_error tensor(91.0693, device='cuda:6', grad_fn=<ViewBackward0>) average_error tensor(0.3944, device='cuda:6', grad_fn=<DivBackward0>)
43431 MiB free out of 48676 MiB total
Total bits: 14273219584.0 Total params: 6476005376
average bits per value: 2.20401601840795
7138.979962110519
Loading tokenizer for huggyllama/llama-7b
/home/lliu/anaconda3/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Token indices sequence length is longer than the specified maximum sequence length for this model (2824491 > 2048). Running this sequence through the model will result in indexing errors
Dataset: wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
Perplexity: 7.759488
